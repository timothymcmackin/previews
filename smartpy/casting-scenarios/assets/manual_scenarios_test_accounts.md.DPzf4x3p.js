import{D as t}from"./chunks/DocFunction.Doty0qhz.js";import{c as h,o as p,aj as n,G as e,w as l,j as s,a as i}from"./chunks/framework.BHElM6wE.js";/* empty css                                                                           */const g=JSON.parse('{"title":"Test accounts","description":"","frontmatter":{},"headers":[],"relativePath":"manual/scenarios/test_accounts.md","filePath":"manual/scenarios/test_accounts.md"}'),k={name:"manual/scenarios/test_accounts.md"},u=Object.assign(k,{setup(d){return(c,a)=>(p(),h("div",null,[a[2]||(a[2]=n(`<h1 id="test-accounts" tabindex="-1">Test accounts <a class="header-anchor" href="#test-accounts" aria-label="Permalink to &quot;Test accounts&quot;">â€‹</a></h1><p>In tests, you can create and use accounts in two ways:</p><ul><li>Generate test accounts by passing a seed string to <span class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sp.test_account</span></span></code></span>. This function returns an object with the address of the test account in its <span class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">address</span></span></code></span> property.</li><li>Create objects of type <span class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sp.address</span></span></code></span>.</li></ul><p>Test accounts generated with <span class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sp.test_account</span></span></code></span> have implicit account addresses (starting with <span class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tz1</span></span></code></span>). For more information about address types, see <a href="./../data-types/addresses#address-types">Address Types</a>.</p><p>To simulate calling a smart contract from a certain account, pass the address of the account (either the test account&#39;s <span class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">address</span></span></code></span> property or the <span class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sp.address</span></span></code></span> object) as the <span class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">_sender</span></span></code></span> or <span class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">_source</span></span></code></span> property in the call to the entrypoint, as in this example:</p><div class="language-smartpy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">smartpy</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@sp.module</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">():</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MyContract</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Contract</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        def</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> __init__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self, admin):</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.data.adminAccount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> admin</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        @sp.entrypoint</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setAdmin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self, newAdmin):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            assert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sp.sender </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.data.adminAccount, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Must be admin&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.data.adminAccount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newAdmin</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@sp.add_test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">():</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Create test accounts</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    alice </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sp.test_account(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Alice&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bob </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sp.address(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;tz1QCVQinE8iVj1H2fckqx6oiM85CNJSK9Sx&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    scenario </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sp.test_scenario(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Admin test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, main)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    contract </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> main.MyContract(alice.address)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    scenario </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> contract</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Verify that non-admin account can&#39;t change the admin</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    contract.setAdmin(bob, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">_sender</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bob, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">_valid</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Verify that the admin can change the admin</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    contract.setAdmin(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        bob,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        _sender</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">alice,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    scenario.verify(contract.data.adminAccount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> bob)</span></span></code></pre></div><p>For more information about calling entrypoints in tests, see <a href="./testing_contracts">Testing contracts</a>.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Using real addresses in test scenarios can simplify deploying contracts. For example, if you use your real account address as the administrator of a contract and compile the contract, the output storage file has your address in it. You can then use that compiled storage file as the initial storage value for the contract.</p><p>However, if you want to create or verify <a href="./../data-types/keys-and-signatures">cryptographic signatures</a> with <span class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sp.make_signature</span></span></code></span> and <span class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sp.check_signature</span></span></code></span> in tests, you must use test accounts and not <span class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sp.address</span></span></code></span> types.</p></div>`,8)),e(t,{name:"sp.test_account",arg:"seed",rType:"test_account"},{default:l(()=>a[0]||(a[0]=[s("p",null,[i("Create a "),s("em",null,"deterministic"),i(" keypair from a seed string. This function always creates the same keypair for the same seed.")],-1),s("div",{class:"language-python vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# seed is `Alice`")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"alice "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," sp.test_account("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Alice"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")])])])],-1),s("p",null,"This command produces an object with the following properties:",-1),s("table",{tabindex:"0"},[s("thead",null,[s("tr",null,[s("th",null,"Property"),s("th",null,"Type"),s("th",null,"Description")])]),s("tbody",null,[s("tr",null,[s("td",null,"alice.address"),s("td",null,[s("span",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"sp.address")])])])]),s("td",null,"Gives the public-key-hash")]),s("tr",null,[s("td",null,"alice.public_key_hash"),s("td",null,[s("span",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"sp.key_hash")])])])]),s("td",null,"Gives the public-key-hash")]),s("tr",null,[s("td",null,"alice.public_key"),s("td",null,[s("span",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"sp.key")])])])]),s("td",null,"Gives the public-key")]),s("tr",null,[s("td",null,"alice.secret_key"),s("td",null,[s("a",{href:"./../data-types/strings-and-bytes#strings"},[s("span",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"sp.string")])])])])]),s("td",null,"Gives the secret-key")])])],-1)])),_:1,__:[0]}),e(t,{name:"sp.make_signature",arg:"secret_key, message, message_format = 'Raw'",rType:"sp.signature"},{default:l(()=>a[1]||(a[1]=[s("p",null,[i("Creates a signature compatible with the "),s("a",{href:"./../data-types/keys-and-signatures"},"sp.check_signature(...)"),i(" function.")],-1),s("p",null,[i("The "),s("span",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"message_format")])])]),i(" parameter accepts two values:")],-1),s("ul",null,[s("li",null,[s("span",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Hex")])])]),i(", in which case the message is interpreted as a hexadecimal string")]),s("li",null,[s("span",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Raw")])])]),i(" (the default) in which case the message is a "),s("a",{href:"./../data-types/strings-and-bytes#bytes"},[s("span",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"sp.bytes")])])])]),i(" value, usually the result of an "),s("span",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"sp.pack")])])]),i(" call.")])],-1)])),_:1,__:[1]}),a[3]||(a[3]=n('<p>For an example of creating and checking signatures with <span class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sp.make_signature</span></span></code></span>, see the &quot;Signatures&quot; template in the SmartPy online IDE.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>You can&#39;t use <span class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sp.test_account</span></span></code></span> or <span class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sp.make_signature</span></span></code></span> in smart contracts because Michelson can&#39;t manipulate secret keys.</p></div>',2))]))}});export{g as __pageData,u as default};
