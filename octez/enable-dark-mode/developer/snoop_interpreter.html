
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Snoop and the Michelson Interpreter &#8212; Octez &amp; Protocol products documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=3301396a" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=eee15179"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-KT3Z3X4Y82"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-KT3Z3X4Y82');
            </script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-KT3Z3X4Y82');
            </script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'developer/snoop_interpreter';</script>
    <script src="../_static/js/custom.js?v=e7f469e6"></script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Time measurement PPX" href="time_measurement_ppx.html" />
    <link rel="prev" title="Rewriting Micheline with tezos-micheline-rewriting" href="tezos_micheline_rewriting.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.svg" class="logo__image only-light" alt="Octez & Protocol products documentation - Home"/>
    <script>document.write(`<img src="../_static/logo.svg" class="logo__image only-dark" alt="Octez & Protocol products documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../introduction/tezos.html">Octez &amp; Protocol overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../introduction/howtoget.html">Installing Octez</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/cosign-verify.html">Verifying Octez Docker Images with Cosign</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/get_troubleshooting.html">Installation troubleshooting</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/howtouse.html">Getting started with Octez</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/howtorun.html">Running Octez</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/services.html">Setting up Octez Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/versioning.html">Octez &amp; Protocol versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/breaking_changes.html">BREAKING CHANGES</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Octez User manual</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../user/setup-client.html">Setting up the client</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../user/client-configuration.html">Client Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/key-management.html">Key Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/sandbox.html">Sandboxed mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/mockup.html">Mockup mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/proxy.html">Proxy mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/light.html">Light mode</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../user/setup-node.html">Setting up the node</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../user/node-configuration.html">Node Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/multinetwork.html">Connecting to a Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/history_modes.html">History modes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/snapshots.html">Snapshots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/proxy-server.html">Proxy server</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../user/node-monitoring.html">Monitoring an Octez Node</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="openmetrics.html">Supported Open Metrics</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../user/teztale.html">Monitoring the consensus protocol</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../user/multisig.html">Built-in multisig contracts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/fa12.html">FA1.2 support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/logging.html">Logging features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/exits.html">Exit codes and signals</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Octez Reference manual</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../shell/the_big_picture.html">Octez Software Architecture</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../shell/shell.html">The Octez Shell</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../shell/validation.html">The validation subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/prevalidation.html">The Prevalidator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/storage.html">The storage layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/sync.html">Synchronisation heuristic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/p2p.html">The peer-to-peer layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/protocol_environment.html">Protocol Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/micheline.html">Micheline</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../shell/data_availability_committees.html">Data Availability Committees</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../shell/dal.html">Data Availability Layer</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../shell/dal_overview.html">DAL overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/dal_node.html">The DAL node</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/dal_bakers.html">Bakers &amp; the DAL</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../shell/smart_rollup_node.html">Smart rollup node</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shell/p2p_api.html">P2P message format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shell/cli-commands.html">Command Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shell/rpc.html">Shell RPCs - Reference</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Protocol Reference Manuals</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../active/index.html">Paris Protocol Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../active/protocol.html">Economic protocol features</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../active/protocol_overview.html">Overview of the economic protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/proof_of_stake.html">Proof-of-stake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/randomness_generation.html">Randomness generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/consensus.html">The consensus algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/voting.html">The Amendment (and Voting) Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/accounts.html">Accounts and addresses</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/michelson.html">Michelson: the language of Smart Contracts in Tezos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/views.html">On-chain Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/timelock.html">Time-lock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/sapling.html">Sapling support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/liquidity_baking.html">Liquidity Baking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/global_constants.html">Global Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/michelson_anti_patterns.html">Michelson Anti-Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/token_management.html">Token transfers and balance updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/precheck.html">Prechecking of manager operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/smart_rollups.html">Smart Optimistic Rollups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/plugins.html">Protocol Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/event.html">Contract events</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/blocks_ops.html">Blocks and Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/validation.html">Validation and Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/tickets.html">Tickets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/adaptive_issuance.html">Adaptive Issuance and Staking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/adaptive_slashing.html">Adaptive Slashing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/dal_support.html">DAL support</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../active/glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../active/cli-commands.html">Command Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../active/rpc.html">Paris RPCs - Reference</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../quebeca/index.html">Quebeca Protocol Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../quebeca/protocol.html">Economic protocol features</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/protocol_overview.html">Overview of the economic protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/proof_of_stake.html">Proof-of-stake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/randomness_generation.html">Randomness generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/baking_power.html">Baking Power</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/consensus.html">The consensus algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/voting.html">The Amendment (and Voting) Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/accounts.html">Accounts and addresses</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/michelson.html">Michelson: the language of Smart Contracts in Tezos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/views.html">On-chain Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/timelock.html">Time-lock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/sapling.html">Sapling support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/liquidity_baking.html">Liquidity Baking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/global_constants.html">Global Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/michelson_anti_patterns.html">Michelson Anti-Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/token_management.html">Token transfers and balance updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/precheck.html">Prechecking of manager operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/smart_rollups.html">Smart Optimistic Rollups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/plugins.html">Protocol Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/event.html">Contract events</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/blocks_ops.html">Blocks and Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/validation.html">Validation and Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/tickets.html">Tickets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/adaptive_issuance.html">Adaptive Issuance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/staking.html">Staking mechanism</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/adaptive_slashing.html">Adaptive Slashing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/dal_support.html">DAL support</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../quebeca/glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quebeca/cli-commands.html">Command Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quebeca/rpc.html">Quebeca RPCs - Reference</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../alpha/index.html">Alpha Dev Protocol Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../alpha/protocol.html">Economic protocol features</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../alpha/protocol_overview.html">Overview of the economic protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/proof_of_stake.html">Proof-of-stake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/randomness_generation.html">Randomness generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/baking_power.html">Baking Power</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/consensus.html">The consensus algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/voting.html">The Amendment (and Voting) Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/accounts.html">Accounts and addresses</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/michelson.html">Michelson: the language of Smart Contracts in Tezos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/views.html">On-chain Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/timelock.html">Time-lock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/sapling.html">Sapling support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/liquidity_baking.html">Liquidity Baking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/global_constants.html">Global Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/michelson_anti_patterns.html">Michelson Anti-Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/token_management.html">Token transfers and balance updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/precheck.html">Prechecking of manager operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/smart_rollups.html">Smart Optimistic Rollups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/plugins.html">Protocol Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/event.html">Contract events</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/blocks_ops.html">Blocks and Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/validation.html">Validation and Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/tickets.html">Tickets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/adaptive_issuance.html">Adaptive Issuance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/staking.html">Staking mechanism</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/adaptive_slashing.html">Adaptive Slashing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/dal_support.html">DAL support</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../alpha/glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../alpha/cli-commands.html">Command Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../alpha/rpc.html">Alpha RPCs - Reference</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tezos developer Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="rpc.html">JSON/RPC interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/errors.html">RPC Errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/openapi.html">RPCs - OpenAPI reference</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Changes in Octez releases</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../releases/releases.html">Release System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases/version-20.html">Version 20.2</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../releases/history.html">Older Versions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-19.html">Version 19.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-18.html">Version 18.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-17.html">Version 17.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-16.html">Version 16.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-15.html">Version 15.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-14.html">Version 14.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-13.html">Version 13.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-12.html">Version 12.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-11.html">Version 11.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-10.html">Version 10.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-9.html">Version 9.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-8.html">Version 8.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-7.html">Version 7.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/january-2020.html">Mainnet January 2020</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/december-2019.html">Mainnet December 2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/october-2019.html">Mainnet-Staging October 2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/september-2019.html">Mainnet September 2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/may-2019.html">Mainnet May 2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/april-2019.html">Mainnet April 2019</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Changes in protocol versions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../protocols/naming.html">Protocol versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../protocols/019_paris.html">Protocol Paris</a></li>
<li class="toctree-l1"><a class="reference internal" href="../protocols/021_quebeca.html">Protocol Quebeca</a></li>
<li class="toctree-l1"><a class="reference internal" href="../protocols/alpha.html">Protocol Alpha</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../protocols/history.html">Older Protocols</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../protocols/018_oxford.html">Protocol Oxford</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/017_nairobi.html">Protocol Nairobi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/016_mumbai.html">Protocol Mumbai</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/015_lima.html">Protocol Lima</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/014_kathmandu.html">Protocol Kathmandu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/013_jakarta.html">Protocol Jakarta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/012_ithaca.html">Protocol Ithaca</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/011_hangzhou.html">Protocol Hangzhou</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/010_granada.html">Protocol Granada</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/009_florence.html">Protocol Florence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/008_edo.html">Protocol Edo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/007_delphi.html">Protocol Delphi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/006_carthage.html">Protocol Carthage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/005_babylon.html">Protocol Babylon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/004_Pt24m4xi.html">Protocol Athens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/003_PsddFKi3.html">Protocol 003_PsddFKi3</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="contributing_index.html">How to contribute</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="contributing.html">How to contribute to Octez</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="contributing-adding-a-new-opam-dependency.html">How to add or update opam dependencies</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="merge_team.html">Octez Merge Team</a></li>
<li class="toctree-l2"><a class="reference internal" href="guidelines.html">Documentation and coding guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="repository_scope.html">Scope of the Octez repository</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="programming.html">Programming tutorials</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="gadt.html">Generalized Algebraic Data Types (GADTs)</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="error_monad.html">The Error Monad</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="error_monad_p1_result.html">Part 1: <code class="docutils literal notranslate"><span class="pre">result</span></code>, Lwt, and Lwt-<code class="docutils literal notranslate"><span class="pre">result</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="error_monad_p2_tzresult.html">Part 2: <code class="docutils literal notranslate"><span class="pre">tzresult</span></code> and Lwt-<code class="docutils literal notranslate"><span class="pre">tzresult</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="error_monad_p3_advanced.html">Part 3: Advanced topics</a></li>
<li class="toctree-l3"><a class="reference internal" href="error_monad_p4_appendices.html">Part 4: Appendices</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="clic.html">The <code class="docutils literal notranslate"><span class="pre">clic</span></code> library</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_encoding.html">The <code class="docutils literal notranslate"><span class="pre">data_encoding</span></code> library</a></li>
<li class="toctree-l2"><a class="reference internal" href="event_logging_framework.html">Using The Event Logging Framework</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="testing_index.html">Testing in Octez</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="testing.html">Overview of Testing in Octez</a></li>
<li class="toctree-l2"><a class="reference internal" href="ppx_expect.html">Ppx_expect</a></li>
<li class="toctree-l2"><a class="reference internal" href="tezt.html">Tezt: OCaml Tezos Test Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="long-tezts.html">Tezt: Long Tests and Performance Regression Test Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="alcotezt.html">Alcotezt: An Alcotest Compatibility Wrapper for Tezt</a></li>
<li class="toctree-l2"><a class="reference internal" href="unit_testing_legacy_code.html">Making legacy code unit-testable</a></li>
<li class="toctree-l2"><a class="reference internal" href="proposal_testing.html">How to Test a Protocol Proposal</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="maintaining.html">Maintaining</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="entering_alpha.html">How to start reading protocol Alpha</a></li>
<li class="toctree-l2"><a class="reference internal" href="michelson_instructions.html">Adding a new instruction to Michelson language</a></li>
<li class="toctree-l2"><a class="reference internal" href="protocol_release_checklist.html">Protocol Release Checklist</a></li>
<li class="toctree-l2"><a class="reference internal" href="howto-freeze-protocols.html">How to Freeze Protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="protocol_environment_upgrade.html">Adding a new protocol environment</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Documenting</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="tools.html">Platform Development tools</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="profiling.html">Profiling the Octez node</a></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="snoop.html">Benchmarking with Snoop</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="snoop_arch.html">Architecture of <code class="docutils literal notranslate"><span class="pre">octez-snoop</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="snoop_tutorial.html">Snoop usage tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="snoop_example.html">In-depth usage example: more control over your benchmark</a></li>
<li class="toctree-l3"><a class="reference internal" href="tezos_micheline_rewriting.html">Rewriting Micheline with <code class="docutils literal notranslate"><span class="pre">tezos-micheline-rewriting</span></code></a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Snoop and the Michelson Interpreter</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="time_measurement_ppx.html">Time measurement PPX</a></li>
<li class="toctree-l2"><a class="reference internal" href="python_environment.html">Python Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="pre_commit_hook.html">Pre-Commit Hook</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="encodings.html">Encodings</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="merkle-proof-encoding-formats.html">Merkle Proof Encoding Formats</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="merkle-proof-formats/v1-tree32.html">V1 for Tree32</a></li>
<li class="toctree-l2"><a class="reference internal" href="merkle-proof-formats/v1-tree2.html">V1 for Tree2</a></li>
<li class="toctree-l2"><a class="reference internal" href="merkle-proof-formats/v2-tree32.html">V2 for Tree32</a></li>
<li class="toctree-l2"><a class="reference internal" href="merkle-proof-formats/v2-tree2.html">V2 for Tree2</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../api/api-inline.html">OCaml APIs - Reference</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-gitlab"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://gitlab.com/tezos/tezos" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-gitlab"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://gitlab.com/tezos/tezos/-/issues/new?issue[title]=Issue%20on%20page%20%2Fdeveloper/snoop_interpreter.html&issue[description]=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Snoop and the Michelson Interpreter</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpreter-workload">Interpreter Workload</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpreter-models">Interpreter Models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpreter-benchmarks">Interpreter benchmarks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-simple-benchmark">A simple benchmark</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-simple-benchmark-with-an-intercept-stack">A simple benchmark with an intercept stack</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-less-simple-benchmark">A less simple benchmark</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#testing">Testing</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="snoop-and-the-michelson-interpreter">
<h1>Snoop and the Michelson Interpreter<a class="headerlink" href="#snoop-and-the-michelson-interpreter" title="Link to this heading">#</a></h1>
<p>In order to evaluate gas costs for the Michelson interpreter, we want to have a collection of benchmarks and models that cover every instruction of the language. This document explains how to modify the files in <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/src/proto_alpha/lib_benchmarks_proto/">src/proto_alpha/lib_benchmarks_proto/</a> in order to fully integrate a new instruction for <code class="docutils literal notranslate"><span class="pre">octez-snoop</span></code>.</p>
<section id="interpreter-workload">
<h2>Interpreter Workload<a class="headerlink" href="#interpreter-workload" title="Link to this heading">#</a></h2>
<p>We first need to update the <code class="docutils literal notranslate"><span class="pre">interpreter_workload.ml</span></code> file. It specifies the data that is collected and saved as a <code class="docutils literal notranslate"><span class="pre">workload</span></code> for each benchmark. First, we add an entry to <code class="docutils literal notranslate"><span class="pre">instruction_name</span></code> with the name of the new instruction prefixed with <code class="docutils literal notranslate"><span class="pre">N_</span></code>, it will be the name <code class="docutils literal notranslate"><span class="pre">octez-snoop</span></code> will refer to this instruction as. Then add it to the list <code class="docutils literal notranslate"><span class="pre">all_instructions</span></code>, and update <code class="docutils literal notranslate"><span class="pre">string_of_instruction_name</span></code>. Now, we can add a function to the <code class="docutils literal notranslate"><span class="pre">Instructions</span></code> module. This function should take a number, possibly zero, of integer arguments that defines our workload. We want these arguments to be the different parameters that may influence the benchmarking time. For instance, the time <code class="docutils literal notranslate"><span class="pre">DIG</span></code> takes to be executed varies with the depth of digging, so the <code class="docutils literal notranslate"><span class="pre">depth</span></code> should be in the workload:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">module</span> <span class="nc">Instructions</span> <span class="o">=</span> <span class="k">struct</span>
  <span class="o">(...)</span>
  <span class="k">let</span> <span class="n">dig</span> <span class="n">depth</span> <span class="o">=</span> <span class="n">ir_sized_step</span> <span class="nc">N_IDig</span> <span class="o">(</span><span class="n">unary</span> <span class="s2">&quot;depth&quot;</span> <span class="n">depth</span><span class="o">)</span>
</pre></div>
</div>
<p>We make these functions by calling <code class="docutils literal notranslate"><span class="pre">ir_sized_step</span></code> with the instruction name we defined above, and a list of arguments, usually formed with the helper functions <code class="docutils literal notranslate"><span class="pre">nullary</span></code>, <code class="docutils literal notranslate"><span class="pre">unary</span></code>, <code class="docutils literal notranslate"><span class="pre">binary</span></code>, etcâ€¦ Each argument must be given a descriptive name, like <code class="docutils literal notranslate"><span class="pre">length</span></code>, or <code class="docutils literal notranslate"><span class="pre">int1</span></code> and <code class="docutils literal notranslate"><span class="pre">int2</span></code>. Note that the order of the elements matters, as it will be the order in which they will be passed to the model later.</p>
<p>The only step left here is to update the <code class="docutils literal notranslate"><span class="pre">extract_ir_sized_step</span></code> function: update the pattern matching to include the new instruction, extract the relevant data from the instruction and the stack, and call the newly built function.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">extract_ir_sized_step</span> <span class="o">:</span>
 <span class="k">fun</span> <span class="n">ctxt</span> <span class="n">instr</span> <span class="n">stack</span> <span class="o">-&gt;</span>
  <span class="k">let</span> <span class="k">open</span> <span class="nc">Script_typed_cps_ir</span> <span class="k">in</span>
  <span class="k">match</span> <span class="o">(</span><span class="n">instr</span><span class="o">,</span> <span class="n">stack</span><span class="o">)</span> <span class="k">with</span>
  <span class="o">(...)</span>
  <span class="o">|</span> <span class="o">(</span><span class="nc">INil</span> <span class="o">(_,</span> <span class="o">_),</span> <span class="o">_)</span> <span class="o">-&gt;</span>
      <span class="nn">Instructions</span><span class="p">.</span><span class="n">nil</span>
  <span class="o">|</span> <span class="o">(</span><span class="nc">IDig</span> <span class="o">(_,</span> <span class="n">n</span><span class="o">,</span> <span class="o">_,</span> <span class="o">_),</span> <span class="o">_)</span> <span class="o">-&gt;</span>
      <span class="nn">Instructions</span><span class="p">.</span><span class="n">dig</span> <span class="n">n</span>
  <span class="o">|</span> <span class="o">(</span><span class="nc">IConcat_bytes</span> <span class="o">(_,</span> <span class="o">_),</span> <span class="o">(</span><span class="n">ss</span><span class="o">,</span> <span class="o">_))</span> <span class="o">-&gt;</span>
      <span class="k">let</span> <span class="n">list_size</span> <span class="o">=</span> <span class="nn">Size</span><span class="p">.</span><span class="n">list</span> <span class="n">ss</span> <span class="k">in</span>
      <span class="k">let</span> <span class="n">total_bytes</span> <span class="o">=</span>
        <span class="nn">List</span><span class="p">.</span><span class="n">fold_left</span>
          <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="n">s</span> <span class="o">-&gt;</span> <span class="nn">Size</span><span class="p">.</span><span class="o">(</span><span class="n">add</span> <span class="n">x</span> <span class="o">(</span><span class="n">bytes</span> <span class="n">s</span><span class="o">)))</span>
          <span class="nn">Size</span><span class="p">.</span><span class="n">zero</span>
          <span class="n">ss</span><span class="o">.</span><span class="n">elements</span>
      <span class="k">in</span>
      <span class="nn">Instructions</span><span class="p">.</span><span class="n">concat_bytes</span> <span class="n">list_size</span> <span class="n">total_bytes</span>
</pre></div>
</div>
<p>Here are three examples: the first one is <code class="docutils literal notranslate"><span class="pre">Nil</span></code>, its execution time is constant, so its function is called as is, and its workload will be empty. For <code class="docutils literal notranslate"><span class="pre">Dig</span></code>, the depth needs to be passed to the <code class="docutils literal notranslate"><span class="pre">Instructions.dig</span></code> function, and it will simply be saved in its workload, to be used later for the model. The last example requires some computation: the execution time of <code class="docutils literal notranslate"><span class="pre">Concat_bytes</span></code> depends on the size of the list on top of the stack, as well as the total number of bytes to concatenate. We calculate these values here, so we can retrieve the appropriate workload.</p>
<p>In that last example, we use the module <code class="docutils literal notranslate"><span class="pre">Size</span></code> to convert the bytes into their size as an integer. It is oftentimes more appropriate to consider the size of the arguments, instead of their values, as the actual workload on the instructions.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">match</span> <span class="o">(</span><span class="n">instr</span><span class="o">,</span> <span class="n">stack</span><span class="o">)</span> <span class="k">with</span>
  <span class="o">(...)</span>
  <span class="o">|</span> <span class="o">(</span><span class="nc">IMul_teznat</span> <span class="o">(_,</span> <span class="o">_),</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="o">_)))</span> <span class="o">-&gt;</span>
      <span class="nn">Instructions</span><span class="p">.</span><span class="n">mul_teznat</span> <span class="o">(</span><span class="nn">Size</span><span class="p">.</span><span class="n">mutez</span> <span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="nn">Size</span><span class="p">.</span><span class="n">integer</span> <span class="n">y</span><span class="o">)</span>
</pre></div>
</div>
<p>In this example, and for most mathematical operations in Michelson, the computation time actually depends on the size in memory of the arguments, not their values. Here, the size of an integer is the number of bytes needed to represent them, likewise for mutez. In this kind of scenario, we will make use of the <code class="docutils literal notranslate"><span class="pre">Size</span></code> module.</p>
</section>
<section id="interpreter-models">
<h2>Interpreter Models<a class="headerlink" href="#interpreter-models" title="Link to this heading">#</a></h2>
<p>We now need to specify a cost model for the instruction in <code class="docutils literal notranslate"><span class="pre">interpreter_model.ml</span></code>. Said models are in the module <code class="docutils literal notranslate"><span class="pre">Models</span></code>, which already contains many generic ones.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">module</span> <span class="nc">Models</span> <span class="o">=</span> <span class="k">struct</span>
  <span class="k">let</span> <span class="n">const1_model</span> <span class="n">name</span> <span class="o">=</span>
    <span class="nn">Model</span><span class="p">.</span><span class="n">unknown_const1</span> <span class="o">~</span><span class="n">const</span><span class="o">:(</span><span class="n">fv</span> <span class="o">(</span><span class="n">sf</span> <span class="s2">&quot;%s_const&quot;</span> <span class="n">name</span><span class="o">))</span>

  <span class="k">let</span> <span class="n">affine_model</span> <span class="n">name</span> <span class="o">=</span>
    <span class="nn">Model</span><span class="p">.</span><span class="n">affine</span>
      <span class="o">~</span><span class="n">intercept</span><span class="o">:(</span><span class="n">fv</span> <span class="o">(</span><span class="n">sf</span> <span class="s2">&quot;%s_const&quot;</span> <span class="n">name</span><span class="o">))</span>
      <span class="o">~</span><span class="n">coeff</span><span class="o">:(</span><span class="n">fv</span> <span class="o">(</span><span class="n">sf</span> <span class="s2">&quot;%s_coeff&quot;</span> <span class="n">name</span><span class="o">))</span>

  <span class="o">(...)</span>
</pre></div>
</div>
<p>They directly derive from generic models available in <code class="docutils literal notranslate"><span class="pre">model.ml</span></code>. <code class="docutils literal notranslate"><span class="pre">const1_model</span></code> is used for constant-time instructions, <code class="docutils literal notranslate"><span class="pre">affine_model</span></code> is for instructions with cost function <span class="math notranslate nohighlight">\(\lambda size. const + coeff * size\)</span>, where <code class="docutils literal notranslate"><span class="pre">size</span></code> is a value that appears in the workload, while <code class="docutils literal notranslate"><span class="pre">const</span></code> and <code class="docutils literal notranslate"><span class="pre">coeff</span></code> are free variables, etcâ€¦ Note that the arity of the model must match the number of elements in the workload. Some instructions may require a specific model that does not yet exist. In this case, we can add it to the <code class="docutils literal notranslate"><span class="pre">Models</span></code> module, like <code class="docutils literal notranslate"><span class="pre">join_tickets_model</span></code>, which has arity 4, and is exclusively used for the instruction <code class="docutils literal notranslate"><span class="pre">IJoin_tickets</span></code>.</p>
<p>The affine model expects an argument for the constant value, called <code class="docutils literal notranslate"><span class="pre">intercept</span></code>. It is the execution time of the instruction when the workload is 0. Some models assume that the intercept is 0, like the linear models. Otherwise, we may want to make two benchmarks for the instruction, one of which made exclusively for the computation of that <code class="docutils literal notranslate"><span class="pre">intercept</span></code>.</p>
<p>When a model has been chosen, we can update the function <code class="docutils literal notranslate"><span class="pre">ir_model</span></code>. Add your instruction to the pattern matching, and return the following</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="n">model_</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="n">instr_or_cont</span> <span class="o">([</span><span class="n">your_model</span><span class="o">]</span> <span class="n">name</span><span class="o">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">your_model</span></code> is your choosen model, and <code class="docutils literal notranslate"><span class="pre">i</span></code> its arrity. For instance:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">|</span> <span class="nc">N_INil</span> <span class="o">-&gt;</span>
     <span class="n">model_0</span> <span class="n">instr_or_cont</span> <span class="o">(</span><span class="n">const1_model</span> <span class="n">name</span><span class="o">)</span>
<span class="o">|</span> <span class="nc">N_IDig</span> <span class="o">|</span> <span class="nc">N_IDug</span> <span class="o">|</span> <span class="nc">N_IDipN</span> <span class="o">|</span> <span class="nc">N_IDropN</span> <span class="o">|</span> <span class="nc">N_IDupN</span> <span class="o">-&gt;</span>
     <span class="n">model_1</span> <span class="n">instr_or_cont</span> <span class="o">(</span><span class="n">affine_model</span> <span class="n">name</span><span class="o">)</span>
<span class="o">|</span> <span class="nc">N_IConcat_bytes</span> <span class="o">-&gt;</span>
     <span class="n">model_2</span> <span class="n">instr_or_cont</span> <span class="o">(</span><span class="n">concat_model</span> <span class="n">name</span><span class="o">)</span>
</pre></div>
</div>
</section>
<section id="interpreter-benchmarks">
<h2>Interpreter benchmarks<a class="headerlink" href="#interpreter-benchmarks" title="Link to this heading">#</a></h2>
<p>The interpreter benchmarks are located in <code class="docutils literal notranslate"><span class="pre">interpreter_benchmarks.ml</span></code>, in the module <code class="docutils literal notranslate"><span class="pre">Registration_section</span></code>, which is itself divided in multiple sub-modules for each family of instructions. Most benchmarks are created and registered using the following helper function <code class="docutils literal notranslate"><span class="pre">benchmark</span></code>, or one of its derivatives.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">benchmark</span><span class="o">:</span>
    <span class="o">?</span><span class="n">amplification</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span>
    <span class="o">?</span><span class="n">intercept</span><span class="o">:</span><span class="kt">bool</span> <span class="o">-&gt;</span>
    <span class="n">name</span><span class="o">:</span><span class="nn">Interpreter_worload</span><span class="p">.</span><span class="n">instruction_name</span> <span class="o">-&gt;</span>
    <span class="n">kinstr_and_stack_sampler</span><span class="o">:(</span><span class="nn">Default_config</span><span class="p">.</span><span class="n">config</span> <span class="o">-&gt;</span>
                              <span class="nn">Random</span><span class="p">.</span><span class="nn">State</span><span class="p">.</span><span class="n">t</span> <span class="o">-&gt;</span>
                              <span class="kt">unit</span> <span class="o">-&gt;</span>
                              <span class="n">ex_stack_and_kinstr</span><span class="o">)</span> <span class="o">-&gt;</span>
    <span class="kt">unit</span>
</pre></div>
</div>
<p>This function builds the <code class="docutils literal notranslate"><span class="pre">Benchmark.S</span></code> module and registers it, doing most of the work defined in Step 1 of the <a class="reference internal" href="snoop_example.html"><span class="doc">usage example</span></a>. Its arguments are as follows:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">amplification</span></code>, if provided, is the number of times an operation must be run in a single execution of the benchmark. If not specified, the instruction will be run only once. It is useful for instance when the operation itself takes very little time, and the calls to the timer take the most of the benchmark runtime.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">intercept</span></code> (default <code class="docutils literal notranslate"><span class="pre">false</span></code>) is <code class="docutils literal notranslate"><span class="pre">true</span></code> if and only if the benchmark is covering the intercept case. It can be used when the expected intercept for the chosen model is not 0. The user should then make sure that the provided sampler generates zero workload for the instruction.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> is simply the name of the benchmarked instruction. It will also appear in the name of the registered benchmark. When searching for a benchmark in snoop, the names are structured as follows: <code class="docutils literal notranslate"><span class="pre">&lt;name&gt;{_intercept}_&lt;protocol_version&gt;</span></code>, where <code class="docutils literal notranslate"><span class="pre">&lt;protocol_version&gt;</span></code> is either the version number of the protocol, or <code class="docutils literal notranslate"><span class="pre">alpha</span></code>. <code class="docutils literal notranslate"><span class="pre">_intercept</span></code> only appears if the previous argument was set to <code class="docutils literal notranslate"><span class="pre">true</span></code>. The function cannot register two benchmarks with the same <code class="docutils literal notranslate"><span class="pre">name</span></code>, unless they have different <code class="docutils literal notranslate"><span class="pre">intercept</span></code> values.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kinstr_and_stack_sampler</span></code> is a function that, given a configuration and a random state, returns a stack and a <code class="docutils literal notranslate"><span class="pre">kinstr</span></code> on which the benchmark will be performed. If <code class="docutils literal notranslate"><span class="pre">intercept</span></code> is <code class="docutils literal notranslate"><span class="pre">Å§rue</span></code>, this sampler should be so that zero workload is generated for the instruction.</p></li>
</ul>
<p>Some other functions are provided to cover some simpler cases, they exist mostly to avoid creating a full sampler for both the stack and the instruction.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">simple_benchmark</span></code> can be used when the stack can be whatever (as long as it is compatible with the benchmarked instruction). Its optional argument <code class="docutils literal notranslate"><span class="pre">intercept_stack</span></code> is the stack on which the intercept case will be run. If this argument is provided, two benchmarks will be registered for the instruction.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">benchmark_with_stack_sampler</span></code> requires a sampler only for the stack, useful when the <code class="docutils literal notranslate"><span class="pre">kinstr</span></code> is fixed, which happens most of the time. <code class="docutils literal notranslate"><span class="pre">benchmark_with_fixed_stack</span></code> requires a fixed stack instead of a sampler. Both variations also exist for <code class="docutils literal notranslate"><span class="pre">simple_benchmark</span></code>.</p></li>
<li><p>Finally, <code class="docutils literal notranslate"><span class="pre">continuation_benchmark</span></code> works similarly to <code class="docutils literal notranslate"><span class="pre">benchmark</span></code>, but for continuations instead of instructions.</p></li>
</ul>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Link to this heading">#</a></h3>
<section id="a-simple-benchmark">
<h4>A simple benchmark<a class="headerlink" href="#a-simple-benchmark" title="Link to this heading">#</a></h4>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="bp">()</span> <span class="o">=</span>
   <span class="n">simple_benchmark</span>
     <span class="o">~</span><span class="n">amplification</span><span class="o">:</span><span class="mi">100</span>
     <span class="o">~</span><span class="n">name</span><span class="o">:</span><span class="nn">Interpreter_workload</span><span class="p">.</span><span class="nc">N_ISwap</span>
     <span class="o">~</span><span class="n">kinstr</span><span class="o">:(</span><span class="nc">ISwap</span> <span class="o">(</span><span class="n">kinfo_unitunit</span><span class="o">,</span> <span class="n">halt_unitunit</span><span class="o">))</span>
     <span class="bp">()</span>
</pre></div>
</div>
<p>Benchmark for <code class="docutils literal notranslate"><span class="pre">ISwap</span></code>. Here the execution time is small enough that we want to use an amplification factor to obtain reasonable timings. The definition of <code class="docutils literal notranslate"><span class="pre">kinstr</span></code> uses some predefined values for <code class="docutils literal notranslate"><span class="pre">kinfo</span></code> and <code class="docutils literal notranslate"><span class="pre">kinstr</span></code>, available at the begining of the registration section.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">kinfo</span> <span class="n">kstack_ty</span> <span class="o">=</span> <span class="o">{</span><span class="n">iloc</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">kstack_ty</span><span class="o">}</span>
<span class="k">let</span> <span class="n">halt</span> <span class="n">stack_ty</span> <span class="o">=</span> <span class="nc">IHalt</span> <span class="o">(</span><span class="n">kinfo</span> <span class="n">stack_ty</span><span class="o">)</span>
<span class="k">let</span> <span class="n">halt_unit</span> <span class="o">=</span> <span class="n">halt</span> <span class="o">(</span><span class="kt">unit</span> <span class="o">@$</span> <span class="n">bot</span><span class="o">)</span>
<span class="k">let</span> <span class="n">halt_unitunit</span> <span class="o">=</span> <span class="n">halt</span> <span class="o">(</span><span class="kt">unit</span> <span class="o">@$</span> <span class="kt">unit</span> <span class="o">@$</span> <span class="n">bot</span><span class="o">)</span>
<span class="k">let</span> <span class="n">kinfo_unit</span> <span class="o">=</span> <span class="n">kinfo</span> <span class="o">(</span><span class="kt">unit</span> <span class="o">@$</span> <span class="n">bot</span><span class="o">)</span>
<span class="k">let</span> <span class="n">kinfo_unitunit</span> <span class="o">=</span> <span class="n">kinfo</span> <span class="o">(</span><span class="kt">unit</span> <span class="o">@$</span> <span class="kt">unit</span> <span class="o">@$</span> <span class="n">bot</span><span class="o">)</span>
</pre></div>
</div>
<p>In our example, <code class="docutils literal notranslate"><span class="pre">ISwap</span></code> is preformed for two unit types on a stack with nothing else. There is no need to specify a stack sampler, the function <code class="docutils literal notranslate"><span class="pre">simple_benchmark</span></code> infers it automatically from the given <code class="docutils literal notranslate"><span class="pre">kinstr</span></code>.</p>
</section>
<section id="a-simple-benchmark-with-an-intercept-stack">
<h4>A simple benchmark with an intercept stack<a class="headerlink" href="#a-simple-benchmark-with-an-intercept-stack" title="Link to this heading">#</a></h4>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="bp">()</span> <span class="o">=</span>
   <span class="n">simple_benchmark</span>
     <span class="o">~</span><span class="n">name</span><span class="o">:</span><span class="nn">Interpreter_workload</span><span class="p">.</span><span class="nc">N_IConcat_bytes</span>
     <span class="o">~</span><span class="n">intercept_stack</span><span class="o">:(</span><span class="nn">Script_ir_translator</span><span class="p">.</span><span class="n">list_empty</span><span class="o">,</span> <span class="o">(</span><span class="bp">()</span><span class="o">,</span> <span class="bp">()</span><span class="o">))</span>
     <span class="o">~</span><span class="n">kinstr</span><span class="o">:</span>
       <span class="o">(</span><span class="nc">IConcat_bytes</span> <span class="o">(</span><span class="n">kinfo</span> <span class="o">(</span><span class="kt">list</span> <span class="n">bytes</span> <span class="o">@$</span> <span class="n">bot</span><span class="o">),</span> <span class="n">halt</span> <span class="o">(</span><span class="n">bytes</span> <span class="o">@$</span> <span class="n">bot</span><span class="o">)))</span>
     <span class="bp">()</span>
</pre></div>
</div>
<p>For <code class="docutils literal notranslate"><span class="pre">IConcat_bytes</span></code>, the intercept case would be an empty list: we are concatenating zero bytes on a list with zero elements, so both values of the workload are zero, as expected. In the non intercept case, the stack is randomly generated in accordance to the specification, which in this case is simply a random list of bytes. The sampling parameters, such as the bounds for the size of the list and its elements, can be controlled by a config file at runtime.</p>
</section>
<section id="a-less-simple-benchmark">
<h4>A less simple benchmark<a class="headerlink" href="#a-less-simple-benchmark" title="Link to this heading">#</a></h4>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="bp">()</span> <span class="o">=</span>
   <span class="k">let</span> <span class="n">dig</span> <span class="o">=</span> <span class="nn">Micheline</span><span class="p">.</span><span class="o">(</span><span class="nc">Prim</span> <span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="nc">I_DIG</span><span class="o">,</span> <span class="o">[</span><span class="nc">Int</span> <span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="nn">Z</span><span class="p">.</span><span class="n">of_int</span> <span class="mi">0</span><span class="o">)],</span> <span class="bp">[]</span><span class="o">))</span> <span class="k">in</span>
   <span class="n">benchmark</span>
     <span class="o">~</span><span class="n">amplification</span><span class="o">:</span><span class="mi">100</span>
     <span class="o">~</span><span class="n">intercept</span><span class="o">:</span><span class="bp">true</span>
     <span class="o">~</span><span class="n">name</span><span class="o">:</span><span class="nn">Interpreter_workload</span><span class="p">.</span><span class="nc">N_IDig</span>
     <span class="o">~</span><span class="n">kinstr_and_stack_sampler</span><span class="o">:(</span><span class="k">fun</span> <span class="o">_</span><span class="n">cfg</span> <span class="n">rng_state</span> <span class="bp">()</span> <span class="o">-&gt;</span>
       <span class="k">let</span> <span class="n">node</span> <span class="o">=</span> <span class="n">dig</span> <span class="k">in</span>
       <span class="n">parse_instr</span> <span class="n">rng_state</span> <span class="n">node</span> <span class="n">long_stack</span><span class="o">)</span>
     <span class="bp">()</span>

 <span class="k">let</span> <span class="bp">()</span> <span class="o">=</span>
   <span class="k">let</span> <span class="n">dig</span> <span class="n">n</span> <span class="o">=</span> <span class="nn">Micheline</span><span class="p">.</span><span class="o">(</span><span class="nc">Prim</span> <span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="nc">I_DIG</span><span class="o">,</span> <span class="o">[</span><span class="nc">Int</span> <span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="nn">Z</span><span class="p">.</span><span class="n">of_int</span> <span class="n">n</span><span class="o">)],</span> <span class="bp">[]</span><span class="o">))</span> <span class="k">in</span>
   <span class="n">benchmark</span>
     <span class="o">~</span><span class="n">name</span><span class="o">:</span><span class="nn">Interpreter_workload</span><span class="p">.</span><span class="nc">N_IDig</span>
     <span class="o">~</span><span class="n">kinstr_and_stack_sampler</span><span class="o">:(</span><span class="k">fun</span> <span class="o">_</span><span class="n">cfg</span> <span class="n">rng_state</span> <span class="bp">()</span> <span class="o">-&gt;</span>
       <span class="k">let</span> <span class="n">node</span> <span class="o">=</span> <span class="n">dig</span> <span class="o">(</span><span class="n">sample_depth</span> <span class="n">rng_state</span><span class="o">)</span> <span class="k">in</span>
       <span class="n">parse_instr</span> <span class="n">rng_state</span> <span class="n">node</span> <span class="n">long_stack</span><span class="o">)</span>
     <span class="bp">()</span>
</pre></div>
</div>
<p>Here we define two benchmarks, the first being the interception case, which is when <code class="docutils literal notranslate"><span class="pre">DIG</span></code> is called with the integer <code class="docutils literal notranslate"><span class="pre">0</span></code>, which is enough since the depth is exactly the workload. Here the sampler uses <code class="docutils literal notranslate"><span class="pre">parse_instr</span></code>, which builds the correct <code class="docutils literal notranslate"><span class="pre">kinstr</span></code> and <code class="docutils literal notranslate"><span class="pre">stack</span></code>, given a Micheline node and a generated stack (here we use <code class="docutils literal notranslate"><span class="pre">long_stack</span></code>, a big stack of unit types). The <code class="docutils literal notranslate"><span class="pre">kinstr</span></code> here must also be sampled, because we want to benchmark the instruction for different workloads, i.e different depths, which are sampled with <code class="docutils literal notranslate"><span class="pre">sample_depth</span></code>.</p>
</section>
</section>
</section>
<section id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Link to this heading">#</a></h2>
<p>Assuming the workload is correctly defined for our benchmarking and modeling needs, we just need to check if the chosen model fits the data. For that, we can refer to the <a class="reference internal" href="snoop_example.html"><span class="doc">usage example</span></a>, and follow the given steps. If the resulting plot shows that the predicted execution time fits the empirical data, then it should be good. Otherwise, it should provide some insight to choose a more fitting model for the instruction.</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="tezos_micheline_rewriting.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Rewriting Micheline with <code class="docutils literal notranslate"><span class="pre">tezos-micheline-rewriting</span></code></p>
      </div>
    </a>
    <a class="right-next"
       href="time_measurement_ppx.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Time measurement PPX</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpreter-workload">Interpreter Workload</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpreter-models">Interpreter Models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpreter-benchmarks">Interpreter benchmarks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-simple-benchmark">A simple benchmark</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-simple-benchmark-with-an-intercept-stack">A simple benchmark with an intercept stack</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-less-simple-benchmark">A less simple benchmark</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#testing">Testing</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Nomadic Labs <contact@nomadic-labs.com>
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2018-2023, Nomadic Labs &lt;contact@nomadic-labs.com&gt;.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>