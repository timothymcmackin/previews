
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Octez Software Architecture &#8212; Octez &amp; Protocol products documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=3301396a" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=eee15179"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-KT3Z3X4Y82"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-KT3Z3X4Y82');
            </script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-KT3Z3X4Y82');
            </script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'shell/the_big_picture';</script>
    <script src="../_static/js/custom.js?v=e7f469e6"></script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The Octez Shell" href="shell.html" />
    <link rel="prev" title="Exit codes and signals" href="../user/exits.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.svg" class="logo__image only-light" alt="Octez & Protocol products documentation - Home"/>
    <script>document.write(`<img src="../_static/logo.svg" class="logo__image only-dark" alt="Octez & Protocol products documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../introduction/tezos.html">Octez &amp; Protocol overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../introduction/howtoget.html">Installing Octez</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/cosign-verify.html">Verifying Octez Docker Images with Cosign</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/get_troubleshooting.html">Installation troubleshooting</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/howtouse.html">Getting started with Octez</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/howtorun.html">Running Octez</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/services.html">Setting up Octez Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/versioning.html">Octez &amp; Protocol versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/breaking_changes.html">BREAKING CHANGES</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Octez User manual</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../user/setup-client.html">Setting up the client</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../user/client-configuration.html">Client Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/key-management.html">Key Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/sandbox.html">Sandboxed mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/mockup.html">Mockup mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/proxy.html">Proxy mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/light.html">Light mode</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../user/setup-node.html">Setting up the node</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../user/node-configuration.html">Node Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/multinetwork.html">Connecting to a Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/history_modes.html">History modes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/snapshots.html">Snapshots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/proxy-server.html">Proxy server</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../user/node-monitoring.html">Monitoring an Octez Node</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../developer/openmetrics.html">Supported Open Metrics</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../user/teztale.html">Monitoring the consensus protocol</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../user/multisig.html">Built-in multisig contracts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/fa12.html">FA1.2 support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/logging.html">Logging features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/exits.html">Exit codes and signals</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Octez Reference manual</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Octez Software Architecture</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="shell.html">The Octez Shell</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="validation.html">The validation subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="prevalidation.html">The Prevalidator</a></li>
<li class="toctree-l2"><a class="reference internal" href="storage.html">The storage layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="sync.html">Synchronisation heuristic</a></li>
<li class="toctree-l2"><a class="reference internal" href="p2p.html">The peer-to-peer layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="protocol_environment.html">Protocol Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="micheline.html">Micheline</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="data_availability_committees.html">Data Availability Committees</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="dal.html">Data Availability Layer</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="dal_overview.html">DAL overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="dal_node.html">The DAL node</a></li>
<li class="toctree-l2"><a class="reference internal" href="dal_bakers.html">Bakers &amp; the DAL</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="smart_rollup_node.html">Smart rollup node</a></li>
<li class="toctree-l1"><a class="reference internal" href="p2p_api.html">P2P message format</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli-commands.html">Command Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="rpc.html">Shell RPCs - Reference</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Protocol Reference Manuals</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../active/index.html">Paris Protocol Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../active/protocol.html">Economic protocol features</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../active/protocol_overview.html">Overview of the economic protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/proof_of_stake.html">Proof-of-stake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/randomness_generation.html">Randomness generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/consensus.html">The consensus algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/voting.html">The Amendment (and Voting) Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/accounts.html">Accounts and addresses</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/michelson.html">Michelson: the language of Smart Contracts in Tezos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/views.html">On-chain Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/timelock.html">Time-lock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/sapling.html">Sapling support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/liquidity_baking.html">Liquidity Baking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/global_constants.html">Global Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/michelson_anti_patterns.html">Michelson Anti-Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/token_management.html">Token transfers and balance updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/precheck.html">Prechecking of manager operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/smart_rollups.html">Smart Optimistic Rollups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/plugins.html">Protocol Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/event.html">Contract events</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/blocks_ops.html">Blocks and Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/validation.html">Validation and Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/tickets.html">Tickets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/adaptive_issuance.html">Adaptive Issuance and Staking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/adaptive_slashing.html">Adaptive Slashing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/dal_support.html">DAL support</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../active/glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../active/cli-commands.html">Command Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../active/rpc.html">Paris RPCs - Reference</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../quebeca/index.html">Quebeca Protocol Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../quebeca/protocol.html">Economic protocol features</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/protocol_overview.html">Overview of the economic protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/proof_of_stake.html">Proof-of-stake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/randomness_generation.html">Randomness generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/baking_power.html">Baking Power</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/consensus.html">The consensus algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/voting.html">The Amendment (and Voting) Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/accounts.html">Accounts and addresses</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/michelson.html">Michelson: the language of Smart Contracts in Tezos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/views.html">On-chain Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/timelock.html">Time-lock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/sapling.html">Sapling support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/liquidity_baking.html">Liquidity Baking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/global_constants.html">Global Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/michelson_anti_patterns.html">Michelson Anti-Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/token_management.html">Token transfers and balance updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/precheck.html">Prechecking of manager operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/smart_rollups.html">Smart Optimistic Rollups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/plugins.html">Protocol Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/event.html">Contract events</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/blocks_ops.html">Blocks and Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/validation.html">Validation and Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/tickets.html">Tickets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/adaptive_issuance.html">Adaptive Issuance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/staking.html">Staking mechanism</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/adaptive_slashing.html">Adaptive Slashing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/dal_support.html">DAL support</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../quebeca/glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quebeca/cli-commands.html">Command Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quebeca/rpc.html">Quebeca RPCs - Reference</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../alpha/index.html">Alpha Dev Protocol Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../alpha/protocol.html">Economic protocol features</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../alpha/protocol_overview.html">Overview of the economic protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/proof_of_stake.html">Proof-of-stake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/randomness_generation.html">Randomness generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/baking_power.html">Baking Power</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/consensus.html">The consensus algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/voting.html">The Amendment (and Voting) Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/accounts.html">Accounts and addresses</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/michelson.html">Michelson: the language of Smart Contracts in Tezos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/views.html">On-chain Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/timelock.html">Time-lock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/sapling.html">Sapling support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/liquidity_baking.html">Liquidity Baking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/global_constants.html">Global Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/michelson_anti_patterns.html">Michelson Anti-Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/token_management.html">Token transfers and balance updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/precheck.html">Prechecking of manager operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/smart_rollups.html">Smart Optimistic Rollups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/plugins.html">Protocol Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/event.html">Contract events</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/blocks_ops.html">Blocks and Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/validation.html">Validation and Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/tickets.html">Tickets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/adaptive_issuance.html">Adaptive Issuance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/staking.html">Staking mechanism</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/adaptive_slashing.html">Adaptive Slashing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/dal_support.html">DAL support</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../alpha/glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../alpha/cli-commands.html">Command Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../alpha/rpc.html">Alpha RPCs - Reference</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tezos developer Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../developer/rpc.html">JSON/RPC interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/errors.html">RPC Errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/openapi.html">RPCs - OpenAPI reference</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Changes in Octez releases</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../releases/releases.html">Release System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases/version-20.html">Version 20.2</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../releases/history.html">Older Versions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-19.html">Version 19.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-18.html">Version 18.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-17.html">Version 17.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-16.html">Version 16.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-15.html">Version 15.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-14.html">Version 14.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-13.html">Version 13.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-12.html">Version 12.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-11.html">Version 11.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-10.html">Version 10.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-9.html">Version 9.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-8.html">Version 8.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-7.html">Version 7.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/january-2020.html">Mainnet January 2020</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/december-2019.html">Mainnet December 2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/october-2019.html">Mainnet-Staging October 2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/september-2019.html">Mainnet September 2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/may-2019.html">Mainnet May 2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/april-2019.html">Mainnet April 2019</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Changes in protocol versions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../protocols/naming.html">Protocol versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../protocols/019_paris.html">Protocol Paris</a></li>
<li class="toctree-l1"><a class="reference internal" href="../protocols/021_quebeca.html">Protocol Quebeca</a></li>
<li class="toctree-l1"><a class="reference internal" href="../protocols/alpha.html">Protocol Alpha</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../protocols/history.html">Older Protocols</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../protocols/018_oxford.html">Protocol Oxford</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/017_nairobi.html">Protocol Nairobi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/016_mumbai.html">Protocol Mumbai</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/015_lima.html">Protocol Lima</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/014_kathmandu.html">Protocol Kathmandu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/013_jakarta.html">Protocol Jakarta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/012_ithaca.html">Protocol Ithaca</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/011_hangzhou.html">Protocol Hangzhou</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/010_granada.html">Protocol Granada</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/009_florence.html">Protocol Florence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/008_edo.html">Protocol Edo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/007_delphi.html">Protocol Delphi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/006_carthage.html">Protocol Carthage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/005_babylon.html">Protocol Babylon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/004_Pt24m4xi.html">Protocol Athens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/003_PsddFKi3.html">Protocol 003_PsddFKi3</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../developer/contributing_index.html">How to contribute</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../developer/contributing.html">How to contribute to Octez</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../developer/contributing-adding-a-new-opam-dependency.html">How to add or update opam dependencies</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/merge_team.html">Octez Merge Team</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/guidelines.html">Documentation and coding guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/repository_scope.html">Scope of the Octez repository</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../developer/programming.html">Programming tutorials</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../developer/gadt.html">Generalized Algebraic Data Types (GADTs)</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../developer/error_monad.html">The Error Monad</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../developer/error_monad_p1_result.html">Part 1: <code class="docutils literal notranslate"><span class="pre">result</span></code>, Lwt, and Lwt-<code class="docutils literal notranslate"><span class="pre">result</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer/error_monad_p2_tzresult.html">Part 2: <code class="docutils literal notranslate"><span class="pre">tzresult</span></code> and Lwt-<code class="docutils literal notranslate"><span class="pre">tzresult</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer/error_monad_p3_advanced.html">Part 3: Advanced topics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer/error_monad_p4_appendices.html">Part 4: Appendices</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/clic.html">The <code class="docutils literal notranslate"><span class="pre">clic</span></code> library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/data_encoding.html">The <code class="docutils literal notranslate"><span class="pre">data_encoding</span></code> library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/event_logging_framework.html">Using The Event Logging Framework</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../developer/testing_index.html">Testing in Octez</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../developer/testing.html">Overview of Testing in Octez</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/ppx_expect.html">Ppx_expect</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/tezt.html">Tezt: OCaml Tezos Test Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/long-tezts.html">Tezt: Long Tests and Performance Regression Test Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/alcotezt.html">Alcotezt: An Alcotest Compatibility Wrapper for Tezt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/unit_testing_legacy_code.html">Making legacy code unit-testable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/proposal_testing.html">How to Test a Protocol Proposal</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../developer/maintaining.html">Maintaining</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../developer/entering_alpha.html">How to start reading protocol Alpha</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/michelson_instructions.html">Adding a new instruction to Michelson language</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/protocol_release_checklist.html">Protocol Release Checklist</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/howto-freeze-protocols.html">How to Freeze Protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/protocol_environment_upgrade.html">Adding a new protocol environment</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Documenting</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../developer/tools.html">Platform Development tools</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../developer/profiling.html">Profiling the Octez node</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../developer/snoop.html">Benchmarking with Snoop</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../developer/snoop_arch.html">Architecture of <code class="docutils literal notranslate"><span class="pre">octez-snoop</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer/snoop_tutorial.html">Snoop usage tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer/snoop_example.html">In-depth usage example: more control over your benchmark</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer/tezos_micheline_rewriting.html">Rewriting Micheline with <code class="docutils literal notranslate"><span class="pre">tezos-micheline-rewriting</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer/snoop_interpreter.html">Snoop and the Michelson Interpreter</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/time_measurement_ppx.html">Time measurement PPX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/python_environment.html">Python Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/pre_commit_hook.html">Pre-Commit Hook</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/encodings.html">Encodings</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../developer/merkle-proof-encoding-formats.html">Merkle Proof Encoding Formats</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../developer/merkle-proof-formats/v1-tree32.html">V1 for Tree32</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/merkle-proof-formats/v1-tree2.html">V1 for Tree2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/merkle-proof-formats/v2-tree32.html">V2 for Tree32</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer/merkle-proof-formats/v2-tree2.html">V2 for Tree2</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../api/api-inline.html">OCaml APIs - Reference</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-gitlab"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://gitlab.com/tezos/tezos" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-gitlab"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://gitlab.com/tezos/tezos/-/issues/new?issue[title]=Issue%20on%20page%20%2Fshell/the_big_picture.html&issue[description]=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Octez Software Architecture</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-big-picture">The Big Picture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#software-architecture-and-packages-relationship">Software Architecture and Packages Relationship</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#base-and-below">Base and below</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-shell">The Shell</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-economic-protocol-environment-and-compiler">The Economic Protocol Environment and Compiler</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-embedded-economic-protocols">The Embedded Economic Protocols</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-client-library">The Client Library</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tests-packages">Tests Packages</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-final-executables">The Final Executables</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="octez-software-architecture">
<h1>Octez Software Architecture<a class="headerlink" href="#octez-software-architecture" title="Link to this heading">#</a></h1>
<p>This page presents the software architecture of the Octez suite, focusing on the most important tool in a Tezos network: the Tezos node, implemented in our case as the Octez node executable (<code class="docutils literal notranslate"><span class="pre">octez-node</span></code>).
The Octez node software architecture faithfully implements the <a class="reference external" href="https://docs.tezos.com/architecture">Tezos software architecture</a> principles:</p>
<ul class="simple">
<li><p>It is separated into a shell and a protocol, to support protocol evolution.</p></li>
<li><p>It implements a client/server architecture, to allow composition with many other tools in a safe way.</p></li>
</ul>
<p>This page contains two sections. The first section, which should be
readable by anyone, describes the main elements of a Tezos node from a
distance. It abstracts from all plumbing and both internal and system
dependencies to give a simple view of the main components, their
responsibilities, and interactions. The second part is written for
developers and is at the level of OPAM packages.</p>
<p>Although the description is focused on the Octez node, some of these components are reused to generate other tools in the Octez suite, see <a class="reference internal" href="#final-executables"><span class="std std-ref">The Final Executables</span></a>.</p>
<section id="the-big-picture">
<span id="id1"></span><h2>The Big Picture<a class="headerlink" href="#the-big-picture" title="Link to this heading">#</a></h2>
<p>The diagram below shows a very coarse-grained architecture of the Tezos node.</p>
<p><img alt="Tezos architecture diagram" src="../_images/octopus.svg" /></p>
<p>The characteristic that makes Tezos unique is its self-amending
property. The part that amends itself is called <a class="reference internal" href="../alpha/protocol.html"><span class="doc">the economic protocol</span></a>
(the green brain of the octopus), sometimes abbreviated by protocol or
even proto in the source code. The rest of a Tezos node is what we call
the <em>shell</em> (the blue octopus).</p>
<p>The protocol is responsible for interpreting the transactions and other
administrative operations. It also has the responsibility to detect
erroneous blocks.</p>
<p>An important thing to notice is that the protocol always sees only one
block chain, that is a linear sequence of blocks since the
genesis. It does not know that it lives in an open network where nodes
can propose alternative heads.</p>
<p>Only the shell knows about the multiple heads. It is responsible for
choosing between the various chain proposals that come from the bakers
(the programs that cook new blocks) of the network. The shell has the
responsibility of selecting and downloading alternative chains, feed
them to the protocol, which in turn has the responsibility to check
them for errors, and give them an absolute score. The shell then
simply selects the valid head of the highest absolute score. This part
of the shell is called <a class="reference internal" href="validation.html"><span class="doc">the validator</span></a>.</p>
<p>The rest of the shell includes the peer-to-peer layer, the disk storage
of blocks, the operations to allow the node to transmit the chain data
to new nodes and the versioned state of the ledger. In-between the
validator, the peer-to-peer layer, and the storage sits a component
called the distributed database, that abstracts the fetching and
replication of new chain data to the validator.</p>
<p>Protocols are compiled using a tweaked OCaml compiler (green part on the
left of the picture) that does two things. First, it checks that the
protocol’s main module has the right type. A good analogy is to see
protocol as plug-ins, and in this case, it means that it respects the
common plugin interface. Then, it restricts the typing environment of
the protocol’s code so that it only calls authorized modules and
functions. Seeing protocols as plug-ins, it means that the code only
called primitives from the plug-in API. It is a form of statically
enforced sandboxing (see <a class="reference internal" href="protocol_environment.html"><span class="doc">Protocol Environment</span></a>).</p>
<p>Note that the economic protocol on the chain is subject to an amendment
procedure. On-chain operations can be used to switch from one protocol to
another. The procedure is described in more details in <a class="reference internal" href="../active/voting.html"><span class="doc">the protocol’s
voting procedure documentation</span></a>.</p>
<p>Finally, the RPC layer (in yellow on the right in the picture) is an
important part of the node. It is how the client, third-party
applications and daemons can interact with the node and introspect its
state. This component uses the mainstream JSON format and HTTP
protocol.  It uses the library <code class="docutils literal notranslate"><span class="pre">resto</span></code>. It is fully
interoperable, and auto descriptive, using JSON schema.</p>
</section>
<section id="software-architecture-and-packages-relationship">
<span id="packages"></span><h2>Software Architecture and Packages Relationship<a class="headerlink" href="#software-architecture-and-packages-relationship" title="Link to this heading">#</a></h2>
<p>The diagram below shows the main OPAM packages present in the source
code of Tezos, and their dependencies. The <code class="docutils literal notranslate"><span class="pre">tezos-</span></code> or <code class="docutils literal notranslate"><span class="pre">octez-</span></code> prefixes have been
dropped for clarity.</p>
<p><img alt="Tezos source packages diagram" src="../_images/packages.svg" /></p>
<p>In green at the bottom are binaries. Highlighted in yellow are the OPAM
packages (sometimes with shortened names). Black arrows show direct
dependencies. Orange arrows show other indirect relationships (code
generation, interface sharing), explained below. The part circled in
blue, contains modules that bear no dependency to Unix, and can thus
be compiled to JavaScript. External dependencies are not shown in this
illustration.</p>
<p>Note that many packages described below are grouped in a single one: <a class="reference external" href="../api/odoc/_html/octez-libs/index.html">octez-libs</a>.
This includes packages as diverse as <a class="reference external" href="../api/odoc/_html/octez-libs/Tezos_stdlib/index.html">tezos-stdlib </a>, <a class="reference external" href="../api/odoc/_html/octez-libs/Tezos_base/index.html">tezos-base </a>, <a class="reference external" href="../api/odoc/_html/octez-shell-libs/Tezos_shell_services/index.html">tezos-shell-services </a>, <a class="reference external" href="../api/odoc/_html/octez-libs/Tezos_context/index.html">tezos-context </a>, etc.)</p>
<section id="base-and-below">
<h3>Base and below<a class="headerlink" href="#base-and-below" title="Link to this heading">#</a></h3>
<p>At the center, the <a class="reference external" href="../api/odoc/_html/octez-libs/Tezos_base/index.html">tezos-base </a> package is where
the blockchain specific code starts. Above it in the figure (but below
in terms of abstraction level) is the set of libraries
that are used everywhere for basic operations.</p>
<ul class="simple">
<li><p><a class="reference external" href="../api/odoc/_html/octez-libs/Tezos_stdlib/index.html">tezos-stdlib </a> contains a few extensions over the
OCaml standard library (a few string primitives, an <code class="docutils literal notranslate"><span class="pre">Option</span></code>
module, etc.), a few <code class="docutils literal notranslate"><span class="pre">Lwt</span></code> utilities, and a <code class="docutils literal notranslate"><span class="pre">Compare</span></code> module
that implements monomorphic comparison operators.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-libs/Tezos_error_monad/index.html">tezos-error-monad </a> is an in-house monadic
interface to the OCaml <code class="docutils literal notranslate"><span class="pre">('a,</span> <span class="pre">'b)</span> <span class="pre">result</span></code> type, that fixes the
<code class="docutils literal notranslate"><span class="pre">'b</span></code> to an extensible type <code class="docutils literal notranslate"><span class="pre">error</span></code> (actually a list, to hold an
error trace). When extending the type, programmers must also call
the <code class="docutils literal notranslate"><span class="pre">register_error</span></code> function that registers a pretty printer and
an encoding for serialization.
A <a class="reference internal" href="../developer/error_monad.html"><span class="doc">tutorial</span></a> is available for this library.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-libs/Tezos_rpc/index.html">tezos-rpc </a> provides the basics of Tezos’ RPC service
mechanism. It provides combinators for building service hierarchies
à la Ocsigen/Eliom, registering, and calling services. This module
is based on <a class="reference external" href="https://opam.ocaml.org/packages/resto">resto</a>, that allows for automatic
generation of machine and human-readable descriptions of the hierarchy of
services, including: the structure of URLs and the expected formats for input
and output bodies, via the use of <code class="docutils literal notranslate"><span class="pre">data_encoding</span></code>.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-libs/Tezos_crypto/index.html">tezos-crypto </a> wraps the external cryptography
libraries that we use. We try to use minimal reference
implementations, with as thin as possible bindings, and
rely on libraries from the
<a class="reference external" href="https://github.com/hacl-star/hacl-star">HACL* project</a>,
written and verified in the F* programming language, and extracted
to C.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-libs/Tezos_micheline/index.html">tezos-micheline </a> is the concrete syntax used by
Michelson, the language of smart contracts. It mostly contains the
generic, untyped AST, a printer, and a parser.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-libs/Tezos_base/index.html">tezos-base </a> wraps all these modules in a common foundation
for all the other components of Tezos, and introduces the data
structures of the blockchain (e.g. <code class="docutils literal notranslate"><span class="pre">Block_hash</span></code>,
<code class="docutils literal notranslate"><span class="pre">Block_header</span></code>, <code class="docutils literal notranslate"><span class="pre">Block_locator</span></code>, <code class="docutils literal notranslate"><span class="pre">Fitness</span></code>, <code class="docutils literal notranslate"><span class="pre">P2p_identity</span></code>)
that are shared between the shell, economic protocol, client,
daemons and third-party software. It also rewraps some modules from
<code class="docutils literal notranslate"><span class="pre">crypto</span></code> as functors that build all-in-one modules for a given
type (for instance, the module for block hashes contains all
possible converters, command line and RPC argument builders, pretty
printers, an autocompleter, etc.). This package also contains the
<code class="docutils literal notranslate"><span class="pre">cli_entries</span></code> module that we use to handle command-line parsing
in some executables.</p></li>
</ul>
</section>
<section id="the-shell">
<h3>The Shell<a class="headerlink" href="#the-shell" title="Link to this heading">#</a></h3>
<p>The shell is the part of the node responsible for all communications,
peer-to-peer and RPC, acting as a cocoon around the economic
protocols.</p>
<ul class="simple">
<li><p><a class="reference external" href="../api/odoc/_html/octez-shell-libs/Tezos_shell_services/index.html">tezos-shell-services </a> contains the definition of the
node’s service hierarchy, and calling functions to use in the
client (or any third party software). As this library is linked
into the client to call the services in a type-safe way, only the
description of services is done here. The registration of handlers
is done in the rest of the node’s implementation.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-libs/Tezos_rpc_http_client/index.html">tezos-rpc-http-client </a> and <a class="reference external" href="../api/odoc/_html/octez-libs/Tezos_rpc_http_server/index.html">tezos-rpc-http-server </a>
use <a class="reference external" href="https://opam.ocaml.org/packages/cohttp">cohttp</a> to implement the RPC
over HTTP server and client, allowing to make actual use of
services declared using <a class="reference external" href="../api/odoc/_html/octez-libs/Tezos_rpc/index.html">tezos-rpc </a>.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-shell-libs/Tezos_p2p/index.html">tezos-p2p </a> is the in-house peer-to-peer layer.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-shell-libs/Tezos_store/index.html">tezos-store </a> is the chain-data store that handles
on-disk block storage, snapshots exporting/importing and chain
reconstruction.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-libs/Tezos_context/index.html">tezos-context </a> contains the raw versioned key-value store
used for storing the ledger’s context (one version per
block). This is implemented using <a class="reference external" href="https://opam.ocaml.org/packages/irmin">irmin</a>.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-shell-libs/Tezos_protocol_updater/index.html">tezos-protocol-updater </a> maintains the table of available
protocol versions, embedded or dynamically linked.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-shell-libs/Tezos_shell/index.html">tezos-shell </a> implements the scheduling of block
validations, the mempool management, and the distributed database.
A description is available in <a class="reference internal" href="validation.html"><span class="doc">this document</span></a>.</p></li>
</ul>
</section>
<section id="the-economic-protocol-environment-and-compiler">
<h3>The Economic Protocol Environment and Compiler<a class="headerlink" href="#the-economic-protocol-environment-and-compiler" title="Link to this heading">#</a></h3>
<p>Economic protocols are compiled by a specific version of the OCaml
compiler. This compiler restricts the set of modules available to the
economic protocol, as a form of static sandboxing. It also generates a
functorized version of the protocol, to make the execution of the
protocol in an alternative environment possible.</p>
<ul class="simple">
<li><p><a class="reference external" href="../api/odoc/_html/octez-proto-libs/Tezos_protocol_environment/index.html">tezos-protocol-environment </a> contains the protocol
generic environment, that is the API of the modules that are available to
the economic protocol and the exported protocol API. A review of this
sandbox is available <a class="reference internal" href="protocol_environment.html"><span class="doc">here</span></a>.
These modules include a stripped-down standard library, and interfaces
to the crypto APIs, RPC definitions, and a key-value store.
It also defines two different context instances: one that simulates
the key-value store in memory for testing, and one whose context function
are dummy ones which can be used when only the types and noncontextual
functions of the protocol are needed.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-protocol-compiler/index.html">octez-protocol-compiler</a> is the compiler for economic
protocols: an alternative driver to the OCaml
<a class="reference external" href="https://opam.ocaml.org/packages/ocaml-compiler-libs">ocaml-compiler-libs</a> that typechecks within the protocol
environment, and performs some more checks on the protocol code.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tezos-protocol-xxx</span></code> is produced by the protocol compiler
and contains a functorized version of protocol <code class="docutils literal notranslate"><span class="pre">xxx</span></code> that takes its
standard library as a parameter. This parameter can be filled with
any of the implementations described in the two points below.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-shell-libs/Tezos_shell_context/index.html">tezos-shell-context </a> implements a context representation
that is accepted by the protocol environment. The node uses this
instance to read and write data on disk.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tezos-embedded-protocol-xxx</span></code> contains a version of the protocol
<code class="docutils literal notranslate"><span class="pre">xxx</span></code> whose standard library is pre-instantiated to the shell’s
implementation, these are the ones that are linked into the
node. It also contains a module that registers the protocol in the
node’s protocol table.</p></li>
</ul>
</section>
<section id="the-embedded-economic-protocols">
<span id="embedded-protocols"></span><h3>The Embedded Economic Protocols<a class="headerlink" href="#the-embedded-economic-protocols" title="Link to this heading">#</a></h3>
<p>Three kinds of economic protocols are included in the main Octez repository.</p>
<ul class="simple">
<li><p>The genesis protocol. <a class="reference external" href="../api/odoc/_html/tezos-protocol-genesis/index.html">tezos-protocol-genesis</a>
(<a class="reference external" href="../api/odoc/_html/tezos-protocol-genesis/Tezos_embedded_protocol_genesis/index.html">tezos-embedded-protocol-genesis </a>) is the protocol of
the genesis block. It accepts a single block, signed by an
activator whose public key is hardcoded, and whose single action is to
switch to a new protocol chosen by the activator.
The <code class="docutils literal notranslate"><span class="pre">master</span></code> branch contains additional variants of the genesis
protocol, one for each of the existing <a class="reference internal" href="../user/multinetwork.html#test-networks"><span class="std std-ref">test
networks</span></a>.</p></li>
<li><p>The active protocols. <code class="docutils literal notranslate"><span class="pre">tezos-protocol-nnn-hhhhhhhh</span></code>
(<code class="docutils literal notranslate"><span class="pre">tezos-embedded-protocol-nnn-hhhhhhhh</span></code>) is either the current
protocol on Mainnet or a protocol that has been active on Mainnet
at some point, where <code class="docutils literal notranslate"><span class="pre">nnn</span></code> is a counter starting at 0 and
<code class="docutils literal notranslate"><span class="pre">hhhhhhhh</span></code> is a prefix of the hash of the protocol code.
Also, <a class="reference external" href="../api/odoc/_html/tezos-protocol-alpha/index.html">tezos-protocol-alpha</a>
(<a class="reference external" href="../api/odoc/_html/tezos-protocol-alpha/Tezos_embedded_protocol_alpha/index.html">tezos-embedded-protocol-alpha </a>) on the <code class="docutils literal notranslate"><span class="pre">master</span></code>
branch is the protocol currently under development
(see <a class="reference internal" href="../introduction/howtouse.html#node-protocol"><span class="std std-ref">here</span></a> for more details).
A <a class="reference internal" href="../developer/entering_alpha.html"><span class="doc">tutorial</span></a> is available to start reading
the protocol’s code.</p></li>
<li><p>Demo protocols. <a class="reference external" href="../api/odoc/_html/tezos-protocol-demo-noops/Tezos_embedded_protocol_demo_noops/index.html">tezos-embedded-protocol-demo-noops </a> is just a demo
protocol that does nothing interesting but has the right
shape. <a class="reference external" href="../api/odoc/_html/tezos-protocol-demo-counter/Tezos_embedded_protocol_demo_counter/index.html">tezos-embedded-protocol-demo-counter </a> is another demo
protocol in which blocks can contain simple operations.</p></li>
</ul>
</section>
<section id="the-client-library">
<h3>The Client Library<a class="headerlink" href="#the-client-library" title="Link to this heading">#</a></h3>
<p>The client is split into many packages, to enforce three separation
lines: shell vs economic protocol, Unix dependent vs JavaScript
compatible, and library vs command-line interface.</p>
<ul class="simple">
<li><p><a class="reference external" href="../api/odoc/_html/octez-shell-libs/Tezos_client_base/index.html">tezos-client-base </a> defines the client context, which is
an object whose methods allow for: accessing a wallet of keys,
interacting via the user, making RPC calls, and signing data using
signer plug-ins. Most of them, including RPC calling functions from
<a class="reference external" href="../api/odoc/_html/octez-shell-libs/Tezos_shell_services/index.html">tezos-shell-services </a> and
<a class="reference external" href="../api/odoc/_html/tezos-protocol-alpha/index.html">tezos-protocol-alpha</a>, are abstracted over this object
type. That way, it is possible to use the same code for different
platforms or toolkits.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-protocol-alpha-libs/Tezos_client_alpha/index.html">tezos-client-alpha </a> provides some functions to perform
the operations of protocol Alpha using the wallet and signers from
the client context.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/tezos-client-genesis/index.html">tezos-client-genesis</a> contains the basic activator
commands available on the genesis protocol.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-shell-libs/Tezos_client_base_unix/index.html">tezos-client-base-unix </a> implements configuration file
and wallet storage in Unix files, user interaction via the Unix
console, and terminal based signer plug-ins.</p></li>
</ul>
</section>
<section id="tests-packages">
<h3>Tests Packages<a class="headerlink" href="#tests-packages" title="Link to this heading">#</a></h3>
<p>The tests are split into various packages, testing more and more
elements while following the dependency chain. Use <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">test</span></code> to
run them.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/tezt/">tezt/</a>:
end-to-end tests as Tezt tests that e.g. launch local sandboxed nodes
and performs various tasks using the client</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-shell-libs/Tezos_p2p/index.html">tezos-p2p </a>
(in directory <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/src/lib_p2p/test/">src/lib_p2p/test/</a>):
tests of the peer-to-peer layer, independently of the Tezos gossip
protocol (establishing connections, propagating peers, etc.)</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-proto-libs/Tezos_protocol_environment/index.html">tezos-protocol-environment </a>
(in directory <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/src/lib_protocol_environment/test/">src/lib_protocol_environment/test/</a>):
tests for the in-memory context implementation.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-shell-libs/Tezos_shell/index.html">tezos-shell </a>
(in directory <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/src/lib_shell/test/">src/lib_shell/test/</a>):
tests for the chain data storage.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-libs/Tezos_stdlib/index.html">tezos-stdlib </a>
(in directory <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/src/lib_stdlib/test/">src/lib_stdlib/test/</a>):
tests for the basic data structures.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-libs/Tezos_context/index.html">tezos-context </a>
(in directory <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/src/lib_context/test/">src/lib_context/test/</a>):
tests for the versioned key-value context.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-shell-libs/Tezos_store/index.html">tezos-store </a>
(in directory <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/src/lib_store/unix/test/">src/lib_store/unix/test/</a>):
tests for the on-disk store.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/tezos-protocol-alpha/index.html">tezos-protocol-alpha</a>
(in directory <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/src/proto_alpha/lib_protocol/test/">src/proto_alpha/lib_protocol/test/</a>):
tests of the Alpha protocol (without launching a node).</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-libs/Tezos_crypto/index.html">tezos-crypto </a>
(in directory <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/src/lib_crypto/test/">src/lib_crypto/test/</a>):
tests for the in-house merkle trees.</p></li>
</ul>
</section>
<section id="the-final-executables">
<span id="final-executables"></span><h3>The Final Executables<a class="headerlink" href="#the-final-executables" title="Link to this heading">#</a></h3>
<p>The Octez executables are generated from packages such as the following ones (for the complete list of binaries, see <a class="reference internal" href="../introduction/howtouse.html#tezos-binaries"><span class="std std-ref">The Binaries</span></a>):</p>
<ul class="simple">
<li><p><a class="reference external" href="../api/odoc/_html/octez-node/index.html">octez-node</a> provides the node launcher binary
<code class="docutils literal notranslate"><span class="pre">octez-node</span></code>. All the algorithmic being implemented in the
shell, this package only implements the node’s CLI. It also
provides the sandboxed node shell script launcher (see the main
readme).</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-client/index.html">octez-client</a> provides the <code class="docutils literal notranslate"><span class="pre">octez-client</span></code> and
<code class="docutils literal notranslate"><span class="pre">octez-admin-client</span></code> binaries. The former contains a small
command line wallet, the latter an administration tool for the
node. It also provides a shell script that configures a shell
environment to interact with a sandboxed node.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-baker-alpha/index.html">octez-baker-alpha</a> provides the <code class="docutils literal notranslate"><span class="pre">octez-baker-alpha</span></code>
binary.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-accuser-alpha/index.html">octez-accuser-alpha</a> provides the <code class="docutils literal notranslate"><span class="pre">octez-accuser-alpha</span></code>
binary.</p></li>
<li><p><a class="reference external" href="../api/odoc/_html/octez-protocol-compiler/index.html">octez-protocol-compiler</a> provides the
<code class="docutils literal notranslate"><span class="pre">octez-protocol-compiler</span></code> binary that is used by the node to
compile new protocols on the fly, and that can be used for
developing new protocols.</p></li>
</ul>
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../user/exits.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Exit codes and signals</p>
      </div>
    </a>
    <a class="right-next"
       href="shell.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">The Octez Shell</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-big-picture">The Big Picture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#software-architecture-and-packages-relationship">Software Architecture and Packages Relationship</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#base-and-below">Base and below</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-shell">The Shell</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-economic-protocol-environment-and-compiler">The Economic Protocol Environment and Compiler</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-embedded-economic-protocols">The Embedded Economic Protocols</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-client-library">The Client Library</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tests-packages">Tests Packages</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-final-executables">The Final Executables</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Nomadic Labs <contact@nomadic-labs.com>
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2018-2023, Nomadic Labs &lt;contact@nomadic-labs.com&gt;.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>