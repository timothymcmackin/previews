
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Documentation and coding guidelines &#8212; Octez &amp; Protocol products documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=f0f2ef8c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=bdc7cc3f"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-KT3Z3X4Y82"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-KT3Z3X4Y82');
            </script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-KT3Z3X4Y82');
            </script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'developer/guidelines';</script>
    <script src="../_static/js/custom.js?v=e7f469e6"></script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Scope of the Octez repository" href="repository_scope.html" />
    <link rel="prev" title="Octez Merge Team" href="merge_team.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.svg" class="logo__image only-light" alt="Octez & Protocol products documentation - Home"/>
    <script>document.write(`<img src="../_static/logo.svg" class="logo__image only-dark" alt="Octez & Protocol products documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../introduction/tezos.html">Octez &amp; Protocol overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../introduction/howtoget.html">Installing Octez</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/cosign-verify.html">Verifying Octez Docker Images with Cosign</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/get_troubleshooting.html">Installation troubleshooting</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/howtouse.html">Getting started with Octez</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/howtorun.html">Running Octez</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/services.html">Setting up Octez Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/versioning.html">Octez &amp; Protocol versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/breaking_changes.html">BREAKING CHANGES</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Octez User manual</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../user/setup-client.html">Setting up the client</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../user/client-configuration.html">Client Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/key-management.html">Key Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/sandbox.html">Sandboxed mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/mockup.html">Mockup mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/proxy.html">Proxy mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/light.html">Light mode</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../user/setup-node.html">Setting up the node</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../user/node-configuration.html">Node Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/multinetwork.html">Connecting to a Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/history_modes.html">History modes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/snapshots.html">Snapshots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/proxy-server.html">Proxy server</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../user/node-monitoring.html">Monitoring an Octez Node</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="openmetrics.html">Supported Open Metrics</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../user/teztale.html">Monitoring the consensus protocol</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../user/multisig.html">Built-in multisig contracts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/fa12.html">FA1.2 support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/logging.html">Logging features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/exits.html">Exit codes and signals</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Octez Reference manual</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../shell/the_big_picture.html">Octez Software Architecture</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../shell/shell.html">The Octez Shell</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../shell/validation.html">The validation subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/prevalidation.html">The Prevalidator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/storage.html">The storage layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/sync.html">Synchronisation heuristic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/p2p.html">The peer-to-peer layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/protocol_environment.html">Protocol Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/micheline.html">Micheline</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../shell/data_availability_committees.html">Data Availability Committees</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../shell/dal.html">Data Availability Layer</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../shell/dal_overview.html">DAL overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/dal_node.html">The DAL node</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/dal_bakers.html">Bakers &amp; the DAL</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../shell/smart_rollup_node.html">Smart rollup node</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shell/p2p_api.html">P2P message format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shell/cli-commands.html">Command Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shell/rpc.html">Shell RPCs - Reference</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Protocol Reference Manuals</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../active/index.html">Paris Protocol Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../active/protocol.html">Economic protocol features</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../active/protocol_overview.html">Overview of the economic protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/proof_of_stake.html">Proof-of-stake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/randomness_generation.html">Randomness generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/consensus.html">The consensus algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/voting.html">The Amendment (and Voting) Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/accounts.html">Accounts and addresses</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/michelson.html">Michelson: the language of Smart Contracts in Tezos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/views.html">On-chain Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/timelock.html">Time-lock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/sapling.html">Sapling support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/liquidity_baking.html">Liquidity Baking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/global_constants.html">Global Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/michelson_anti_patterns.html">Michelson Anti-Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/token_management.html">Token transfers and balance updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/precheck.html">Prechecking of manager operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/smart_rollups.html">Smart Optimistic Rollups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/plugins.html">Protocol Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/event.html">Contract events</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/blocks_ops.html">Blocks and Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/validation.html">Validation and Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/tickets.html">Tickets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/adaptive_issuance.html">Adaptive Issuance and Staking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/adaptive_slashing.html">Adaptive Slashing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/dal_support.html">DAL support</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../active/glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../active/cli-commands.html">Command Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../active/rpc.html">Paris RPCs - Reference</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../quebeca/index.html">Quebeca Protocol Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../quebeca/protocol.html">Economic protocol features</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/protocol_overview.html">Overview of the economic protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/proof_of_stake.html">Proof-of-stake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/randomness_generation.html">Randomness generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/baking_power.html">Baking Power</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/consensus.html">The consensus algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/voting.html">The Amendment (and Voting) Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/accounts.html">Accounts and addresses</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/michelson.html">Michelson: the language of Smart Contracts in Tezos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/views.html">On-chain Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/timelock.html">Time-lock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/sapling.html">Sapling support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/liquidity_baking.html">Liquidity Baking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/global_constants.html">Global Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/michelson_anti_patterns.html">Michelson Anti-Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/token_management.html">Token transfers and balance updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/precheck.html">Prechecking of manager operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/smart_rollups.html">Smart Optimistic Rollups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/plugins.html">Protocol Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/event.html">Contract events</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/blocks_ops.html">Blocks and Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/validation.html">Validation and Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/tickets.html">Tickets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/adaptive_issuance.html">Adaptive Issuance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/staking.html">Staking mechanism</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/adaptive_slashing.html">Adaptive Slashing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quebeca/dal_support.html">DAL support</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../quebeca/glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quebeca/cli-commands.html">Command Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quebeca/rpc.html">Quebeca RPCs - Reference</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../alpha/index.html">Alpha Dev Protocol Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../alpha/protocol.html">Economic protocol features</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../alpha/protocol_overview.html">Overview of the economic protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/proof_of_stake.html">Proof-of-stake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/randomness_generation.html">Randomness generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/baking_power.html">Baking Power</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/consensus.html">The consensus algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/voting.html">The Amendment (and Voting) Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/accounts.html">Accounts and addresses</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/michelson.html">Michelson: the language of Smart Contracts in Tezos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/views.html">On-chain Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/timelock.html">Time-lock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/sapling.html">Sapling support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/liquidity_baking.html">Liquidity Baking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/global_constants.html">Global Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/michelson_anti_patterns.html">Michelson Anti-Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/token_management.html">Token transfers and balance updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/precheck.html">Prechecking of manager operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/smart_rollups.html">Smart Optimistic Rollups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/plugins.html">Protocol Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/event.html">Contract events</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/blocks_ops.html">Blocks and Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/validation.html">Validation and Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/tickets.html">Tickets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/adaptive_issuance.html">Adaptive Issuance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/staking.html">Staking mechanism</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/adaptive_slashing.html">Adaptive Slashing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/dal_support.html">DAL support</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../alpha/glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../alpha/cli-commands.html">Command Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../alpha/rpc.html">Alpha RPCs - Reference</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tezos developer Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="rpc.html">JSON/RPC interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/errors.html">RPC Errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/openapi.html">RPCs - OpenAPI reference</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Changes in Octez releases</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../releases/releases.html">Release System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases/version-20.html">Version 20.2</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../releases/history.html">Older Versions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-19.html">Version 19.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-18.html">Version 18.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-17.html">Version 17.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-16.html">Version 16.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-15.html">Version 15.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-14.html">Version 14.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-13.html">Version 13.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-12.html">Version 12.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-11.html">Version 11.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-10.html">Version 10.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-9.html">Version 9.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-8.html">Version 8.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-7.html">Version 7.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/january-2020.html">Mainnet January 2020</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/december-2019.html">Mainnet December 2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/october-2019.html">Mainnet-Staging October 2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/september-2019.html">Mainnet September 2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/may-2019.html">Mainnet May 2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/april-2019.html">Mainnet April 2019</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Changes in protocol versions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../protocols/naming.html">Protocol versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../protocols/019_paris.html">Protocol Paris</a></li>
<li class="toctree-l1"><a class="reference internal" href="../protocols/021_quebeca.html">Protocol Quebeca</a></li>
<li class="toctree-l1"><a class="reference internal" href="../protocols/alpha.html">Protocol Alpha</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../protocols/history.html">Older Protocols</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../protocols/018_oxford.html">Protocol Oxford</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/017_nairobi.html">Protocol Nairobi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/016_mumbai.html">Protocol Mumbai</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/015_lima.html">Protocol Lima</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/014_kathmandu.html">Protocol Kathmandu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/013_jakarta.html">Protocol Jakarta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/012_ithaca.html">Protocol Ithaca</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/011_hangzhou.html">Protocol Hangzhou</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/010_granada.html">Protocol Granada</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/009_florence.html">Protocol Florence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/008_edo.html">Protocol Edo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/007_delphi.html">Protocol Delphi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/006_carthage.html">Protocol Carthage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/005_babylon.html">Protocol Babylon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/004_Pt24m4xi.html">Protocol Athens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/003_PsddFKi3.html">Protocol 003_PsddFKi3</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="contributing_index.html">How to contribute</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="contributing.html">How to contribute to Octez</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="contributing-adding-a-new-opam-dependency.html">How to add or update opam dependencies</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="merge_team.html">Octez Merge Team</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Documentation and coding guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="repository_scope.html">Scope of the Octez repository</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="programming.html">Programming tutorials</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="gadt.html">Generalized Algebraic Data Types (GADTs)</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="error_monad.html">The Error Monad</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="error_monad_p1_result.html">Part 1: <code class="docutils literal notranslate"><span class="pre">result</span></code>, Lwt, and Lwt-<code class="docutils literal notranslate"><span class="pre">result</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="error_monad_p2_tzresult.html">Part 2: <code class="docutils literal notranslate"><span class="pre">tzresult</span></code> and Lwt-<code class="docutils literal notranslate"><span class="pre">tzresult</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="error_monad_p3_advanced.html">Part 3: Advanced topics</a></li>
<li class="toctree-l3"><a class="reference internal" href="error_monad_p4_appendices.html">Part 4: Appendices</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="clic.html">The <code class="docutils literal notranslate"><span class="pre">clic</span></code> library</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_encoding.html">The <code class="docutils literal notranslate"><span class="pre">data_encoding</span></code> library</a></li>
<li class="toctree-l2"><a class="reference internal" href="event_logging_framework.html">Using The Event Logging Framework</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="testing_index.html">Testing in Octez</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="testing.html">Overview of Testing in Octez</a></li>
<li class="toctree-l2"><a class="reference internal" href="ppx_expect.html">Ppx_expect</a></li>
<li class="toctree-l2"><a class="reference internal" href="tezt.html">Tezt: OCaml Tezos Test Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="long-tezts.html">Tezt: Long Tests and Performance Regression Test Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="alcotezt.html">Alcotezt: An Alcotest Compatibility Wrapper for Tezt</a></li>
<li class="toctree-l2"><a class="reference internal" href="unit_testing_legacy_code.html">Making legacy code unit-testable</a></li>
<li class="toctree-l2"><a class="reference internal" href="proposal_testing.html">How to Test a Protocol Proposal</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="maintaining.html">Maintaining</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="entering_alpha.html">How to start reading protocol Alpha</a></li>
<li class="toctree-l2"><a class="reference internal" href="michelson_instructions.html">Adding a new instruction to Michelson language</a></li>
<li class="toctree-l2"><a class="reference internal" href="protocol_release_checklist.html">Protocol Release Checklist</a></li>
<li class="toctree-l2"><a class="reference internal" href="howto-freeze-protocols.html">How to Freeze Protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="protocol_environment_upgrade.html">Adding a new protocol environment</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Documenting</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tools.html">Platform Development tools</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="profiling.html">Profiling the Octez node</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="snoop.html">Benchmarking with Snoop</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="snoop_arch.html">Architecture of <code class="docutils literal notranslate"><span class="pre">octez-snoop</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="snoop_tutorial.html">Snoop usage tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="snoop_example.html">In-depth usage example: more control over your benchmark</a></li>
<li class="toctree-l3"><a class="reference internal" href="tezos_micheline_rewriting.html">Rewriting Micheline with <code class="docutils literal notranslate"><span class="pre">tezos-micheline-rewriting</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="snoop_interpreter.html">Snoop and the Michelson Interpreter</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="time_measurement_ppx.html">Time measurement PPX</a></li>
<li class="toctree-l2"><a class="reference internal" href="python_environment.html">Python Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="pre_commit_hook.html">Pre-Commit Hook</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="encodings.html">Encodings</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="merkle-proof-encoding-formats.html">Merkle Proof Encoding Formats</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="merkle-proof-formats/v1-tree32.html">V1 for Tree32</a></li>
<li class="toctree-l2"><a class="reference internal" href="merkle-proof-formats/v1-tree2.html">V1 for Tree2</a></li>
<li class="toctree-l2"><a class="reference internal" href="merkle-proof-formats/v2-tree32.html">V2 for Tree32</a></li>
<li class="toctree-l2"><a class="reference internal" href="merkle-proof-formats/v2-tree2.html">V2 for Tree2</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../api/api-inline.html">OCaml APIs - Reference</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-gitlab"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://gitlab.com/tezos/tezos" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-gitlab"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://gitlab.com/tezos/tezos/-/issues/new?issue[title]=Issue%20on%20page%20%2Fdeveloper/guidelines.html&issue[description]=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Documentation and coding guidelines</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#documentation-guidelines">Documentation guidelines</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comments-within-the-code">Comments within the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-fixme-comments">TODO/FIXME comments</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#license">License</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#documenting-interfaces-and-implementations">Documenting interfaces and implementations</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#using-docstrings">Using docstrings</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#docstrings-errors">Docstrings errors</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#index-mld-files">index.mld files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#readme-files">README files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-documentation-rules">General documentation rules</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#don-t-repeat-the-code">Donâ€™t repeat the code</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comments-maintainability">Comments maintainability</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#logging-vs-comments">Logging vs comments</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comment-first">Comment first</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coding-guidelines">Coding guidelines</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#logging-levels">Logging Levels</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#logging-guidelines">Logging Guidelines</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#make-logs-for-higher-severity-levels-actionable">Make logs for higher severity levels actionable</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#avoid-impacting-performance">Avoid impacting performance</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#make-logs-readable">Make logs readable</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#maintain-consistency-in-debug-logs">Maintain consistency in <code class="docutils literal notranslate"><span class="pre">Debug</span></code> logs</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#privacy-and-security">Privacy and Security</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-formatting">Code formatting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exposing-internals">Exposing internals</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exceptions-and-errors">Exceptions and errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rpc-security">RPC security</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rpc-versioning">RPC Versioning</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-version-an-rpc">How to Version an RPC</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#when-to-add-a-new-version-to-an-rpc">When to Add a New Version to an RPC</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linting">Linting</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-the-length-of-two-lists">Comparing the length of two lists</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-the-length-of-a-list-to-a-constant">Comparing the length of a list to a constant</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-the-length-of-a-list-with-zero">Comparing the length of a list with zero</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#folding-over-a-promise-or-a-result">Folding over a promise or a result</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#chaining-list-concat-and-list-map">Chaining List.concat and List.map</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#naming">Naming</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#other-coding-conventions">Other coding conventions</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="documentation-and-coding-guidelines">
<h1>Documentation and coding guidelines<a class="headerlink" href="#documentation-and-coding-guidelines" title="Link to this heading">#</a></h1>
<p>This document provides guidelines that should be observed by all the contributors to the Octez codebase. It first presents documentation guidelines, and then rules specific to coding.</p>
<section id="documentation-guidelines">
<h2>Documentation guidelines<a class="headerlink" href="#documentation-guidelines" title="Link to this heading">#</a></h2>
<p>Documentation guidelines are presented for different scales: functions, modules, files, and libraries. General remarks applying to all scales are presented <a class="reference internal" href="#general-doc-rules"><span class="std std-ref">afterwards</span></a>.</p>
<section id="comments-within-the-code">
<span id="in-code-comments"></span><h3>Comments within the code<a class="headerlink" href="#comments-within-the-code" title="Link to this heading">#</a></h3>
<p>The OCaml code should include comments facilitating comprehension and maintenance.</p>
<p>Towards this goal, comments are useful in the code wherever they bring important information that is not easily deducible from the code itself, such as: explaining the high-level goal of a code fragment, justifying an unusual pattern of code, exhibiting an  invariant, etc. See also rule <a class="reference internal" href="#rule-dont-repeat-the-code"><span class="std std-ref">Donâ€™t repeat the code</span></a>.</p>
<p>Additionally, the main syntactic constructs in the code should be commented as follows.</p>
<p>Modules:</p>
<ul class="simple">
<li><p>One-line comment explaining the purpose of the module</p></li>
<li><p>If needed: More detailed description</p></li>
</ul>
<p>The comments on a module may describe the overall abstraction provided by the module and its capabilities, without implementation details or even specifics of the different functions.
It may also describe limitations of the module that are important to developers using it (e.g. concurrency or performance limitations).</p>
<p>Types:</p>
<ul class="simple">
<li><p>One-line comment explaining what the type represents, typically the invariants satisfied by its inhabitants</p></li>
</ul>
<p>Functions and methods:</p>
<ul class="simple">
<li><p>Purpose of the function, brief description of the arguments and returned value</p></li>
<li><p>If needed: How and why to use this function</p></li>
<li><p>If needed: Pre-conditions for calling the function, including constraints on arguments values or dependencies between arguments, if any</p></li>
<li><p>If needed: Conditions under which the function will return an error or raise an exception</p></li>
<li><p>If needed: Any special behavior that is not obvious</p></li>
</ul>
<p>Constants, variables, variants, and struct fields:</p>
<ul class="simple">
<li><p>Purpose and definition of this data. Useful comments do not just expand a name using the same words, but rather describe the data including details that could not be included in its name.</p></li>
<li><p>If there is an associated measurement unit, define it in the comment, unless it is contained in the name, e.g.,  <code class="docutils literal notranslate"><span class="pre">TIMEOUT_MS</span></code> for a timeout in milliseconds.</p></li>
</ul>
<section id="todo-fixme-comments">
<span id="todo-fixme"></span><h4>TODO/FIXME comments<a class="headerlink" href="#todo-fixme-comments" title="Link to this heading">#</a></h4>
<p>During the <a class="reference internal" href="contributing.html#code-review"><span class="std std-ref">code review process</span></a>, follow-up issues may be created to improve some piece of code that already implements its specification (e.g., optimize, refactor, or bring a potentially useful generalization).
When the place of the future evolution is known in advance (e.g. a given function), you should mark it with a <code class="docutils literal notranslate"><span class="pre">TODO</span></code> comment of the form:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="c">(* TODO: &lt;reference to issue&gt;</span>
<span class="c">   &lt;one-line explanation&gt;</span>
<span class="c">   &lt;Add long explanation if the issue description is not the right place.&gt;</span>
<span class="c">*)</span>
</pre></div>
</div>
<p>If the evolution is needed to fix some code that does <em>not</em> fully implement its specification, (e.g., a known bug detected but not yet fixed, or a temporary implementation handling only some particular cases), rather than to merely improve the code, you should use a <code class="docutils literal notranslate"><span class="pre">FIXME</span></code> tag instead of the <code class="docutils literal notranslate"><span class="pre">TODO</span></code>, adhering to the same syntax for the rest.</p>
<p>Thus, the difference between <code class="docutils literal notranslate"><span class="pre">TODO</span></code> and <code class="docutils literal notranslate"><span class="pre">FIXME</span></code> tags is a semantic one,  reflecting the full/partial implementation of the specification.
Consequently, when the specification evolves to become more demanding, some <code class="docutils literal notranslate"><span class="pre">TODO</span></code> tags corresponding to <em>potential</em> evolutions may have to be recasted as <code class="docutils literal notranslate"><span class="pre">FIXME</span></code> tags, corresponding to <em>required</em> evolutions.</p>
<p>Another consequence of the fact that FIXME tags indicate an already-specified remaining work, they can point to a merge request (MR) instead of an issue, especially when the remaining work has already been started. This may correspond to at least the following familiar scenarios:</p>
<ol class="arabic simple">
<li><p>You are making a list of small-sized MRs to fix one big issue, and in one MR you want to point the reviewers to other MRs already started.</p></li>
<li><p>While working on some MR, you notice a problem with your code, by which it derives from the specification. But you already have one approval for the current MR and you donâ€™t want to invalidate it by adding a significant chunk of code. So you fix the problem in a separate MR from the one you are working on.</p></li>
</ol>
<p>In the above cases, it would be possible to create a new (sub-)issue, and reference it in the code (and also in the MR). But that would add a level of indirection, both for the person doing the work and for the person reviewing the work.
Therefore, in such cases, it can be more convenient to refer to an MR directly.</p>
<p>Note that the reference to an existing issue or MR on the first line is mandatory, to facilitate searches of specific evolutions.
These tags might be checked automatically by the <a class="reference internal" href="contributing.html#merge-bot"><span class="std std-ref">Merge-Request Bot</span></a>, e.g. to signal tags that refer to non-existent issues or MRs, to closed issues, or to already merged MRs.
The reference to an issue may be one of:</p>
<ul class="simple">
<li><p>a URL such as <code class="docutils literal notranslate"><span class="pre">https://gitlab.com/tezos/tezos/-/issues/1377</span></code></p></li>
<li><p>a GitLab notation for an issue such as <code class="docutils literal notranslate"><span class="pre">#123</span></code> (implicitly under <code class="docutils literal notranslate"><span class="pre">tezos/tezos</span></code>), <code class="docutils literal notranslate"><span class="pre">michelson-reference#123</span></code> (implicitly under <code class="docutils literal notranslate"><span class="pre">tezos/michelson-reference</span></code>),
or <code class="docutils literal notranslate"><span class="pre">oxheadalpha/merbocop#123</span></code> (fully qualified).</p></li>
<li><p>a GitLab notation for a merge request such as <code class="docutils literal notranslate"><span class="pre">!10990</span></code>.</p></li>
</ul>
</section>
</section>
<section id="license">
<h3>License<a class="headerlink" href="#license" title="Link to this heading">#</a></h3>
<p>The Octez software is distributed under the MIT license. Every OCaml source file should start with a header comment instantiating the following template:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="c">(*****************************************************************************)</span>
<span class="c">(*                                                                           *)</span>
<span class="c">(* SPDX-License-Identifier: MIT                                              *)</span>
<span class="c">(* SPDX-FileCopyrightText: [year(s)] [Holder &lt;email&gt;]                        *)</span>
<span class="c">(*                                                                           *)</span>
<span class="c">(*****************************************************************************)</span>
</pre></div>
</div>
<p>For other languages than OCaml, use the appropriate comment syntax. For example, here is the Rust template:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>//
// SPDX-License-Identifier: MIT
// SPDX-FileCopyrightText: [year(s)] [Holder &lt;email&gt;]
//
</pre></div>
</div>
<p>The following, full-text equivalent, template for OCaml is also valid but deprecated:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="c">(*****************************************************************************)</span>
<span class="c">(*                                                                           *)</span>
<span class="c">(* MIT License                                                               *)</span>
<span class="c">(* Copyright (c) [year(s)] [Holder &lt;email&gt;]                                  *)</span>
<span class="c">(*                                                                           *)</span>
<span class="c">(* Permission is hereby granted, free of charge, to any person obtaining a   *)</span>
<span class="c">(* copy of this software and associated documentation files (the &quot;Software&quot;),*)</span>
<span class="c">(* to deal in the Software without restriction, including without limitation *)</span>
<span class="c">(* the rights to use, copy, modify, merge, publish, distribute, sublicense,  *)</span>
<span class="c">(* and/or sell copies of the Software, and to permit persons to whom the     *)</span>
<span class="c">(* Software is furnished to do so, subject to the following conditions:      *)</span>
<span class="c">(*                                                                           *)</span>
<span class="c">(* The above copyright notice and this permission notice shall be included   *)</span>
<span class="c">(* in all copies or substantial portions of the Software.                    *)</span>
<span class="c">(*                                                                           *)</span>
<span class="c">(* THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR*)</span>
<span class="c">(* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,  *)</span>
<span class="c">(* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL   *)</span>
<span class="c">(* THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER*)</span>
<span class="c">(* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING   *)</span>
<span class="c">(* FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER       *)</span>
<span class="c">(* DEALINGS IN THE SOFTWARE.                                                 *)</span>
<span class="c">(*                                                                           *)</span>
<span class="c">(*****************************************************************************)</span>
</pre></div>
</div>
<p>Note that:</p>
<ul class="simple">
<li><p>The holder, on the copyright line, is the name of the company which hires the employee or the sub-contractor.</p></li>
<li><p>For sub-contractors, check your specific contract terms. They sometimes allow to include, as an additional copyright holder, the name of a particular developer, but consider that this may end up with bloated license headers.</p></li>
<li><p>When adding a significant new contribution to a file (i.e. more like whole new features, rather than simple fixes), check whether there already is a copyright for your copyright holder (see above).</p>
<ul>
<li><p>If there is one, mentioning any year, it is not required to add the current year (but this is allowed). In no case should you <em>replace</em> the existing year with the current one.</p></li>
<li><p>If there is no line for your copyright holder, you should add one, with the current year.</p></li>
</ul>
</li>
</ul>
</section>
<section id="documenting-interfaces-and-implementations">
<h3>Documenting interfaces and implementations<a class="headerlink" href="#documenting-interfaces-and-implementations" title="Link to this heading">#</a></h3>
<p>At the granularity of OCaml files, it is essential to document the interface implemented by each file.
In many cases, it is useful to also document the implementation, but <em>separately</em> from the interface.</p>
<p>Implementation (<code class="docutils literal notranslate"><span class="pre">.ml</span></code>) files:</p>
<ul class="simple">
<li><p>Document the interface:</p>
<ul>
<li><p>In the common case where there is a corresponding interface (<code class="docutils literal notranslate"><span class="pre">.mli</span></code>) file,
document the interface file instead, as detailed below.</p></li>
<li><p>In the less common case where there is no corresponding interface (<code class="docutils literal notranslate"><span class="pre">.mli</span></code>)
file, document the exported elements directly in the implementation
(<code class="docutils literal notranslate"><span class="pre">.ml</span></code>) file.</p></li>
</ul>
</li>
<li><p>Document the implementation: For many non-trivial implementations, it is most useful to document the design principles, code structure, internal invariants, and so on.
Such information should be placed in a comment block at the top of the file.</p></li>
</ul>
<p>Interface (<code class="docutils literal notranslate"><span class="pre">.mli</span></code>) file comments:</p>
<ul class="simple">
<li><p>One-line description</p></li>
<li><p>Brief description of the library, introducing the needed concepts</p></li>
<li><p>Brief description of each module, type, function, data, as described for <a class="reference internal" href="#in-code-comments"><span class="std std-ref">comments in the code</span></a> but <a class="reference internal" href="#using-docstrings"><span class="std std-ref">using special comments</span></a></p></li>
<li><p>If applicable, external invariants (i.e., visible to the user).</p></li>
</ul>
<p>Interface comments should omit implementation details, to the extent where these are invisible to users of the interface.</p>
<section id="using-docstrings">
<span id="id1"></span><h4>Using docstrings<a class="headerlink" href="#using-docstrings" title="Link to this heading">#</a></h4>
<p>The documentation of OCaml interfaces is automatically generated by <code class="docutils literal notranslate"><span class="pre">odoc</span></code> from <em>special comments</em> in the source code, of the form <code class="docutils literal notranslate"><span class="pre">(**</span> <span class="pre">...</span> <span class="pre">*)</span></code>, also called documentation comments, or â€œdocstringsâ€.
Here are a few tips and guidelines on using docstrings.</p>
<ul class="simple">
<li><p>A documentation page is generated for each module <em>interface</em> and module type, and for each class <em>interface</em> and class type, from the docstrings attached to them and to their contained elements.
Docstrings inside a module <em>implementation</em> (i.e. <code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">...</span> <span class="pre">end</span></code> constructs) are not kept.
You should use normal comments (<code class="docutils literal notranslate"><span class="pre">(*</span> <span class="pre">...</span> <span class="pre">*)</span></code>) inside the implementation.</p></li>
<li><p>The page generated for each interface starts with a â€œpreambleâ€, consisting of: the docstring on its declaration, if any, and the â€œtop-commentâ€ inside the interface (the first docstring inside the interface not attached to a contained element), if any.
The first paragraph of the preamble, if any, will serve as the â€œsynopsisâ€ of the interface, and will be used when the interface appears in a list (typically, in the page of its containing interface).</p></li>
<li><p>When it makes sense, you should document not only interfaces at the top level of a file, but also those embedded in other (module or class) interfaces.</p></li>
<li><p>Docstrings in <code class="docutils literal notranslate"><span class="pre">.mli</span></code> and <code class="docutils literal notranslate"><span class="pre">.ml</span></code> files are handled the same, so do not omit documenting the interfaces in the latter files.</p></li>
</ul>
<p>For more information on using docstrings, see the <code class="docutils literal notranslate"><span class="pre">odoc</span></code> <a class="reference external" href="https://ocaml.github.io/odoc/odoc_for_authors.html">documentation for library authors</a>.
In particular, it contains a <a class="reference external" href="https://ocaml.github.io/odoc/cheatsheet.html">cheatsheet</a> that may be useful.</p>
<section id="docstrings-errors">
<h5>Docstrings errors<a class="headerlink" href="#docstrings-errors" title="Link to this heading">#</a></h5>
<p>When <code class="docutils literal notranslate"><span class="pre">odoc</span></code> is generating documentation from docstrings, it performs various syntax and semantics checks and may thereby emit many kinds of warnings.
Some of these warnings are turned into errors when the flag <code class="docutils literal notranslate"><span class="pre">ODOC_WARN_ERROR</span></code> is on.
You have to fix at least these errors for making the CI green.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">odoc</span></code> returns a non-zero exit code, the list of errors is displayed in the terminal but some details are abstracted away.
The full details of each error, and also the regular warnings, can be found in the log produced by <code class="docutils literal notranslate"><span class="pre">odoc</span></code> in file <code class="docutils literal notranslate"><span class="pre">${TMPDOCDIR}/odoc.log</span></code>, where variable <code class="docutils literal notranslate"><span class="pre">TMPDOCDIR</span></code> is defined in file <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/docs/Makefile">docs/Makefile</a>.
Search for the string <code class="docutils literal notranslate"><span class="pre">Error:</span></code> in that file to find all the errors.</p>
<p>You may consult a list of <a class="reference external" href="https://gitlab.com/nomadic-labs/protodoc/-/blob/master/doc/errors.md">typical error messages found by odoc in the Tezos repository</a>.
These examples may help both to avoid common pitfalls when writing docstrings,  and to better understand <code class="docutils literal notranslate"><span class="pre">odoc</span></code> errors that you may encounter.</p>
</section>
</section>
</section>
<section id="index-mld-files">
<h3>index.mld files<a class="headerlink" href="#index-mld-files" title="Link to this heading">#</a></h3>
<p>At the granularity of the library, you can optionally include an <code class="docutils literal notranslate"><span class="pre">index.mld</span></code> file.
This file is used to generate the landing page for the online API of the library.
If you do not include this file, the landing page is automatically generated and only includes a list of all top-level modules.</p>
<p>An <code class="docutils literal notranslate"><span class="pre">mld</span></code> file is written in the <a class="reference external" href="https://ocaml.org/manual/ocamldoc.html#s%3Aocamldoc-comments">ocamldoc markup language</a>.</p>
<p>Because it is used for the online API of the library it should contain information that might be of interest to the users.
This includes</p>
<ul class="simple">
<li><p>A general introduction to the library.</p></li>
<li><p>Design decisions for the API.</p></li>
<li><p>Usage recommendations including the security model and assumptions.</p></li>
<li><p>Example uses.</p></li>
<li><p>Links to related documents (such as RFC and ISO standards).</p></li>
</ul>
<p>The file should also include a link to all of the modules that are intended entry-points for the users.
You can include those with <code class="docutils literal notranslate"><span class="pre">{!module:Foo}</span></code> inline in an appropriate paragraph of the documentation.
You can also include those with a dedicated block:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{!modules:
Foo
Bar
Blah
}
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When you add an <code class="docutils literal notranslate"><span class="pre">index.mld</span></code> file, donâ€™t forget to add a <code class="docutils literal notranslate"><span class="pre">~documentation:[]</span></code> parameter to the packageâ€™s manifest which adds a documentation stanza in the corresponding dune file.
Otherwise, your <code class="docutils literal notranslate"><span class="pre">index.mld</span></code> file will be ignored by <code class="docutils literal notranslate"><span class="pre">odoc</span></code> and the API page will be the default one!</p>
</div>
</section>
<section id="readme-files">
<h3>README files<a class="headerlink" href="#readme-files" title="Link to this heading">#</a></h3>
<p>Also at the level of the library, you should include a <code class="docutils literal notranslate"><span class="pre">README.md</span></code> in <a class="reference external" href="https://daringfireball.net/projects/markdown/">Markdown format</a>.
Such files are mandatory in top-level directories of the Octez codebase (such as <code class="docutils literal notranslate"><span class="pre">src/</span></code> and <code class="docutils literal notranslate"><span class="pre">docs/</span></code>), and at least in immediate sub-directories of the source directory (<code class="docutils literal notranslate"><span class="pre">src/*/</span></code>).
Because it is accessible only in the source tree, the file should contain information that might be of interest to the maintainers and contributors.</p>
<p>You must instantiate the <code class="docutils literal notranslate"><span class="pre">README.md</span></code> file with the following template:</p>
<div class="highlight-markdown notranslate"><div class="highlight"><pre><span></span><span class="gh"># Component Name</span>
&lt;!-- Summary line: One sentence about this component. --&gt;

<span class="gu">## API Documentation</span>
&lt;!-- Link to the external API. --&gt;

<span class="gu">## Installation</span>
&lt;!-- Describe how this component can be installed (if applicable). --&gt;

<span class="gu">## Overview</span>
&lt;!--
<span class="k">-</span><span class="w"> </span>Describe the purpose of this component.
<span class="k">-</span><span class="w"> </span>Describe the interaction of the code in this directory with the other
  components. This includes dependencies on other components, for instance.
--&gt;

<span class="gu">## Implementation Details</span>
&lt;!--
<span class="k">-</span><span class="w"> </span>Describe the file structure and the location of the main components.
<span class="k">-</span><span class="w"> </span>Other relevant implementation details (e.g., global invariants,
  implementation design rationale, etc.).
<span class="k">-</span><span class="w"> </span>Testing specifics, build-system specifics, etc. as needed.
--&gt;
</pre></div>
</div>
<p>The rationale of this template is that a README file addresses the developers
that are not just using the library but also fixing or modifying it.
To avoid duplication between the <code class="docutils literal notranslate"><span class="pre">index.mld</span></code> and <code class="docutils literal notranslate"><span class="pre">README.md</span></code> files, follow
this simple rule-of-thumb: the <code class="docutils literal notranslate"><span class="pre">index.mld</span></code> contains information for the users
(how to use the API) whereas the <code class="docutils literal notranslate"><span class="pre">README.md</span></code> file contains information for the
maintainers (how are the files organised, are there any build-system quirks,
etc.).</p>
<p>When filling in the template, you should keep untouched the guidelines within
HTML comments (which are visible to the document maintainers but invisible to
end-users), so that any maintainer can check how well the README instantiates
the template, and address any gap if needed.</p>
</section>
<section id="general-documentation-rules">
<span id="general-doc-rules"></span><h3>General documentation rules<a class="headerlink" href="#general-documentation-rules" title="Link to this heading">#</a></h3>
<section id="don-t-repeat-the-code">
<span id="rule-dont-repeat-the-code"></span><h4>Donâ€™t repeat the code<a class="headerlink" href="#don-t-repeat-the-code" title="Link to this heading">#</a></h4>
<p>When writing comments, a common mistake is to repeat the code, paraphrasing it with the same words, or at the same abstraction level.
Good comments bring information that is not obvious from the code itself.
They complement the code with details at a <em>different level of abstraction</em>, thus typically using different words to provide details on the meaning of the code.</p>
<ul>
<li><p>Lower-level comments add precision</p>
<p>Such comments add precision by providing details not easily inferred from the code. For example, comments on a function may define its behaviour in particular cases, or provide defaults for the arguments; comments on a variable may add details, such as the measurement units, boundary conditions, invariants, or define the meaning of the different values (e.g. for a boolean variable).</p>
</li>
<li><p>Higher-level comments enhance intuition</p>
<p>Such comments are written at a higher level of discourse than the code, and provide a basis to understand the provided asbtractions and underlying concepts, and to reason about them.
For example:</p>
<ul>
<li><p>An implementation comment inside a module or function body may explain the overall goal and provide a conceptual framework in which the details of the code may be easily understood.</p>
<p>Typically, the comment will explain <em>what</em> the code is doing, and possibly <em>why</em> (e.g., in which context the code is called), rather than <em>how</em> it is done â€“  this can be usually seen in the code itself.</p>
</li>
<li><p>A comment on the interface provided by a library may describe the solution provided for the given problem domain, how the different functions may be combined together, some limitations of the library (e.g. in terms of concurrency), etc.</p></li>
</ul>
</li>
</ul>
</section>
<section id="comments-maintainability">
<h4>Comments maintainability<a class="headerlink" href="#comments-maintainability" title="Link to this heading">#</a></h4>
<p>Maintaining comments up-to-date with the code is a crucial component of their usefulness.
Moreover, if many comments in a piece of software become out of date, developers may start ignoring them altogether.
Fortunately, a few techniques may greatly increase the maintainability of comments.</p>
<ul>
<li><p>Place comments near the concerned code.</p>
<p>Comments are more likely to be updated if they are placed at the â€œnaturalâ€ place where developers would look for them.
For interface comments, the position of docstrings is already defined by Odoc: on the definition of the module, function, or variable.
Implementation comments should be placed near the code they describe; avoid placing all the comments at the beginning of the file, unless their scope is the whole file.</p>
</li>
<li><p>Stay at a high level.</p>
<p>Usually, the farther comments are from the code, the more high-level they must be.
Comments associated to a large scope of code may typically present a global view of the code in general terms, which makes them less likely to be invalidated by local changes; when changes concern a large part of that scope, they can be impacted but there are chances that developers will see them.</p>
</li>
<li><p>Avoid duplicating comments.</p>
<p>Some comments are needed in several places.</p>
<ul>
<li><p>For instance, an externally-visble module exporting part of the functionality of some internal module(s) should describe each exported element, because users may not look to the internal module(s); but the internal modules should also describe their interface for their own users and maintainers.</p>
<p>In such cases, duplication may be avoided by choosing a single place for the comments, and using cross-references to it wherever needed.
Fortunately, Odoc provides <a class="reference external" href="https://ocaml.github.io/odoc/odoc_for_authors.html#links-and-references">such cross-references</a> and checks for each reference that the target element exists, ensuring they do not get stale when code is moved or suppressed.</p>
</li>
<li><p>In other cases, the documentation needed near some piece of code is already available outside the code. For instance, a user-visible client command or node RPC should not duplicate explanations in the user reference.</p>
<p>Most such cases are handled in Octez by automatically generating the reference manual from the code.
When this is not the case, comments in the code should refer to the outside sources instead of duplicating them, by using: web links to the technical documentation, to GitLab repositories, or to third-party websites when appropriate (e.g. Wikipedia for known concepts).</p>
</li>
<li><p>Another important case is comments describing a cross-module design decision or property.</p>
<p>Duplication can be avoided here by using cross-references, as described above.
However, if all the modules belong to the same library, you could rather place the comments in a <code class="docutils literal notranslate"><span class="pre">index.mld</span></code> file describing the library, and refer to that file in all the needed places, using Odoc-checked cross-references.</p>
</li>
</ul>
</li>
<li><p>Envision cohesive documentation.</p>
<ul>
<li><p>When writing online technical documentation, refer whenever needed to code artefacts: module APIs, GitLab entities in the Octez repository, or source files, using our Sphinx-checked <a class="reference internal" href="../README.html#custom-sphinx-roles"><span class="std std-ref">custom roles</span></a>.</p></li>
<li><p>More generally, including various kinds of checked cross-references in the documentation makes it more cohesive, more robust and easier to maintain.
Indeed, the more checked links you include in the documentation (from comments to related code elements, from comments to <code class="docutils literal notranslate"><span class="pre">.mld</span></code> files and back, from external documentation to code and back, to external websites, etc.), the more are chances that the documentation will be updated along with the code, when some links break.</p>
<p>Our documentation tools (Odoc and Sphinx, currently) provide support for such cohesive documentation which is probably more advanced than the average, so take advantage from it!</p>
</li>
</ul>
</li>
</ul>
</section>
<section id="logging-vs-comments">
<h4>Logging vs comments<a class="headerlink" href="#logging-vs-comments" title="Link to this heading">#</a></h4>
<p>Sometimes, it may be preferable to use logging instead of commenting a section of code.
That is, consider using:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Log</span><span class="p">.</span><span class="n">info</span> <span class="s2">&quot;Does this and that...&quot;</span> <span class="o">;</span>
</pre></div>
</div>
<p>instead of:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="c">(* Does this and that... *)</span>
</pre></div>
</div>
<p>and certainly instead of:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="c">(* Does this and that... *)</span>
<span class="nn">Log</span><span class="p">.</span><span class="n">info</span> <span class="s2">&quot;Does this and that...&quot;</span> <span class="o">;</span>
</pre></div>
</div>
<p>This form of â€œexecutable commentsâ€ is appropriate for instance when writing tests, and more generally, whenever a dynamic execution trace is useful, provided that the log message contains all the information that you would put in a comment.
Of course, if the log message is too short to fully describe the code section, consider completing it (rather than duplicating it) with comments.</p>
<p>For details on logging, see <a class="reference internal" href="#logging-levels"><span class="std std-ref">Logging Levels</span></a>.</p>
</section>
<section id="comment-first">
<h4>Comment first<a class="headerlink" href="#comment-first" title="Link to this heading">#</a></h4>
<p>This section is by no means a rule to comply with, but just some arguments, advocated by John Ousterhout <a class="footnote-reference brackets" href="#id5" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>, for a documentation practice consisting in writing most comments <em>before</em> writing the code, or <em>while</em> writing the code.
These arguments are left to the appreciation of each developer.</p>
<p>Most comments, including all the docstrings that describe interfaces, are more related to the software design phase than to the other phases of software development such as coding, testing, releasing.
Indeed, these comments are currently the only way to fully describe the abstractions provided by software and their underlying concepts.
Writing comments during the design phase (e.g. woven with the definition of interfaces), may be an effective way to improve the quality of both the design and the comments, because:</p>
<ul class="simple">
<li><p>During this phase, the developersâ€™ mindset is at the right level of abstraction to describe software components clearly and simply, not distracted by implementation details.
This usually results in better comments.</p></li>
<li><p>Moreover, by expressing the interface design concisely in words, comments are an effective design tool: they allow evaluating the simplicity of interfaces from the start, and thus producing better designs.
For example, a module or function difficult to describe in a simple way may be a sign that the design does not effectively hide complexity or does not provide the right abstractions.</p></li>
<li><p>Finally, writing comments before the code may be more fun and rewarding.
Indeed, integrating comments in a useful way in the design process can make documentation more appealing, and a well-presented result may by more satisfying.
As opposed to that, many developers are writing comments as some sort of menial work to do after code is complete, when the design has to be partly reconstituted from the code; this typically leads to more work, and to lower-quality, and hence less satisfactory comments.</p></li>
</ul>
</section>
</section>
</section>
<section id="coding-guidelines">
<h2>Coding guidelines<a class="headerlink" href="#coding-guidelines" title="Link to this heading">#</a></h2>
<p>This section presents coding guidelines, related to aspects such as logging levels, code formatting, and naming.</p>
<section id="logging-levels">
<span id="id3"></span><h3>Logging Levels<a class="headerlink" href="#logging-levels" title="Link to this heading">#</a></h3>
<p>The Octez libraries use a logging library with 5 different verbosity <em>levels</em>
defined in <code class="docutils literal notranslate"><span class="pre">src/lib_event_logging/internal_event.mli</span></code> for the shell and
<code class="docutils literal notranslate"><span class="pre">src/lib_protocol_environment/sigs/v3/logging.mli</span></code> for protocol code.</p>
<p>It is important to choose the appropriate level for each event in the code to
avoid flooding the node administrator with too much information.</p>
<p>These are the rules of thumb that we use in the code to decide the appropriate
level (here listed from most to least verbose) for each event:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Debug</span></code> level, the most verbose, is used by developers to follow
the flow of execution of the node at the lowest granularity. Feel free to add
detailed info while staying reasonable, as emitting too many logs can be
costly even if they are not printed anywhere.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Info</span></code> level contains additional information that you might want to
have, but these logs are not important to have if your node is running OK
(and definitely do not require any action). These logs are stored in the
daily logs (by default) that devs may want to look for more technical info but should not
be too verbose to prevent the log files from growing too large.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Notice</span></code> level (the default) should be about things that the node
admin should be concerned, but do not require any action. These logs
are printed on stdout and should be short, concise, noise-free, and easy to
read and understand for a non-developer. They should indicate progress and
surprising behavior.</p></li>
</ul>
<p>The two following levels are used to alert the node
administrator about potential problems and errors:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Warning</span></code> level are all those events that might require the node
administratorâ€™s attention and can reveal potential anomalies in the nodeâ€™s
operation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Error</span></code> level are all those events that require an intervention from the node
administrator or signal exceptional circumstances.</p></li>
</ul>
<p>There is another level <code class="docutils literal notranslate"><span class="pre">Fatal</span></code> with the highest priority but it is rarely
relevant. Specifically, <code class="docutils literal notranslate"><span class="pre">Fatal</span></code> should be reserved for errors that
absolutely cannot be recovered. All logging at the <code class="docutils literal notranslate"><span class="pre">Fatal</span></code> level should be
immediately followed by a call to <code class="docutils literal notranslate"><span class="pre">Lwt_exit.exit_and_raise</span></code>.</p>
<p>Note that a library is never able to decide whether a certain condition is fatal
or not. Indeed, the application that calls into the library may not consider the
function call as essential to the continuation of the applicationâ€™s main
purpose. Consequently, <code class="docutils literal notranslate"><span class="pre">Fatal</span></code> should never be used within libraries.</p>
</section>
<section id="logging-guidelines">
<h3>Logging Guidelines<a class="headerlink" href="#logging-guidelines" title="Link to this heading">#</a></h3>
<section id="make-logs-for-higher-severity-levels-actionable">
<h4>Make logs for higher severity levels actionable<a class="headerlink" href="#make-logs-for-higher-severity-levels-actionable" title="Link to this heading">#</a></h4>
<p>Logs with levels <code class="docutils literal notranslate"><span class="pre">Fatal</span></code>, <code class="docutils literal notranslate"><span class="pre">Error</span></code>, and <code class="docutils literal notranslate"><span class="pre">Warning</span></code> should be actionable.
Ensure the log provides sufficient information for debugging and reproduction
if possible. Include object type, identity (variable and value that identifies
the context, such as <code class="docutils literal notranslate"><span class="pre">pid:</span> <span class="pre">123</span></code>), state, error code and other
critical info if applicable.</p>
<p>Examples of actionable log:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">(</span>error<span class="w"> </span>code<span class="w"> </span>E1007<span class="o">)</span><span class="w"> </span>file<span class="w"> </span>~/.octez-node/config.json<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>valid<span class="w"> </span>JSON,<span class="w"> </span>please<span class="w"> </span>remove<span class="w"> </span>it<span class="w"> </span>and<span class="w"> </span>reconfigure<span class="w"> </span>your<span class="w"> </span>node<span class="w"> </span>with<span class="w"> </span><span class="s1">&#39;octez-node config init&#39;</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>pid:42825<span class="o">][</span>rpc_middleware<span class="o">]</span><span class="w"> </span>:<span class="w"> </span><span class="o">(</span><span class="m">16</span><span class="o">)</span><span class="w"> </span>got<span class="w"> </span>conn<span class="w"> </span>closed,<span class="w"> </span>but<span class="w"> </span>shutdown<span class="w"> </span>callback<span class="w"> </span>not<span class="w"> </span>found
</pre></div>
</div>
<p>Example of poor logs:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>unexpected<span class="w"> </span>error
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cannot<span class="w"> </span>parse<span class="w"> </span>configuration
</pre></div>
</div>
</section>
<section id="avoid-impacting-performance">
<h4>Avoid impacting performance<a class="headerlink" href="#avoid-impacting-performance" title="Link to this heading">#</a></h4>
<p>Carefully consider the balance between the performance impact and the need
for debug capabilities.</p>
<ul class="simple">
<li><p>Be cautious about logging in performance-critical sections of the code to
avoid unnecessary overhead.</p></li>
<li><p>Ensure that calculations done solely for logging are performed within the log
statement itself, ensuring they are only executed if the logs are enabled.</p></li>
</ul>
</section>
<section id="make-logs-readable">
<h4>Make logs readable<a class="headerlink" href="#make-logs-readable" title="Link to this heading">#</a></h4>
<p>Print out states and error codes as a plain text unless the state is well
known as a number. Good examples are <code class="docutils literal notranslate"><span class="pre">Enabled</span></code> and <code class="docutils literal notranslate"><span class="pre">404</span></code>.</p>
</section>
<section id="maintain-consistency-in-debug-logs">
<h4>Maintain consistency in <code class="docutils literal notranslate"><span class="pre">Debug</span></code> logs<a class="headerlink" href="#maintain-consistency-in-debug-logs" title="Link to this heading">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">Debug</span></code> logs are often extensive, so prepare them for easier analysis:</p>
<ul class="simple">
<li><p>Maintain a consistent style for formatting states and identities, allowing
easy log filtering. For example, if you choose to write <code class="docutils literal notranslate"><span class="pre">pid:</span> <span class="pre">123</span></code>, stick
to it and avoid using <code class="docutils literal notranslate"><span class="pre">pid=123</span></code> elsewhere for the same context.</p></li>
<li><p>Place identities in the same order, making it easier to filter logs by
multiple parameters simultaneously. For example, use <code class="docutils literal notranslate"><span class="pre">conn:</span> <span class="pre">123,</span> <span class="pre">pid:</span> <span class="pre">456</span></code>.</p></li>
<li><p>Prefer a table style for logs. Group identities at the beginning of the line
and follow with a clear description.</p></li>
<li><p>Make the log originator easily identifyable. Enabling <code class="docutils literal notranslate"><span class="pre">Debug</span></code> logs typically
triggers logs from multiple components and logical areas. Ensure it is easy
to filter out logs belonging to one logical area or one log originator.</p></li>
</ul>
<p>Example of consistent logs:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Jun<span class="w"> </span><span class="m">07</span><span class="w"> </span><span class="m">18</span>:11:41.604:<span class="w"> </span><span class="o">[</span>pid:95779<span class="o">][</span>resto<span class="o">]</span><span class="w"> </span>server<span class="w"> </span><span class="o">(</span><span class="m">18</span><span class="o">)</span><span class="w"> </span>got<span class="w"> </span>conn<span class="w"> </span>closed
Jun<span class="w"> </span><span class="m">07</span><span class="w"> </span><span class="m">18</span>:11:41.606:<span class="w"> </span><span class="o">[</span>pid:95662<span class="o">][</span>node_run_cmd<span class="o">]</span><span class="w"> </span><span class="o">(</span><span class="m">6</span><span class="o">)</span><span class="w"> </span>got<span class="w"> </span>conn<span class="w"> </span>closed
Jun<span class="w"> </span><span class="m">07</span><span class="w"> </span><span class="m">18</span>:11:41.606:<span class="w"> </span><span class="o">[</span>pid:95662<span class="o">][</span>resto<span class="o">]</span><span class="w"> </span>server<span class="w"> </span><span class="o">(</span><span class="m">6</span><span class="o">)</span><span class="w"> </span>got<span class="w"> </span>conn<span class="w"> </span>closed
Jun<span class="w"> </span><span class="m">07</span><span class="w"> </span><span class="m">18</span>:11:41.606:<span class="w"> </span><span class="o">[</span>pid:95662<span class="o">][</span>resto<span class="o">]</span><span class="w"> </span>server<span class="w"> </span><span class="o">(</span><span class="m">6</span><span class="o">)</span><span class="w"> </span>closed<span class="w"> </span>bound<span class="w"> </span>streamed<span class="w"> </span>connection
</pre></div>
</div>
<p>Example of poor logs:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>May<span class="w"> </span><span class="m">29</span><span class="w"> </span><span class="m">12</span>:15:59.267:<span class="w"> </span>started
May<span class="w"> </span><span class="m">29</span><span class="w"> </span><span class="m">12</span>:15:59.267:<span class="w"> </span>requester<span class="w"> </span>worker<span class="w"> </span>timout
May<span class="w"> </span><span class="m">29</span><span class="w"> </span><span class="m">12</span>:16:31.467:<span class="w"> </span>connection<span class="w"> </span>closed<span class="w"> </span><span class="m">3</span>
May<span class="w"> </span><span class="m">29</span><span class="w"> </span><span class="m">12</span>:16:31.468:<span class="w"> </span><span class="o">(</span><span class="m">4</span><span class="o">)</span><span class="w"> </span>received<span class="w"> </span>request
</pre></div>
</div>
</section>
<section id="privacy-and-security">
<h4>Privacy and Security<a class="headerlink" href="#privacy-and-security" title="Link to this heading">#</a></h4>
<p>Avoid logging sensitive information. Ensure that logs do not expose private
data, keys, or personally identifiable information (PII).</p>
</section>
</section>
<section id="code-formatting">
<h3>Code formatting<a class="headerlink" href="#code-formatting" title="Link to this heading">#</a></h3>
<p>To ensure that your OCaml code is well formatted, set up correctly your editor:</p>
<ul class="simple">
<li><p>automatically run <code class="docutils literal notranslate"><span class="pre">ocamlformat</span></code> when saving a file</p></li>
<li><p>no tabs, use whitespaces</p></li>
<li><p>no trailing whitespaces</p></li>
<li><p>indent correctly (e.g. use lisp-mode for dune files)</p></li>
</ul>
<p>Some of these checks can be executed with a <a class="reference external" href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks">pre-commit hook</a>
(see <a class="reference internal" href="pre_commit_hook.html"><span class="doc">Pre-Commit Hook</span></a> for more details).</p>
</section>
<section id="exposing-internals">
<h3>Exposing internals<a class="headerlink" href="#exposing-internals" title="Link to this heading">#</a></h3>
<p>Sometimes you want to expose some internal functions, types or sub-modules of a module: usually it is for testing part of the module logic, but it may also be to let some power users access internals (for performance, extra-functionality, or any other reason).</p>
<p>A first question you should ask yourself is: â€œIs this a hint that my module has too many responsibilities?â€.</p>
<p>If the answer is yes: consider splitting your module per responsibility and see if you still need to expose internals.</p>
<p>If the answer is no: the guideline is to expose an internal module as part of your API:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Internal_for_tests</span></code> for internal types, functions and sub-modules that are only meant to be accessed by tests</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Internal</span></code> for internal types, functions and sub-modules that are meant to be accessed by production code (but may also be accessed by tests)</p></li>
</ul>
<p>Additionally you should add the <code class="docutils literal notranslate"><span class="pre">(**/**)</span></code> <a class="reference external" href="https://ocaml.org/manual/ocamldoc.html#ss:ocamldoc-stop">Stop special comment</a> so that this module is
not displayed in the public module documentation.</p>
<p>The rationale of <code class="docutils literal notranslate"><span class="pre">Internal_for_tests</span></code> is to make it explicit both for developers writing code and for reviewers that this module must not be used in production code.</p>
<p>Example:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span> <span class="c">(* mli *)</span>
 <span class="k">type</span> <span class="n">t</span>

 <span class="k">val</span> <span class="n">f</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">u</span>

<span class="hll"> <span class="c">(**/**)</span>
</span>
<span class="hll"> <span class="k">module</span> <span class="nc">Internal_for_tests</span> <span class="o">:</span> <span class="k">sig</span>
</span><span class="hll">   <span class="c">(** The actual representation of [t] *)</span>
</span><span class="hll">   <span class="k">type</span> <span class="n">t_raw</span> <span class="o">=</span> <span class="o">{</span><span class="n">bar</span> <span class="o">:</span> <span class="kt">string</span><span class="o">;</span> <span class="n">baz</span> <span class="o">:</span> <span class="kt">int</span><span class="o">}</span>
</span><span class="hll">
</span><span class="hll">   <span class="c">(** Access inner fields of a value of type [t] *)</span>
</span><span class="hll">   <span class="k">val</span> <span class="n">unwrap</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t_raw</span>
</span><span class="hll">
</span><span class="hll">   <span class="c">(** An internal function that we want to test in isolation *)</span>
</span><span class="hll">   <span class="k">val</span> <span class="n">g</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">v</span>
</span><span class="hll">
</span><span class="hll">   <span class="c">(** You can also expose internal modules, e.g. the inner cache *)</span>
</span><span class="hll">   <span class="k">module</span> <span class="nc">Mycache</span> <span class="o">:</span> <span class="nn">Cache</span><span class="p">.</span><span class="nc">S</span>
</span><span class="hll"> <span class="k">end</span>
</span>
 <span class="c">(* ml *)</span>
 <span class="k">module</span> <span class="nc">Mycache</span> <span class="o">=</span> <span class="nn">Cache</span><span class="p">.</span><span class="nn">Make</span> <span class="p">...</span>

 <span class="n">type</span> <span class="n">t</span> <span class="o">=</span> <span class="o">{</span><span class="n">bar</span> <span class="o">:</span> <span class="kt">string</span><span class="o">;</span> <span class="n">baz</span> <span class="o">:</span> <span class="kt">int</span><span class="o">}</span>

 <span class="c">(* [g] is an internal function, not part of the public API *)</span>
 <span class="k">let</span> <span class="n">g</span> <span class="n">t</span> <span class="o">=</span> <span class="o">...</span>

 <span class="c">(* [f] uses internal function [g] *)</span>
 <span class="k">let</span> <span class="n">f</span> <span class="n">t</span> <span class="o">=</span>
   <span class="k">let</span> <span class="n">w</span> <span class="o">=</span> <span class="n">g</span> <span class="n">t</span> <span class="k">in</span>
   <span class="o">...</span>

<span class="hll"> <span class="k">module</span> <span class="nc">Internal_for_tests</span> <span class="o">=</span> <span class="k">struct</span>
</span><span class="hll">   <span class="k">type</span> <span class="n">t_raw</span> <span class="o">=</span> <span class="n">t</span> <span class="o">=</span> <span class="o">{</span><span class="n">bar</span> <span class="o">:</span> <span class="kt">string</span><span class="o">;</span> <span class="n">baz</span> <span class="o">:</span> <span class="kt">int</span><span class="o">}</span>
</span><span class="hll">
</span><span class="hll">   <span class="k">let</span> <span class="n">unwrap</span> <span class="n">t</span> <span class="o">=</span> <span class="n">t</span>
</span><span class="hll">
</span><span class="hll">   <span class="k">let</span> <span class="n">g</span> <span class="o">=</span> <span class="n">g</span>
</span><span class="hll">
</span><span class="hll">   <span class="k">module</span> <span class="nc">Mycache</span> <span class="o">=</span> <span class="nc">Mycache</span>
</span><span class="hll"> <span class="k">end</span>
</span></pre></div>
</div>
</section>
<section id="exceptions-and-errors">
<h3>Exceptions and errors<a class="headerlink" href="#exceptions-and-errors" title="Link to this heading">#</a></h3>
<p>The following pieces of advice should be applied in general, although exceptions apply (pun intended).</p>
<ul class="simple">
<li><p>Only use exceptions locally and donâ€™t let them escape: raise them and catch them within the same function or the same module.</p>
<ul>
<li><p>If a function that is exported can fail, return a <code class="docutils literal notranslate"><span class="pre">result</span></code> or a <code class="docutils literal notranslate"><span class="pre">tzresult</span></code>.</p></li>
<li><p>If you cannot (or for another reason do not) handle an exception and it may escape you <strong>must</strong> document it.</p></li>
</ul>
</li>
<li><p>Never catch <code class="docutils literal notranslate"><span class="pre">Stack_overflow</span></code> nor <code class="docutils literal notranslate"><span class="pre">Out_of_memory</span></code> which are exceptions from
the OCaml runtime rather than the code itself. In other words, when one of
these exception is raised in one process, the same exception may or may not be
raised in another process executing the same code on other machines. When you
catch this exception, you make a branching in the code that is decided not
based on properties of the code, but properties of the process executing the
code. Consequently, the same branching may differ on two distinct runs of the
same code. This is, in essence, non-determinism.</p>
<ul>
<li><p>If you are in one of the small cases where non-determinism is ok and you
have a compelling reason to catch either <code class="docutils literal notranslate"><span class="pre">Stack_overflow</span></code> or
<code class="docutils literal notranslate"><span class="pre">Out_of_memory</span></code>, you <strong>must</strong> include a comment explaining why.</p></li>
<li><p>Note that catch-all patterns (such as wildcard (<code class="docutils literal notranslate"><span class="pre">|</span> <span class="pre">_</span> <span class="pre">-&gt;</span></code>) and variable
(<code class="docutils literal notranslate"><span class="pre">|</span> <span class="pre">exn</span> <span class="pre">-&gt;</span></code>) include <code class="docutils literal notranslate"><span class="pre">Stack_overflow</span></code> and <code class="docutils literal notranslate"><span class="pre">Out_of_memory</span></code>.</p></li>
</ul>
</li>
<li><p>Do not let low-level, implementation-dependent exceptions and errors bubble up
to high-level code. For example, you should catch <code class="docutils literal notranslate"><span class="pre">Unix_error</span></code> near the
syscall sites (ideally, within the same module) and handle it there. If you
cannot handle it (e.g., if the error is non-recoverable) you should translate
it into an error that is more relevant to the high-level code.</p>
<ul>
<li><p>E.g., If a file-writing call to a library function raises
<code class="docutils literal notranslate"><span class="pre">Unix_error(ENOSPC,</span> <span class="pre">_,</span> <span class="pre">_)</span></code>, the caller of that library function should</p>
<ul>
<li><p>catch the exception,</p></li>
<li><p>attempt to recover (if possible; e.g., by removing other old files before attempting it again),</p></li>
<li><p>and if the recovery does not work (e.g., does not release sufficient
space) or is impossible (e.g., there are no references to old files in
scope) then it should fail in a more meaningful way than by forwarding the
exception (e.g., indicating what operation it was trying to carry).</p></li>
</ul>
</li>
<li><p>In the rare case that the underlying exception/error is satisfactory to the
higher level code, then you may propagate it as is.</p></li>
</ul>
</li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">Lwtreslib</span></code> and the <code class="docutils literal notranslate"><span class="pre">Error_monad</span></code> libraries provide functions that can
help you follow these guidelines. Notably, <code class="docutils literal notranslate"><span class="pre">traces</span></code> allow callers to
contextualise the errors produced by its callees.</p>
</section>
<section id="rpc-security">
<span id="id4"></span><h3>RPC security<a class="headerlink" href="#rpc-security" title="Link to this heading">#</a></h3>
<p>During the development of the codebase a lot of RPC endpoints were created, some
of which are responsible for delicate or computationally intense tasks like
validating blocks or executing Michelson scripts. While some of them are
necessary for the nodeâ€™s users to interact with the blockchain, others are there
to expose API to processes responsible for baking and attesting, for
configuration or debugging purposes or to facilitate development of smart
contracts.</p>
<p>In order to mitigate risks related to exposing these endpoints, Access Control
Lists (ACL for short) were introduced to limit the scope of the API exposed to
public networks (see also <a class="reference internal" href="../user/node-configuration.html#configure-rpc"><span class="std std-ref">RPC parameters</span></a>). While node administrators are
free to configure these ACLs however they like, there is <a class="reference internal" href="../user/node-configuration.html#default-acl"><span class="std std-ref">the default ACL</span></a>, which lists all the endpoints that are <strong>exposed by default</strong>.</p>
<p>When adding a new RPC endpoint, please consider whether or not there is a reason
to call it over a public network. If the answer is yes, you should probably
consider adding the new endpoint to the ACL. If there are also risks related to
calling the endpoint by a potentially malicious user, they should be weighed
when making the decision too. There are no simple answers here. Remember that
all new endpoints are <strong>blocked by default</strong> unless explicitly added to the ACL.</p>
<p>When changing an existing public RPC endpoint it is also important to consider,
how does the change impact possible risks related to calling the endpoint.
Should it be removed from the ACL?</p>
</section>
<section id="rpc-versioning">
<span id="rpc-versioning-dev"></span><h3>RPC Versioning<a class="headerlink" href="#rpc-versioning" title="Link to this heading">#</a></h3>
<p>General information about RPC versioning can be found in
<a class="reference internal" href="../introduction/versioning.html"><span class="doc">Octez &amp; Protocol versioning</span></a>.</p>
<section id="how-to-version-an-rpc">
<h4>How to Version an RPC<a class="headerlink" href="#how-to-version-an-rpc" title="Link to this heading">#</a></h4>
<p>If an RPC already has a query parameter <code class="docutils literal notranslate"><span class="pre">version</span></code>, just add a
variant to the corresponding type <code class="docutils literal notranslate"><span class="pre">t_with_version</span></code> (see
<a class="reference internal" href="#rpc-versioning-dev-adding-an-rpc"><span class="std std-ref">When to Add a New Version to an RPC</span></a>). Otherwise, the <code class="docutils literal notranslate"><span class="pre">version</span></code>
query parameter should be added (a natural number starting from
<code class="docutils literal notranslate"><span class="pre">0</span></code>). See example <a class="reference external" href="https://gitlab.com/tezos/tezos/-/merge_requests/3480">here</a>.</p>
<p>For versioning an RPC which returns a type <code class="docutils literal notranslate"><span class="pre">t</span></code>, you have to write in
the service module of the RPC a type <code class="docutils literal notranslate"><span class="pre">t_with_version</span></code> which has one
constructor by version. The encoding of <code class="docutils literal notranslate"><span class="pre">t_with_version</span></code> is simply
constructed using the <code class="docutils literal notranslate"><span class="pre">Data_encoding.union</span></code> function.</p>
<p>To ensure that the implementation of the RPC (the directory module)
uses the version parameter we recommend that <code class="docutils literal notranslate"><span class="pre">t_with_version</span></code> is
abstract and a dispatcher is written in the service file. This way,
when a new version is added, only the dispatcher function needs to be
updated. In general, the type for this dispatcher will be:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">t_dispatcher</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="o">~</span><span class="n">version</span><span class="o">:</span><span class="kt">int</span> <span class="o">-&gt;</span> <span class="n">t_with_version</span>
</pre></div>
</div>
<p>A similar process can be followed to modify the input of an RPC.
However, in that case, the semantics of <code class="docutils literal notranslate"><span class="pre">union</span></code> makes the parameter
<code class="docutils literal notranslate"><span class="pre">version</span></code> optional (all versions are supported by default). It is
still interesting to version RPCs to allow removing older versions in the
future.</p>
<p>Notice that we use only one version number for both input and output
of an RPC.</p>
</section>
<section id="when-to-add-a-new-version-to-an-rpc">
<span id="rpc-versioning-dev-adding-an-rpc"></span><h4>When to Add a New Version to an RPC<a class="headerlink" href="#when-to-add-a-new-version-to-an-rpc" title="Link to this heading">#</a></h4>
<p>If you modify the input or the output of an RPC, it is not always
necessary to create a new version for the RPC. A new version should be
brought in when a <strong>breaking change</strong> is introduced. Assume that an
RPC returns the following JSON value:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;foo&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;bar&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;baz&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If you introduce a new field <code class="docutils literal notranslate"><span class="pre">foobar</span></code> like this:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;foo&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;bar&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;baz&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;foobar&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">5</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>it should not be considered a breaking change. Indeed, many
decoders which accept the former value also accept the latter.</p>
<p>However, if you remove a field or change the encoding of a field in a
non-extensible way as above, it should be considered a breaking change
like the two examples below.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;foo&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bar&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;bar&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;baz&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;bar&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;baz&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="linting">
<h3>Linting<a class="headerlink" href="#linting" title="Link to this heading">#</a></h3>
<p>The OCaml part of Octez code is analysed by a linter. You can check more details
in <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/scripts/semgrep/README.md">scripts/semgrep/README.md</a>. Below are explanations for the different
rules that may trigger linting errors.</p>
<section id="comparing-the-length-of-two-lists">
<span id="linting-list-lengths-comparison"></span><h4>Comparing the length of two lists<a class="headerlink" href="#comparing-the-length-of-two-lists" title="Link to this heading">#</a></h4>
<p>This rule detects inefficient comparisons between two list lengths and suggests
more efficient specialised functions.</p>
<p>When comparing the lengths of two lists it might be tempting to compute the
lengths and compare them. This seems the most straightforward approach.
Unfortunately, this approach is costly. Specifically,
<code class="docutils literal notranslate"><span class="pre">List.length</span> <span class="pre">xs</span> <span class="pre">&gt;</span> <span class="pre">List.length</span> <span class="pre">ys</span></code> is O(<code class="docutils literal notranslate"><span class="pre">length(xs)``+``length(ys)</span></code>) because
each list is traversed in full.</p>
<p>The OCaml <code class="docutils literal notranslate"><span class="pre">Stdlib.List</span></code> module provides the function
<code class="docutils literal notranslate"><span class="pre">compare_lengths</span> <span class="pre">:</span> <span class="pre">'a</span> <span class="pre">list</span> <span class="pre">-&gt;</span> <span class="pre">'b</span> <span class="pre">list</span> <span class="pre">-&gt;</span> <span class="pre">int</span></code> which traverses both lists at
once, and only as much of it as is necessary to determine which is longer.
Consequently, the cost of
<code class="docutils literal notranslate"><span class="pre">List.compare_lengths</span> <span class="pre">xs</span> <span class="pre">ys</span></code> is O(min(<code class="docutils literal notranslate"><span class="pre">length(xs)</span></code>, <code class="docutils literal notranslate"><span class="pre">length(ys)</span></code>) because
the function stops when it reaches the end of one list.</p>
<p>The value returned by <code class="docutils literal notranslate"><span class="pre">compare_lengths</span></code> is compatible with the semantic of
other comparison functions in the Stdlib. This means that the naive comparison
<code class="docutils literal notranslate"><span class="pre">List.length</span> <span class="pre">xs</span> <span class="pre">&gt;</span> <span class="pre">List.length</span> <span class="pre">ys</span></code> can be rewritten more efficiently as
<code class="docutils literal notranslate"><span class="pre">List.compare_lengths</span> <span class="pre">xs</span> <span class="pre">ys</span> <span class="pre">&gt;</span> <span class="pre">0</span></code> (note the same comparison operator is used).</p>
<p>In Octez, there is also <code class="docutils literal notranslate"><span class="pre">Compare.List_lengths</span></code> which provides infix operators
to compare the lengths of two lists directly. The same example can be rewritten
<code class="docutils literal notranslate"><span class="pre">Compare.List_lengths.(xs</span> <span class="pre">&gt;</span> <span class="pre">ys)</span></code>.</p>
</section>
<section id="comparing-the-length-of-a-list-to-a-constant">
<span id="linting-list-length-comparison"></span><h4>Comparing the length of a list to a constant<a class="headerlink" href="#comparing-the-length-of-a-list-to-a-constant" title="Link to this heading">#</a></h4>
<p>This rule detects inefficient comparisons between a list length and a constant
and suggests more efficient specialised functions.</p>
<p>When comparing the length of a list to a constant it might be tempting to
compute the length and compare it to the constant. This seems the most
straightforward approach. Unfortunately, this approach is costly. Specifically,
<code class="docutils literal notranslate"><span class="pre">List.length</span> <span class="pre">xs</span> <span class="pre">&gt;</span> <span class="pre">k</span></code> is O(<code class="docutils literal notranslate"><span class="pre">length(xs)</span></code>) because the expression traverses the
entirety of <code class="docutils literal notranslate"><span class="pre">xs</span></code>.</p>
<p>The OCaml <code class="docutils literal notranslate"><span class="pre">Stdlib.List</span></code> module provides the function
<code class="docutils literal notranslate"><span class="pre">compare_length_with</span> <span class="pre">:</span> <span class="pre">'a</span> <span class="pre">list</span> <span class="pre">-&gt;</span> <span class="pre">int</span> <span class="pre">-&gt;</span> <span class="pre">int</span></code> which only traverses as much of
the list as is necessary to determine if it is longer than the constant. The
cost of <code class="docutils literal notranslate"><span class="pre">List.compare_length_with</span> <span class="pre">xs</span> <span class="pre">k</span></code> is O(min(<code class="docutils literal notranslate"><span class="pre">length(xs)</span></code>, <code class="docutils literal notranslate"><span class="pre">k</span></code>)
because it stops when it reaches the end of <code class="docutils literal notranslate"><span class="pre">xs</span></code> or after traversing <code class="docutils literal notranslate"><span class="pre">k</span></code>
elements.</p>
<p>The value returned by <code class="docutils literal notranslate"><span class="pre">compare_length_with</span></code> is compatible with the semantic of
other comparison functions in the Stdlib. This means that the expression
<code class="docutils literal notranslate"><span class="pre">List.length</span> <span class="pre">xs</span> <span class="pre">&gt;</span> <span class="pre">k</span></code> can be rewritten more efficiently as
<code class="docutils literal notranslate"><span class="pre">List.compare_length_with</span> <span class="pre">xs</span> <span class="pre">k</span> <span class="pre">&gt;</span> <span class="pre">0</span></code> (note the same comparison operator is
used).</p>
<p>In Octez, there is also <code class="docutils literal notranslate"><span class="pre">Compare.List_length_with</span></code> which provides infix
operators to compare the length of a list to a constant directly. The same
example can be written <code class="docutils literal notranslate"><span class="pre">Compare.List_length_with.(xs</span> <span class="pre">&gt;</span> <span class="pre">k)</span></code>.</p>
</section>
<section id="comparing-the-length-of-a-list-with-zero">
<span id="linting-list-length-empty"></span><h4>Comparing the length of a list with zero<a class="headerlink" href="#comparing-the-length-of-a-list-with-zero" title="Link to this heading">#</a></h4>
<p>A common special case of the former consists in testing if a list is
empty. While <code class="docutils literal notranslate"><span class="pre">List.compare_length_with</span> <span class="pre">xs</span> <span class="pre">0</span> <span class="pre">=</span> <span class="pre">0</span></code> or
<code class="docutils literal notranslate"><span class="pre">Compare.List_length_with.(xs</span> <span class="pre">=</span> <span class="pre">0)</span></code> test this property in constant
time, pattern-matching on <code class="docutils literal notranslate"><span class="pre">xs</span></code> or calling <code class="docutils literal notranslate"><span class="pre">List.is_empty</span> <span class="pre">xs</span></code>
should generally be preferred for readability.</p>
</section>
<section id="folding-over-a-promise-or-a-result">
<span id="linting-folding-over-a-promise"></span><h4>Folding over a promise or a result<a class="headerlink" href="#folding-over-a-promise-or-a-result" title="Link to this heading">#</a></h4>
<p>This rule detects difficult-to-read patterns of code wherein you traverse a
list, with an Lwt promise or a result as accumulator.</p>
<p>When folding over a list (using <code class="docutils literal notranslate"><span class="pre">List.fold_left</span></code> or <code class="docutils literal notranslate"><span class="pre">List.fold_right</span></code>), the
accumulator can be of any type. In particular, it can be an Lwt promise or a
result, and the folding can perform some additional control-flow.</p>
<p>This is valid code accepted by the compiler. But it often produces code which is
difficult to read. For example, when folding over a promise, a small change can
affect whether the traversal sequential (one element at a time) or concurrent
(all elements treated at the same time).</p>
<p>To make the code more readable, you should use the functions provided in the
Octez support libraries. Specifically, the <code class="docutils literal notranslate"><span class="pre">List</span></code> module in Octez includes
Lwt-, Result-, and Lwt-Result-specific variants of all the traversal functions
(<code class="docutils literal notranslate"><span class="pre">map</span></code>, <code class="docutils literal notranslate"><span class="pre">iter</span></code>, <code class="docutils literal notranslate"><span class="pre">for_all</span></code>, <code class="docutils literal notranslate"><span class="pre">exists</span></code>, etc.)</p>
<p>Check the
<a class="reference external" href="../../api/odoc/_html/octez-libs/Tezos_base/TzPervasives/List/index.html">online documentation </a> for a full list of the content of the <code class="docutils literal notranslate"><span class="pre">List</span></code> module.</p>
</section>
<section id="chaining-list-concat-and-list-map">
<span id="chaining-concat-map"></span><h4>Chaining List.concat and List.map<a class="headerlink" href="#chaining-list-concat-and-list-map" title="Link to this heading">#</a></h4>
<p>This rule detects compositions of <code class="docutils literal notranslate"><span class="pre">List.concat</span></code> and <code class="docutils literal notranslate"><span class="pre">List.map</span></code> that are
suboptimal.</p>
<p>The specialised <code class="docutils literal notranslate"><span class="pre">List.concat_map</span></code> function is equivalent to, but more
efficient than, the composition of <code class="docutils literal notranslate"><span class="pre">List.concat</span></code> and <code class="docutils literal notranslate"><span class="pre">List.map</span></code>. The
specialised traversor is even tail-recursive.</p>
<p>Lwtreslib provides additional combinators <code class="docutils literal notranslate"><span class="pre">List.concat_map_s</span></code>,
<code class="docutils literal notranslate"><span class="pre">List.concat_map_e</span></code>, and <code class="docutils literal notranslate"><span class="pre">List.concat_map_es</span></code> to replace the non-vanilla
compositions.</p>
<p>Check the <a class="reference external" href="../../api/odoc/_html/octez-libs/Tezos_lwt_result_stdlib/Lwtreslib/Bare/List/index.html#val-concat_map">online documentation </a>.</p>
</section>
</section>
<section id="naming">
<h3>Naming<a class="headerlink" href="#naming" title="Link to this heading">#</a></h3>
<p>Good names help maintainers quickly understand the code by concisely suggesting what a variable represents or what a function computes.</p>
<p>This implies that good names precisely evoke the denoted value(s), without being longer than necessary:</p>
<ul class="simple">
<li><p><em>precision</em>: avoid using too generic names such as â€œbufferâ€, â€œcounterâ€, or â€œresultâ€; give instead some hint about what is stored, counted, or computed.</p></li>
<li><p><em>concision</em>: as you cannot put everything into a name, select the most important notion(s), and avoid redundant words (abbreviating or not is up to you; itâ€™s just about avoiding names longer than necessary).
For instance, suffixing the name with its type such as â€œâ€¦_listâ€ is not needed since the IDE can tell its type; just using plural is usually enough.
On the contrary, it is useful to add details to the type, such as â€œâ€¦_dirâ€ or â€œâ€¦_titleâ€ for a value of type string.</p></li>
</ul>
<p>Beyond choosing good individual names, it is also important to ensure <em>consistency</em> of naming.
For example, if within a same module, â€œoperationâ€ is used sometimes for Michelson operations and other times for arithmetic operations, this introduces ambiguity, that can be solved by refining the naming scheme.</p>
</section>
<section id="other-coding-conventions">
<h3>Other coding conventions<a class="headerlink" href="#other-coding-conventions" title="Link to this heading">#</a></h3>
<p>Other than the guidelines above, Octez developers should be aware
of general <a class="reference external" href="https://caml.inria.fr/resources/doc/guides/guidelines.en.html">OCaml programming guidelines</a>, which recommend formatting, naming conventions,
and more.</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id5" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">1</a><span class="fn-bracket">]</span></span>
<ol class="upperalpha simple" start="10">
<li><p>Ousterhout, <a class="reference external" href="https://web.stanford.edu/~ouster/cgi-bin/aposd.php">A Philosophy of Software Design</a>, Yaknyam Press, 2021.</p></li>
</ol>
</aside>
</aside>
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="merge_team.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Octez Merge Team</p>
      </div>
    </a>
    <a class="right-next"
       href="repository_scope.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Scope of the Octez repository</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#documentation-guidelines">Documentation guidelines</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comments-within-the-code">Comments within the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-fixme-comments">TODO/FIXME comments</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#license">License</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#documenting-interfaces-and-implementations">Documenting interfaces and implementations</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#using-docstrings">Using docstrings</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#docstrings-errors">Docstrings errors</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#index-mld-files">index.mld files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#readme-files">README files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-documentation-rules">General documentation rules</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#don-t-repeat-the-code">Donâ€™t repeat the code</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comments-maintainability">Comments maintainability</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#logging-vs-comments">Logging vs comments</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comment-first">Comment first</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coding-guidelines">Coding guidelines</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#logging-levels">Logging Levels</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#logging-guidelines">Logging Guidelines</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#make-logs-for-higher-severity-levels-actionable">Make logs for higher severity levels actionable</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#avoid-impacting-performance">Avoid impacting performance</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#make-logs-readable">Make logs readable</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#maintain-consistency-in-debug-logs">Maintain consistency in <code class="docutils literal notranslate"><span class="pre">Debug</span></code> logs</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#privacy-and-security">Privacy and Security</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-formatting">Code formatting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exposing-internals">Exposing internals</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exceptions-and-errors">Exceptions and errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rpc-security">RPC security</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rpc-versioning">RPC Versioning</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-version-an-rpc">How to Version an RPC</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#when-to-add-a-new-version-to-an-rpc">When to Add a New Version to an RPC</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linting">Linting</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-the-length-of-two-lists">Comparing the length of two lists</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-the-length-of-a-list-to-a-constant">Comparing the length of a list to a constant</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-the-length-of-a-list-with-zero">Comparing the length of a list with zero</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#folding-over-a-promise-or-a-result">Folding over a promise or a result</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#chaining-list-concat-and-list-map">Chaining List.concat and List.map</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#naming">Naming</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#other-coding-conventions">Other coding conventions</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Nomadic Labs <contact@nomadic-labs.com>
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2018-2023, Nomadic Labs &lt;contact@nomadic-labs.com&gt;.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>