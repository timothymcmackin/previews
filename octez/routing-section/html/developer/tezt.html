
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tezt: OCaml Tezos Test Framework &#8212; Octez &amp; Protocol products documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=6c3b92c6" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=d3bab30c"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-KT3Z3X4Y82"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-KT3Z3X4Y82');
            </script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-KT3Z3X4Y82');
            </script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'developer/tezt';</script>
    <script src="../_static/js/custom.js?v=e7f469e6"></script>
    <link rel="canonical" href="https://octez.tezos.com/docs/developer/tezt.html" />
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tezt: Long Tests and Performance Regression Test Framework" href="long-tezts.html" />
    <link rel="prev" title="Ppx_expect" href="ppx_expect.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.svg" class="logo__image only-light" alt="Octez & Protocol products documentation - Home"/>
    <script>document.write(`<img src="../_static/logo.svg" class="logo__image only-dark" alt="Octez & Protocol products documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://docs.tezos.com/" title="Up to Tezos docs" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../_static/tezosdocs.png" class="icon-link-image" alt="Up to Tezos docs"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://docs.tezos.com/overview/resources/#documentation-map" title="Documentation map" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../_static/map.png" class="icon-link-image" alt="Documentation map"/></a>
        </li>
</ul></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../introduction/tezos.html">Octez &amp; Protocol overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../introduction/howtoget.html">Installing Octez</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/howtobuild.html">Building Octez from source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/cosign-verify.html">Verifying Octez Docker Images with Cosign</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/get_troubleshooting.html">Installation troubleshooting</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/howtouse.html">Getting started with Octez</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/howtorun.html">Running Octez</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/services.html">Setting up Octez Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/serokell.html">Migrating from Serokell’s to Nomadic Labs’ packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/versioning.html">Octez &amp; Protocol versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/breaking_changes.html">Breaking changes</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Octez User manual</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../user/setup-client.html">Setting up the client</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../user/client-configuration.html">Client Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/key-management.html">Key Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/sandbox.html">Sandboxed mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/mockup.html">Mockup mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/proxy.html">Proxy mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/light.html">Light mode</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../user/setup-node.html">Setting up the node</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../user/node-configuration.html">Node Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/routing.html">Routing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/multinetwork.html">Connecting to a Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/history_modes.html">History modes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/snapshots.html">Snapshots</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../user/node-monitoring.html">Monitoring an Octez Node</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="openmetrics.html">Supported Open Metrics</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../user/teztale.html">Monitoring the consensus protocol</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../user/multisig.html">Built-in multisig contracts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/fa12.html">FA1.2 support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/logging.html">Logging features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/exits.html">Exit codes and signals</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Octez Reference manual</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../shell/the_big_picture.html">Octez Software Architecture</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../shell/shell.html">The Octez Shell</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../shell/validation.html">The validation subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/prevalidation.html">The Prevalidator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/storage.html">The storage layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/sync.html">Synchronisation heuristic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/p2p.html">The peer-to-peer layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/protocol_environment.html">Protocol Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/micheline.html">Micheline</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../shell/baker.html">The Octez Baker</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../shell/dal.html">Data Availability Layer</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../shell/dal_overview.html">DAL overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/dal_node.html">The DAL node</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/dal_run.html">Running a DAL attester node</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/dal_bakers.html">Bakers &amp; the DAL</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../shell/smart_rollup_node.html">Smart rollup node</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="rollup_metrics.html">Supported Open Metrics</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../shell/p2p_api.html">P2P message format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shell/cli-commands.html">Command Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shell/rpc.html">Shell RPCs - Reference</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Protocol Reference Manuals</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../active/index.html">Rio Protocol Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../active/protocol.html">Economic protocol features</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../active/protocol_overview.html">Overview of the economic protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/proof_of_stake.html">Proof-of-stake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/randomness_generation.html">Randomness generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/baking_power.html">Baking Power</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/consensus.html">The consensus algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/voting.html">The Amendment (and Voting) Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/accounts.html">Accounts and addresses</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/michelson.html">Michelson: the language of Smart Contracts in Tezos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/views.html">On-chain Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/timelock.html">Time-lock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/sapling.html">Sapling support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/liquidity_baking.html">Liquidity Baking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/global_constants.html">Global Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/michelson_anti_patterns.html">Michelson Anti-Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/token_management.html">Token transfers and balance updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/mempool.html">Mempool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/smart_rollups.html">Smart Optimistic Rollups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/plugins.html">Protocol Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/event.html">Contract events</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/blocks_ops.html">Blocks and Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/validation.html">Validation and Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/tickets.html">Tickets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/adaptive_issuance.html">Adaptive Issuance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/staking.html">Staking mechanism</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/adaptive_slashing.html">Adaptive Slashing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/dal_support.html">DAL integration</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../active/glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../active/cli-commands.html">Command Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../active/rpc.html">Rio RPCs - Reference</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../seoul/index.html">Seoul Protocol Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../seoul/protocol.html">Economic protocol features</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../seoul/protocol_overview.html">Overview of the economic protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/proof_of_stake.html">Proof-of-stake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/randomness_generation.html">Randomness generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/baking_power.html">Baking Power</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/consensus.html">The consensus algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/voting.html">The Amendment (and Voting) Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/accounts.html">Accounts and addresses</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/native_multisig.html">Native Multisig accounts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/michelson.html">Michelson: the language of Smart Contracts in Tezos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/views.html">On-chain Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/timelock.html">Time-lock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/sapling.html">Sapling support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/liquidity_baking.html">Liquidity Baking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/global_constants.html">Global Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/michelson_anti_patterns.html">Michelson Anti-Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/token_management.html">Token transfers and balance updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/mempool.html">Mempool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/smart_rollups.html">Smart Optimistic Rollups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/plugins.html">Protocol Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/event.html">Contract events</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/blocks_ops.html">Blocks and Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/validation.html">Validation and Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/tickets.html">Tickets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/adaptive_issuance.html">Adaptive Issuance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/staking.html">Staking mechanism</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/adaptive_slashing.html">Adaptive Slashing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/dal_support.html">DAL integration</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../seoul/glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../seoul/cli-commands.html">Command Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../seoul/rpc.html">Seoul RPCs - Reference</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../alpha/index.html">Alpha Dev Protocol Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../alpha/protocol.html">Economic protocol features</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../alpha/protocol_overview.html">Overview of the economic protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/proof_of_stake.html">Proof-of-stake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/randomness_generation.html">Randomness generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/baking_power.html">Baking Power</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/consensus.html">The consensus algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/voting.html">The Amendment (and Voting) Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/accounts.html">Accounts and addresses</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/native_multisig.html">Native Multisig accounts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/michelson.html">Michelson: the language of Smart Contracts in Tezos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/views.html">On-chain Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/timelock.html">Time-lock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/sapling.html">Sapling support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/liquidity_baking.html">Liquidity Baking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/global_constants.html">Global Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/michelson_anti_patterns.html">Michelson Anti-Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/token_management.html">Token transfers and balance updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/mempool.html">Mempool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/smart_rollups.html">Smart Optimistic Rollups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/plugins.html">Protocol Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/event.html">Contract events</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/blocks_ops.html">Blocks and Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/validation.html">Validation and Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/tickets.html">Tickets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/adaptive_issuance.html">Adaptive Issuance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/staking.html">Staking mechanism</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/adaptive_slashing.html">Adaptive Slashing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/dal_support.html">DAL integration</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../alpha/glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../alpha/cli-commands.html">Command Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../alpha/rpc.html">Alpha RPCs - Reference</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tezos developer Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="rpc.html">JSON/RPC interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/errors.html">RPC Errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/openapi.html">RPCs - OpenAPI reference</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Changes in Octez releases</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../releases/releases.html">Release System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases/version-23.html">Version 23.0</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../releases/history.html">Older Versions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-22.html">Version 22.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-21.html">Version 21.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-20.html">Version 20.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-19.html">Version 19.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-18.html">Version 18.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-17.html">Version 17.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-16.html">Version 16.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-15.html">Version 15.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-14.html">Version 14.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-13.html">Version 13.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-12.html">Version 12.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-11.html">Version 11.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-10.html">Version 10.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-9.html">Version 9.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-8.html">Version 8.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-7.html">Version 7.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/january-2020.html">Mainnet January 2020</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/december-2019.html">Mainnet December 2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/october-2019.html">Mainnet-Staging October 2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/september-2019.html">Mainnet September 2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/may-2019.html">Mainnet May 2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/april-2019.html">Mainnet April 2019</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Changes in protocol versions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../protocols/naming.html">Protocol versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../protocols/022_rio.html">Protocol Rio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../protocols/023_seoul.html">Protocol Seoul</a></li>
<li class="toctree-l1"><a class="reference internal" href="../protocols/alpha.html">Protocol Alpha</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../protocols/history.html">Older Protocols</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../protocols/021_quebec.html">Protocol Quebec</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/020_paris.html">Protocol Paris</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/018_oxford.html">Protocol Oxford</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/017_nairobi.html">Protocol Nairobi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/016_mumbai.html">Protocol Mumbai</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/015_lima.html">Protocol Lima</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/014_kathmandu.html">Protocol Kathmandu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/013_jakarta.html">Protocol Jakarta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/012_ithaca.html">Protocol Ithaca</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/011_hangzhou.html">Protocol Hangzhou</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/010_granada.html">Protocol Granada</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/009_florence.html">Protocol Florence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/008_edo.html">Protocol Edo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/007_delphi.html">Protocol Delphi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/006_carthage.html">Protocol Carthage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/005_babylon.html">Protocol Babylon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/004_Pt24m4xi.html">Protocol Athens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/003_PsddFKi3.html">Protocol 003_PsddFKi3</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="contributing_index.html">How to contribute</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="contributing.html">How to contribute to Octez</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="contributing-adding-a-new-opam-dependency.html">How to add or update opam dependencies</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="merge_team.html">Octez Merge Team</a></li>
<li class="toctree-l2"><a class="reference internal" href="guidelines.html">Documentation and coding guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="repository_scope.html">Scope of the Octez repository</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="programming.html">Programming tutorials</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="gadt.html">Generalized Algebraic Data Types (GADTs)</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="error_monad.html">The Error Monad</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="error_monad_p1_result.html">Part 1: <code class="docutils literal notranslate"><span class="pre">result</span></code>, Lwt, and Lwt-<code class="docutils literal notranslate"><span class="pre">result</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="error_monad_p2_tzresult.html">Part 2: <code class="docutils literal notranslate"><span class="pre">tzresult</span></code> and Lwt-<code class="docutils literal notranslate"><span class="pre">tzresult</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="error_monad_p3_advanced.html">Part 3: Advanced topics</a></li>
<li class="toctree-l3"><a class="reference internal" href="error_monad_p4_appendices.html">Part 4: Appendices</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="clic.html">The <code class="docutils literal notranslate"><span class="pre">clic</span></code> library</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_encoding.html">The <code class="docutils literal notranslate"><span class="pre">data_encoding</span></code> library</a></li>
<li class="toctree-l2"><a class="reference internal" href="event_logging_framework.html">Using The Event Logging Framework</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="octez_architecture.html">Octez Architecture Details</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="baker.html">Baker application’s architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="rpc_architecture.html">RPC handling architecture</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="testing_index.html">Testing in Octez</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="testing.html">Overview of Testing in Octez</a></li>
<li class="toctree-l2"><a class="reference internal" href="ppx_expect.html">Ppx_expect</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Tezt: OCaml Tezos Test Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="long-tezts.html">Tezt: Long Tests and Performance Regression Test Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="alcotezt.html">Alcotezt: An Alcotest Compatibility Wrapper for Tezt</a></li>
<li class="toctree-l2"><a class="reference internal" href="unit_testing_legacy_code.html">Making legacy code unit-testable</a></li>
<li class="toctree-l2"><a class="reference internal" href="proposal_testing.html">How to Test a Protocol Proposal</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="maintaining.html">Maintaining</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="entering_alpha.html">How to start reading protocol Alpha</a></li>
<li class="toctree-l2"><a class="reference internal" href="michelson_instructions.html">Adding a new instruction to Michelson language</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="protocol_playbook.html">Protocol Proposals</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="protocol_release_checklist.html">Protocol Release Checklist</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="howto-freeze-protocols.html">How to Freeze Protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="protocol_environment_upgrade.html">Adding a new protocol environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="rpc_howto.html">RPC How-To</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Documenting</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tools.html">Platform Development tools</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="profiling.html">Profiling the Octez node</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="profiler_heap.html">Memory profiling the OCaml heap</a></li>
<li class="toctree-l3"><a class="reference internal" href="profiler_valgrind.html">Memory profiling the C heap</a></li>
<li class="toctree-l3"><a class="reference internal" href="profiler_perf.html">Performance profiling</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="profiler_module.html">The Profiler module</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="ppx_profiler.html">Profiler PPX</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="snoop.html">Benchmarking with Snoop</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="snoop_arch.html">Architecture of <code class="docutils literal notranslate"><span class="pre">octez-snoop</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="snoop_tutorial.html">Snoop usage tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="snoop_example.html">In-depth usage example: more control over your benchmark</a></li>
<li class="toctree-l3"><a class="reference internal" href="tezos_micheline_rewriting.html">Rewriting Micheline with <code class="docutils literal notranslate"><span class="pre">tezos-micheline-rewriting</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="snoop_interpreter.html">Snoop and the Michelson Interpreter</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="time_measurement_ppx.html">Time measurement PPX</a></li>
<li class="toctree-l2"><a class="reference internal" href="python_environment.html">Python Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="pre_commit_hook.html">Pre-Commit Hook</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="encodings.html">Encodings</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="merkle-proof-encoding-formats.html">Merkle Proof Encoding Formats</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="merkle-proof-formats/v1-tree32.html">V1 for Tree32</a></li>
<li class="toctree-l2"><a class="reference internal" href="merkle-proof-formats/v1-tree2.html">V1 for Tree2</a></li>
<li class="toctree-l2"><a class="reference internal" href="merkle-proof-formats/v2-tree32.html">V2 for Tree32</a></li>
<li class="toctree-l2"><a class="reference internal" href="merkle-proof-formats/v2-tree2.html">V2 for Tree2</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../api/api-inline.html">OCaml APIs - Reference</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Grafazos</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../grafazos-doc/index.html">Grafazos: Grafana dashboards for Octez node monitoring.</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-gitlab"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://gitlab.com/tezos/tezos" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-gitlab"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://gitlab.com/tezos/tezos/-/blob/master/docs/developer/tezt.rst" target="_blank"
   class="btn btn-sm btn-source-file-button dropdown-item"
   title="Show source"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">Show source</span>
</a>
</li>
      
      
      
      
      <li><a href="https://gitlab.com/tezos/tezos/-/issues/new?issue[title]=Issue%20on%20page%20%2Fdeveloper/tezt.html&issue[description]=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tezt: OCaml Tezos Test Framework</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-run-tests">How to Run Tests</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-write-new-integration-tests">How to Write New Integration Tests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#detailed-walk-through-the-basic-test">Detailed Walk through the Basic Test</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-write-new-unit-tests">How to Write New Unit Tests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#javascript">JavaScript</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-tests">Regression Tests</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="tezt-ocaml-tezos-test-framework">
<h1>Tezt: OCaml Tezos Test Framework<a class="headerlink" href="#tezt-ocaml-tezos-test-framework" title="Link to this heading">#</a></h1>
<p><a class="reference external" href="https://gitlab.com/nomadic-labs/tezt/">Tezt</a> is a generic test framework written in OCaml.
It focuses on integration tests that launch external processes.
In particular, Tezt can be used to orchestrate tests involving Tezos nodes and clients.</p>
<p>To facilitate the use with Tezos, Tezt has been complemented by a specific library called Tezt-Tezos.</p>
<p>Tezt is pronounced <a class="reference external" href="https://ipa-reader.com/?text=t%C9%9Bzti">/tɛzti/</a>
(think “tezty”, as in <em>Tez</em> are tas*ty*).</p>
<p>The main benefits of using Tezt-Tezos are:</p>
<ul class="simple">
<li><p>tests are written in the same language as Octez itself (OCaml),
which reduces context switch for developers;</p></li>
<li><p>tests do not actively poll the node
as they passively listen to node events instead,
which results in faster and more reliable tests;</p></li>
<li><p>in verbose mode, logs show the interleaved output of all external processes,
while the tests are running;</p></li>
<li><p>it should be easy to use and extend.</p></li>
</ul>
<p>Therefore, Tezt and Tezt-Tezos have been leveraged to build a test suite for Octez. See <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/tezt/README.md">tezt/README.md</a> for details on its implementation.</p>
<p>The rest of this page explains how to run the test suite and how to add new tests.</p>
<section id="how-to-run-tests">
<h2>How to Run Tests<a class="headerlink" href="#how-to-run-tests" title="Link to this heading">#</a></h2>
<p>It is recommended to set up an alias:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>alias tezt=&#39;dune exec tezt/tests/main.exe --&#39;
</pre></div>
</div>
<p>Try it with <code class="docutils literal notranslate"><span class="pre">--help</span></code> to get the list of command-line options as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>tezt --help
</pre></div>
</div>
<p>Just run <code class="docutils literal notranslate"><span class="pre">tezt</span></code> with no options to run all tests.
However, most often you only want to run a subset of the tests.
You can get the list of tests with <code class="docutils literal notranslate"><span class="pre">--list</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>tezt --list
</pre></div>
</div>
<p>For instance, to run only tests from files <code class="docutils literal notranslate"><span class="pre">basic.ml</span></code> and <code class="docutils literal notranslate"><span class="pre">RPC_test.ml</span></code>
that have tag <code class="docutils literal notranslate"><span class="pre">alpha</span></code> but not tag <code class="docutils literal notranslate"><span class="pre">regression</span></code>, with log level “info”, run:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>tezt -f basic.ml -f RPC_test.ml alpha /regression -i
</pre></div>
</div>
<p>You can also run tests in parallel, although in that case it is recommended
to use the default log level to avoid interleaving logs. For instance,
the following command runs tests declared in file <code class="docutils literal notranslate"><span class="pre">encoding.ml</span></code>
with up to 8 tests in parallel:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>tezt -f encoding.ml -j 8
</pre></div>
</div>
</section>
<section id="how-to-write-new-integration-tests">
<h2>How to Write New Integration Tests<a class="headerlink" href="#how-to-write-new-integration-tests" title="Link to this heading">#</a></h2>
<p>The best way to get started is to have a look at existing tests in directory
<code class="docutils literal notranslate"><span class="pre">tezt/tests</span></code> of the Octez repository.</p>
<p>Most integration tests are part of the same executable <code class="docutils literal notranslate"><span class="pre">tezt/tests/main.exe</span></code>.
The source of this module is <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/tezt/tests/main.ml">tezt/tests/main.ml</a>.
This executable runs all tests, but you can restrict the set of tests to run
by specifying tags on the command line, or even the titles of the tests to run
(with the <code class="docutils literal notranslate"><span class="pre">--test</span></code> option).</p>
<p>All tests do not have to be implemented in <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/tezt/tests/main.ml">tezt/tests/main.ml</a> though.
You can of course add more modules and have them be linked into <code class="docutils literal notranslate"><span class="pre">main.exe</span></code> together.
The best way to do this is to write your tests as functions and call them from
the main module.</p>
<p>For instance, let’s create a new basic test in a new file named <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/tezt/tests/basic.ml">tezt/tests/basic.ml</a>:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">check_node_initialization</span> <span class="o">(</span><span class="n">history_mode</span> <span class="o">:</span> <span class="nn">Node</span><span class="p">.</span><span class="n">history_mode</span><span class="o">)</span> <span class="o">:</span>
    <span class="nn">Protocol</span><span class="p">.</span><span class="n">t</span> <span class="kt">list</span> <span class="o">-&gt;</span> <span class="kt">unit</span> <span class="o">=</span>
  <span class="nn">Protocol</span><span class="p">.</span><span class="n">register_test</span>
    <span class="o">~__</span><span class="n">FILE__</span>
    <span class="o">~</span><span class="n">title</span><span class="o">:</span>
      <span class="o">(</span><span class="n">sf</span> <span class="s2">&quot;node initialization (%s mode)&quot;</span> <span class="o">(</span><span class="nn">Node</span><span class="p">.</span><span class="n">show_history_mode</span> <span class="n">history_mode</span><span class="o">))</span>
    <span class="o">~</span><span class="n">tags</span><span class="o">:[</span><span class="s2">&quot;basic&quot;</span><span class="o">;</span> <span class="s2">&quot;node&quot;</span><span class="o">;</span> <span class="nn">Node</span><span class="p">.</span><span class="n">show_history_mode</span> <span class="n">history_mode</span><span class="o">]</span>
  <span class="o">@@</span> <span class="k">fun</span> <span class="n">protocol</span> <span class="o">-&gt;</span>
  <span class="k">let</span> <span class="n">metrics_addr</span> <span class="o">=</span> <span class="nn">Constant</span><span class="p">.</span><span class="n">default_host</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">metrics_port</span> <span class="o">=</span> <span class="nn">Port</span><span class="p">.</span><span class="n">fresh</span> <span class="bp">()</span> <span class="k">in</span>
  <span class="k">let</span><span class="o">*</span> <span class="n">node</span> <span class="o">=</span>
    <span class="nn">Node</span><span class="p">.</span><span class="n">init</span> <span class="o">[</span><span class="nc">History_mode</span> <span class="n">history_mode</span><span class="o">]</span> <span class="o">~</span><span class="n">metrics_addr</span> <span class="o">~</span><span class="n">metrics_port</span>
  <span class="k">in</span>
  <span class="k">let</span><span class="o">*</span> <span class="n">client</span> <span class="o">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">init</span> <span class="o">~</span><span class="n">endpoint</span><span class="o">:(</span><span class="nc">Node</span> <span class="n">node</span><span class="o">)</span> <span class="bp">()</span> <span class="k">in</span>
  <span class="k">let</span><span class="o">*</span> <span class="bp">()</span> <span class="o">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">activate_protocol</span> <span class="o">~</span><span class="n">protocol</span> <span class="n">client</span> <span class="k">in</span>
  <span class="nn">Log</span><span class="p">.</span><span class="n">info</span> <span class="s2">&quot;Activated protocol.&quot;</span> <span class="o">;</span>
  <span class="k">let</span><span class="o">*</span> <span class="bp">()</span> <span class="o">=</span> <span class="n">repeat</span> <span class="mi">10</span> <span class="o">(</span><span class="k">fun</span> <span class="bp">()</span> <span class="o">-&gt;</span> <span class="nn">Client</span><span class="p">.</span><span class="n">bake_for_and_wait</span> <span class="n">client</span><span class="o">)</span> <span class="k">in</span>
  <span class="nn">Log</span><span class="p">.</span><span class="n">info</span> <span class="s2">&quot;Baked 10 blocks.&quot;</span> <span class="o">;</span>
  <span class="k">let</span><span class="o">*</span> <span class="n">level</span> <span class="o">=</span> <span class="nn">Node</span><span class="p">.</span><span class="n">wait_for_level</span> <span class="n">node</span> <span class="mi">11</span> <span class="k">in</span>
  <span class="nn">Log</span><span class="p">.</span><span class="n">info</span> <span class="s2">&quot;Level is now %d.&quot;</span> <span class="n">level</span> <span class="o">;</span>
  <span class="k">let</span><span class="o">*</span> <span class="n">identity</span> <span class="o">=</span> <span class="nn">Node</span><span class="p">.</span><span class="n">wait_for_identity</span> <span class="n">node</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">identity</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="k">then</span> <span class="nn">Test</span><span class="p">.</span><span class="n">fail</span> <span class="s2">&quot;identity is empty&quot;</span> <span class="o">;</span>
  <span class="nn">Log</span><span class="p">.</span><span class="n">info</span> <span class="s2">&quot;Identity is not empty.&quot;</span> <span class="o">;</span>
  <span class="k">let</span> <span class="n">addr</span> <span class="o">=</span> <span class="nn">Format</span><span class="p">.</span><span class="n">sprintf</span> <span class="s2">&quot;http://%s:%d/metrics&quot;</span> <span class="n">metrics_addr</span> <span class="n">metrics_port</span> <span class="k">in</span>
  <span class="k">let</span><span class="o">*</span> <span class="n">metrics</span> <span class="o">=</span>
    <span class="nn">Process</span><span class="p">.</span><span class="n">spawn</span> <span class="o">~</span><span class="n">log_output</span><span class="o">:</span><span class="bp">false</span> <span class="s2">&quot;curl&quot;</span> <span class="o">[</span><span class="s2">&quot;-s&quot;</span><span class="o">;</span> <span class="n">addr</span><span class="o">]</span>
    <span class="o">|&gt;</span> <span class="nn">Process</span><span class="p">.</span><span class="n">check_and_read_stdout</span>
  <span class="k">in</span>
  <span class="k">if</span> <span class="n">metrics</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="k">then</span> <span class="nn">Test</span><span class="p">.</span><span class="n">fail</span> <span class="s2">&quot;Unable to read metrics&quot;</span> <span class="k">else</span> <span class="n">return</span> <span class="bp">()</span>

<span class="c">(* This test checks that tests with tag [ci_disabled] do not run in the CI.</span>
<span class="c">   It happened once when [Test.run] was accidentally called twice.</span>
<span class="c">   To make sure that the test is selected by Manifezt often enough,</span>
<span class="c">   it is tagged with some [~uses] that are often selected. *)</span>
<span class="k">let</span> <span class="bp">()</span> <span class="o">=</span>
  <span class="nn">Test</span><span class="p">.</span><span class="n">register</span>
    <span class="o">~__</span><span class="n">FILE__</span>
    <span class="o">~</span><span class="n">title</span><span class="o">:</span><span class="s2">&quot;meta: failing test with tag ci_disabled&quot;</span>
    <span class="o">~</span><span class="n">tags</span><span class="o">:[</span><span class="nn">Tag</span><span class="p">.</span><span class="n">ci_disabled</span><span class="o">]</span>
    <span class="o">~</span><span class="n">uses</span><span class="o">:</span>
      <span class="o">[</span>
        <span class="nn">Constant</span><span class="p">.</span><span class="n">octez_node</span><span class="o">;</span>
        <span class="nn">Constant</span><span class="p">.</span><span class="n">octez_client</span><span class="o">;</span>
        <span class="nn">Constant</span><span class="p">.</span><span class="n">octez_dal_node</span><span class="o">;</span>
        <span class="nn">Constant</span><span class="p">.</span><span class="n">octez_dac_node</span><span class="o">;</span>
        <span class="nn">Constant</span><span class="p">.</span><span class="n">octez_smart_rollup_node</span><span class="o">;</span>
        <span class="nn">Constant</span><span class="p">.</span><span class="n">octez_evm_node</span><span class="o">;</span>
        <span class="nn">Constant</span><span class="p">.</span><span class="nn">WASM</span><span class="p">.</span><span class="n">evm_kernel</span><span class="o">;</span>
      <span class="o">]</span>
  <span class="o">@@</span> <span class="k">fun</span> <span class="bp">()</span> <span class="o">-&gt;</span>
  <span class="nn">Test</span><span class="p">.</span><span class="n">fail</span>
    <span class="s2">&quot;This test is not supposed to be run because it has tag ci_disabled. If it \</span>
<span class="s2">     does run (in the CI), it means that the tag ci_disabled is not working \</span>
<span class="s2">     properly anymore.&quot;</span>

<span class="k">let</span> <span class="n">register</span> <span class="o">~</span><span class="n">protocols</span> <span class="o">=</span>
  <span class="n">check_node_initialization</span> <span class="nc">Archive</span> <span class="n">protocols</span> <span class="o">;</span>
  <span class="n">check_node_initialization</span> <span class="o">(</span><span class="nc">Full</span> <span class="nc">None</span><span class="o">)</span> <span class="n">protocols</span> <span class="o">;</span>
  <span class="n">check_node_initialization</span> <span class="o">(</span><span class="nc">Rolling</span> <span class="nc">None</span><span class="o">)</span> <span class="n">protocols</span>
</pre></div>
</div>
<p>Then, let’s launch the test from <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/tezt/tests/main.ml">tezt/tests/main.ml</a> by calling:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="nn">Basic</span><span class="p">.</span><span class="n">register</span> <span class="o">~</span><span class="n">protocols</span><span class="o">:[</span><span class="nc">Alpha</span><span class="o">]</span> <span class="o">;</span>
<span class="nn">Test</span><span class="p">.</span><span class="n">run</span> <span class="bp">()</span> <span class="c">(* This call should already be there. *)</span>
</pre></div>
</div>
<p>Finally, let’s try it with:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>dune exec tezt/tests/main.exe -- basic --info
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">--info</span></code> flag allows you to see the <code class="docutils literal notranslate"><span class="pre">Log.info</span></code> messages. It is the same as <code class="docutils literal notranslate"><span class="pre">-i</span></code>.
Here is what you should see:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ dune exec tezt/tests/main.exe -- basic --info
[13:45:36.666] Starting test: Alpha: node initialization (archive mode)
[13:45:37.525] Activated protocol.
[13:45:38.215] Baked 10 blocks.
[13:45:38.215] Level is now 11.
[13:45:38.215] Identity is not empty.
[13:45:38.231] [SUCCESS] (1/3) Alpha: node initialization (archive mode)
[13:45:38.231] Starting test: Alpha: node initialization (full mode)
[13:45:39.113] Activated protocol.
[13:45:39.813] Baked 10 blocks.
[13:45:39.813] Level is now 11.
[13:45:39.813] Identity is not empty.
[13:45:39.828] [SUCCESS] (2/3) Alpha: node initialization (full mode)
[13:45:39.828] Starting test: Alpha: node initialization (rolling mode)
[13:45:40.708] Activated protocol.
[13:45:41.407] Baked 10 blocks.
[13:45:41.407] Level is now 11.
[13:45:41.407] Identity is not empty.
[13:45:41.422] [SUCCESS] (3/3) Alpha: node initialization (rolling mode)
</pre></div>
</div>
<section id="detailed-walk-through-the-basic-test">
<h3>Detailed Walk through the Basic Test<a class="headerlink" href="#detailed-walk-through-the-basic-test" title="Link to this heading">#</a></h3>
<p>Let’s review what our basic test in the previous section does.</p>
<ul class="simple">
<li><p>First, note that the Tezt library and its Base module are opened automatically by Dune
based on its configuration file.
The Base module contains useful functions such as <code class="docutils literal notranslate"><span class="pre">let*</span></code> (which is <code class="docutils literal notranslate"><span class="pre">Lwt.bind</span></code>)
or <code class="docutils literal notranslate"><span class="pre">sf</span></code> (a short-hand for <code class="docutils literal notranslate"><span class="pre">Printf.sprintf</span></code>).</p></li>
<li><p>Then, we define a function <code class="docutils literal notranslate"><span class="pre">check_node_initialization</span></code> which registers one test.
It is parameterized by the history mode. <code class="docutils literal notranslate"><span class="pre">Protocol.register_test</span></code> is partially
applied here; <code class="docutils literal notranslate"><span class="pre">check_node_initialization</span></code> is also implicitly parameterized by the
list of protocols to run the test on.</p></li>
<li><p>The function <code class="docutils literal notranslate"><span class="pre">Protocol.register_test</span></code> registers a test.
It is a wrapper over <code class="docutils literal notranslate"><span class="pre">Test.register</span></code>.
This wrapper is preferred when the test is parameterized by a list of protocols.
The <code class="docutils literal notranslate"><span class="pre">~__FILE__</span></code> argument gives the source filename so that one can select this
file with the <code class="docutils literal notranslate"><span class="pre">--file</span></code> argument, to only run tests declared in this file.
Each test has a title which is used in logs and on the command-line with the <code class="docutils literal notranslate"><span class="pre">--test</span></code>
option (which allows to run a particular test from its title).
Each test also has a list of tags.
We gave our test the tag <code class="docutils literal notranslate"><span class="pre">basic</span></code> in particular.
No other test has this tag, so it is easy to run all of the tests of our new <code class="docutils literal notranslate"><span class="pre">Basic</span></code>
module, and only them, by adding <code class="docutils literal notranslate"><span class="pre">basic</span></code> on the command-line.</p></li>
<li><p>The function <code class="docutils literal notranslate"><span class="pre">Protocol.register_test</span></code> takes a function as an argument.
This function contains the implementation of the test.</p></li>
<li><p>First, we initialize a node with <code class="docutils literal notranslate"><span class="pre">Node.init</span></code>.
This creates a node and runs the node command <code class="docutils literal notranslate"><span class="pre">identity</span> <span class="pre">generate</span></code>,
then <code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">init</span></code> and finally <code class="docutils literal notranslate"><span class="pre">run</span></code>.
It then waits until the node is ready, and returns the node.
Note that you do not have to call <code class="docutils literal notranslate"><span class="pre">Node.init</span></code>.
For instance, if you want to test the behavior of the node without an identity,
you can call <code class="docutils literal notranslate"><span class="pre">Node.create</span></code>, followed by <code class="docutils literal notranslate"><span class="pre">Node.config_init</span></code> and <code class="docutils literal notranslate"><span class="pre">Node.run</span></code>.</p></li>
<li><p>Then, we initialize a client with <code class="docutils literal notranslate"><span class="pre">Client.init</span></code>.
We give it a node, which is the node that the client will connect to by default.
Note that we can still use this client to perform operations on other nodes
if we want to, it’s just convenient to specify it once and for all.</p></li>
<li><p>Then, we activate the protocol with the <code class="docutils literal notranslate"><span class="pre">activate</span> <span class="pre">protocol</span></code> command of the client.
By default, this activates the protocol given as argument,
with some default parameters and using the default activator key
(defined in the <code class="docutils literal notranslate"><span class="pre">Constant</span></code> module).
This activator key was added to the client by <code class="docutils literal notranslate"><span class="pre">Client.init</span></code>.
You can override all of this.
For instance, if you don’t want the client to know the default activator key,
use <code class="docutils literal notranslate"><span class="pre">Client.create</span></code> instead of <code class="docutils literal notranslate"><span class="pre">Client.init</span></code>
(you can use <code class="docutils literal notranslate"><span class="pre">Client.import_secret_key</span></code> to import another activator key, for instance).
Or, if you want to change the fitness or the parameter file,
you can use the <code class="docutils literal notranslate"><span class="pre">?fitness</span></code> and <code class="docutils literal notranslate"><span class="pre">?parameter_file</span></code> optional
arguments of <code class="docutils literal notranslate"><span class="pre">Client.activate_protocol</span></code>.</p></li>
<li><p>Then, we log a message using <code class="docutils literal notranslate"><span class="pre">Log.info</span></code>.
This message is not visible with the default verbosity, but you can
see it by running <code class="docutils literal notranslate"><span class="pre">main.exe</span></code> with the <code class="docutils literal notranslate"><span class="pre">--info</span></code> option (or <code class="docutils literal notranslate"><span class="pre">--verbose</span></code>).</p></li>
<li><p>Then, we repeat <code class="docutils literal notranslate"><span class="pre">Client.bake_for</span></code> 10 times, to bake 10 blocks.</p></li>
<li><p>Then, we wait for the level of the node to be at least 11 (the activation block
plus the 10 blocks that we baked) using <code class="docutils literal notranslate"><span class="pre">Node.wait_for_level</span></code>. If you call this
function and the level is already 11 or greater, <code class="docutils literal notranslate"><span class="pre">Node.wait_for_level</span></code> returns
immediately. (Note: <code class="docutils literal notranslate"><span class="pre">Node.wait_for_level</span></code> makes the test fail if the node stops before
reaching level 11.)</p></li>
<li><p>Finally, we read the identity of the node using <code class="docutils literal notranslate"><span class="pre">Node.wait_for_identity</span></code> which
returns as soon as the node reads the identity file. In fact, this was probably
done much sooner, but Tezt stores the identity in case you try to query it
later, just like the level. (Note: <code class="docutils literal notranslate"><span class="pre">Node.wait_for_identity</span></code> makes the test fail
if the node stops before reading the identity file.)</p></li>
<li><p>We check that the identity is not empty, and if it is we call <code class="docutils literal notranslate"><span class="pre">Test.fail</span></code>.
This causes the test to terminate immediately with an error.
Note that it is not the only cause of failure for this test:
we already saw that <code class="docutils literal notranslate"><span class="pre">Node.wait_for_level</span></code> and <code class="docutils literal notranslate"><span class="pre">Node.wait_for_identity</span></code> can
cause a test failure, and if anything goes wrong (failing to initialize the
node or the client, failing to activate the protocol…) <code class="docutils literal notranslate"><span class="pre">Test.fail</span></code> is called
automatically as well.</p></li>
<li><p>After the test succeeds or fails, <code class="docutils literal notranslate"><span class="pre">Test.run</span></code> cleans up everything.
It terminates all running processes by sending <code class="docutils literal notranslate"><span class="pre">SIGTERM</span></code>.
It waits for them with <code class="docutils literal notranslate"><span class="pre">waitpid</span></code> to avoid zombie processes.
And it removes all temporary files, in particular the data directory of the node
and the base directory of the client.</p></li>
<li><p>We run this test three times, once per history mode: <code class="docutils literal notranslate"><span class="pre">archive</span></code>, <code class="docutils literal notranslate"><span class="pre">full</span></code> and <code class="docutils literal notranslate"><span class="pre">rolling</span></code>.
Note that we added the history mode as a tag to <code class="docutils literal notranslate"><span class="pre">Test.register</span></code>, so if we want
to run only the test for history mode <code class="docutils literal notranslate"><span class="pre">full</span></code>, for instance,
we can simply run <code class="docutils literal notranslate"><span class="pre">dune</span> <span class="pre">exec</span> <span class="pre">tezt/tests/main.exe</span> <span class="pre">--</span> <span class="pre">basic</span> <span class="pre">full</span></code>.
You can see our list of basic tests and their tags
with <code class="docutils literal notranslate"><span class="pre">dune</span> <span class="pre">exec</span> <span class="pre">tezt/tests/main.exe</span> <span class="pre">--</span> <span class="pre">basic</span> <span class="pre">--list</span></code>.</p></li>
</ul>
</section>
</section>
<section id="how-to-write-new-unit-tests">
<h2>How to Write New Unit Tests<a class="headerlink" href="#how-to-write-new-unit-tests" title="Link to this heading">#</a></h2>
<p>For Tezt, the main difference between a unit test and an integration test is
that a unit test does not use the <code class="docutils literal notranslate"><span class="pre">Process</span></code> module. Indeed, an integration
test tests an executable by running it, while a unit test links with a library
to test its functions directly.</p>
<p>Since the scope of unit tests is much smaller, they are usually registered
in executables that are dedicated to the library being tested. For instance,
tests for <code class="docutils literal notranslate"><span class="pre">src/lib_base</span></code> could be put in an executable named
<code class="docutils literal notranslate"><span class="pre">src/lib_base/tezt/main.exe</span></code>. Such executables are usually faster to
compile and run than <code class="docutils literal notranslate"><span class="pre">tezt/tests/main.exe</span></code> since their dependency cone is limited.</p>
<p>To add unit tests to a library which does not yet have a Tezt executable,
create files such as <code class="docutils literal notranslate"><span class="pre">src/lib_base/tezt/example.ml</span></code> and <code class="docutils literal notranslate"><span class="pre">src/lib_base/tezt/other.ml</span></code>
and use <code class="docutils literal notranslate"><span class="pre">Test.register</span></code> to register tests in those files, at toplevel.
Here is a minimal example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>let () =
  Test.register
    ~__FILE__
    ~title:&quot;test title here&quot;
    ~tags:[&quot;test&quot;; &quot;tags&quot;; &quot;here&quot;]
  @@ fun () -&gt;
  (* your test here *)
  unit
</pre></div>
</div>
<p>Then, declare those files in <code class="docutils literal notranslate"><span class="pre">manifest/</span></code>, for instance in <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/manifest/product_octez.ml">manifest/product_octez.ml</a>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>let _octez_base_tezts =
  tezt
    [&quot;example&quot;; &quot;other&quot;]
    ~path:&quot;src/lib_base/tezt&quot;
    ~opam:&quot;tezos-base&quot;
    ~deps:[octez_base]
</pre></div>
</div>
<p>This causes the manifest to generate executable <code class="docutils literal notranslate"><span class="pre">src/lib_base/tezt/main.exe</span></code> for you.
This executable calls <code class="docutils literal notranslate"><span class="pre">Test.run</span></code>. It also declares a Dune alias <code class="docutils literal notranslate"><span class="pre">runtest</span></code>
so that you can run your tests with either of the following commands:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>dune build @src/lib_base/runtest
dune exec src/lib_base/tezt/main.exe
</pre></div>
</div>
<p>Note that your tests will actually also be available in <code class="docutils literal notranslate"><span class="pre">tezt/tests/main.exe</span></code>.
This executable gathers all tests so that the CI can auto-balance them.</p>
<section id="javascript">
<h3>JavaScript<a class="headerlink" href="#javascript" title="Link to this heading">#</a></h3>
<p>If you want to be able to run your test with Node.js, declare them in the manifest
with <code class="docutils literal notranslate"><span class="pre">~js_compatible:true</span></code> and with <code class="docutils literal notranslate"><span class="pre">JS</span></code> in <code class="docutils literal notranslate"><span class="pre">~modes</span></code>. For instance:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>let _octez_base_tezts =
  tezt
    [&quot;example&quot;; &quot;other&quot;]
    ~path:&quot;src/lib_base/tezt&quot;
    ~opam:&quot;tezos-base&quot;
    ~js_compatible:true
    ~modes:[Native; JS]
    ~deps:[octez_base]
</pre></div>
</div>
<p>Running <code class="docutils literal notranslate"><span class="pre">dune</span> <span class="pre">build</span></code> will generate not only a native executable
(<code class="docutils literal notranslate"><span class="pre">src/lib_base/tezt/main.exe</span></code>) but also a JavaScript file
(<code class="docutils literal notranslate"><span class="pre">src/lib_base/tezt/main_js.bc.js</span></code>) that you can run with Node.js:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nodejs _build/default/src/lib_base/tezt/main_js.bc.js
</pre></div>
</div>
<p>Note however that tests that use <code class="docutils literal notranslate"><span class="pre">Tezt.Process</span></code>, <code class="docutils literal notranslate"><span class="pre">Tezt.Temp</span></code> or <code class="docutils literal notranslate"><span class="pre">Tezt.Runner</span></code>
cannot use the JavaScript backend. In other words, integration tests cannot
be run with Node.js, only unit tests.</p>
</section>
</section>
<section id="regression-tests">
<h2>Regression Tests<a class="headerlink" href="#regression-tests" title="Link to this heading">#</a></h2>
<p>Regression tests are used to prevent unintended changes to existing
functionality by ensuring that the software behaves the same way as it did
before introduced changes.</p>
<p>Regression tests capture commands and output of commands executed during a test.
An output of some regression test is stored in the repository and is expected to
match exactly with the captured output on subsequent runs. An added advantage of
this is that when a change in behaviour is intentional, its effect is made
visible by the change in test’s output.</p>
<p>To run all the regression tests, use the <code class="docutils literal notranslate"><span class="pre">regression</span></code> tag:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>dune exec tezt/tests/main.exe regression
</pre></div>
</div>
<p>When the change in behaviour is intentional or when a new regression test is
introduced, the output of regression test must be (re-)generated. This can be
done with the <code class="docutils literal notranslate"><span class="pre">--reset-regressions</span></code> option, e.g.:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>dune exec tezt/tests/main.exe regression -- --reset-regressions
</pre></div>
</div>
<p>Regression tests are registered with <code class="docutils literal notranslate"><span class="pre">Regression.register</span></code> instead of
<code class="docutils literal notranslate"><span class="pre">Test.register</span></code>. Use <code class="docutils literal notranslate"><span class="pre">Regression.capture</span></code> or <code class="docutils literal notranslate"><span class="pre">Regression.hooks</span></code> to
capture output that you want to be stable. Regression tests can be used
both in unit tests and integration tests.</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="ppx_expect.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Ppx_expect</p>
      </div>
    </a>
    <a class="right-next"
       href="long-tezts.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Tezt: Long Tests and Performance Regression Test Framework</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-run-tests">How to Run Tests</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-write-new-integration-tests">How to Write New Integration Tests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#detailed-walk-through-the-basic-test">Detailed Walk through the Basic Test</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-write-new-unit-tests">How to Write New Unit Tests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#javascript">JavaScript</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-tests">Regression Tests</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Contributors to the Octez & Tezos protocol documentation
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2018-2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>