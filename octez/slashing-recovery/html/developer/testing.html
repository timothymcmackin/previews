
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Overview of Testing in Octez &#8212; Octez &amp; Protocol products documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=6c3b92c6" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=9e990f31"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-KT3Z3X4Y82"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-KT3Z3X4Y82');
            </script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-KT3Z3X4Y82');
            </script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'developer/testing';</script>
    <script src="../_static/js/custom.js?v=e7f469e6"></script>
    <link rel="canonical" href="https://octez.tezos.com/docs/developer/testing.html" />
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Ppx_expect" href="ppx_expect.html" />
    <link rel="prev" title="Testing in Octez" href="testing_index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.svg" class="logo__image only-light" alt="Octez & Protocol products documentation - Home"/>
    <script>document.write(`<img src="../_static/logo.svg" class="logo__image only-dark" alt="Octez & Protocol products documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://docs.tezos.com/" title="Up to Tezos docs" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../_static/tezosdocs.png" class="icon-link-image" alt="Up to Tezos docs"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://docs.tezos.com/overview/resources/#documentation-map" title="Documentation map" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../_static/map.png" class="icon-link-image" alt="Documentation map"/></a>
        </li>
</ul></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../introduction/tezos.html">Octez &amp; Protocol overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../introduction/howtoget.html">Installing Octez</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/howtobuild.html">Building Octez from source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/cosign-verify.html">Verifying Octez Docker Images with Cosign</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/get_troubleshooting.html">Installation troubleshooting</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/howtouse.html">Getting started with Octez</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/howtorun.html">Running Octez</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/services.html">Setting up Octez Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/serokell.html">Migrating from Serokell’s to Nomadic Labs’ packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/versioning.html">Octez &amp; Protocol versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/breaking_changes.html">Breaking changes</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Octez User manual</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../user/setup-client.html">Setting up the client</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../user/client-configuration.html">Client Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/key-management.html">Key Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/sandbox.html">Sandboxed mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/mockup.html">Mockup mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/proxy.html">Proxy mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/light.html">Light mode</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../user/setup-node.html">Setting up the node</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../user/node-configuration.html">Node Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/multinetwork.html">Connecting to a Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/history_modes.html">History modes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/snapshots.html">Snapshots</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../user/node-monitoring.html">Monitoring an Octez Node</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="openmetrics.html">Supported Open Metrics</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../user/teztale.html">Monitoring the consensus protocol</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../user/multisig.html">Built-in multisig contracts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/fa12.html">FA1.2 support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/logging.html">Logging features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/exits.html">Exit codes and signals</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Octez Reference manual</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../shell/the_big_picture.html">Octez Software Architecture</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../shell/shell.html">The Octez Shell</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../shell/validation.html">The validation subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/prevalidation.html">The Prevalidator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/storage.html">The storage layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/sync.html">Synchronisation heuristic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/p2p.html">The peer-to-peer layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/protocol_environment.html">Protocol Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/micheline.html">Micheline</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../shell/baker.html">The Octez Baker</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../shell/dal.html">Data Availability Layer</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../shell/dal_overview.html">DAL overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/dal_node.html">The DAL node</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/dal_run.html">Running a DAL attester node</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/dal_bakers.html">Bakers &amp; the DAL</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../shell/smart_rollup_node.html">Smart rollup node</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="rollup_metrics.html">Supported Open Metrics</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../shell/cli-commands.html">Command Line Interface</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Protocol Reference Manuals</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../active/index.html">Rio Protocol Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../active/protocol.html">Economic protocol features</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../active/protocol_overview.html">Overview of the economic protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/proof_of_stake.html">Proof-of-stake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/randomness_generation.html">Randomness generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/baking_power.html">Baking Power</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/consensus.html">The consensus algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/voting.html">The Amendment (and Voting) Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/accounts.html">Accounts and addresses</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/michelson.html">Michelson: the language of Smart Contracts in Tezos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/views.html">On-chain Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/timelock.html">Time-lock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/sapling.html">Sapling support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/liquidity_baking.html">Liquidity Baking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/global_constants.html">Global Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/michelson_anti_patterns.html">Michelson Anti-Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/token_management.html">Token transfers and balance updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/mempool.html">Mempool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/smart_rollups.html">Smart Optimistic Rollups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/plugins.html">Protocol Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/event.html">Contract events</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/blocks_ops.html">Blocks and Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/validation.html">Validation and Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/tickets.html">Tickets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/adaptive_issuance.html">Adaptive Issuance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/staking.html">Staking mechanism</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/adaptive_slashing.html">Adaptive Slashing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../active/dal_support.html">DAL integration</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../active/glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../active/cli-commands.html">Command Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../active/rpc.html">Rio RPCs - Reference</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../seoul/index.html">Seoul Protocol Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../seoul/protocol.html">Economic protocol features</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../seoul/protocol_overview.html">Overview of the economic protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/proof_of_stake.html">Proof-of-stake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/randomness_generation.html">Randomness generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/baking_power.html">Baking Power</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/consensus.html">The consensus algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/voting.html">The Amendment (and Voting) Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/accounts.html">Accounts and addresses</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/native_multisig.html">Native Multisig accounts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/michelson.html">Michelson: the language of Smart Contracts in Tezos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/views.html">On-chain Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/timelock.html">Time-lock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/sapling.html">Sapling support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/liquidity_baking.html">Liquidity Baking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/global_constants.html">Global Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/michelson_anti_patterns.html">Michelson Anti-Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/token_management.html">Token transfers and balance updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/mempool.html">Mempool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/smart_rollups.html">Smart Optimistic Rollups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/plugins.html">Protocol Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/event.html">Contract events</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/blocks_ops.html">Blocks and Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/validation.html">Validation and Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/tickets.html">Tickets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/adaptive_issuance.html">Adaptive Issuance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/staking.html">Staking mechanism</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/adaptive_slashing.html">Adaptive Slashing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seoul/dal_support.html">DAL integration</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../seoul/glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../seoul/cli-commands.html">Command Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../seoul/rpc.html">Seoul RPCs - Reference</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../alpha/index.html">Alpha Dev Protocol Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../alpha/protocol.html">Economic protocol features</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../alpha/protocol_overview.html">Overview of the economic protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/proof_of_stake.html">Proof-of-stake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/randomness_generation.html">Randomness generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/baking_power.html">Baking Power</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/consensus.html">The consensus algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/voting.html">The Amendment (and Voting) Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/accounts.html">Accounts and addresses</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/native_multisig.html">Native Multisig accounts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/michelson.html">Michelson: the language of Smart Contracts in Tezos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/views.html">On-chain Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/timelock.html">Time-lock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/sapling.html">Sapling support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/liquidity_baking.html">Liquidity Baking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/global_constants.html">Global Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/michelson_anti_patterns.html">Michelson Anti-Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/token_management.html">Token transfers and balance updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/mempool.html">Mempool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/smart_rollups.html">Smart Optimistic Rollups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/plugins.html">Protocol Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/event.html">Contract events</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/blocks_ops.html">Blocks and Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/validation.html">Validation and Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/tickets.html">Tickets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/adaptive_issuance.html">Adaptive Issuance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/staking.html">Staking mechanism</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/adaptive_slashing.html">Adaptive Slashing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alpha/dal_support.html">DAL integration</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../alpha/glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../alpha/cli-commands.html">Command Line Interface</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tezos developer Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="rpc.html">JSON/RPC interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/openapi.html">RPCs - OpenAPI reference</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Changes in Octez releases</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../releases/releases.html">Release System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases/version-22.html">Version 22.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases/version-23.html">Version 23.0~rc2</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../releases/history.html">Older Versions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-21.html">Version 21.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-20.html">Version 20.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-19.html">Version 19.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-18.html">Version 18.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-17.html">Version 17.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-16.html">Version 16.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-15.html">Version 15.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-14.html">Version 14.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-13.html">Version 13.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-12.html">Version 12.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-11.html">Version 11.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-10.html">Version 10.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-9.html">Version 9.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-8.html">Version 8.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/version-7.html">Version 7.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/january-2020.html">Mainnet January 2020</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/december-2019.html">Mainnet December 2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/october-2019.html">Mainnet-Staging October 2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/september-2019.html">Mainnet September 2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/may-2019.html">Mainnet May 2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/april-2019.html">Mainnet April 2019</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Changes in protocol versions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../protocols/naming.html">Protocol versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../protocols/022_rio.html">Protocol Rio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../protocols/023_seoul.html">Protocol Seoul</a></li>
<li class="toctree-l1"><a class="reference internal" href="../protocols/alpha.html">Protocol Alpha</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../protocols/history.html">Older Protocols</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../protocols/021_quebec.html">Protocol Quebec</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/020_paris.html">Protocol Paris</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/018_oxford.html">Protocol Oxford</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/017_nairobi.html">Protocol Nairobi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/016_mumbai.html">Protocol Mumbai</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/015_lima.html">Protocol Lima</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/014_kathmandu.html">Protocol Kathmandu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/013_jakarta.html">Protocol Jakarta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/012_ithaca.html">Protocol Ithaca</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/011_hangzhou.html">Protocol Hangzhou</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/010_granada.html">Protocol Granada</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/009_florence.html">Protocol Florence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/008_edo.html">Protocol Edo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/007_delphi.html">Protocol Delphi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/006_carthage.html">Protocol Carthage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/005_babylon.html">Protocol Babylon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/004_Pt24m4xi.html">Protocol Athens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/003_PsddFKi3.html">Protocol 003_PsddFKi3</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="contributing_index.html">How to contribute</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="contributing.html">How to contribute to Octez</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="contributing-adding-a-new-opam-dependency.html">How to add or update opam dependencies</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="merge_team.html">Octez Merge Team</a></li>
<li class="toctree-l2"><a class="reference internal" href="guidelines.html">Documentation and coding guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="repository_scope.html">Scope of the Octez repository</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="programming.html">Programming tutorials</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="gadt.html">Generalized Algebraic Data Types (GADTs)</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="error_monad.html">The Error Monad</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="error_monad_p1_result.html">Part 1: <code class="docutils literal notranslate"><span class="pre">result</span></code>, Lwt, and Lwt-<code class="docutils literal notranslate"><span class="pre">result</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="error_monad_p2_tzresult.html">Part 2: <code class="docutils literal notranslate"><span class="pre">tzresult</span></code> and Lwt-<code class="docutils literal notranslate"><span class="pre">tzresult</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="error_monad_p3_advanced.html">Part 3: Advanced topics</a></li>
<li class="toctree-l3"><a class="reference internal" href="error_monad_p4_appendices.html">Part 4: Appendices</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="clic.html">The <code class="docutils literal notranslate"><span class="pre">clic</span></code> library</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_encoding.html">The <code class="docutils literal notranslate"><span class="pre">data_encoding</span></code> library</a></li>
<li class="toctree-l2"><a class="reference internal" href="event_logging_framework.html">Using The Event Logging Framework</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="octez_architecture.html">Octez Architecture Details</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="baker.html">Baker application’s architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="rpc_architecture.html">RPC handling architecture</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="testing_index.html">Testing in Octez</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Overview of Testing in Octez</a></li>
<li class="toctree-l2"><a class="reference internal" href="ppx_expect.html">Ppx_expect</a></li>
<li class="toctree-l2"><a class="reference internal" href="tezt.html">Tezt: OCaml Tezos Test Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="long-tezts.html">Tezt: Long Tests and Performance Regression Test Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="alcotezt.html">Alcotezt: An Alcotest Compatibility Wrapper for Tezt</a></li>
<li class="toctree-l2"><a class="reference internal" href="unit_testing_legacy_code.html">Making legacy code unit-testable</a></li>
<li class="toctree-l2"><a class="reference internal" href="proposal_testing.html">How to Test a Protocol Proposal</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="maintaining.html">Maintaining</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="entering_alpha.html">How to start reading protocol Alpha</a></li>
<li class="toctree-l2"><a class="reference internal" href="michelson_instructions.html">Adding a new instruction to Michelson language</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="protocol_playbook.html">Protocol Proposals</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="protocol_release_checklist.html">Protocol Release Checklist</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="howto-freeze-protocols.html">How to Freeze Protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="protocol_environment_upgrade.html">Adding a new protocol environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="rpc_howto.html">RPC How-To</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Documenting</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tools.html">Platform Development tools</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="profiling.html">Profiling the Octez node</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="profiler_heap.html">Memory profiling the OCaml heap</a></li>
<li class="toctree-l3"><a class="reference internal" href="profiler_valgrind.html">Memory profiling the C heap</a></li>
<li class="toctree-l3"><a class="reference internal" href="profiler_perf.html">Performance profiling</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="profiler_module.html">The Profiler module</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="ppx_profiler.html">Profiler PPX</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="snoop.html">Benchmarking with Snoop</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="snoop_arch.html">Architecture of <code class="docutils literal notranslate"><span class="pre">octez-snoop</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="snoop_tutorial.html">Snoop usage tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="snoop_example.html">In-depth usage example: more control over your benchmark</a></li>
<li class="toctree-l3"><a class="reference internal" href="tezos_micheline_rewriting.html">Rewriting Micheline with <code class="docutils literal notranslate"><span class="pre">tezos-micheline-rewriting</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="snoop_interpreter.html">Snoop and the Michelson Interpreter</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="time_measurement_ppx.html">Time measurement PPX</a></li>
<li class="toctree-l2"><a class="reference internal" href="python_environment.html">Python Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="pre_commit_hook.html">Pre-Commit Hook</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="encodings.html">Encodings</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="merkle-proof-encoding-formats.html">Merkle Proof Encoding Formats</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="merkle-proof-formats/v1-tree32.html">V1 for Tree32</a></li>
<li class="toctree-l2"><a class="reference internal" href="merkle-proof-formats/v1-tree2.html">V1 for Tree2</a></li>
<li class="toctree-l2"><a class="reference internal" href="merkle-proof-formats/v2-tree32.html">V2 for Tree32</a></li>
<li class="toctree-l2"><a class="reference internal" href="merkle-proof-formats/v2-tree2.html">V2 for Tree2</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../api/api-inline.html">OCaml APIs - Reference</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Grafazos</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../grafazos-doc/index.html">Grafazos: Grafana dashboards for Octez node monitoring.</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-gitlab"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://gitlab.com/tezos/tezos" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-gitlab"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://gitlab.com/tezos/tezos/-/blob/master/docs/developer/testing.rst" target="_blank"
   class="btn btn-sm btn-source-file-button dropdown-item"
   title="Show source"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">Show source</span>
</a>
</li>
      
      
      
      
      <li><a href="https://gitlab.com/tezos/tezos/-/issues/new?issue[title]=Issue%20on%20page%20%2Fdeveloper/testing.html&issue[description]=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Overview of Testing in Octez</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-frameworks">Testing frameworks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ppx-expect">Ppx_expect</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qcheck">QCheck</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tezt">Tezt</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#long-tests-and-performance-regression-test-framework">Long Tests and Performance regression Test Framework</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#alcotezt">Alcotezt</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#alcotest-usage-deprecated">Alcotest (usage deprecated)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#michelson-unit-tests">Michelson unit tests</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#executing-tests-locally">Executing tests locally</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#measuring-test-coverage">Measuring test coverage</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#enabling-instrumentation-for-new-libraries-and-executables">Enabling instrumentation for new libraries and executables</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#truncated-coverage-files">Truncated coverage files</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-reports">Comparing reports</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#executing-tests-through-the-gitlab-ci">Executing tests through the GitLab CI</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-tests-to-the-ci">Adding tests to the CI</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#test-coverage-in-merge-requests">Test coverage in merge requests</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#known-issues">Known issues</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#test-coverage-on-master">Test coverage on master</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conventions">Conventions</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="overview-of-testing-in-octez">
<h1>Overview of Testing in Octez<a class="headerlink" href="#overview-of-testing-in-octez" title="Link to this heading">#</a></h1>
<p>The goal of this document is to give an overview on how testing is done in
Octez, and to help Octez contributors use the test suite and
write tests by pointing them towards the most
appropriate testing framework for their use case. Finally, this guide
explains how tests can be <a class="reference internal" href="#gitlab-test-ci"><span class="std std-ref">run automatically in the Octez CI</span></a> and how to <a class="reference internal" href="#measuring-test-coverage"><span class="std std-ref">measure test coverage</span></a>.</p>
<p>The frameworks used in Octez can be categorized along two axes: the
type of component they test, and the type of testing they perform. We
distinguish the following components:</p>
<ul class="simple">
<li><p>Node</p>
<ul>
<li><p>Protocol</p>
<ul>
<li><p>Michelson interpreter</p></li>
<li><p>Stitching</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Networked nodes</p></li>
<li><p>Client</p></li>
<li><p>Ledger application</p></li>
<li><p>Baker</p></li>
</ul>
<p>Secondly, these components can be tested at different levels of
granularity. Additionally, tests can verify functionality, but also
non-functional properties such as performance (execution time, memory and disk
usage). We distinguish:</p>
<dl class="simple">
<dt>Unit testing</dt><dd><p>Unit testing tests software units, typically functions, in isolation.</p>
</dd>
<dt>Integration testing</dt><dd><p>Integration testing tests compositions of smaller units.</p>
</dd>
<dt>System testing</dt><dd><p>System testing tests the final binaries directly.</p>
</dd>
<dt>Regression testing</dt><dd><p>In general, regression testing aims to detect the re-introduction
of previously identified bugs. It can also refer to a
coarse-grained type of testing where the output of a test execution
is compared to a pre-recorded log of expected output. We here use
“regression testing” to refer to the second meaning.</p>
</dd>
<dt>Property testing / Fuzzing</dt><dd><p>Both property testing and fuzzing test
code with automatically generated inputs. Property testing is
typically used to ensure functional correctness, and gives the user
more control over generated input and the expected output. Fuzzing
is typically used to search for security weaknesses and often guides
input generation with the goal of increasing test coverage.</p>
</dd>
<dt>Performance testing</dt><dd><p>Testing of non-functional aspects such as run-time, memory and disk
usage.</p>
</dd>
<dt>Acceptance testing</dt><dd><p>Testing of the software in real conditions. It is usually slower,
more costly and less amenable to automation than integration or
system testing. It is often the final step in the testing process,
performed before a release. However, in Octez, acceptance testing
is decoupled from releases, and currently consists in manually running
a net of resilience tests on a regular base. These tests use various
testing frameworks.</p>
</dd>
</dl>
<p>By combining the two axes,
we obtain the following matrix. Each cell contains the frameworks
appropriate for the corresponding component and testing type. The frameworks
are linked to a sub-section of this page where the framework is presented
in more detail.</p>
<div class="pst-scrollable-table-container"><table class="table" id="id5">
<caption><span class="caption-text">Testing frameworks and their applications in Octez. EXP: <a class="reference internal" href="#ppx-expect-section"><span class="std std-ref">Ppx_expect</span></a>, AT: <a class="reference internal" href="#alcotezt-section"><span class="std std-ref">Alcotezt</span></a>, QC: <a class="reference internal" href="#property-based-test"><span class="std std-ref">QCheck</span></a>, TZ: <a class="reference internal" href="#tezt-section"><span class="std std-ref">Tezt</span></a>, LTF: <a class="reference internal" href="#long-tezt-section"><span class="std std-ref">Long Tests and Performance regression Test Framework</span></a>, TZT: <a class="reference internal" href="#michelson-unit-tests"><span class="std std-ref">Michelson unit tests</span></a></span><a class="headerlink" href="#id5" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Component</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Property</p></th>
<th class="head"><p>Integration</p></th>
<th class="head"><p>System</p></th>
<th class="head"><p>Regression</p></th>
<th class="head"><p>Performance</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Node</p></td>
<td><p><a class="reference internal" href="#alcotezt-section"><span class="std std-ref">AT</span></a></p></td>
<td><p><a class="reference internal" href="#property-based-test"><span class="std std-ref">QC</span></a></p></td>
<td><p><a class="reference internal" href="#alcotezt-section"><span class="std std-ref">AT</span></a></p></td>
<td><p><a class="reference internal" href="#tezt-section"><span class="std std-ref">TZ</span></a></p></td>
<td></td>
<td><p><a class="reference internal" href="#long-tezt-section"><span class="std std-ref">LTF</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>– Protocol</p></td>
<td><p><a class="reference internal" href="#alcotezt-section"><span class="std std-ref">AT</span></a>, <a class="reference internal" href="#ppx-expect-section"><span class="std std-ref">EXP</span></a></p></td>
<td><p><a class="reference internal" href="#property-based-test"><span class="std std-ref">QC</span></a></p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>– – Michelson interpreter</p></td>
<td><p><a class="reference internal" href="#alcotezt-section"><span class="std std-ref">AT</span></a>, <a class="reference internal" href="#michelson-unit-tests"><span class="std std-ref">TZT</span></a></p></td>
<td></td>
<td></td>
<td><p><a class="reference internal" href="#tezt-section"><span class="std std-ref">TZ</span></a></p></td>
<td><p><a class="reference internal" href="#tezt-section"><span class="std std-ref">TZ</span></a></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Client</p></td>
<td><p><a class="reference internal" href="#ppx-expect-section"><span class="std std-ref">EXP</span></a></p></td>
<td><p><a class="reference internal" href="#property-based-test"><span class="std std-ref">QC</span></a></p></td>
<td></td>
<td><p><a class="reference internal" href="#tezt-section"><span class="std std-ref">TZ</span></a></p></td>
<td></td>
<td><p><a class="reference internal" href="#long-tezt-section"><span class="std std-ref">LTF</span></a></p></td>
</tr>
<tr class="row-even"><td><p>Networked nodes</p></td>
<td><p>–</p></td>
<td></td>
<td><p><a class="reference internal" href="#tezt-section"><span class="std std-ref">TZ</span></a></p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Attester</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Baker</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<section id="testing-frameworks">
<h2>Testing frameworks<a class="headerlink" href="#testing-frameworks" title="Link to this heading">#</a></h2>
<section id="ppx-expect">
<span id="ppx-expect-section"></span><h3>Ppx_expect<a class="headerlink" href="#ppx-expect" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://github.com/janestreet/ppx_expect">Ppx_expect</a> is a
framework for writing tests for OCaml code generating textual output, similar to
<a class="reference external" href="https://bitheap.org/cram/">Cram</a> which is used for testing command line applications.</p>
<dl class="simple">
<dt>Typical use cases:</dt><dd><ul class="simple">
<li><p>Unit tests and integration tests leveraging existing printers instead of checking properties.</p></li>
<li><p>Tests that change on purpose over time. One can easily make tests
pass again with a single dune invocation <code class="docutils literal notranslate"><span class="pre">dune</span> <span class="pre">runtest</span> <span class="pre">--auto-promote</span></code></p></li>
</ul>
</dd>
<dt>Example tests:</dt><dd><ul class="simple">
<li><p>Unit tests for <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/src/lib_micheline">src/lib_micheline</a>, in <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/src/lib_micheline/test/test_parser.ml">src/lib_micheline/test/test_parser.ml</a>. To
execute them locally, run <code class="docutils literal notranslate"><span class="pre">dune</span> <span class="pre">runtest</span> <span class="pre">src/lib_micheline/test</span></code> in
the Octez root.</p></li>
</ul>
</dd>
<dt>References:</dt><dd><ul class="simple">
<li><p><a class="reference internal" href="ppx_expect.html"><span class="doc">Section in Octez Developer Documentation on Ppx_expect</span></a></p></li>
<li><p><a class="reference external" href="https://github.com/janestreet/ppx_expect">Ppx_expect README</a>.</p></li>
<li><p><a class="reference external" href="https://dune.readthedocs.io/en/stable/tests.html#inline-expectation-tests">Dune documentation about inline expectation tests</a>.</p></li>
<li><p><a class="reference external" href="https://github.com/janestreet/ppx_inline_test">Ppx_inline_test README</a>.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="qcheck">
<span id="property-based-test"></span><h3>QCheck<a class="headerlink" href="#qcheck" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://github.com/c-cube/qcheck">QCheck</a> is a library for
property-based testing in OCaml.</p>
<dl class="simple">
<dt>Typical use cases:</dt><dd><ul class="simple">
<li><p>Verifying input-output invariants for functions with
randomized inputs.</p></li>
</ul>
</dd>
<dt>Example test:</dt><dd><ul class="simple">
<li><p>QCheck is used in <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/src/lib_base/test/test_time.ml">src/lib_base/test/test_time.ml</a> to test the <a class="reference external" href="../../api/odoc/_html/octez-libs/Tezos_base/Time/index.html">Tezos_base.Time </a> module. For instance, subtracting and then adding a random amount of seconds to a random time should give back the original time: this tests that <code class="docutils literal notranslate"><span class="pre">add</span></code> and <code class="docutils literal notranslate"><span class="pre">diff</span></code> are consistent (and the inverse of each other). To run this test, you need to run <code class="docutils literal notranslate"><span class="pre">dune</span> <span class="pre">exec</span> <span class="pre">src/lib_base/test/test_time.exe</span></code>.</p></li>
</ul>
</dd>
<dt>References:</dt><dd><ul class="simple">
<li><p><a class="reference external" href="https://github.com/c-cube/qcheck">QCheck README</a></p></li>
<li><p><a class="reference external" href="https://c-cube.github.io/qcheck/">QCheck module documentation</a></p></li>
</ul>
</dd>
</dl>
</section>
<section id="tezt">
<span id="tezt-section"></span><h3>Tezt<a class="headerlink" href="#tezt" title="Link to this heading">#</a></h3>
<p><a class="reference internal" href="tezt.html"><span class="doc">Tezt</span></a> is a system testing framework for Octez. Tezt is capable of regression
testing. Tezt focuses on tests that run in the CI, although it is also
used for some manual tests (see the <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/tezt/manual_tests">tezt/manual_tests</a>
folder). Its main strengths are summarized in its <a class="reference internal" href="tezt.html"><span class="doc">section in the
Tezos Developer Documentation</span></a>. Conceptually Tezt consists of a
generic framework for writing tests interacting with external
processes, and a set of Octez-specific modules for interacting with
the Octez binaries: the client, baker, etc.</p>
<dl class="simple">
<dt>Typical use cases:</dt><dd><ul class="simple">
<li><p>Testing the commands of <code class="docutils literal notranslate"><span class="pre">octez-client</span></code>. This allows to test the
full chain: from client, to node RPC to the implementation of the
economic protocol.</p></li>
<li><p>Test networks of nodes, with daemons.</p></li>
<li><p>Detecting unintended changes in the output of a component, using
regression tests.</p></li>
</ul>
</dd>
<dt>Example tests:</dt><dd><ul class="simple">
<li><p>Testing baking (in <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/tezt/tests/basic.ml">tezt/tests/basic.ml</a>)</p></li>
<li><p>Testing double baking and double attestation scenarios (in
<a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/tezt/tests/double_bake.ml">tezt/tests/double_bake.ml</a>).</p></li>
<li><p>Testing absence of regressions in encodings (in <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/tezt/tests/encoding.ml">tezt/tests/encoding.ml</a>)</p></li>
</ul>
</dd>
<dt>References:</dt><dd><ul class="simple">
<li><p><a class="reference internal" href="tezt.html"><span class="doc">Section in Tezos Developer Documentation on Tezt</span></a></p></li>
<li><p><a class="reference external" href="https://nomadic-labs.gitlab.io/tezt/">General API documentation</a></p></li>
<li><p><a class="reference external" href="../../api/odoc/_html/tezt-tezos/Tezt_tezos/index.html">Octez-specific API documentation </a></p></li>
</ul>
</dd>
</dl>
</section>
<section id="long-tests-and-performance-regression-test-framework">
<span id="long-tezt-section"></span><h3>Long Tests and Performance regression Test Framework<a class="headerlink" href="#long-tests-and-performance-regression-test-framework" title="Link to this heading">#</a></h3>
<p>A library called <code class="docutils literal notranslate"><span class="pre">tezt-performance-regression</span></code>, which is a wrapper around Tezt, is used for tests that are too long to run in the CI and for performance testing. Those
tests are run on dedicated machines and can send data points to an
<a class="reference external" href="https://github.com/influxdata/influxdb">InfluxDB</a> instance to produce
graphs using <a class="reference external" href="https://github.com/grafana/grafana">Grafana</a> and/or
detect performance regressions. See <a class="reference internal" href="long-tezts.html"><span class="doc">Tezt: Long Tests and Performance Regression Test Framework</span></a>.</p>
</section>
<section id="alcotezt">
<span id="alcotezt-section"></span><h3>Alcotezt<a class="headerlink" href="#alcotezt" title="Link to this heading">#</a></h3>
<p>Alcotezt is an <a class="reference internal" href="#alcotest-section"><span class="std std-ref">Alcotest</span></a>-compatible wrapper
for <a class="reference internal" href="#tezt-section"><span class="std std-ref">Tezt</span></a>. With it, unit tests originally written
for Alcotest (now deprecated) can be executed using Tezt instead. We are currently in
the progress of migrating all Alcotests to Tezt, and we are using
Alcotezt as a stop gap towards this goal. For new unit and integration
testing suites, prefer using Tezt directly.</p>
<dl class="simple">
<dt>Typical use cases:</dt><dd><ul class="simple">
<li><p>Conversion of pre-existing Alcotests to Tezt</p></li>
</ul>
</dd>
<dt>Example tests:</dt><dd><ul class="simple">
<li><p>Unit tests for <a class="reference external" href="../../api/odoc/_html/octez-libs/Tezos_clic/index.html">tezos-clic </a>. To execute them locally, run <code class="docutils literal notranslate"><span class="pre">dune</span> <span class="pre">build</span> <span class="pre">&#64;src/lib_clic/runtest</span></code>.</p></li>
<li><p>Unit tests for <a class="reference external" href="../../api/odoc/_html/octez-version/index.html">octez-version</a>. To execute them locally, run <code class="docutils literal notranslate"><span class="pre">dune</span> <span class="pre">build</span> <span class="pre">&#64;src/lib_version/runtest</span></code>.</p></li>
</ul>
</dd>
</dl>
<p>See <a class="reference internal" href="alcotezt.html"><span class="doc">Alcotezt: An Alcotest Compatibility Wrapper for Tezt</span></a> for more information on how to convert tests to
Alcotezt, and how to execute them.</p>
</section>
<section id="alcotest-usage-deprecated">
<span id="alcotest-section"></span><h3>Alcotest (usage deprecated)<a class="headerlink" href="#alcotest-usage-deprecated" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://github.com/mirage/alcotest">Alcotest</a> is a library for unit
and integration testing in OCaml. Alcotest was historically the
primary tool in Octez for unit and integration testing of OCaml code.
However, we are currently migrating to <a class="reference internal" href="tezt.html"><span class="doc">Tezt</span></a> for unit,
integration and system testing. To ease migration from Alcotest to
Tezt, the <a class="reference internal" href="#alcotezt-section"><span class="std std-ref">Alcotezt</span></a> wrapper was introduced.
Alcotezt is briefly described above and in more detail in
<a class="reference internal" href="alcotezt.html"><span class="doc">Alcotezt: An Alcotest Compatibility Wrapper for Tezt</span></a>. The below Alcotest description applies to tests that
have not yet been converted to Alcotezt.</p>
<dl class="simple">
<dt>Typical use cases:</dt><dd><ul class="simple">
<li><p>Verifying simple input-output specifications for functions with a
hard-coded set of input-output pairs.</p></li>
<li><p>OCaml integration tests.</p></li>
</ul>
</dd>
<dt>References:</dt><dd><ul class="simple">
<li><p><a class="reference external" href="https://github.com/mirage/alcotest">Alcotest README</a>.</p></li>
</ul>
</dd>
</dl>
</section>
</section>
<section id="michelson-unit-tests">
<span id="id3"></span><h2>Michelson unit tests<a class="headerlink" href="#michelson-unit-tests" title="Link to this heading">#</a></h2>
<p>The <a class="reference internal" href="../active/michelson.html#michelson-tzt"><span class="std std-ref">TZT syntax extension</span></a> defines a
format for unit tests for Michelson snippets. The
tests written in it are executable:</p>
<ul class="simple">
<li><p>through <code class="docutils literal notranslate"><span class="pre">octez-client</span> <span class="pre">run</span> <span class="pre">unit</span> <span class="pre">test</span></code> for the Michelson interpreter written in OCaml;</p></li>
<li><p>through <code class="docutils literal notranslate"><span class="pre">cargo</span> <span class="pre">run</span> <span class="pre">--bin</span> <span class="pre">tzt_runner</span></code> for the Michelson interpreter written in Rust.</p></li>
</ul>
<p>Example use cases:</p>
<ul class="simple">
<li><p>Verifying the functional (input–output) behavior of snippets of
Michelson instructions.</p></li>
<li><p>Conformance testing for Michelson interpreters.</p></li>
</ul>
<p>A <a class="reference external" href="https://github.com/runtimeverification/michelson-semantics/tree/master/tests/unit">conformance test suite for Michelson interpreters</a> written using the TZT extension is maintained and is used for non-regression testing.</p>
</section>
<section id="executing-tests-locally">
<span id="gitlab-test-ci"></span><h2>Executing tests locally<a class="headerlink" href="#executing-tests-locally" title="Link to this heading">#</a></h2>
<p>Whereas executing the tests through the CI, as described below, is the
standard and most convenient way of running the full test suite, they
can also be executed locally.</p>
<p>All tests can be run with <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">test</span></code> in the project root. However, this
can take some time, and some tests are resource-intensive or require additional
configuration. Alternatively, one can run subsets of tests identified
by a specialized target <code class="docutils literal notranslate"><span class="pre">test-*</span></code>. For instance, <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">test-unit</span></code>
runs the alcotest tests and should be quite fast. See the project
<code class="docutils literal notranslate"><span class="pre">Makefile</span></code> for the full list of testing targets.</p>
<section id="measuring-test-coverage">
<span id="id4"></span><h3>Measuring test coverage<a class="headerlink" href="#measuring-test-coverage" title="Link to this heading">#</a></h3>
<p>We measure <a class="reference external" href="https://en.wikipedia.org/wiki/Code_coverage">test coverage</a>
with <a class="reference external" href="https://github.com/aantron/bisect_ppx/">bisect_ppx</a>. This tool
is used to see which lines in the code source are actually executed when
running one or several tests. Importantly, it tells us which parts of the
code aren’t tested.</p>
<p>We describe here how <code class="docutils literal notranslate"><span class="pre">bisect_ppx</span></code> can be used locally. See below for usage
with CI.</p>
<p>To install <code class="docutils literal notranslate"><span class="pre">bisect_ppx</span></code>, run the following command from the root of the
project directory:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>make build-dev-deps
</pre></div>
</div>
<p>The OCaml code should be instrumented in order to generate coverage data. This
is done by prepending</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>./scripts/with_coverage.sh
</pre></div>
</div>
<p>to build and test commands run from the root of the project directory. For example,</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>./scripts/with_coverage.sh make
./scripts/with_coverage.sh make test-coverage
</pre></div>
</div>
<p>Generate the HTML report from the coverage files using</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>make coverage-report
</pre></div>
</div>
<p>The generated report is available in <code class="docutils literal notranslate"><span class="pre">_coverage_report/index.html</span></code>. It shows
for each file, which lines have been executed at least once, by at least
one of the tests.</p>
<p>Clean up coverage data (output and report) with:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>make coverage-clean
</pre></div>
</div>
<p>The helper <code class="docutils literal notranslate"><span class="pre">./scripts/with_coverage.sh</span></code> can also be used outside make commands (e.g. with <code class="docutils literal notranslate"><span class="pre">dune</span></code>, <code class="docutils literal notranslate"><span class="pre">poetry</span></code>). For example,</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>./scripts/with_coverage.sh dune runtest src/lib_shell/
./scripts/with_coverage.sh dune exec tezt/tests/main.exe -f basic.ml
</pre></div>
</div>
<p>However you launch the tests, the same commands are used to get the report
(e.g. <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">coverage-report</span></code>).</p>
<section id="enabling-instrumentation-for-new-libraries-and-executables">
<h4>Enabling instrumentation for new libraries and executables<a class="headerlink" href="#enabling-instrumentation-for-new-libraries-and-executables" title="Link to this heading">#</a></h4>
<p>To ensure that all libraries and executables are included in the
coverage report, the following field should be added to all <code class="docutils literal notranslate"><span class="pre">library</span></code>
and <code class="docutils literal notranslate"><span class="pre">executable(s)</span></code> stanzas in all <code class="docutils literal notranslate"><span class="pre">dune</span></code> files, e.g.:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(library
  (name ...)
  (instrumentation
    (backend bisect_ppx)))
</pre></div>
</div>
<p>The manifest will add this stanza automatically unless
<code class="docutils literal notranslate"><span class="pre">~bisect_ppx:false</span></code> is specified.</p>
<p>This enables the conditional instrumentation of the compilation unit
through the <code class="docutils literal notranslate"><span class="pre">./scripts/with_coverage.sh</span></code> helper as described above.</p>
<p>Exempted from this rule are the <code class="docutils literal notranslate"><span class="pre">dune</span></code> files that belong to tests,
developer utilities and old protocols. In particular:</p>
<ul class="simple">
<li><p>benchmarks, e.g. <code class="docutils literal notranslate"><span class="pre">src/lib_shell/bench/dune</span></code></p></li>
<li><p>bindings, e.g. <code class="docutils literal notranslate"><span class="pre">src/lib_sapling/bindings/dune</span></code></p></li>
<li><p>test frameworks, e.g. <code class="docutils literal notranslate"><span class="pre">tezt/lib/dune</span></code></p></li>
<li><p>test packages, e.g. <code class="docutils literal notranslate"><span class="pre">src/*/test/dune</span></code></p></li>
<li><p>old protocols, e.g. <code class="docutils literal notranslate"><span class="pre">src/proto_00*/*/*dune</span></code></p></li>
<li><p>helper utilities, e.g.:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">src/openapi/dune</span></code>, (executable name <code class="docutils literal notranslate"><span class="pre">openapi</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src/lib_client_base/gen/dune</span></code> (executable name <code class="docutils literal notranslate"><span class="pre">bip39_generator</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src/lib_protocol_compiler/dune</span></code> (executable name <code class="docutils literal notranslate"><span class="pre">replace</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src/proto_alpha/lib_parameters/dune</span></code> (executable name <code class="docutils literal notranslate"><span class="pre">gen</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src/proto_011_PtHangz2/lib_parameters/dune</span></code> (executable name <code class="docutils literal notranslate"><span class="pre">gen</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src/lib_protocol_environment/ppinclude/dune</span></code> (executable name <code class="docutils literal notranslate"><span class="pre">ppinclude</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src/lib_store/legacy_store/dune</span></code> (executable name <code class="docutils literal notranslate"><span class="pre">legacy_store_builder</span></code>)</p></li>
</ul>
</li>
</ul>
</section>
<section id="truncated-coverage-files">
<h4>Truncated coverage files<a class="headerlink" href="#truncated-coverage-files" title="Link to this heading">#</a></h4>
<p>Occasionally, tests write corrupted coverage data. If you run into the
issue, you will see a message
like:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ make coverage-report
Error: coverage file &#39;_coverage_output/foobar.coverage&#39; is truncated

make: *** [Makefile:105: coverage-report] Error 1
</pre></div>
</div>
<p>or</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ make coverage-report
bisect-ppx-report: internal error, uncaught exception:
                   Bisect_common.Invalid_file(&quot;_coverage_output/foobar.coverage&quot;, &quot;unexpected end of file while reading magic number&quot;)

make: *** [Makefile:112: coverage-report] Error 125
</pre></div>
</div>
<p>Typically, this indicates that a instrumented binary that was launched
by the test was terminated abruptly before it had time to finish
writing coverage data. You can just rerun the test, and most likely, it
won’t produce a corrupted trace on the second run. However, this is
not a long-term solution. Below, we present some hints on how to debug
this issue:</p>
<p>Binaries instrumented with <code class="docutils literal notranslate"><span class="pre">bisect_ppx</span></code> attach an <code class="docutils literal notranslate"><span class="pre">at_exit</span></code>
handler that writes collected coverage data at termination of the
tested process execution.</p>
<p>To ensure that this process is not disrupted, one should follow these
guidelines:</p>
<dl>
<dt>For system test frameworks</dt><dd><p>System test frameworks like <a class="reference internal" href="tezt.html"><span class="doc">Tezt: OCaml Tezos Test Framework</span></a>,
run binaries e.g. <code class="docutils literal notranslate"><span class="pre">octez-client</span></code> and
<code class="docutils literal notranslate"><span class="pre">octez-node</span></code>. Typically, they do so with calls to <code class="docutils literal notranslate"><span class="pre">exec</span></code> so the
resulting process does not inherit the signal handlers from the
parent process (the test framework). When writing tests in these
frameworks, the author must ensure that the processes launched are
instrumented and that they do proper signal handling: they should
catch <code class="docutils literal notranslate"><span class="pre">SIGTERM</span></code> and call exit in their <code class="docutils literal notranslate"><span class="pre">SIGTERM</span></code> handler. This
should already be the case for the binaries in octez.  They should
also ensure that the framework terminates the processes with <code class="docutils literal notranslate"><span class="pre">SIGTERM</span></code>.</p>
</dd>
<dt>For integration test frameworks</dt><dd><p>Some integration test frameworks, such as the <code class="docutils literal notranslate"><span class="pre">lib_p2p</span></code> test
framework, spawn subprocesses through <code class="docutils literal notranslate"><span class="pre">fork</span></code>. These
subprocesses inherit the signal handler of the parent process
(the test framework). Such frameworks should themselves be
instrumented and themselves do proper signal handling as described
above. Bisect provides a convenience for doing so, through the
<code class="docutils literal notranslate"><span class="pre">--sigterm</span></code> flag:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(preprocess (pps bisect_ppx --bisect-sigterm))
</pre></div>
</div>
<p>When enabled, it ensures that the instrumented process writes
coverage data successfully on receiving <code class="docutils literal notranslate"><span class="pre">SIGTERM</span></code>. For an
illustration of how to implement this, and the problem it resolves,
see <a class="reference external" href="https://gitlab.com/tezos/tezos/-/merge_requests/3792">!3792</a>.</p>
</dd>
<dt>General process handling</dt><dd><p>If possible, do not leave processes “hanging” in tests. Instead,
use e.g. <code class="docutils literal notranslate"><span class="pre">wait</span></code> or <code class="docutils literal notranslate"><span class="pre">Lwt.bind</span></code> to ensure that processes get a
chance to terminate before the full test terminates. For an
illustration of how to implement this, and the problem it resolves,
see <a class="reference external" href="https://gitlab.com/tezos/tezos/-/merge_requests/3691">!3691</a>.</p>
</dd>
</dl>
</section>
<section id="comparing-reports">
<h4>Comparing reports<a class="headerlink" href="#comparing-reports" title="Link to this heading">#</a></h4>
<p>At times, it is convenient to compare two coverage reports. This can
be used to ensure that coverage does not regress when e.g. migrating a test
from one framework to another. We provide a <a class="reference external" href="https://github.com/vch9/bisect_ppx/tree/html-compare">fork of bisect_ppx</a> with this
functionality. It adds the command <code class="docutils literal notranslate"><span class="pre">compare-html</span></code> to <code class="docutils literal notranslate"><span class="pre">bisect-ppx-report</span></code>.</p>
<p>Running:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>bisect-ppx-report compare-html -x x.coverage -y y.coverage
</pre></div>
</div>
<p>will create an HTML report comparing the coverage of in <code class="docutils literal notranslate"><span class="pre">x.coverage</span></code>
and <code class="docutils literal notranslate"><span class="pre">y.coverage</span></code>. A limitation of this tool is that it assumes that
only coverage has changed – not the underlying source files.</p>
</section>
</section>
</section>
<section id="executing-tests-through-the-gitlab-ci">
<h2>Executing tests through the GitLab CI<a class="headerlink" href="#executing-tests-through-the-gitlab-ci" title="Link to this heading">#</a></h2>
<p>To execute the tests on a merge request, the <code class="docutils literal notranslate"><span class="pre">trigger</span></code> job needs to be
manually executed. To trigger it, go to the GitLab merge request page. Click
the grey gear in the leftmost circle of the pipeline, then click the <code class="docutils literal notranslate"><span class="pre">Play</span></code>
button. If necessary, Marge-bot will trigger the merge request pipeline before
merging it. For instances, to see the latest runs of the CI, visit <a class="reference external" href="https://gitlab.com/tezos/tezos/-/pipelines?scope=finished">this page</a>. You can click
the status of a pipeline for more details.</p>
<p>The results of the test suite on terminated pipelines is presented on
the details of the merge request page corresponding to the
pipeline’s branch (if any). For more information, see the <a class="reference external" href="https://docs.gitlab.com/ci/testing/unit_test_reports/">GitLab
documentation on Unit test reports</a>.</p>
<p>By default, the <code class="docutils literal notranslate"><span class="pre">test</span></code> of the CI runs the tests as a set of independent jobs
that cluster the tests with a varying grain. This strikes a balance between exploiting GitLab
runner parallelism while limiting the number of jobs per
pipeline. The grain used varies slightly for different types of
tests:</p>
<dl class="simple" id="gitlab-tezt-ci">
<dt>Tezt integration and regression tests</dt><dd><p>By default, Tezt tests are grouped in several batch jobs named <code class="docutils literal notranslate"><span class="pre">tezt</span></code> and
are executed in merge request pipelines. According to the tags attached to them,
the tests can be handled differently. The description of these tags can be
found in <a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/src/lib_test/tag.mli">src/lib_test/tag.mli</a>.</p>
</dd>
<dt>The OCaml package tests (Alcotest &amp; QCheck)</dt><dd><p>The OCaml package tests are regrouped in a set of jobs per protocol package,
in addition to one job regrouping tests for remaining packages.</p>
</dd>
</dl>
<section id="adding-tests-to-the-ci">
<h3>Adding tests to the CI<a class="headerlink" href="#adding-tests-to-the-ci" title="Link to this heading">#</a></h3>
<p>When adding a new test that should be run in the CI (which should be
the case for most automatic tests), you need to make sure that it is
properly configured. The procedure for doing this depends on the type
of test you’ve added:</p>
<dl class="simple">
<dt>Tezt integration and regression tests</dt><dd><p>New Tezt tests will be included automatically in the CI.</p>
</dd>
<dt>The OCaml package tests (Alcotest &amp; QCheck)</dt><dd><p>Any tests located in a folder named <code class="docutils literal notranslate"><span class="pre">src/**/test/</span></code> that are
executed through <code class="docutils literal notranslate"><span class="pre">dune</span> <span class="pre">runtest</span></code> will be picked up automatically by
the CI. No intervention is necessary.</p>
</dd>
<dt>Other</dt><dd><p>For other types of tests, you need to manually modify the
CI configuration. Please refer to the CI configuration’s README
(<a class="reference external" href="https://gitlab.com/tezos/tezos/-/tree/master/ci/README.md">ci/README.md</a>) for more information.</p>
</dd>
</dl>
</section>
<section id="test-coverage-in-merge-requests">
<h3>Test coverage in merge requests<a class="headerlink" href="#test-coverage-in-merge-requests" title="Link to this heading">#</a></h3>
<p>Build and tests are instrumented with <code class="docutils literal notranslate"><span class="pre">bisect_ppx</span></code> in the CI for each merge
request on Octez. To measure test coverage in the CI, it launches the job
<code class="docutils literal notranslate"><span class="pre">unified_job</span></code> in stage <code class="docutils literal notranslate"><span class="pre">test_coverage</span></code> which generates the coverage report.
They are stored as an HTML report that can be downloaded or browsed from the CI page
upon completion of the job (see the Artifacts produced by the MR pipeline in the GitLab UI).</p>
<p>The summary report gives the merge request an overall test coverage percentage
(displayed just next to the MR pipeline in the GitLab UI).</p>
<p>Additionally, using <code class="docutils literal notranslate"><span class="pre">bisect-ppx-report</span> <span class="pre">cobertura</span></code>, we produce and
upload a Cobertura artifact activating the <a class="reference external" href="https://docs.gitlab.com/ci/testing/code_coverage/#coverage-visualization">test coverage
visualization</a>
in GitLab:</p>
<img alt="../_images/testing-coverage-markers.png" src="../_images/testing-coverage-markers.png" />
<section id="known-issues">
<h4>Known issues<a class="headerlink" href="#known-issues" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>After termination of the <code class="docutils literal notranslate"><span class="pre">unified_coverage</span></code> job, test coverage
visualization can take some time to load. Once the coverage report
is processed by GitLab, you will have to refresh the <code class="docutils literal notranslate"><span class="pre">Changes</span></code>
tab of the MR to see the results.</p></li>
<li><p>Instrumenting the code with both <code class="docutils literal notranslate"><span class="pre">ppx_inline_test</span></code> and <code class="docutils literal notranslate"><span class="pre">bisect_ppx</span></code> can produce misplaced locations.
This is caused by a bug in <code class="docutils literal notranslate"><span class="pre">ppx_inline_test</span></code> version <code class="docutils literal notranslate"><span class="pre">0.14.1</span></code> that will be in their next release.</p></li>
<li><p>Occasionally, tests write corrupted coverage data. In this case, the job <code class="docutils literal notranslate"><span class="pre">unified_coverage</span></code> will fail. We’ve done our best to ensure this happens rarely. If it happens, you can either try:</p>
<ul class="simple">
<li><p>Re-running the full pipeline.</p></li>
<li><p>Reading the log of the job <code class="docutils literal notranslate"><span class="pre">unified_coverage</span></code>. It’ll direct
you to the test job that produced the corrupted coverage file.  You can
then retry the test job, and once finished, retry the
<code class="docutils literal notranslate"><span class="pre">unified_coverage</span></code> job.</p></li>
<li><p>Finally, if the problem persists, adding the label
<code class="docutils literal notranslate"><span class="pre">ci--no-coverage</span></code> will disable the <code class="docutils literal notranslate"><span class="pre">unified_coverage</span></code>
job. You can add this as a last resort to merge the MR.</p></li>
</ul>
</li>
</ol>
</section>
</section>
<section id="test-coverage-on-master">
<h3>Test coverage on master<a class="headerlink" href="#test-coverage-on-master" title="Link to this heading">#</a></h3>
<p>In addition to computing test coverage on merge request, we also
associate coverage information to each merge commit on the master
branch. Instead of running the test suite on master, which would be
wasteful, we fetch it from the most recent merge request.</p>
<p>The job <code class="docutils literal notranslate"><span class="pre">unified_coverage</span></code> detects when it runs on <code class="docutils literal notranslate"><span class="pre">master</span></code>. In
this case, it reads the history of the branch to find the latest
pipeline on the most recently merged branch. It then fetches the
coverage result from there, and also retrieves the artifacts which
contains the HTML coverage report.
GitLab also produces a <a class="reference external" href="https://gitlab.com/tezos/tezos/-/graphs/master/charts">graph of the coverage ratio over time</a>.</p>
</section>
</section>
<section id="conventions">
<h2>Conventions<a class="headerlink" href="#conventions" title="Link to this heading">#</a></h2>
<p>Besides implementing tests, it is necessary to comment test files as
much as possible to keep a maintainable project for future
contributors. As part of this effort, we require that contributors
follow this convention:</p>
<ol class="arabic simple">
<li><p>For each unit test module, add a header that explains the overall
goal of the tests in the file (i.e., tested component and nature of
the tests). Such header must follow this template, and be added
after license:</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(** Testing
    -------
    Component:    (component to test, e.g. Shell, Micheline)
    Invocation:   (command to invoke tests)
    Dependencies: (e.g., helper files, optional so this line can be removed)
    Subject:      (brief description of the test goals)
*)
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>For each test in the unit test module, the function name shall
start with <code class="docutils literal notranslate"><span class="pre">test_</span></code> and one must add a small doc comment that
explains what the test actually asserts (2-4 lines are
enough). These lines should appear at the beginning of each test
unit function that is called by e.g. <code class="docutils literal notranslate"><span class="pre">Alcotest_lwt.test_case</span></code>. For
instance,</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(** Transfer to an unactivated account and then activate it. *)
let test_transfer_to_unactivated_then_activate () =
...
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Each file name must be prefixed by <code class="docutils literal notranslate"><span class="pre">test_</span></code> to preserve a uniform
directory structure.</p></li>
<li><p>OCaml comments must be valid <code class="docutils literal notranslate"><span class="pre">ocamldoc</span></code> <a class="reference external" href="https://ocaml.org/manual/ocamldoc.html#s:ocamldoc-comments">special comments</a>.</p></li>
<li><p>If a test takes 2 minutes or more on the CI, it should be tagged as <code class="docutils literal notranslate"><span class="pre">slow</span></code>
(see <a class="reference internal" href="#gitlab-tezt-ci"><span class="std std-ref">Tezt integration and regression tests</span></a>). Note
that tests with tag <code class="docutils literal notranslate"><span class="pre">slow</span></code> do not run automatically in the CI of merge
requests.</p></li>
</ol>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="testing_index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Testing in Octez</p>
      </div>
    </a>
    <a class="right-next"
       href="ppx_expect.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Ppx_expect</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-frameworks">Testing frameworks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ppx-expect">Ppx_expect</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qcheck">QCheck</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tezt">Tezt</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#long-tests-and-performance-regression-test-framework">Long Tests and Performance regression Test Framework</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#alcotezt">Alcotezt</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#alcotest-usage-deprecated">Alcotest (usage deprecated)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#michelson-unit-tests">Michelson unit tests</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#executing-tests-locally">Executing tests locally</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#measuring-test-coverage">Measuring test coverage</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#enabling-instrumentation-for-new-libraries-and-executables">Enabling instrumentation for new libraries and executables</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#truncated-coverage-files">Truncated coverage files</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-reports">Comparing reports</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#executing-tests-through-the-gitlab-ci">Executing tests through the GitLab CI</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-tests-to-the-ci">Adding tests to the CI</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#test-coverage-in-merge-requests">Test coverage in merge requests</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#known-issues">Known issues</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#test-coverage-on-master">Test coverage on master</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conventions">Conventions</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Contributors to the Octez & Tezos protocol documentation
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2018-2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>