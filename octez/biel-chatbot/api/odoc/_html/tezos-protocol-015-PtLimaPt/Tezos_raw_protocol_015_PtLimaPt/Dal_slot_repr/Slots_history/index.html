<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Slots_history (tezos-protocol-015-PtLimaPt.Tezos_raw_protocol_015_PtLimaPt.Dal_slot_repr.Slots_history)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">tezos-protocol-015-PtLimaPt</a> &#x00BB; <a href="../../index.html">Tezos_raw_protocol_015_PtLimaPt</a> &#x00BB; <a href="../index.html">Dal_slot_repr</a> &#x00BB; Slots_history</nav><header class="odoc-preamble"><h1>Module <code><span>Dal_slot_repr.Slots_history</span></code></h1><p>This module provides an abstract data structure (type <a href="../index.html#type-t"><code>t</code></a>) that represents a skip list used to store successive DAL slots confirmed on L1. There is one slot per cell in the skip list. The slots are sorted in increasing order by level, and by slot index, for the slots of the same level.</p><p>This module also defines a bounded history cache (type <code>History_cache.t</code>) that allows to remember recent values of a skip list of type <a href="../index.html#type-t"><code>t</code></a> (indexed by the skip lists' hashes). This structure is meant to be maintained and used by the rollup node to produce refutation proofs involving DAL slot inputs.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div><div class="spec-doc"><p>Abstract representation of a skip list specialized for confirmed slot headers.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-encoding"><a href="#val-encoding" class="anchor"></a><code><span><span class="keyword">val</span> encoding : <span><a href="#type-t">t</a> <a href="../../../Tezos_protocol_environment_015_PtLimaPt/Data_encoding/index.html#type-t">Tezos_protocol_environment_015_PtLimaPt.Data_encoding.t</a></span></span></code></div><div class="spec-doc"><p>Encoding of the datatype.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-genesis"><a href="#val-genesis" class="anchor"></a><code><span><span class="keyword">val</span> genesis : <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>First cell of this skip list.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-History_cache"><a href="#module-History_cache" class="anchor"></a><code><span><span class="keyword">module</span> <a href="History_cache/index.html">History_cache</a></span><span> : <a href="../../Bounded_history_repr/module-type-S/index.html">Bounded_history_repr.S</a></span></code></div><div class="spec-doc"><p>The <code>History_cache.t</code> structure is basically a bounded lookup table of <a href="#type-t"><code>t</code></a> skip lists. (See <a href="../../Bounded_history_repr/module-type-S/index.html"><code>Bounded_history_repr.S</code></a>). In the L1 layer, the capacity (bound) is set to zero (nothing is remembered). By contrast, the rollup node uses a history cache with a (sufficiently) large capacity to participate in all potential refutation games occurring during the challenge period. Indeed, the successive recent skip-lists stored in the cache are needed to produce proofs involving slots' pages.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-add_confirmed_slots"><a href="#val-add_confirmed_slots" class="anchor"></a><code><span><span class="keyword">val</span> add_confirmed_slots : 
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="History_cache/index.html#type-t">History_cache.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../index.html#type-slot">slot</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="#type-t">t</a> * <a href="History_cache/index.html#type-t">History_cache.t</a>)</span>
    <a href="../../../Tezos_protocol_environment_015_PtLimaPt/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_015_PtLimaPt.Error_monad.tzresult</a></span></span></code></div><div class="spec-doc"><p><code>add_confirmed_slots hist cache slots</code> updates the given structure <code>hist</code> with the list of <code>slots</code>. The given <code>cache</code> is also updated to add successive values of <code>cell</code> to it.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-add_confirmed_slots_no_cache"><a href="#val-add_confirmed_slots_no_cache" class="anchor"></a><code><span><span class="keyword">val</span> add_confirmed_slots_no_cache : 
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../index.html#type-slot">slot</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <a href="../../../Tezos_protocol_environment_015_PtLimaPt/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_015_PtLimaPt.Error_monad.tzresult</a></span></span></code></div><div class="spec-doc"><p><code>add_confirmed_slots_no_cache cell slots</code> same as <a href="#val-add_confirmed_slots"><code>add_confirmed_slots</code></a>, but no cache is updated.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-equal"><a href="#val-equal" class="anchor"></a><code><span><span class="keyword">val</span> equal : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>equal a b</code> returns true iff a is equal to b.</p></div></div></div></body></html>
