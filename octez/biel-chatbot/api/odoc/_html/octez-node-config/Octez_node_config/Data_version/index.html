<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Data_version (octez-node-config.Octez_node_config.Data_version)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">octez-node-config</a> &#x00BB; <a href="../index.html">Octez_node_config</a> &#x00BB; Data_version</nav><header class="odoc-preamble"><h1>Module <code><span>Octez_node_config.Data_version</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-Invalid_data_dir"><a href="#extension-decl-Invalid_data_dir" class="anchor"></a><code><span><span class="keyword">type</span> <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-error">Tezos_base.TzPervasives.error</a> += </span></code><ol><li id="extension-Invalid_data_dir" class="def variant extension anchored"><a href="#extension-Invalid_data_dir" class="anchor"></a><code><span>| </span><span><span class="extension">Invalid_data_dir</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="module-Data_version.data_dir" class="def record field anchored"><a href="#module-Data_version.data_dir" class="anchor"></a><code><span>data_dir : string;</span></code></li><li id="module-Data_version.msg" class="def record field anchored"><a href="#module-Data_version.msg" class="anchor"></a><code><span>msg : <span>string option</span>;</span></code></li></ol><code><span>}</span></code></li></ol></div><div class="spec-doc"><p>Errors related to checks related to the data dir.</p></div></div><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-Could_not_read_data_dir_version"><a href="#extension-decl-Could_not_read_data_dir_version" class="anchor"></a><code><span><span class="keyword">type</span> <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-error">Tezos_base.TzPervasives.error</a> += </span></code><ol><li id="extension-Could_not_read_data_dir_version" class="def variant extension anchored"><a href="#extension-Could_not_read_data_dir_version" class="anchor"></a><code><span>| </span><span><span class="extension">Could_not_read_data_dir_version</span> <span class="keyword">of</span> string</span></code></li></ol></div></div><p>Default file names to store the information about the node's network identity, peers and configuration.</p><div class="odoc-spec"><div class="spec value anchored" id="val-default_identity_file_name"><a href="#val-default_identity_file_name" class="anchor"></a><code><span><span class="keyword">val</span> default_identity_file_name : string</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_config_file_name"><a href="#val-default_config_file_name" class="anchor"></a><code><span><span class="keyword">val</span> default_config_file_name : string</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_peers_file_name"><a href="#val-default_peers_file_name" class="anchor"></a><code><span><span class="keyword">val</span> default_peers_file_name : string</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-ensure_mode"><a href="#type-ensure_mode" class="anchor"></a><code><span><span class="keyword">type</span> ensure_mode</span><span> = </span></code><ol><li id="type-ensure_mode.Exists" class="def variant constructor anchored"><a href="#type-ensure_mode.Exists" class="anchor"></a><code><span>| </span><span><span class="constructor">Exists</span></span></code></li><li id="type-ensure_mode.Is_bare" class="def variant constructor anchored"><a href="#type-ensure_mode.Is_bare" class="anchor"></a><code><span>| </span><span><span class="constructor">Is_bare</span></span></code></li><li id="type-ensure_mode.Is_compatible" class="def variant constructor anchored"><a href="#type-ensure_mode.Is_compatible" class="anchor"></a><code><span>| </span><span><span class="constructor">Is_compatible</span></span></code></li></ol></div><div class="spec-doc"><p>Defines the properties that must be satisfied by the call to <code>ensure_data_dir</code>.</p><p>Depending of the given mode, it will:</p><ul><li>Exists: ensures that the directory exists, if not, creates a fresh directory by creating it and writing a version file.</li><li>Is_bare: ensures that, if the directory exists, it contains no other file than:</li><li>the version file;</li><li>the identity file;</li><li>the configuration file;</li><li>the peer list file; Otherwise, creates an fresh directory.</li><li>Is_compatible: similar to <code>Exists</code> but, additionally, will check the version compatibility.</li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ensure_data_dir"><a href="#val-ensure_data_dir" class="anchor"></a><code><span><span class="keyword">val</span> ensure_data_dir : 
  <span><span class="optlabel">?mode</span>:<a href="#type-ensure_mode">ensure_mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../octez-libs/Tezos_base/Genesis/index.html#type-t">Tezos_base.Genesis.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>unit <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>ensure_data_dir ~mode genesis data_dir</code> ensures that a directory is valid with regards to the given <code>mode</code>. See <code>ensure_mode</code> for the mode's properties. By default, the mode is set to <code>Is_compatible</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-upgrade_data_dir"><a href="#val-upgrade_data_dir" class="anchor"></a><code><span><span class="keyword">val</span> upgrade_data_dir : 
  <span><span class="label">data_dir</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../octez-libs/Tezos_base/Genesis/index.html#type-t">Tezos_base.Genesis.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">chain_name</span>:<a href="../../../octez-libs/Tezos_version/Distributed_db_version/Name/index.html#type-t">Tezos_base.TzPervasives.Distributed_db_version.Name.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">sandbox_parameters</span>:
    <span><span>(string * <a href="../../../octez-libs/Data_encoding/index.html#type-json">Tezos_base.TzPervasives.Data_encoding.json</a>)</span> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>unit <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Upgrade data directory from an older version.</p><p><code>upgrade_data_dir dir genesis ~chain_name ~sandbox_parameters</code> checks if an upgrade of the given data directory <code>dir</code> is available. If the data directory is upgradable then the upgrade is performed. Otherwise, nothing is done.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-store_dir"><a href="#val-store_dir" class="anchor"></a><code><span><span class="keyword">val</span> store_dir : <span>string <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>store_dir dir</code> is a directory within <code>dir</code> that the node uses for its store. In order for <code>store_dir dir</code> to be valid, <code>dir</code> must be a valid directory name.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-protocol_dir"><a href="#val-protocol_dir" class="anchor"></a><code><span><span class="keyword">val</span> protocol_dir : <span>string <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>protocol_dir dir</code> is a directory within <code>dir</code> that the node uses for its protocol. In order for <code>protocol_dir dir</code> to be valid, <code>dir</code> must be a valid directory name.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-lock_file"><a href="#val-lock_file" class="anchor"></a><code><span><span class="keyword">val</span> lock_file : <span>string <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>lock_file dir</code> is a file within <code>dir</code> that the node uses for its lock. In order for <code>lock_file dir</code> to be valid, <code>dir</code> must be a valid directory name.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-upgrade_status"><a href="#val-upgrade_status" class="anchor"></a><code><span><span class="keyword">val</span> upgrade_status : 
  <span><span class="label">data_dir</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span>bool <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>upgrade_status ~data_dir</code> returns whether or not an upgrade is available. In addition to that, it prints a user friendly log.</p></div></div></div></body></html>
