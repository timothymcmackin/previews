<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Dal_pages_request (octez-smart-rollup-node-alpha.Octez_smart_rollup_node_alpha.Dal_pages_request)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">octez-smart-rollup-node-alpha</a> &#x00BB; <a href="../index.html">Octez_smart_rollup_node_alpha</a> &#x00BB; Dal_pages_request</nav><header class="odoc-preamble"><h1>Module <code><span>Octez_smart_rollup_node_alpha.Dal_pages_request</span></code></h1><p>Access DAL slots and pages content.</p><p>This module is a wrapper on top of <code>Store.Dal_slot_pages</code> module to access DAL slots and pages' data that have been previously fetched by the rollup node.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value anchored" id="val-slot_pages"><a href="#val-slot_pages" class="anchor"></a><code><span><span class="keyword">val</span> slot_pages : 
  <span><a href="../../../octez-l2-libs/Octez_smart_rollup/Rollup_constants/index.html#type-dal_constants">Octez_smart_rollup.Rollup_constants.dal_constants</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">dal_activation_level</span>:
    <span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Raw_level/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Raw_level.t</a> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">inbox_level</span>:int32 <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">_</span> <a href="../../../octez-smart-rollup-node-lib/Octez_smart_rollup_node/Node_context/index.html#type-t">Octez_smart_rollup_node.Node_context.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Dal/index.html#type-slot_id">Tezos_protocol_alpha.Protocol.Alpha_context.Dal.slot_id</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">dal_attested_slots_validity_lag</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Dal/Page/index.html#type-content">Tezos_protocol_alpha.Protocol.Alpha_context.Dal.Page.content</a> list</span> option</span>
    <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Retrieve the pages' content of the given slot ID's from the store.</p><p>The function returns <code>Dal_slot_not_found_in_store</code> if no entry is found in the store for the given ID (i.e. no page is registered with or without content).</p><p>If the returned value is <code>Some pages</code>, the slot whose ID is given is supposed to be confirmed and <code>pages</code> correspond to the pages of the slot. Otherwise <code>None</code> is returned.</p><p>The function relies on <code>Store.Dal_slot_pages</code>'s invariants to guarantee that:</p><ul><li>the pages are returned in increasing order w.r.t. their indexes in the slot;</li><li>the size of the list, in case it is not empty, is equal to the expected number of pages in a slot.</li></ul><p><code>dal_attestation_lag</code> is used to retrieve the correct entry in <code>store</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-page_content"><a href="#val-page_content" class="anchor"></a><code><span><span class="keyword">val</span> page_content : 
  <span><a href="../../../octez-l2-libs/Octez_smart_rollup/Rollup_constants/index.html#type-dal_constants">Octez_smart_rollup.Rollup_constants.dal_constants</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">dal_activation_level</span>:
    <span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Raw_level/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Raw_level.t</a> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">inbox_level</span>:int32 <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">_</span> <a href="../../../octez-smart-rollup-node-lib/Octez_smart_rollup_node/Node_context/index.html#type-t">Octez_smart_rollup_node.Node_context.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">attestation_threshold_percent</span>:<span>int option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">restricted_commitments_publishers</span>:
    <span><span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Contract/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Contract.t</a> list</span> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Dal/Page/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Dal.Page.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">dal_attested_slots_validity_lag</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Dal/Page/index.html#type-content">Tezos_protocol_alpha.Protocol.Alpha_context.Dal.Page.content</a> option</span>
    <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Retrieve the content of the page identified by the given ID from the store.</p><p>This function checks the attestation status of the page's slot by inspecting the skip list cells stored on L1 at the slot's attested level. A slot is considered attested if either one of the following conditions is met:</p><ul><li>The <code>is_proto_attested</code> field in the content of the cell is true, and attestation_threshold_percent is None (default DAL behavior).</li></ul><ul><li>The attestation_threshold_percent is set to a specific threshold, the slot meets or exceeds this threshold, and the publisher is authorized, provided a whitelist is specified in <code>restricted_commitments_publishers</code>.</li></ul><p>If the slot of the page is attested, the data is retrieved from the DAL node and returned. Otherwise, the function returns None. It also returns None if the page_id or slot_id is invalid (or no longer valid). This includes cases where:</p><ul><li>Indices are out of range.</li></ul><ul><li>The rollup was originated after the slot's publication.</li></ul><ul><li>The slot is too old (i.e., its level is beyond <code>dal_attested_slots_validity_lag</code>).</li></ul></div></div></div></body></html>
