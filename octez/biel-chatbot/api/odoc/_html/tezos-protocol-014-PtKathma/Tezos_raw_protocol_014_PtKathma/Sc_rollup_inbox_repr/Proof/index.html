<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Proof (tezos-protocol-014-PtKathma.Tezos_raw_protocol_014_PtKathma.Sc_rollup_inbox_repr.Proof)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">tezos-protocol-014-PtKathma</a> &#x00BB; <a href="../../index.html">Tezos_raw_protocol_014_PtKathma</a> &#x00BB; <a href="../index.html">Sc_rollup_inbox_repr</a> &#x00BB; Proof</nav><header class="odoc-preamble"><h1>Module <code><span>Sc_rollup_inbox_repr.Proof</span></code></h1><p>The <code>Proof</code> module wraps the more specific proof types provided earlier in this file into the inbox proof as it is required by a refutation.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-starting_point"><a href="#type-starting_point" class="anchor"></a><code><span><span class="keyword">type</span> starting_point</span><span> = </span><span>{</span></code><ol><li id="type-starting_point.inbox_level" class="def record field anchored"><a href="#type-starting_point.inbox_level" class="anchor"></a><code><span>inbox_level : <a href="../../Raw_level_repr/index.html#type-t">Raw_level_repr.t</a>;</span></code></li><li id="type-starting_point.message_counter" class="def record field anchored"><a href="#type-starting_point.message_counter" class="anchor"></a><code><span>message_counter : <a href="../../../Tezos_protocol_environment_014_PtKathma/Z/index.html#type-t">Tezos_protocol_environment_014_PtKathma.Z.t</a>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = </span><span>{</span></code><ol><li id="type-t.skips" class="def record field anchored"><a href="#type-t.skips" class="anchor"></a><code><span>skips : <span><span>(<a href="../index.html#type-inbox">inbox</a> * <a href="../index.html#type-inclusion_proof">inclusion_proof</a>)</span> list</span>;</span></code></li><li id="type-t.level" class="def record field anchored"><a href="#type-t.level" class="anchor"></a><code><span>level : <a href="../index.html#type-inbox">inbox</a>;</span></code></li><li id="type-t.inc" class="def record field anchored"><a href="#type-t.inc" class="anchor"></a><code><span>inc : <a href="../index.html#type-inclusion_proof">inclusion_proof</a>;</span></code></li><li id="type-t.message_proof" class="def record field anchored"><a href="#type-t.message_proof" class="anchor"></a><code><span>message_proof : <span><a href="../../../Tezos_protocol_environment_014_PtKathma/Context/Proof/index.html#type-tree">Tezos_protocol_environment_014_PtKathma.Context.Proof.tree</a>
                  <a href="../../../Tezos_protocol_environment_014_PtKathma/Context/Proof/index.html#type-t">Tezos_protocol_environment_014_PtKathma.Context.Proof.t</a></span>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>An inbox proof has three parameters:</p><ul><li>the <a href="#type-starting_point"><code>starting_point</code></a> specifying a location in the inbox ;</li></ul><ul><li>the <code>message</code>, of type <code>Sc_rollup_PVM_sem.input option</code> ;</li></ul><ul><li>and a reference <code>inbox</code>.</li></ul><p>A valid inbox proof implies the following semantics: beginning at <code>starting_point</code> and reading forward through <code>inbox</code>, the first message you reach will be <code>message</code>.</p><p>Usually this is very simple because there will actually be a message at the location specified by <code>starting_point</code>. But in some cases <code>starting_point</code> is past the last message within a level, and then the inbox proof must prove that and also provide another proof starting at the beginning of the next level. This can in theory happen across multiple levels if they are empty, which is why we need a list <code>skips</code> of sub-inboxes.</p><p>TODO #2997: an issue to fix the problem of unbounded inbox proofs if the list below can be arbitrarily long (if there are many consecutive empty levels).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span><span class="keyword">val</span> pp : <span><a href="../../../Tezos_protocol_environment_014_PtKathma/Format/index.html#type-formatter">Tezos_protocol_environment_014_PtKathma.Format.formatter</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-encoding"><a href="#val-encoding" class="anchor"></a><code><span><span class="keyword">val</span> encoding : <span><a href="#type-t">t</a> <a href="../../../Tezos_protocol_environment_014_PtKathma/Data_encoding/index.html#type-t">Tezos_protocol_environment_014_PtKathma.Data_encoding.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-valid"><a href="#val-valid" class="anchor"></a><code><span><span class="keyword">val</span> valid : 
  <span><a href="#type-starting_point">starting_point</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../index.html#type-inbox">inbox</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span><a href="../../Sc_rollup_PVM_sem/index.html#type-input">Sc_rollup_PVM_sem.input</a> option</span>,
    <a href="../../../Tezos_protocol_environment_014_PtKathma/Error_monad/index.html#type-error">Tezos_protocol_environment_014_PtKathma.Error_monad.error</a>)</span>
    <a href="../../../Tezos_protocol_environment_014_PtKathma/Pervasives/index.html#type-result">Tezos_protocol_environment_014_PtKathma.Pervasives.result</a></span>
    <a href="../../../Tezos_protocol_environment_014_PtKathma/Lwt/index.html#type-t">Tezos_protocol_environment_014_PtKathma.Lwt.t</a></span></span></code></div><div class="spec-doc"><p>See the docstring for </p><table class="odoc-table"></table><p>for details of proof semantics.</p><p><code>valid starting_point inbox proof</code> will return the third parameter of the proof, <code>message</code>, iff the proof is valid.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-produce_proof"><a href="#val-produce_proof" class="anchor"></a><code><span><span class="keyword">val</span> produce_proof : 
  <span><a href="../index.html#type-inbox">inbox</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../../Raw_level_repr/index.html#type-t">Raw_level_repr.t</a> * <a href="../../../Tezos_protocol_environment_014_PtKathma/Z/index.html#type-t">Tezos_protocol_environment_014_PtKathma.Z.t</a>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="#type-t">t</a> * <span><a href="../../Sc_rollup_PVM_sem/index.html#type-input">Sc_rollup_PVM_sem.input</a> option</span>,
    <a href="../../../Tezos_protocol_environment_014_PtKathma/Error_monad/index.html#type-error">Tezos_protocol_environment_014_PtKathma.Error_monad.error</a>)</span>
    <a href="../../../Tezos_protocol_environment_014_PtKathma/Pervasives/index.html#type-result">Tezos_protocol_environment_014_PtKathma.Pervasives.result</a></span>
    <a href="../../../Tezos_protocol_environment_014_PtKathma/Lwt/index.html#type-t">Tezos_protocol_environment_014_PtKathma.Lwt.t</a></span></span></code></div><div class="spec-doc"><p>TODO #2997 Currently a placeholder, needs implementation.</p><p><code>produce_proof inbox (level, counter)</code> creates an inbox proof proving the first message after the index <code>counter</code> at location <code>level</code>. This will fail if the inbox given doesn't have sufficient data (it needs to be run on an inbox with the full history).</p></div></div></div></body></html>
