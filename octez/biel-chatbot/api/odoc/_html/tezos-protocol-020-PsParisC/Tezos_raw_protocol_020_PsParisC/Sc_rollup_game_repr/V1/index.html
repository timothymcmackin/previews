<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>V1 (tezos-protocol-020-PsParisC.Tezos_raw_protocol_020_PsParisC.Sc_rollup_game_repr.V1)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">tezos-protocol-020-PsParisC</a> &#x00BB; <a href="../../index.html">Tezos_raw_protocol_020_PsParisC</a> &#x00BB; <a href="../index.html">Sc_rollup_game_repr</a> &#x00BB; V1</nav><header class="odoc-preamble"><h1>Module <code><span>Sc_rollup_game_repr.V1</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-dissection_chunk"><a href="#type-dissection_chunk" class="anchor"></a><code><span><span class="keyword">type</span> dissection_chunk</span><span> = <a href="../../Sc_rollup_dissection_chunk_repr/index.html#type-t">Sc_rollup_dissection_chunk_repr.t</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-game_state"><a href="#type-game_state" class="anchor"></a><code><span><span class="keyword">type</span> game_state</span><span> = </span></code><ol><li id="type-game_state.Dissecting" class="def variant constructor anchored"><a href="#type-game_state.Dissecting" class="anchor"></a><code><span>| </span><span><span class="constructor">Dissecting</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-game_state.dissection" class="def record field anchored"><a href="#type-game_state.dissection" class="anchor"></a><code><span>dissection : <span><a href="#type-dissection_chunk">dissection_chunk</a> list</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>dissection</code>, a list of states with tick counts. The current player will specify, in the next move, a tick count that indicates the last of these states that she agrees with.</p><span class="comment-delim">*)</span></div></li><li id="type-game_state.default_number_of_sections" class="def record field anchored"><a href="#type-game_state.default_number_of_sections" class="anchor"></a><code><span>default_number_of_sections : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>default_number_of_sections</code> is the number of sections a disection should contain in the more general case where we still have a high enough number of disputed ticks.</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>When the state is <code>Dissecting</code>, both player are still dissecting the commitment to find the tick to refute.</p><span class="comment-delim">*)</span></div></li><li id="type-game_state.Final_move" class="def variant constructor anchored"><a href="#type-game_state.Final_move" class="anchor"></a><code><span>| </span><span><span class="constructor">Final_move</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-game_state.agreed_start_chunk" class="def record field anchored"><a href="#type-game_state.agreed_start_chunk" class="anchor"></a><code><span>agreed_start_chunk : <a href="#type-dissection_chunk">dissection_chunk</a>;</span></code></li><li id="type-game_state.refuted_stop_chunk" class="def record field anchored"><a href="#type-game_state.refuted_stop_chunk" class="anchor"></a><code><span>refuted_stop_chunk : <a href="#type-dissection_chunk">dissection_chunk</a>;</span></code></li></ol><code><span>}</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>When the state is <code>Final_move</code>, either <code>Alice</code> or <code>Bob</code> already played an invalid proof.</p><p>The other player will have a chance to prove that the <code>refuted_stop_state</code> is valid. If both players fail to either validate or refute the stop state, the current game state describes a draw situation. In the same way, the draw can be described by the situation where the two players manage to validate or refute the stop state.</p><span class="comment-delim">*)</span></div></li></ol></div><div class="spec-doc"><p>Describes the current state of a game.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-game_state_encoding"><a href="#val-game_state_encoding" class="anchor"></a><code><span><span class="keyword">val</span> game_state_encoding : 
  <span><a href="#type-game_state">game_state</a> <a href="../../../Tezos_protocol_environment_020_PsParisC/Data_encoding/index.html#type-t">Tezos_protocol_environment_020_PsParisC.Data_encoding.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-game_state_equal"><a href="#val-game_state_equal" class="anchor"></a><code><span><span class="keyword">val</span> game_state_equal : <span><a href="#type-game_state">game_state</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-game_state">game_state</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = </span><span>{</span></code><ol><li id="type-t.turn" class="def record field anchored"><a href="#type-t.turn" class="anchor"></a><code><span>turn : <a href="../index.html#type-player">player</a>;</span></code></li><li id="type-t.inbox_snapshot" class="def record field anchored"><a href="#type-t.inbox_snapshot" class="anchor"></a><code><span>inbox_snapshot : <a href="../../Sc_rollup_inbox_repr/index.html#type-history_proof">Sc_rollup_inbox_repr.history_proof</a>;</span></code></li><li id="type-t.dal_snapshot" class="def record field anchored"><a href="#type-t.dal_snapshot" class="anchor"></a><code><span>dal_snapshot : <a href="../../Dal_slot_repr/History/index.html#type-t">Dal_slot_repr.History.t</a>;</span></code></li><li id="type-t.start_level" class="def record field anchored"><a href="#type-t.start_level" class="anchor"></a><code><span>start_level : <a href="../../Raw_level_repr/index.html#type-t">Raw_level_repr.t</a>;</span></code></li><li id="type-t.inbox_level" class="def record field anchored"><a href="#type-t.inbox_level" class="anchor"></a><code><span>inbox_level : <a href="../../Raw_level_repr/index.html#type-t">Raw_level_repr.t</a>;</span></code></li><li id="type-t.game_state" class="def record field anchored"><a href="#type-t.game_state" class="anchor"></a><code><span>game_state : <a href="#type-game_state">game_state</a>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>A game is characterized by:</p><ul><li><code>refuter_commitment_hash</code>, the hash of the commitment of the player that has initiated the game.</li></ul><ul><li><code>defender_commitment_hash</code>, the hash of the commitment of the player that is tentatively refuted.</li></ul><ul><li><code>turn</code>, the player that must provide the next move.</li></ul><ul><li><code>inbox_snapshot</code>, a snapshot of the inbox state at the moment the game is created. This is only used when checking <code>Input_step</code> and <code>Blocked_step</code> proofs; it makes the proofs easier to create--- otherwise they would have a 'moving target' because the actual inbox may be updated continuously.</li></ul><ul><li><code>dal_snapshot</code>, a snapshot of the DAL's confirmed slots history at the moment the game is created. In fact, since the confirmed slots history at initialization would likely evolve during the game, we need a (fixed) reference w.r.t. which Dal input proofs would be produced and verified if needed.</li></ul><ul><li><code>level</code>, the inbox level of the commitment the game is refuting. This is only used when checking <code>Blocked_step</code> proofs---the proof will show that the next message available in <code>inbox_snapshot</code> is at <code>level</code>, so shouldn't be included in this commitment.</li></ul><ul><li><code>game_state</code>, the current state of the game, see <a href="#type-game_state"><code>game_state</code></a> for more information.</li></ul><p>Invariants: -----------</p><ul><li><code>dissection</code> must contain at least 2 values (normally it will be 32 values, but smaller if there isn't enough space for a dissection that size. The initial game dissection will be 3 values except in the case of a zero-tick commit when it will have 2 values.)</li><li>the first state hash value in <code>dissection</code> must not be <code>None</code></li><li><code>inbox_snapshot</code> and <code>dal_snapshot</code> never change once the game is created</li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-equal"><a href="#val-equal" class="anchor"></a><code><span><span class="keyword">val</span> equal : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>equal g1 g2</code> returns <code>true</code> iff <code>g1</code> is equal to <code>g2</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-opponent"><a href="#val-opponent" class="anchor"></a><code><span><span class="keyword">val</span> opponent : <span><a href="../index.html#type-player">player</a> <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-player">player</a></span></code></div><div class="spec-doc"><p>Return the other player</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-encoding"><a href="#val-encoding" class="anchor"></a><code><span><span class="keyword">val</span> encoding : <span><a href="#type-t">t</a> <a href="../../../Tezos_protocol_environment_020_PsParisC/Data_encoding/index.html#type-t">Tezos_protocol_environment_020_PsParisC.Data_encoding.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_dissection"><a href="#val-pp_dissection" class="anchor"></a><code><span><span class="keyword">val</span> pp_dissection : 
  <span><a href="../../../Tezos_protocol_environment_020_PsParisC/Format/index.html#type-formatter">Tezos_protocol_environment_020_PsParisC.Format.formatter</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-dissection_chunk">dissection_chunk</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-player_equal"><a href="#val-player_equal" class="anchor"></a><code><span><span class="keyword">val</span> player_equal : <span><a href="../index.html#type-player">player</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../index.html#type-player">player</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-player_encoding"><a href="#val-player_encoding" class="anchor"></a><code><span><span class="keyword">val</span> player_encoding : 
  <span><a href="../index.html#type-player">player</a> <a href="../../../Tezos_protocol_environment_020_PsParisC/Data_encoding/index.html#type-t">Tezos_protocol_environment_020_PsParisC.Data_encoding.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span><span class="keyword">val</span> pp : <span><a href="../../../Tezos_protocol_environment_020_PsParisC/Format/index.html#type-formatter">Tezos_protocol_environment_020_PsParisC.Format.formatter</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div></div></body></html>
