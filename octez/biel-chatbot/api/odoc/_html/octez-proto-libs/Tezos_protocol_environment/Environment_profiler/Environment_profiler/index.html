<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Environment_profiler (octez-proto-libs.Tezos_protocol_environment.Environment_profiler.Environment_profiler)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">octez-proto-libs</a> &#x00BB; <a href="../../index.html">Tezos_protocol_environment</a> &#x00BB; <a href="../index.html">Environment_profiler</a> &#x00BB; Environment_profiler</nav><header class="odoc-preamble"><h1>Module <code><span>Environment_profiler.Environment_profiler</span></code></h1></header><nav class="odoc-toc"><ul><li><a href="#plugging">Plugging</a></li><li><a href="#sequences">Sequences</a></li><li><a href="#profiling">Profiling</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-metadata"><a href="#type-metadata" class="anchor"></a><code><span><span class="keyword">type</span> <span class="keyword">nonrec</span> metadata</span><span> = <a href="../../../../octez-libs/Tezos_base/Profiler/index.html#type-metadata">Tezos_base.Profiler.metadata</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-id"><a href="#type-id" class="anchor"></a><code><span><span class="keyword">type</span> <span class="keyword">nonrec</span> id</span><span> = <a href="../../../../octez-libs/Tezos_base/Profiler/index.html#type-id">Tezos_base.Profiler.id</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-ids"><a href="#type-ids" class="anchor"></a><code><span><span class="keyword">type</span> <span class="keyword">nonrec</span> ids</span><span> = <a href="../../../../octez-libs/Tezos_base/Profiler/index.html#type-ids">Tezos_base.Profiler.ids</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-verbosity"><a href="#type-verbosity" class="anchor"></a><code><span><span class="keyword">type</span> <span class="keyword">nonrec</span> verbosity</span><span> = <a href="../../../../octez-libs/Tezos_base/Profiler/index.html#type-verbosity">Tezos_base.Profiler.verbosity</a></span><span> = </span></code><ol><li id="type-verbosity.Notice" class="def variant constructor anchored"><a href="#type-verbosity.Notice" class="anchor"></a><code><span>| </span><span><span class="constructor">Notice</span></span></code></li><li id="type-verbosity.Info" class="def variant constructor anchored"><a href="#type-verbosity.Info" class="anchor"></a><code><span>| </span><span><span class="constructor">Info</span></span></code></li><li id="type-verbosity.Debug" class="def variant constructor anchored"><a href="#type-verbosity.Debug" class="anchor"></a><code><span>| </span><span><span class="constructor">Debug</span></span></code></li></ol></div></div><h4 id="plugging"><a href="#plugging" class="anchor"></a>Plugging</h4><div class="odoc-spec"><div class="spec value anchored" id="val-plug"><a href="#val-plug" class="anchor"></a><code><span><span class="keyword">val</span> plug : <span><a href="../../../../octez-libs/Tezos_base/Profiler/index.html#type-instance">Tezos_base.Profiler.instance</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>plug instance</code> plugs the profiler stored in the module to <code>instance</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unplug"><a href="#val-unplug" class="anchor"></a><code><span><span class="keyword">val</span> unplug : <span><a href="../../../../octez-libs/Tezos_base/Profiler/index.html#type-instance">Tezos_base.Profiler.instance</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>unplug instance</code> unplugs the profiler stored in the module from <code>instance</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-close_and_unplug"><a href="#val-close_and_unplug" class="anchor"></a><code><span><span class="keyword">val</span> close_and_unplug : <span><a href="../../../../octez-libs/Tezos_base/Profiler/index.html#type-instance">Tezos_base.Profiler.instance</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>close_and_unplug instance</code> closes the profiler stored in the module and unplugs it from <code>instance</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-close_and_unplug_all"><a href="#val-close_and_unplug_all" class="anchor"></a><code><span><span class="keyword">val</span> close_and_unplug_all : <span>unit <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>close_and_unplug_all ()</code> closes the profiler stored in the module and unplugs it from all instances it was plugged to</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-plugged"><a href="#val-plugged" class="anchor"></a><code><span><span class="keyword">val</span> plugged : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../../octez-libs/Tezos_base/Profiler/index.html#type-instance">Tezos_base.Profiler.instance</a> list</span></span></code></div><div class="spec-doc"><p><code>plugged ()</code> returns all the instances plugged to the profiler stored in the module</p></div></div><h4 id="sequences"><a href="#sequences" class="anchor"></a>Sequences</h4><div class="odoc-spec"><div class="spec value anchored" id="val-record"><a href="#val-record" class="anchor"></a><code><span><span class="keyword">val</span> record : <span><a href="#type-verbosity">verbosity</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-id">id</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Open a sequence in the current sequence. If currently aggregating (not all aggregation scopes are closed), this has the same semantics as <a href="#val-aggregate"><code>aggregate</code></a> instead.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-aggregate"><a href="#val-aggregate" class="anchor"></a><code><span><span class="keyword">val</span> aggregate : <span><a href="#type-verbosity">verbosity</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-id">id</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Open an aggregation node in the current sequence.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-stop"><a href="#val-stop" class="anchor"></a><code><span><span class="keyword">val</span> stop : <span>unit <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Close the most recently opened sequence or aggregation scope.</p></div></div><h4 id="profiling"><a href="#profiling" class="anchor"></a>Profiling</h4><div class="odoc-spec"><div class="spec value anchored" id="val-stamp"><a href="#val-stamp" class="anchor"></a><code><span><span class="keyword">val</span> stamp : <span><a href="#type-verbosity">verbosity</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-id">id</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Record a timestamp in the most recently opened sequence.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mark"><a href="#val-mark" class="anchor"></a><code><span><span class="keyword">val</span> mark : <span><a href="#type-verbosity">verbosity</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-ids">ids</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Count this event's occurences in the most recent sequence.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-span"><a href="#val-span" class="anchor"></a><code><span><span class="keyword">val</span> span : <span><a href="#type-verbosity">verbosity</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../../octez-libs/Tezos_base/Profiler/index.html#type-span">Tezos_base.Profiler.span</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-ids">ids</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Sum the time spent in this event in the most recent sequence.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-inc"><a href="#val-inc" class="anchor"></a><code><span><span class="keyword">val</span> inc : <span><a href="../../../../octez-libs/Tezos_base/Profiler/index.html#type-report">Tezos_base.Profiler.report</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Include a report in the current sequence.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-record_f"><a href="#val-record_f" class="anchor"></a><code><span><span class="keyword">val</span> record_f : <span><a href="#type-verbosity">verbosity</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-id">id</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>record_f verbosity label f</code> will call:</p><pre class="language-ocaml"><code>record verbosity name;
f ();
stop ();</code></pre></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-record_s"><a href="#val-record_s" class="anchor"></a><code><span><span class="keyword">val</span> record_s : <span><a href="#type-verbosity">verbosity</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-id">id</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Same as <a href="#val-record_f"><code>record_f</code></a> but for Lwt function</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-aggregate_f"><a href="#val-aggregate_f" class="anchor"></a><code><span><span class="keyword">val</span> aggregate_f : <span><a href="#type-verbosity">verbosity</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-id">id</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>aggregate_f verbosity label f</code> will call:</p><pre class="language-ocaml"><code>aggregate verbosity name;
f ();
stop ();</code></pre></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-aggregate_s"><a href="#val-aggregate_s" class="anchor"></a><code><span><span class="keyword">val</span> aggregate_s : <span><a href="#type-verbosity">verbosity</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-id">id</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Same as <a href="#val-aggregate_f"><code>aggregate_f</code></a> but for Lwt functions</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-span_f"><a href="#val-span_f" class="anchor"></a><code><span><span class="keyword">val</span> span_f : <span><a href="#type-verbosity">verbosity</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-ids">ids</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>span_f verbosity label_list f</code> will compute <code>span</code> but specifically around <code>f</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-span_s"><a href="#val-span_s" class="anchor"></a><code><span><span class="keyword">val</span> span_s : <span><a href="#type-verbosity">verbosity</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-ids">ids</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Same as <a href="#val-span_f"><code>span_f</code></a> but for Lwt functions</p></div></div></div></body></html>
