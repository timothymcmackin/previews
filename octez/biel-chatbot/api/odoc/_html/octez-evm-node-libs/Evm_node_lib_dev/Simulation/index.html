<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Simulation (octez-evm-node-libs.Evm_node_lib_dev.Simulation)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">octez-evm-node-libs</a> &#x00BB; <a href="../index.html">Evm_node_lib_dev</a> &#x00BB; Simulation</nav><header class="odoc-preamble"><h1>Module <code><span>Evm_node_lib_dev.Simulation</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-estimate_gas_input_v1"><a href="#type-estimate_gas_input_v1" class="anchor"></a><code><span><span class="keyword">type</span> estimate_gas_input_v1</span><span> = </span><span>{</span></code><ol><li id="type-estimate_gas_input_v1.call" class="def record field anchored"><a href="#type-estimate_gas_input_v1.call" class="anchor"></a><code><span>call : <a href="../../Evm_node_lib_dev_encoding/Ethereum_types/index.html#type-call">Evm_node_lib_dev_encoding.Ethereum_types.call</a>;</span></code></li><li id="type-estimate_gas_input_v1.with_da_fees" class="def record field anchored"><a href="#type-estimate_gas_input_v1.with_da_fees" class="anchor"></a><code><span>with_da_fees : bool;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>If true, the gas returned by the simulation include the DA gas units.</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-estimate_gas_input_v2"><a href="#type-estimate_gas_input_v2" class="anchor"></a><code><span><span class="keyword">type</span> estimate_gas_input_v2</span><span> = </span><span>{</span></code><ol><li id="type-estimate_gas_input_v2.call" class="def record field anchored"><a href="#type-estimate_gas_input_v2.call" class="anchor"></a><code><span>call : <a href="../../Evm_node_lib_dev_encoding/Ethereum_types/index.html#type-call">Evm_node_lib_dev_encoding.Ethereum_types.call</a>;</span></code></li><li id="type-estimate_gas_input_v2.with_da_fees" class="def record field anchored"><a href="#type-estimate_gas_input_v2.with_da_fees" class="anchor"></a><code><span>with_da_fees : bool;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>If true, the gas returned by the simulation includes the DA gas units.</p><span class="comment-delim">*)</span></div></li><li id="type-estimate_gas_input_v2.timestamp" class="def record field anchored"><a href="#type-estimate_gas_input_v2.timestamp" class="anchor"></a><code><span>timestamp : <a href="../../../octez-libs/Tezos_base/Time/Protocol/index.html#type-t">Tezos_base.TzPervasives.Time.Protocol.t</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Timestamp used during simulation.</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-estimate_gas_input"><a href="#type-estimate_gas_input" class="anchor"></a><code><span><span class="keyword">type</span> estimate_gas_input</span><span> = </span></code><ol><li id="type-estimate_gas_input.V0" class="def variant constructor anchored"><a href="#type-estimate_gas_input.V0" class="anchor"></a><code><span>| </span><span><span class="constructor">V0</span> <span class="keyword">of</span> <a href="../../Evm_node_lib_dev_encoding/Ethereum_types/index.html#type-call">Evm_node_lib_dev_encoding.Ethereum_types.call</a></span></code></li><li id="type-estimate_gas_input.V1" class="def variant constructor anchored"><a href="#type-estimate_gas_input.V1" class="anchor"></a><code><span>| </span><span><span class="constructor">V1</span> <span class="keyword">of</span> <a href="#type-estimate_gas_input_v1">estimate_gas_input_v1</a></span></code></li><li id="type-estimate_gas_input.V2" class="def variant constructor anchored"><a href="#type-estimate_gas_input.V2" class="anchor"></a><code><span>| </span><span><span class="constructor">V2</span> <span class="keyword">of</span> <a href="#type-estimate_gas_input_v2">estimate_gas_input_v2</a></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-hex_string_to_bytes"><a href="#val-hex_string_to_bytes" class="anchor"></a><code><span><span class="keyword">val</span> hex_string_to_bytes : <span><a href="../../Evm_node_lib_dev_encoding/Ethereum_types/index.html#type-hex">Evm_node_lib_dev_encoding.Ethereum_types.hex</a> <span class="arrow">&#45;&gt;</span></span> bytes</span></code></div><div class="spec-doc"><p><code>hex_string_to_bytes s</code> transforms a hex string <code>s</code> into a byte string.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-of_opt"><a href="#val-of_opt" class="anchor"></a><code><span><span class="keyword">val</span> of_opt : 
  <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <a href="../../Evm_node_lib_dev_encoding/Rlp/index.html#type-item">Evm_node_lib_dev_encoding.Rlp.item</a>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> option</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="../../Evm_node_lib_dev_encoding/Rlp/index.html#type-item">Evm_node_lib_dev_encoding.Rlp.item</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-of_addr"><a href="#val-of_addr" class="anchor"></a><code><span><span class="keyword">val</span> of_addr : 
  <span><a href="../../Evm_node_lib_dev_encoding/Ethereum_types/index.html#type-address">Evm_node_lib_dev_encoding.Ethereum_types.address</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="../../Evm_node_lib_dev_encoding/Rlp/index.html#type-item">Evm_node_lib_dev_encoding.Rlp.item</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-of_qty"><a href="#val-of_qty" class="anchor"></a><code><span><span class="keyword">val</span> of_qty : 
  <span><a href="../../Evm_node_lib_dev_encoding/Ethereum_types/index.html#type-quantity">Evm_node_lib_dev_encoding.Ethereum_types.quantity</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="../../Evm_node_lib_dev_encoding/Rlp/index.html#type-item">Evm_node_lib_dev_encoding.Rlp.item</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-of_hash"><a href="#val-of_hash" class="anchor"></a><code><span><span class="keyword">val</span> of_hash : 
  <span><a href="../../Evm_node_lib_dev_encoding/Ethereum_types/index.html#type-hash">Evm_node_lib_dev_encoding.Ethereum_types.hash</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="../../Evm_node_lib_dev_encoding/Rlp/index.html#type-item">Evm_node_lib_dev_encoding.Rlp.item</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-rlp_v0"><a href="#val-rlp_v0" class="anchor"></a><code><span><span class="keyword">val</span> rlp_v0 : 
  <span><a href="../../Evm_node_lib_dev_encoding/Ethereum_types/index.html#type-call">Evm_node_lib_dev_encoding.Ethereum_types.call</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="../../Evm_node_lib_dev_encoding/Rlp/index.html#type-item">Evm_node_lib_dev_encoding.Rlp.item</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-rlp_v1"><a href="#val-rlp_v1" class="anchor"></a><code><span><span class="keyword">val</span> rlp_v1 : <span><a href="#type-estimate_gas_input_v1">estimate_gas_input_v1</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../Evm_node_lib_dev_encoding/Rlp/index.html#type-item">Evm_node_lib_dev_encoding.Rlp.item</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-rlp_v2"><a href="#val-rlp_v2" class="anchor"></a><code><span><span class="keyword">val</span> rlp_v2 : <span><a href="#type-estimate_gas_input_v2">estimate_gas_input_v2</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../Evm_node_lib_dev_encoding/Rlp/index.html#type-item">Evm_node_lib_dev_encoding.Rlp.item</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-rlp_encode"><a href="#val-rlp_encode" class="anchor"></a><code><span><span class="keyword">val</span> rlp_encode : <span><a href="#type-estimate_gas_input">estimate_gas_input</a> <span class="arrow">&#45;&gt;</span></span> bytes</span></code></div><div class="spec-doc"><p>Encoding used to forward the call to the kernel, to be used in simulation mode only.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-simulation_message"><a href="#type-simulation_message" class="anchor"></a><code><span><span class="keyword">type</span> simulation_message</span><span> = </span></code><ol><li id="type-simulation_message.Start" class="def variant constructor anchored"><a href="#type-simulation_message.Start" class="anchor"></a><code><span>| </span><span><span class="constructor">Start</span></span></code></li><li id="type-simulation_message.Simple" class="def variant constructor anchored"><a href="#type-simulation_message.Simple" class="anchor"></a><code><span>| </span><span><span class="constructor">Simple</span> <span class="keyword">of</span> string</span></code></li><li id="type-simulation_message.NewChunked" class="def variant constructor anchored"><a href="#type-simulation_message.NewChunked" class="anchor"></a><code><span>| </span><span><span class="constructor">NewChunked</span> <span class="keyword">of</span> int</span></code></li><li id="type-simulation_message.Chunk" class="def variant constructor anchored"><a href="#type-simulation_message.Chunk" class="anchor"></a><code><span>| </span><span><span class="constructor">Chunk</span> <span class="keyword">of</span> int * string</span></code></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-max_chunk_size"><a href="#val-max_chunk_size" class="anchor"></a><code><span><span class="keyword">val</span> max_chunk_size : int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-split_in_messages"><a href="#val-split_in_messages" class="anchor"></a><code><span><span class="keyword">val</span> split_in_messages : <span>bytes <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><a href="#type-simulation_message">simulation_message</a> list</span>, <span class="type-var">'a</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-simulation_tag"><a href="#val-simulation_tag" class="anchor"></a><code><span><span class="keyword">val</span> simulation_tag : string</span></code></div><div class="spec-doc"><p>Tag signaling a simulation message</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-simple_tag"><a href="#val-simple_tag" class="anchor"></a><code><span><span class="keyword">val</span> simple_tag : string</span></code></div><div class="spec-doc"><p>Tag signaling a simulation message containing a full simulation call</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-new_chunked_tag"><a href="#val-new_chunked_tag" class="anchor"></a><code><span><span class="keyword">val</span> new_chunked_tag : string</span></code></div><div class="spec-doc"><p>Tag signaling a simulation message starting a serie of chunks</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-chunk_tag"><a href="#val-chunk_tag" class="anchor"></a><code><span><span class="keyword">val</span> chunk_tag : string</span></code></div><div class="spec-doc"><p>Tag signaling a simulation message containing a chunk</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-evaluation_tag"><a href="#val-evaluation_tag" class="anchor"></a><code><span><span class="keyword">val</span> evaluation_tag : string</span></code></div><div class="spec-doc"><p>Tag indicating simulation is an evaluation</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-_validation_tag"><a href="#val-_validation_tag" class="anchor"></a><code><span><span class="keyword">val</span> _validation_tag : string</span></code></div><div class="spec-doc"><p>Tag indicating simulation is a validation</p><p>This tag can no longer be used, but if you plan to add another tag please avoid using this one to avoid mistakes.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-add_tag"><a href="#val-add_tag" class="anchor"></a><code><span><span class="keyword">val</span> add_tag : <span>string <span class="arrow">&#45;&gt;</span></span> <span>bytes <span class="arrow">&#45;&gt;</span></span> bytes</span></code></div><div class="spec-doc"><p><code>add_tag tag bytes</code> prefixes bytes by the given tag</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-encode_message"><a href="#val-encode_message" class="anchor"></a><code><span><span class="keyword">val</span> encode_message : <span><a href="#type-simulation_message">simulation_message</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-encode"><a href="#val-encode" class="anchor"></a><code><span><span class="keyword">val</span> encode : <span><a href="#type-estimate_gas_input">estimate_gas_input</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>string list</span>, <span class="type-var">'a</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-execution_result"><a href="#type-execution_result" class="anchor"></a><code><span><span class="keyword">type</span> execution_result</span><span> = </span><span>{</span></code><ol><li id="type-execution_result.value" class="def record field anchored"><a href="#type-execution_result.value" class="anchor"></a><code><span>value : <span><a href="../../Evm_node_lib_dev_encoding/Ethereum_types/index.html#type-hash">Evm_node_lib_dev_encoding.Ethereum_types.hash</a> option</span>;</span></code></li><li id="type-execution_result.gas_used" class="def record field anchored"><a href="#type-execution_result.gas_used" class="anchor"></a><code><span>gas_used : <span><a href="../../Evm_node_lib_dev_encoding/Ethereum_types/index.html#type-quantity">Evm_node_lib_dev_encoding.Ethereum_types.quantity</a> option</span>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-call_result"><a href="#type-call_result" class="anchor"></a><code><span><span class="keyword">type</span> call_result</span><span> =
  <span><span>(<a href="#type-execution_result">execution_result</a>, <a href="../../Evm_node_lib_dev_encoding/Ethereum_types/index.html#type-hash">Evm_node_lib_dev_encoding.Ethereum_types.hash</a>)</span>
    <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-simulation_result"><a href="#type-simulation_result" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a simulation_result</span></span><span> = <span><span>(<span class="type-var">'a</span>, string)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Encodings"><a href="#module-Encodings" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Encodings/index.html">Encodings</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-simulation_result"><a href="#val-simulation_result" class="anchor"></a><code><span><span class="keyword">val</span> simulation_result : 
  <span>bytes <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span>(<span><span>(<a href="#type-execution_result">execution_result</a>, <a href="../../Evm_node_lib_dev_encoding/Ethereum_types/index.html#type-hash">Evm_node_lib_dev_encoding.Ethereum_types.hash</a>)</span>
      <span class="xref-unresolved">Stdlib</span>.result</span>,
     string)</span>
     <span class="xref-unresolved">Stdlib</span>.result</span>,
    <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tztrace">Tezos_base.TzPervasives.tztrace</a>)</span>
    <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-gas_estimation"><a href="#val-gas_estimation" class="anchor"></a><code><span><span class="keyword">val</span> gas_estimation : 
  <span>bytes <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span>(<span><span>(<a href="#type-execution_result">execution_result</a>, <a href="../../Evm_node_lib_dev_encoding/Ethereum_types/index.html#type-hash">Evm_node_lib_dev_encoding.Ethereum_types.hash</a>)</span>
      <span class="xref-unresolved">Stdlib</span>.result</span>,
     string)</span>
     <span class="xref-unresolved">Stdlib</span>.result</span>,
    <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tztrace">Tezos_base.TzPervasives.tztrace</a>)</span>
    <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div></div></div></body></html>
