<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>S (octez-l2-libs.Octez_smart_rollup_node_store.Store_sig.S)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">octez-l2-libs</a> &#x00BB; <a href="../../index.html">Octez_smart_rollup_node_store</a> &#x00BB; <a href="../index.html">Store_sig</a> &#x00BB; S</nav><header class="odoc-preamble"><h1>Module type <code><span>Store_sig.S</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-store"><a href="#type-store" class="anchor"></a><code><span><span class="keyword">type</span> <span>+'a store</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a t</span></span><span> = <span><span>[&lt; `Read <span>| `Write</span> Read ]</span> <span class="keyword">as</span> 'a <a href="#type-store">store</a></span></span></code></div><div class="spec-doc"><p>Type of store. The parameter indicates if the store can be written or only read.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-rw"><a href="#type-rw" class="anchor"></a><code><span><span class="keyword">type</span> rw</span><span> = <span><a href="../../../Tezos_layer2_store/Store_sigs/index.html#type-rw">Tezos_layer2_store.Store_sigs.rw</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Read/write store <a href="#type-t"><code>t</code></a>.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-ro"><a href="#type-ro" class="anchor"></a><code><span><span class="keyword">type</span> ro</span><span> = <span><a href="../../../Tezos_layer2_store/Store_sigs/index.html#type-ro">Tezos_layer2_store.Store_sigs.ro</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Read only store <a href="#type-t"><code>t</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-version"><a href="#val-version" class="anchor"></a><code><span><span class="keyword">val</span> version : <a href="../../Store_version/index.html#type-t">Store_version.t</a></span></code></div><div class="spec-doc"><p>Version supported by this code.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-close"><a href="#val-close" class="anchor"></a><code><span><span class="keyword">val</span> close : <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>unit <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>close store</code> closes the store.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-load"><a href="#val-load" class="anchor"></a><code><span><span class="keyword">val</span> load : 
  <span><span><span class="type-var">'a</span> <a href="../../../Tezos_layer2_store/Store_sigs/index.html#type-mode">Tezos_layer2_store.Store_sigs.mode</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">index_buffer_size</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">l2_blocks_cache_size</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><span class="type-var">'a</span> <a href="#type-store">store</a></span> <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>load mode ~index_buffer_size ~l2_blocks_cache_size directory</code> loads a store from the data persisted in <code>directory</code>. If <code>mode</code> is <code>Store_sigs.Read_only</code>, then the indexes and irmin store will be opened in readonly mode and only read operations will be permitted. This allows to open a store for read access that is already opened in <code>Store_sigs.Read_write</code> mode in another process. <code>index_buffer_size</code> is the maximum cache size in memory before it is flushed to disk. <code>l2_blocks_cache_size</code> is the number of L2 blocks the rollup node will keep in memory.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-readonly"><a href="#val-readonly" class="anchor"></a><code><span><span class="keyword">val</span> readonly : <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-ro">ro</a></span></code></div><div class="spec-doc"><p><code>readonly store</code> returns a read-only version of <code>store</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-iter_l2_blocks"><a href="#val-iter_l2_blocks" class="anchor"></a><code><span><span class="keyword">val</span> iter_l2_blocks : 
  <span><span class="optlabel">?progress</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../Octez_smart_rollup/Metadata/index.html#type-t">Octez_smart_rollup.Metadata.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">_</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><a href="../../../Octez_smart_rollup/Sc_rollup_block/index.html#type-t">Octez_smart_rollup.Sc_rollup_block.t</a> <span class="arrow">&#45;&gt;</span></span>
    <span><span>unit <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>unit <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>iter_l2_blocks ?progress metadata store f</code> iterates <code>f</code> on all L2 blocks reachable from the head, from newest to oldest. If <code>progress</code> is provided, a progress bar is displayed with the progress messages during the iteration.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-gc"><a href="#val-gc" class="anchor"></a><code><span><span class="keyword">val</span> gc : <span><a href="#type-rw">rw</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">level</span>:int32 <span class="arrow">&#45;&gt;</span></span> <span><span>unit <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>gc store ~level</code> asynchronously garbage collects everything from the store that concerns blocks for levels below <code>level</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-wait_gc_completion"><a href="#val-wait_gc_completion" class="anchor"></a><code><span><span class="keyword">val</span> wait_gc_completion : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>wait_gc_completion store</code> returns a blocking thread if a GC run is currently ongoing.</p></div></div></div></body></html>
