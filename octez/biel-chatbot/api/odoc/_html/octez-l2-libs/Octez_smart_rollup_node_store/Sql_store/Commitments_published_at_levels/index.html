<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Commitments_published_at_levels (octez-l2-libs.Octez_smart_rollup_node_store.Sql_store.Commitments_published_at_levels)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">octez-l2-libs</a> &#x00BB; <a href="../../index.html">Octez_smart_rollup_node_store</a> &#x00BB; <a href="../index.html">Sql_store</a> &#x00BB; Commitments_published_at_levels</nav><header class="odoc-preamble"><h1>Module <code><span>Sql_store.Commitments_published_at_levels</span></code></h1><p>Storage mapping commitment hashes to the level when they were published by the rollup node.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-publication_levels"><a href="#type-publication_levels" class="anchor"></a><code><span><span class="keyword">type</span> publication_levels</span><span> = </span><span>{</span></code><ol><li id="type-publication_levels.first_published_at_level" class="def record field anchored"><a href="#type-publication_levels.first_published_at_level" class="anchor"></a><code><span>first_published_at_level : int32;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The level at which this commitment was first published.</p><span class="comment-delim">*)</span></div></li><li id="type-publication_levels.published_at_level" class="def record field anchored"><a href="#type-publication_levels.published_at_level" class="anchor"></a><code><span>published_at_level : <span>int32 option</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The level at which we published this commitment. If <code>first_published_at_level &lt;&gt; published_at_level</code> it means that the commitment is republished.</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-register"><a href="#val-register" class="anchor"></a><code><span><span class="keyword">val</span> register : 
  <span><span class="optlabel">?conn</span>:<a href="../../../Octez_sqlite/Sqlite/index.html#type-conn">Octez_sqlite.Sqlite.conn</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../index.html#type-rw">rw</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../../octez-libs/Tezos_crypto/Hashed/Smart_rollup_commitment_hash/index.html#type-t">Octez_smart_rollup.Commitment.Hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-publication_levels">publication_levels</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>unit <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>register ?conn s hash levels</code> stores the publication levels for commitment whose hash is <code>hash</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get"><a href="#val-get" class="anchor"></a><code><span><span class="keyword">val</span> get : 
  <span><span class="optlabel">?conn</span>:<a href="../../../Octez_sqlite/Sqlite/index.html#type-conn">Octez_sqlite.Sqlite.conn</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">_</span> <a href="../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../../octez-libs/Tezos_crypto/Hashed/Smart_rollup_commitment_hash/index.html#type-t">Octez_smart_rollup.Commitment.Hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><a href="#type-publication_levels">publication_levels</a> option</span> <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Retrieve the publication levels for a commitment by its hash.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_first_published_level"><a href="#val-get_first_published_level" class="anchor"></a><code><span><span class="keyword">val</span> get_first_published_level : 
  <span><span class="optlabel">?conn</span>:<a href="../../../Octez_sqlite/Sqlite/index.html#type-conn">Octez_sqlite.Sqlite.conn</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">_</span> <a href="../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../../octez-libs/Tezos_crypto/Hashed/Smart_rollup_commitment_hash/index.html#type-t">Octez_smart_rollup.Commitment.Hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>int32 option</span> <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Retrieve the level at which a commitment was first published.</p></div></div></div></body></html>
