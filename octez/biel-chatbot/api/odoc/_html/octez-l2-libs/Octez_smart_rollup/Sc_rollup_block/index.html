<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Sc_rollup_block (octez-l2-libs.Octez_smart_rollup.Sc_rollup_block)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">octez-l2-libs</a> &#x00BB; <a href="../index.html">Octez_smart_rollup</a> &#x00BB; Sc_rollup_block</nav><header class="odoc-preamble"><h1>Module <code><span>Octez_smart_rollup.Sc_rollup_block</span></code></h1></header><nav class="odoc-toc"><ul><li><a href="#structure-of-layer-2-blocks">Structure of layer 2 blocks</a></li><li><a href="#encodings">Encodings</a></li><li><a href="#helper-functions">Helper functions</a></li></ul></nav><div class="odoc-content"><h3 id="structure-of-layer-2-blocks"><a href="#structure-of-layer-2-blocks" class="anchor"></a>Structure of layer 2 blocks</h3><div class="odoc-spec"><div class="spec type anchored" id="type-header"><a href="#type-header" class="anchor"></a><code><span><span class="keyword">type</span> header</span><span> = </span><span>{</span></code><ol><li id="type-header.block_hash" class="def record field anchored"><a href="#type-header.block_hash" class="anchor"></a><code><span>block_hash : <a href="../../../octez-libs/Tezos_crypto/Hashed/Block_hash/index.html#type-t">Tezos_base.TzPervasives.Block_hash.t</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Tezos block hash.</p><span class="comment-delim">*)</span></div></li><li id="type-header.level" class="def record field anchored"><a href="#type-header.level" class="anchor"></a><code><span>level : int32;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Level of the block, corresponds to the level of the tezos block.</p><span class="comment-delim">*)</span></div></li><li id="type-header.predecessor" class="def record field anchored"><a href="#type-header.predecessor" class="anchor"></a><code><span>predecessor : <a href="../../../octez-libs/Tezos_crypto/Hashed/Block_hash/index.html#type-t">Tezos_base.TzPervasives.Block_hash.t</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Predecessor hash of the Tezos block.</p><span class="comment-delim">*)</span></div></li><li id="type-header.commitment_hash" class="def record field anchored"><a href="#type-header.commitment_hash" class="anchor"></a><code><span>commitment_hash : <span><a href="../../../octez-libs/Tezos_crypto/Hashed/Smart_rollup_commitment_hash/index.html#type-t">Octez_smart_rollup.Commitment.Hash.t</a> option</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Hash of this block's commitment if any was computed for it.</p><span class="comment-delim">*)</span></div></li><li id="type-header.previous_commitment_hash" class="def record field anchored"><a href="#type-header.previous_commitment_hash" class="anchor"></a><code><span>previous_commitment_hash : <a href="../../../octez-libs/Tezos_crypto/Hashed/Smart_rollup_commitment_hash/index.html#type-t">Octez_smart_rollup.Commitment.Hash.t</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Previous commitment hash in the chain. If there is a commitment for this block, this field contains the commitment that was previously computed.</p><span class="comment-delim">*)</span></div></li><li id="type-header.context" class="def record field anchored"><a href="#type-header.context" class="anchor"></a><code><span>context : <a href="../../Tezos_layer2_store/Smart_rollup_context_hash/index.html#type-t">Tezos_layer2_store.Smart_rollup_context_hash.t</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Hash of the layer 2 context for this block.</p><span class="comment-delim">*)</span></div></li><li id="type-header.inbox_witness" class="def record field anchored"><a href="#type-header.inbox_witness" class="anchor"></a><code><span>inbox_witness : <a href="../../../octez-libs/Tezos_crypto/Hashed/Smart_rollup_merkelized_payload_hashes_hash/index.html#type-t">Tezos_crypto.Hashed.Smart_rollup_merkelized_payload_hashes_hash.t</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Witness for the inbox for this block, i.e. the Merkle hash of payloads of messages.</p><span class="comment-delim">*)</span></div></li><li id="type-header.inbox_hash" class="def record field anchored"><a href="#type-header.inbox_hash" class="anchor"></a><code><span>inbox_hash : <a href="../Inbox_hash/index.html#type-t">Octez_smart_rollup.Inbox.Hash.t</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Hash of the inbox for this block.</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>A layer 2 block header contains information about the inbox and commitment with respect to a layer 1 block, but without the inbox content of messages.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-content"><a href="#type-content" class="anchor"></a><code><span><span class="keyword">type</span> content</span><span> = </span><span>{</span></code><ol><li id="type-content.inbox" class="def record field anchored"><a href="#type-content.inbox" class="anchor"></a><code><span>inbox : <a href="../Inbox/index.html#type-t">Inbox.t</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Inbox for this block.</p><span class="comment-delim">*)</span></div></li><li id="type-content.messages" class="def record field anchored"><a href="#type-content.messages" class="anchor"></a><code><span>messages : <span>string list</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Serialized messages added to the inbox in this block.</p><span class="comment-delim">*)</span></div></li><li id="type-content.commitment" class="def record field anchored"><a href="#type-content.commitment" class="anchor"></a><code><span>commitment : <span><a href="../Commitment/index.html#type-t">Commitment.t</a> option</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Commitment, if any is computed for this block. <code>header.commitment =
          Some h</code> iff <code>commitment = Some c</code> and <code>hash c = h</code>.</p><span class="comment-delim">*)</span></div></li><li id="type-content.outbox" class="def record field anchored"><a href="#type-content.outbox" class="anchor"></a><code><span>outbox : <span><span><span>(int * <a href="../Outbox_message/index.html#type-summary">Outbox_message.summary</a>)</span> list</span> option</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Outbox messages produced by execution of inbox</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Contents of blocks which include the actual content of the inbox and messages.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-block"><a href="#type-block" class="anchor"></a><code><span><span class="keyword">type</span> <span>('header, 'content) block</span></span><span> = </span><span>{</span></code><ol><li id="type-block.header" class="def record field anchored"><a href="#type-block.header" class="anchor"></a><code><span>header : <span class="type-var">'header</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Header of this block.</p><span class="comment-delim">*)</span></div></li><li id="type-block.content" class="def record field anchored"><a href="#type-block.content" class="anchor"></a><code><span>content : <span class="type-var">'content</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Content of the block.</p><span class="comment-delim">*)</span></div></li><li id="type-block.initial_tick" class="def record field anchored"><a href="#type-block.initial_tick" class="anchor"></a><code><span>initial_tick : <span class="xref-unresolved">Z</span>.t;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Initial tick of the PVM at this block, i.e. before evaluation of the messages.</p><span class="comment-delim">*)</span></div></li><li id="type-block.num_ticks" class="def record field anchored"><a href="#type-block.num_ticks" class="anchor"></a><code><span>num_ticks : int64;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Number of ticks produced by the evaluation of the messages in this block.</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>block parameterized by a header and content. The parameters are here to allow to split the header and rest of the block.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = <span><span>(<a href="#type-header">header</a>, unit)</span> <a href="#type-block">block</a></span></span></code></div><div class="spec-doc"><p>The type of layer 2 blocks. This type corresponds to what is stored on disk for L2 blocks. The contents is stored in separate tables because it can be large to read is is not always necessary.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-full"><a href="#type-full" class="anchor"></a><code><span><span class="keyword">type</span> full</span><span> = <span><span>(<a href="#type-header">header</a>, <a href="#type-content">content</a>)</span> <a href="#type-block">block</a></span></span></code></div><div class="spec-doc"><p>The type of layer 2 blocks including their content (inbox, messages, commitment).</p></div></div><h3 id="encodings"><a href="#encodings" class="anchor"></a>Encodings</h3><div class="odoc-spec"><div class="spec value anchored" id="val-header_encoding"><a href="#val-header_encoding" class="anchor"></a><code><span><span class="keyword">val</span> header_encoding : <span><a href="#type-header">header</a> <a href="../../../octez-libs/Data_encoding/index.html#type-t">Tezos_base.TzPervasives.Data_encoding.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-header_size"><a href="#val-header_size" class="anchor"></a><code><span><span class="keyword">val</span> header_size : int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-content_encoding"><a href="#val-content_encoding" class="anchor"></a><code><span><span class="keyword">val</span> content_encoding : <span><a href="#type-content">content</a> <a href="../../../octez-libs/Data_encoding/index.html#type-t">Tezos_base.TzPervasives.Data_encoding.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-block_encoding"><a href="#val-block_encoding" class="anchor"></a><code><span><span class="keyword">val</span> block_encoding : 
  <span><span><span class="type-var">'header</span> <a href="../../../octez-libs/Data_encoding/index.html#type-t">Tezos_base.TzPervasives.Data_encoding.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'content</span> <a href="../../../octez-libs/Data_encoding/index.html#type-t">Tezos_base.TzPervasives.Data_encoding.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'header</span>, <span class="type-var">'content</span>)</span> <a href="#type-block">block</a></span> <a href="../../../octez-libs/Data_encoding/index.html#type-t">Tezos_base.TzPervasives.Data_encoding.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-encoding"><a href="#val-encoding" class="anchor"></a><code><span><span class="keyword">val</span> encoding : <span><a href="#type-t">t</a> <a href="../../../octez-libs/Data_encoding/index.html#type-t">Tezos_base.TzPervasives.Data_encoding.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-full_encoding"><a href="#val-full_encoding" class="anchor"></a><code><span><span class="keyword">val</span> full_encoding : <span><a href="#type-full">full</a> <a href="../../../octez-libs/Data_encoding/index.html#type-t">Tezos_base.TzPervasives.Data_encoding.t</a></span></span></code></div></div><h3 id="helper-functions"><a href="#helper-functions" class="anchor"></a>Helper functions</h3><div class="odoc-spec"><div class="spec value anchored" id="val-most_recent_commitment"><a href="#val-most_recent_commitment" class="anchor"></a><code><span><span class="keyword">val</span> most_recent_commitment : <span><a href="#type-header">header</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../octez-libs/Tezos_crypto/Hashed/Smart_rollup_commitment_hash/index.html#type-t">Octez_smart_rollup.Commitment.Hash.t</a></span></code></div><div class="spec-doc"><p><code>most_recent_commitment header</code> returns the most recent commitment information at the block of with <code>header</code>. It is either the commitment for this block if there is one or the previous commitment otherwise.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-final_tick"><a href="#val-final_tick" class="anchor"></a><code><span><span class="keyword">val</span> final_tick : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-block">block</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Z</span>.t</span></code></div><div class="spec-doc"><p><code>final_tick block</code> is the final tick, after evaluation of the messages in the <code>block</code>, i.e. <code>block.initial_tick + block.num_ticks</code>.</p></div></div></div></body></html>
