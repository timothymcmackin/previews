<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Compiler (octez-protocol-compiler.Octez_protocol_compiler.Compiler)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">octez-protocol-compiler</a> &#x00BB; <a href="../index.html">Octez_protocol_compiler</a> &#x00BB; Compiler</nav><header class="odoc-preamble"><h1>Module <code><span>Octez_protocol_compiler.Compiler</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value anchored" id="val-default_warnings"><a href="#val-default_warnings" class="anchor"></a><code><span><span class="keyword">val</span> default_warnings : string</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_warn_error"><a href="#val-default_warn_error" class="anchor"></a><code><span><span class="keyword">val</span> default_warn_error : string</span></code></div></div><p>Override the default 'Env.Persistent_signature.load' with a lookup in locally defined hashtable.</p><div class="odoc-spec"><div class="spec value anchored" id="val-preloaded_cmis"><a href="#val-preloaded_cmis" class="anchor"></a><code><span><span class="keyword">val</span> preloaded_cmis : 
  <span><span class="xref-unresolved">Persistent_env</span>.Persistent_signature.t
    <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Hashtbl/index.html#type-t">Tezos_base.TzPervasives.String.Hashtbl.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-load_cmi_from_file"><a href="#val-load_cmi_from_file" class="anchor"></a><code><span><span class="keyword">val</span> load_cmi_from_file : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-load_embedded_cmi"><a href="#val-load_embedded_cmi" class="anchor"></a><code><span><span class="keyword">val</span> load_embedded_cmi : <span><span>(string * string)</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-load_embedded_cmis"><a href="#val-load_embedded_cmis" class="anchor"></a><code><span><span class="keyword">val</span> load_embedded_cmis : <span><span><span>(string * string)</span> list</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><p>Compilation environment.</p><p><code>tezos_protocol_env</code> defines the list of <code>cmi</code> available while compiling the protocol version. The <code>cmi</code> are packed into the <code>octez-node</code> binary by using <code>ocp-ocamlres</code>, see the Makefile.</p><p><code>register_env</code> defines a complementary list of <code>cmi</code> available while compiling the generated <code>register.ml</code> file (that register the protocol first-class module into the <code>Updater.versions</code> hashtable).</p><div class="odoc-spec"><div class="spec value anchored" id="val-all_files"><a href="#val-all_files" class="anchor"></a><code><span><span class="keyword">val</span> all_files : <span><span><span>[&lt; <span>`File of string * <span class="type-var">'a</span></span> ]</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(string * <span class="type-var">'a</span>)</span> list</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-tezos_protocol_env"><a href="#val-tezos_protocol_env" class="anchor"></a><code><span><span class="keyword">val</span> tezos_protocol_env : <span><span>(string * string)</span> list</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-register_env"><a href="#val-register_env" class="anchor"></a><code><span><span class="keyword">val</span> register_env : <span><span>(string * string)</span> list</span></span></code></div></div><p>Helpers</p><div class="odoc-spec"><div class="spec value anchored" id="val-create_file"><a href="#val-create_file" class="anchor"></a><code><span><span class="keyword">val</span> create_file : <span><span class="optlabel">?perm</span>:<span class="xref-unresolved">Unix</span>.file_perm <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-safe_unlink"><a href="#val-safe_unlink" class="anchor"></a><code><span><span class="keyword">val</span> safe_unlink : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unlink_cmi"><a href="#val-unlink_cmi" class="anchor"></a><code><span><span class="keyword">val</span> unlink_cmi : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(string * <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unlink_object"><a href="#val-unlink_object" class="anchor"></a><code><span><span class="keyword">val</span> unlink_object : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-debug_flag"><a href="#val-debug_flag" class="anchor"></a><code><span><span class="keyword">val</span> debug_flag : <span>bool <span class="xref-unresolved">Stdlib</span>.ref</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-debug"><a href="#val-debug" class="anchor"></a><code><span><span class="keyword">val</span> debug : <span><span><span>(<span class="type-var">'a</span>, <span class="xref-unresolved">Stdlib</span>.Format.formatter, unit)</span> <span class="xref-unresolved">Stdlib</span>.format</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mktemp_dir"><a href="#val-mktemp_dir" class="anchor"></a><code><span><span class="keyword">val</span> mktemp_dir : <span>unit <span class="arrow">&#45;&gt;</span></span> string</span></code></div></div><p>Main</p><div class="odoc-spec"><div class="spec type anchored" id="type-driver"><a href="#type-driver" class="anchor"></a><code><span><span class="keyword">type</span> driver</span><span> = </span><span>{</span></code><ol><li id="type-driver.compile_ml" class="def record field anchored"><a href="#type-driver.compile_ml" class="anchor"></a><code><span>compile_ml : <span><span class="optlabel">?for_pack</span>:string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> string;</span></code></li><li id="type-driver.pack_objects" class="def record field anchored"><a href="#type-driver.pack_objects" class="anchor"></a><code><span>pack_objects : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> string;</span></code></li><li id="type-driver.link_shared" class="def record field anchored"><a href="#type-driver.link_shared" class="anchor"></a><code><span>link_shared : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> unit;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-parse_options"><a href="#val-parse_options" class="anchor"></a><code><span><span class="keyword">val</span> parse_options : <span>bool <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_protocol_hash_result"><a href="#val-pp_protocol_hash_result" class="anchor"></a><code><span><span class="keyword">val</span> pp_protocol_hash_result : 
  <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../../../octez-libs/Tezos_crypto/Hashed/Protocol_hash/index.html#type-t">Tezos_base.TzPervasives.Protocol_hash.t</a>
   * <span><a href="../../../octez-libs/Tezos_crypto/Hashed/Protocol_hash/index.html#type-t">Tezos_base.TzPervasives.Protocol_hash.t</a> option</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-main"><a href="#val-main" class="anchor"></a><code><span><span class="keyword">val</span> main : <span><a href="#type-driver">driver</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div></div></body></html>
