<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>MONADIC (octez-protocol-compiler.Tezos_protocol_registerer.PROTOCOL_V11.Env.Skip_list.Make.MONADIC)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../../../../index.html">octez-protocol-compiler</a> &#x00BB; <a href="../../../../../index.html">Tezos_protocol_registerer</a> &#x00BB; <a href="../../../../index.html">PROTOCOL_V11</a> &#x00BB; <a href="../../../index.html">Env</a> &#x00BB; <a href="../../index.html">Skip_list</a> &#x00BB; <a href="../index.html">Make</a> &#x00BB; MONADIC</nav><header class="odoc-preamble"><h1>Module type <code><span>Make.MONADIC</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-result"><a href="#type-result" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a result</span></span></code></div><div class="spec-doc"><p>Type of results for monadic functions.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find"><a href="#val-find" class="anchor"></a><code><span><span class="keyword">val</span> find : 
  <span><span class="label">deref</span>:<span>(<span><span class="type-var">'ptr</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span><span>(<span class="type-var">'content</span>, <span class="type-var">'ptr</span>)</span> <a href="../index.html#type-cell">cell</a></span> option</span> <a href="#type-result">result</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">cell_ptr</span>:<span class="type-var">'ptr</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">target_index</span>:<a href="../../../Z/index.html#type-t">Z.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><span>(<span class="type-var">'content</span>, <span class="type-var">'ptr</span>)</span> <a href="../index.html#type-cell">cell</a></span> option</span> <a href="#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>find ~deref ~cell_ptr ~target_index</code> returns <code>Some cell</code> where <code>cell</code> is the cell at position <code>target_index</code>. This is done by dereferencing the last pointer of the path returned by <a href="#val-back_path"><code>back_path</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-back_path"><a href="#val-back_path" class="anchor"></a><code><span><span class="keyword">val</span> back_path : 
  <span><span class="label">deref</span>:<span>(<span><span class="type-var">'ptr</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span><span>(<span class="type-var">'content</span>, <span class="type-var">'ptr</span>)</span> <a href="../index.html#type-cell">cell</a></span> option</span> <a href="#type-result">result</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">cell_ptr</span>:<span class="type-var">'ptr</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">target_index</span>:<a href="../../../Z/index.html#type-t">Z.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><span class="type-var">'ptr</span> list</span> option</span> <a href="#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>back_path ~deref ~cell_ptr ~target_index</code> returns <code>Some path</code> where <code>path</code> is a sequence of back pointers to traverse to go from <code>cell_ptr</code> to the cell at position <code>target_index</code> in the sequence denoted by <code>(deref, cell_ptr)</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-valid_back_path"><a href="#val-valid_back_path" class="anchor"></a><code><span><span class="keyword">val</span> valid_back_path : 
  <span><span class="label">equal_ptr</span>:<span>(<span><span class="type-var">'ptr</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'ptr</span> <span class="arrow">&#45;&gt;</span></span> bool)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">deref</span>:<span>(<span><span class="type-var">'ptr</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span><span>(<span class="type-var">'content</span>, <span class="type-var">'ptr</span>)</span> <a href="../index.html#type-cell">cell</a></span> option</span> <a href="#type-result">result</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">cell_ptr</span>:<span class="type-var">'ptr</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">target_ptr</span>:<span class="type-var">'ptr</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'ptr</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>bool <a href="#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>valid_back_path ~equal_ptr ~deref ~cell_ptr ~target_ptr path</code> returns <code>true</code> iff <code>path</code> is a valid and minimal path from <code>cell_ptr</code> to <code>target_ptr</code> in the skip list denoted by <code>(deref, cell_ptr)</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-search"><a href="#val-search" class="anchor"></a><code><span><span class="keyword">val</span> search : 
  <span><span class="label">deref</span>:<span>(<span><span class="type-var">'ptr</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span><span>(<span class="type-var">'content</span>, <span class="type-var">'ptr</span>)</span> <a href="../index.html#type-cell">cell</a></span> option</span> <a href="#type-result">result</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">compare</span>:<span>(<span><span class="type-var">'content</span> <span class="arrow">&#45;&gt;</span></span> int)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">cell</span>:<span><span>(<span class="type-var">'content</span>, <span class="type-var">'ptr</span>)</span> <a href="../index.html#type-cell">cell</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'content</span>, <span class="type-var">'ptr</span>)</span> <a href="../index.html#type-search_result">search_result</a></span> <a href="#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>search ~deref ~compare ~cell</code> allows to find a cell of the skip list according to its content. This function assumes that the content of the cells is in increasing order according to the ordering defined by the function <code>compare</code>. In other words, this function assumes that <code>compare</code> is a function that returns a negative integer for cells before the target and a positive integer for cells after the target. The value returned by this function is <code>{rev_path; last_cell}</code> such that.</p><ul><li><code>rev_path = []</code> if and only if <code>compare (content cell) &gt; 0</code></li></ul><ul><li>For all the cases below, if there is a path from cell <code>A</code> to cell <code>B</code>, <code>rev_path</code> contains the list of cells to go from <code>B</code> to <code>A</code>. Consequently, the first element of <code>rev_path</code> is <code>B</code>. Except for <code>Nearest_lower</code>, this path is a minimal path.</li></ul><ul><li><code>last_pointer = Deref_returned_none</code> if <code>deref</code> fails to associate a cell to a pointer during the search. In that case, <code>rev_path</code> is a path from <code>cell</code> to <code>candidate</code> where <code>candidate</code> is the last cell for which candidate did not fail and such that <code>compare (content (candidate)) &gt; 0</code>.</li></ul><ul><li><code>last_pointer = No_exact_or_lower_ptr</code> if for all cell of the skip list, <code>compare (content cell) &gt; 0</code>. In that case, <code>rev_path</code> is a path from <code>cell</code> to the genesis cell.</li></ul><ul><li><code>last_pointer = Found target</code> if there is a cell <code>target</code> such that <code>compare (content target) = 0</code> and a path from <code>cell</code> to <code>target</code>. In that case, <code>rev_path</code> is the minimal path from <code>cell</code> to <code>target</code>.</li></ul><ul><li><code>last_pointer = Nearest_lower {lower;upper}</code> if there is no cell in the skip list such that <code>compare (content cell) = 0</code>. In that case <code>lower</code> is the unique cell such that <code>compare (content
     lower) &lt; 0</code> and for all other cells <code>candidate</code> such that <code>compare (content candidate) &lt; 0</code> then there is a path from <code>lower</code> to <code>candidate</code>. <code>upper</code>, if it exists is the successor cell to <code>lower</code>, i.e. <code>deref ((back_pointer upper) 0) = Some
     lower</code>. In that case, <code>rev_path</code> is a path from <code>cell</code> to <code>lower</code>. This path is *NOT* minimal but almost. The path is minimal from <code>cell</code> to <code>upper=Some up</code>. By minimality, the path is logarithmic. Consequently, since there is a direct pointer from <code>up</code> to <code>lower</code>, the passe to <code>lower</code> is also logarithmic.</li></ul></div></div></div></body></html>
