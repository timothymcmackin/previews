<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Baking_nonces (octez-protocol-021-PsQuebec-libs.Tezos_baking_021_PsQuebec.Baking_nonces)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">octez-protocol-021-PsQuebec-libs</a> &#x00BB; <a href="../index.html">Tezos_baking_021_PsQuebec</a> &#x00BB; Baking_nonces</nav><header class="odoc-preamble"><h1>Module <code><span>Tezos_baking_021_PsQuebec.Baking_nonces</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-state"><a href="#type-state" class="anchor"></a><code><span><span class="keyword">type</span> state</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = <a href="#type-state">state</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-nonces"><a href="#type-nonces" class="anchor"></a><code><span><span class="keyword">type</span> nonces</span></code></div><div class="spec-doc"><p><code>nonces</code> is a hash map corresponding to the data which can be found in the file from <code>nonces_location</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-load"><a href="#val-load" class="anchor"></a><code><span><span class="keyword">val</span> load : 
  <span><a href="../../../octez-shell-libs/Tezos_client_base/Client_context/class-type-wallet/index.html">Tezos_client_base.Client_context.wallet</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">stateful_location</span>:<span><span>[ `Stateful_nonce ]</span> <a href="../Baking_files/index.html#type-location">Baking_files.location</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-nonces">nonces</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>load wallet location</code> loads the file corresponding to <code>location</code> and returns a data structure containing the stored information.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-generate_seed_nonce"><a href="#val-generate_seed_nonce" class="anchor"></a><code><span><span class="keyword">val</span> generate_seed_nonce : 
  <span><span class="optlabel">?timeout</span>:float <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Baking_configuration/index.html#type-nonce_config">Baking_configuration.nonce_config</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Baking_state/index.html#type-consensus_key">Baking_state.consensus_key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-021-PsQuebec/Tezos_raw_protocol_021_PsQuebec/Alpha_context/Raw_level/index.html#type-t">Tezos_protocol_021_PsQuebec.Protocol.Alpha_context.Raw_level.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../../../tezos-protocol-021-PsQuebec/Tezos_raw_protocol_021_PsQuebec/Nonce_hash/index.html#type-t">Tezos_protocol_021_PsQuebec.Protocol.Nonce_hash.t</a>
   * <a href="../../../tezos-protocol-021-PsQuebec/Tezos_raw_protocol_021_PsQuebec/Alpha_context/Nonce/index.html#type-t">Tezos_protocol_021_PsQuebec.Protocol.Alpha_context.Nonce.t</a>)</span>
    <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>generate_seed_nonce nonce_config delegate level</code> computes a nonce via a <code>Deterministic</code> or <code>Random</code> approach, depending on the <code>nonce_config</code> argument; the deterministic case uses as parameters <code>delegate</code> and <code>level</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-register_nonce"><a href="#val-register_nonce" class="anchor"></a><code><span><span class="keyword">val</span> register_nonce : 
  <span><a href="../../Tezos_client_021_PsQuebec/Protocol_client_context/class-type-full/index.html">Tezos_client_021_PsQuebec.Protocol_client_context.full</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">chain_id</span>:<a href="../../../octez-libs/Tezos_crypto/Hashed/Chain_id/index.html#type-t">Tezos_base.TzPervasives.Chain_id.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../octez-libs/Tezos_crypto/Hashed/Block_hash/index.html#type-t">Tezos_base.TzPervasives.Block_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-021-PsQuebec/Tezos_raw_protocol_021_PsQuebec/Alpha_context/Nonce/index.html#type-t">Tezos_protocol_021_PsQuebec.Protocol.Alpha_context.Nonce.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">cycle</span>:<a href="../../../tezos-protocol-021-PsQuebec/Tezos_raw_protocol_021_PsQuebec/Alpha_context/Cycle/index.html#type-t">Tezos_protocol_021_PsQuebec.Protocol.Alpha_context.Cycle.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">level</span>:<a href="../../../tezos-protocol-021-PsQuebec/Tezos_raw_protocol_021_PsQuebec/Alpha_context/Raw_level/index.html#type-t">Tezos_protocol_021_PsQuebec.Protocol.Alpha_context.Raw_level.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">round</span>:<a href="../../../tezos-protocol-021-PsQuebec/Tezos_raw_protocol_021_PsQuebec/Alpha_context/Round/index.html#type-t">Tezos_protocol_021_PsQuebec.Protocol.Alpha_context.Round.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>unit <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>register_nonce cctxt ~chain_id block_hash nonce ~cycle ~level ~round</code> updates the contents from the nonces file located using <code>cctxt</code> and <code>~chain_id</code> by adding a new entry or replacing an existing one of the form <code>block_hash</code> : <code>nonce</code> * <code>~cycle</code> * <code>~level</code> * <code>~round</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-start_revelation_worker"><a href="#val-start_revelation_worker" class="anchor"></a><code><span><span class="keyword">val</span> start_revelation_worker : 
  <span><a href="../../Tezos_client_021_PsQuebec/Protocol_client_context/class-type-full/index.html">Tezos_client_021_PsQuebec.Protocol_client_context.full</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Baking_configuration/index.html#type-nonce_config">Baking_configuration.nonce_config</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../octez-libs/Tezos_crypto/Hashed/Chain_id/index.html#type-t">Tezos_base.TzPervasives.Chain_id.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-021-PsQuebec/Tezos_raw_protocol_021_PsQuebec/Alpha_context/Constants/index.html#type-t">Tezos_protocol_021_PsQuebec.Protocol.Alpha_context.Constants.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Baking_state/index.html#type-proposal">Baking_state.proposal</a> <span class="xref-unresolved">Lwt_stream</span>.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Lwt_canceler</span>.t <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>start_revelation_worker cctxt config chain_id constants block_stream</code> represents the continuous process of receiving new proposal from <code>block_stream</code> and applying them to the internal state created from <code>cctxt</code>, <code>config</code>, <code>chain_id</code> and <code>constants</code>; each new proposal can produce a nonce, to be stored in a nonce file location, facilitating the nonce revelation process.</p></div></div></div></body></html>
