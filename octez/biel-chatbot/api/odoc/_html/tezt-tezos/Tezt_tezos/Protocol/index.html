<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Protocol (tezt-tezos.Tezt_tezos.Protocol)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">tezt-tezos</a> &#x00BB; <a href="../index.html">Tezt_tezos</a> &#x00BB; Protocol</nav><header class="odoc-preamble"><h1>Module <code><span>Tezt_tezos.Protocol</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = </span></code><ol><li id="type-t.Quebec" class="def variant constructor anchored"><a href="#type-t.Quebec" class="anchor"></a><code><span>| </span><span><span class="constructor">Quebec</span></span></code></li><li id="type-t.ParisC" class="def variant constructor anchored"><a href="#type-t.ParisC" class="anchor"></a><code><span>| </span><span><span class="constructor">ParisC</span></span></code></li><li id="type-t.Alpha" class="def variant constructor anchored"><a href="#type-t.Alpha" class="anchor"></a><code><span>| </span><span><span class="constructor">Alpha</span></span></code></li></ol></div><div class="spec-doc"><p>Protocols we may want to test with.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-encoding"><a href="#val-encoding" class="anchor"></a><code><span><span class="keyword">val</span> encoding : <span><a href="#type-t">t</a> <a href="../../../octez-libs/Data_encoding/index.html#type-t">Data_encoding.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-constants"><a href="#type-constants" class="anchor"></a><code><span><span class="keyword">type</span> constants</span><span> = </span></code><ol><li id="type-constants.Constants_sandbox" class="def variant constructor anchored"><a href="#type-constants.Constants_sandbox" class="anchor"></a><code><span>| </span><span><span class="constructor">Constants_sandbox</span></span></code></li><li id="type-constants.Constants_mainnet" class="def variant constructor anchored"><a href="#type-constants.Constants_mainnet" class="anchor"></a><code><span>| </span><span><span class="constructor">Constants_mainnet</span></span></code></li><li id="type-constants.Constants_mainnet_with_chain_id" class="def variant constructor anchored"><a href="#type-constants.Constants_mainnet_with_chain_id" class="anchor"></a><code><span>| </span><span><span class="constructor">Constants_mainnet_with_chain_id</span></span></code></li><li id="type-constants.Constants_test" class="def variant constructor anchored"><a href="#type-constants.Constants_test" class="anchor"></a><code><span>| </span><span><span class="constructor">Constants_test</span></span></code></li></ol></div><div class="spec-doc"><p>Protocol parameters.</p><p>These values denote which file to use from the <code>&quot;parameters&quot;</code> directory.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-constants_to_string"><a href="#val-constants_to_string" class="anchor"></a><code><span><span class="keyword">val</span> constants_to_string : <span><a href="#type-constants">constants</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_constants"><a href="#val-default_constants" class="anchor"></a><code><span><span class="keyword">val</span> default_constants : <a href="#type-constants">constants</a></span></code></div><div class="spec-doc"><p>The default constants used by tests: <code>Constants_sandbox</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-name"><a href="#val-name" class="anchor"></a><code><span><span class="keyword">val</span> name : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Get the name of a protocol, capitalized (e.g. <code>&quot;Edo&quot;</code>).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-number"><a href="#val-number" class="anchor"></a><code><span><span class="keyword">val</span> number : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p>Get the number of a protocol, e.g. 012 for Ithaca.</p><p>The number for <code>Alpha</code> is the number it will have once snapshotted.</p><p>Use this to specify constraints that should not change once Alpha is snapshotted. For instance, <code>number protocol &gt;= 012</code> meant &quot;at least Ithaca&quot; even when Ithaca was still Alpha, while <code>number protocol &gt;= number Alpha</code> stopped being true for Ithaca after it was snapshotted.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-directory"><a href="#val-directory" class="anchor"></a><code><span><span class="keyword">val</span> directory : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Get the directory of a protocol (e.g. <code>&quot;proto_012_Psithaca&quot;</code>).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-tag"><a href="#val-tag" class="anchor"></a><code><span><span class="keyword">val</span> tag : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Get the name of a protocol as a tag, for use when registering tests (e.g. <code>&quot;edo&quot;</code>).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-hash"><a href="#val-hash" class="anchor"></a><code><span><span class="keyword">val</span> hash : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Get the full hash of a protocol.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-genesis_hash"><a href="#val-genesis_hash" class="anchor"></a><code><span><span class="keyword">val</span> genesis_hash : string</span></code></div><div class="spec-doc"><p>Hash of protocol genesis</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-demo_noops_hash"><a href="#val-demo_noops_hash" class="anchor"></a><code><span><span class="keyword">val</span> demo_noops_hash : string</span></code></div><div class="spec-doc"><p>Hash of protocol demo_noops</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-demo_counter_hash"><a href="#val-demo_counter_hash" class="anchor"></a><code><span><span class="keyword">val</span> demo_counter_hash : string</span></code></div><div class="spec-doc"><p>Hash of protocol demo_counter</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-protocol_zero_hash"><a href="#val-protocol_zero_hash" class="anchor"></a><code><span><span class="keyword">val</span> protocol_zero_hash : string</span></code></div><div class="spec-doc"><p>Hash of protocol zero</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-parameter_file"><a href="#val-parameter_file" class="anchor"></a><code><span><span class="keyword">val</span> parameter_file : <span><span class="optlabel">?constants</span>:<a href="#type-constants">constants</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Get the location of the parameter file.</p><p>This returns the path to one of the parameter files of the <code>&quot;parameters&quot;</code> directory of the protocol, relative to the root of the repository.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-accuser"><a href="#val-accuser" class="anchor"></a><code><span><span class="keyword">val</span> accuser : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../octez-libs/Tezt_wrapper/Uses/index.html#type-t">Tezt_wrapper.Uses.t</a></span></code></div><div class="spec-doc"><p>Get the path of the accuser of a protocol, such as <code>&quot;./octez-accuser-alpha&quot;</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-baker"><a href="#val-baker" class="anchor"></a><code><span><span class="keyword">val</span> baker : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../octez-libs/Tezt_wrapper/Uses/index.html#type-t">Tezt_wrapper.Uses.t</a></span></code></div><div class="spec-doc"><p>Get the path of the baker of a protocol, such as <code>&quot;./octez-baker-alpha&quot;</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-daemon_name"><a href="#val-daemon_name" class="anchor"></a><code><span><span class="keyword">val</span> daemon_name : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Get the part of the daemon name that is specific to a protocol (e.g. <code>&quot;PtEdo2Zk&quot;</code>).</p><p>This should not be used for anything except to compute the name of executables.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-encoding_prefix"><a href="#val-encoding_prefix" class="anchor"></a><code><span><span class="keyword">val</span> encoding_prefix : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Get the part which is added at the beginning of all encoding names.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-parameter_overrides"><a href="#type-parameter_overrides" class="anchor"></a><code><span><span class="keyword">type</span> parameter_overrides</span><span> =
  <span><span>(<span>string list</span>
   * <span>[ `None <span><span>| `Int</span> of int</span> <span><span>| `String_of_int</span> of int</span> <span>| <span class="xref-unresolved">Tezt_wrapper</span>.JSON.u</span> ]</span>)</span>
    list</span></span></code></div><div class="spec-doc"><p>Values to override in protocol parameters.</p><p>They are pairs of JSON paths and optional values that can be used to override or remove (when the value is <code>`None</code>) the default parameters when activating a protocol.</p><p><code>`Int i</code> is a short-hand for <code>`Float (float i)</code> and <code>`String_of_int i</code> is a short-hand for <code>`String (string_of_int i)</code>.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-bootstrap_smart_rollup"><a href="#type-bootstrap_smart_rollup" class="anchor"></a><code><span><span class="keyword">type</span> bootstrap_smart_rollup</span><span> = </span><span>{</span></code><ol><li id="type-bootstrap_smart_rollup.address" class="def record field anchored"><a href="#type-bootstrap_smart_rollup.address" class="anchor"></a><code><span>address : string;</span></code></li><li id="type-bootstrap_smart_rollup.pvm_kind" class="def record field anchored"><a href="#type-bootstrap_smart_rollup.pvm_kind" class="anchor"></a><code><span>pvm_kind : string;</span></code></li><li id="type-bootstrap_smart_rollup.boot_sector" class="def record field anchored"><a href="#type-bootstrap_smart_rollup.boot_sector" class="anchor"></a><code><span>boot_sector : string;</span></code></li><li id="type-bootstrap_smart_rollup.parameters_ty" class="def record field anchored"><a href="#type-bootstrap_smart_rollup.parameters_ty" class="anchor"></a><code><span>parameters_ty : <span class="xref-unresolved">Ezjsonm</span>.value;</span></code></li><li id="type-bootstrap_smart_rollup.whitelist" class="def record field anchored"><a href="#type-bootstrap_smart_rollup.whitelist" class="anchor"></a><code><span>whitelist : <span><span>string list</span> option</span>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-bootstrap_contract"><a href="#type-bootstrap_contract" class="anchor"></a><code><span><span class="keyword">type</span> bootstrap_contract</span><span> = </span><span>{</span></code><ol><li id="type-bootstrap_contract.delegate" class="def record field anchored"><a href="#type-bootstrap_contract.delegate" class="anchor"></a><code><span>delegate : <span>string option</span>;</span></code></li><li id="type-bootstrap_contract.amount" class="def record field anchored"><a href="#type-bootstrap_contract.amount" class="anchor"></a><code><span>amount : <a href="../Tez/index.html#type-t">Tez.t</a>;</span></code></li><li id="type-bootstrap_contract.script" class="def record field anchored"><a href="#type-bootstrap_contract.script" class="anchor"></a><code><span>script : <span class="xref-unresolved">Ezjsonm</span>.value;</span></code></li><li id="type-bootstrap_contract.hash" class="def record field anchored"><a href="#type-bootstrap_contract.hash" class="anchor"></a><code><span>hash : <span>string option</span>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_bootstrap_balance"><a href="#val-default_bootstrap_balance" class="anchor"></a><code><span><span class="keyword">val</span> default_bootstrap_balance : int</span></code></div><div class="spec-doc"><p>The value is the same as the one in src/proto_alpha/lib_parameters/default_parameters.ml.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-write_parameter_file"><a href="#val-write_parameter_file" class="anchor"></a><code><span><span class="keyword">val</span> write_parameter_file : 
  <span><span class="optlabel">?bootstrap_accounts</span>:<span><span>(<a href="../Account/index.html#type-key">Account.key</a> * <span>int option</span>)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?additional_bootstrap_accounts</span>:<span><span>(<a href="../Account/index.html#type-key">Account.key</a> * <span>int option</span> * bool)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?bootstrap_smart_rollups</span>:<span><a href="#type-bootstrap_smart_rollup">bootstrap_smart_rollup</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?bootstrap_contracts</span>:<span><a href="#type-bootstrap_contract">bootstrap_contract</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?output_file</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">base</span>:<span><span>(string, <a href="#type-t">t</a> * <span><a href="#type-constants">constants</a> option</span>)</span> <span class="xref-unresolved">Either</span>.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-parameter_overrides">parameter_overrides</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Write a protocol parameter file.</p><p>This function first builds a default parameter file from the <code>base</code> parameter. If <code>base</code> is a <code>string</code> <code>Either.Left</code>, the string denotes a path to a parameter file like <code>&quot;src/proto_alpha/parameters/sandbox-parameters.json&quot;</code>, which is taken as the base parameters. If <code>base</code> is a <code>t*constantsoption</code> <code>Either.Right</code>, the default parameters of the given protocol are the base parameters.</p><p>Then, the base parameters are tweaked with:</p><ul><li><code>bootstrap_accounts</code>, when given these accounts are used instead of <code>Account.Bootstrap.keys</code></li><li><code>parameters_overrides</code></li><li><code>additional_bootstrap_accounts</code> is a list of bootstrap accounts to add to activation parameters. Each account is a triplet <code>(key, balance, revealed)</code>. If <code>revealed</code> the public key is added, else the public key hash is added. Revealed keys are expected to bake from the start. Default <code>balance</code> is 4000000 tez.</li><li><code>bootstrap_smart_rollups</code> when given.</li><li><code>bootstrap_contracts</code> when given.</li><li><code>output_file</code> the path where to write the protocol parameter file, a <code>Temp.file</code> temporary file &quot;parameters.json&quot; by default.</li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-previous_protocol"><a href="#val-previous_protocol" class="anchor"></a><code><span><span class="keyword">val</span> previous_protocol : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> option</span></span></code></div><div class="spec-doc"><p>Get the predecessor of a protocol.</p><p>WARNING: use of this function is discouraged, because it prevents the type-checker from telling you that your test can no longer run when removing a protocol.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-all"><a href="#val-all" class="anchor"></a><code><span><span class="keyword">val</span> all : <span><a href="#type-t">t</a> list</span></span></code></div><div class="spec-doc"><p>Get the list of all protocols.</p><p>WARNING: use of this function is discouraged, because:</p><ul><li>if we add protocols such as demo-noop or demo-counter to type <code>t</code>, it would be awkward to add them to <code>all</code> if <code>all</code> only contained &quot;real&quot; protocols up to now, and it would also be awkward not to add them to <code>all</code>;</li><li>it is easier for maintainers if the list of protocols a test runs on is clearly defined where the test is registered.</li></ul></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-supported_protocols"><a href="#type-supported_protocols" class="anchor"></a><code><span><span class="keyword">type</span> supported_protocols</span><span> = </span></code><ol><li id="type-supported_protocols.Any_protocol" class="def variant constructor anchored"><a href="#type-supported_protocols.Any_protocol" class="anchor"></a><code><span>| </span><span><span class="constructor">Any_protocol</span></span></code></li><li id="type-supported_protocols.From_protocol" class="def variant constructor anchored"><a href="#type-supported_protocols.From_protocol" class="anchor"></a><code><span>| </span><span><span class="constructor">From_protocol</span> <span class="keyword">of</span> int</span></code></li><li id="type-supported_protocols.Until_protocol" class="def variant constructor anchored"><a href="#type-supported_protocols.Until_protocol" class="anchor"></a><code><span>| </span><span><span class="constructor">Until_protocol</span> <span class="keyword">of</span> int</span></code></li><li id="type-supported_protocols.Between_protocols" class="def variant constructor anchored"><a href="#type-supported_protocols.Between_protocols" class="anchor"></a><code><span>| </span><span><span class="constructor">Between_protocols</span> <span class="keyword">of</span> int * int</span></code></li><li id="type-supported_protocols.Has_predecessor" class="def variant constructor anchored"><a href="#type-supported_protocols.Has_predecessor" class="anchor"></a><code><span>| </span><span><span class="constructor">Has_predecessor</span></span></code></li><li id="type-supported_protocols.And" class="def variant constructor anchored"><a href="#type-supported_protocols.And" class="anchor"></a><code><span>| </span><span><span class="constructor">And</span> <span class="keyword">of</span> <span><a href="#type-supported_protocols">supported_protocols</a> list</span></span></code></li><li id="type-supported_protocols.Or" class="def variant constructor anchored"><a href="#type-supported_protocols.Or" class="anchor"></a><code><span>| </span><span><span class="constructor">Or</span> <span class="keyword">of</span> <span><a href="#type-supported_protocols">supported_protocols</a> list</span></span></code></li><li id="type-supported_protocols.Not" class="def variant constructor anchored"><a href="#type-supported_protocols.Not" class="anchor"></a><code><span>| </span><span><span class="constructor">Not</span> <span class="keyword">of</span> <a href="#type-supported_protocols">supported_protocols</a></span></code></li></ol></div><div class="spec-doc"><p>Constraints on the set protocols that a test supports.</p><p>Do not use this to decide which protocols the test should run on, this is the role of the last argument of <code>register_test</code> and <code>register_regression_test</code>. Instead, declare what the test *could* run on.</p><ul><li><code>Any_protocol</code>: the test can run on all active protocols. This is the default.</li><li><code>From_protocol n</code>: the test can run on protocols <code>p</code> such that <code>number p &gt;= n</code>.</li><li><code>Until_protocol n</code>: the test can run on protocols <code>p</code> such that <code>number p &lt;= n</code>.</li><li><code>Between_protocols (a, b)</code>: the test can run on protocols <code>p</code> such that <code>a &lt;= number p &lt;= b</code>.</li><li><code>Has_predecessor</code>: the test can run on protocols which have a predecessor according to <code>previous_protocol</code>.</li><li><code>And l</code>: all predicates of <code>l</code> hold.</li><li><code>Or l</code>: at least one predicate of <code>l</code> hold.</li><li><code>Not p</code>: predicate <code>p</code> does not hold.</li></ul><p>Always write the number itself, do not compute it. For instance, writing <code>Until_protocol (number Alpha)</code> would make your test not support the snapshotted version Alpha after Alpha is snapshotted, even though it actually does.</p><p>It is recommended to write protocol numbers with leading zeros. For instance, write <code>From_protocol 008</code> instead of <code>From_protocol 8</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-register_test"><a href="#val-register_test" class="anchor"></a><code><span><span class="keyword">val</span> register_test : 
  <span><span class="label">__FILE__</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">title</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">tags</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?uses</span>:<span>(<span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../octez-libs/Tezt_wrapper/Uses/index.html#type-t">Tezt_wrapper.Uses.t</a> list</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?uses_node</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?uses_client</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?uses_admin_client</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?supports</span>:<a href="#type-supported_protocols">supported_protocols</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?additional_tags</span>:<span>(<span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>string list</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-t">t</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p>Register a test that uses the protocol.</p><p>This is the same as <code>Test.register</code> except that:</p><ul><li>the name of the protocol is automatically added at the beginning of <code>title</code>;</li><li>the name of the protocol is automatically added as a tag in <code>tags</code>;</li><li>the function that implements the test takes a protocol as parameter;</li><li>an additional parameter gives the list of protocols to run the test on.</li></ul><p>The list of protocol is the last parameter because this function is intended to be applied partially, without this list; the test function being the parameter of type <code>t -&gt; unit Lwt.t</code> before the list. The list of protocols is specified in <code>main.ml</code>, next to the registration of all other tests, so that it is easy to see at a glance which tests run on which protocols.</p><p>If your test involves several protocols (for instance to test migration), use <code>Test.register</code> directly.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-register_long_test"><a href="#val-register_long_test" class="anchor"></a><code><span><span class="keyword">val</span> register_long_test : 
  <span><span class="label">__FILE__</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">title</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">tags</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?uses</span>:<span>(<span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../octez-libs/Tezt_wrapper/Uses/index.html#type-t">Tezt_wrapper.Uses.t</a> list</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?uses_node</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?uses_client</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?uses_admin_client</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?supports</span>:<a href="#type-supported_protocols">supported_protocols</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">team</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">executors</span>:<span><a href="../../Tezt_tezos_tezt_performance_regression/Long_test/index.html#type-executor">Tezt_tezos_tezt_performance_regression.Long_test.executor</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">timeout</span>:<a href="../../Tezt_tezos_tezt_performance_regression/Long_test/index.html#type-timeout">Tezt_tezos_tezt_performance_regression.Long_test.timeout</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?additional_tags</span>:<span>(<span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>string list</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-t">t</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p>Register a long-test that uses the propocol.</p><p>This is the same as <code>Long_test.register</code>, with the same differences as <code>Protocol.register_test</code> compared to <code>Test.register</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-register_regression_test"><a href="#val-register_regression_test" class="anchor"></a><code><span><span class="keyword">val</span> register_regression_test : 
  <span><span class="label">__FILE__</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">title</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">tags</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?uses</span>:<span>(<span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../octez-libs/Tezt_wrapper/Uses/index.html#type-t">Tezt_wrapper.Uses.t</a> list</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?uses_node</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?uses_client</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?uses_admin_client</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?supports</span>:<a href="#type-supported_protocols">supported_protocols</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?additional_tags</span>:<span>(<span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>string list</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-t">t</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p>Register a regression test that uses the protocol.</p><p>This is the same as <code>Regression.register</code>, with the same differences as <code>Protocol.register_test</code> compared to <code>Test.register</code>, and where <code>output_file</code> is parameterized by the protocol.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-with_predecessor"><a href="#val-with_predecessor" class="anchor"></a><code><span><span class="keyword">val</span> with_predecessor : <span><span>(<span><span class="label">previous_protocol</span>:<a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">protocol</span>:<a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p>Convert a function that expects two successive protocols into a function that expects only one.</p><p>The resulting function causes the test to fail if called on a protocol which does not have a predecessor. Use <code>~supports:Has_predecessor</code> to prevent this.</p><p>Typical usage:</p><pre class="language-ocaml"><code>Protocol.register_test ...
  ~supports:Has_predecessor
@@ Protocol.with_predecessor
@@ fun ~previous_protocol ~protocol -&gt;
...</code></pre></div></div></div></body></html>
