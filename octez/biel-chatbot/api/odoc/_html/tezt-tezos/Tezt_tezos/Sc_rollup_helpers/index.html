<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Sc_rollup_helpers (tezt-tezos.Tezt_tezos.Sc_rollup_helpers)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">tezt-tezos</a> &#x00BB; <a href="../index.html">Tezt_tezos</a> &#x00BB; Sc_rollup_helpers</nav><header class="odoc-preamble"><h1>Module <code><span>Tezt_tezos.Sc_rollup_helpers</span></code></h1><p>Helpers built upon the Sc_rollup_node and Sc_rollup_client</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value anchored" id="val-hooks"><a href="#val-hooks" class="anchor"></a><code><span><span class="keyword">val</span> hooks : <span class="xref-unresolved">Tezt</span>.Process.hooks</span></code></div><div class="spec-doc"><p>Hooks that handles hashes specific to smart rollups.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-rpc_hooks"><a href="#val-rpc_hooks" class="anchor"></a><code><span><span class="keyword">val</span> rpc_hooks : <a href="../RPC_core/index.html#type-rpc_hooks">RPC_core.rpc_hooks</a></span></code></div><div class="spec-doc"><p>Expose Tezos_regression.rpc_hooks for regressions</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-hex_encode"><a href="#val-hex_encode" class="anchor"></a><code><span><span class="keyword">val</span> hex_encode : <span>string <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>hex_encode s</code> returns the hexadecimal representation of the given string <code>s</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-read_kernel"><a href="#val-read_kernel" class="anchor"></a><code><span><span class="keyword">val</span> read_kernel : <span><span class="optlabel">?base</span>:string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>read_kernel filename</code> reads binary encoded WebAssembly module (e.g. `foo.wasm`) and returns a hex-encoded Wasm PVM boot sector, suitable for passing to <code>originate_sc_rollup</code>.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Installer_kernel_config"><a href="#module-Installer_kernel_config" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Installer_kernel_config/index.html">Installer_kernel_config</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-installer_result"><a href="#type-installer_result" class="anchor"></a><code><span><span class="keyword">type</span> installer_result</span><span> = </span><span>{</span></code><ol><li id="type-installer_result.output" class="def record field anchored"><a href="#type-installer_result.output" class="anchor"></a><code><span>output : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Output path of the boot sector.</p><span class="comment-delim">*)</span></div></li><li id="type-installer_result.boot_sector" class="def record field anchored"><a href="#type-installer_result.boot_sector" class="anchor"></a><code><span>boot_sector : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Boot sector.</p><span class="comment-delim">*)</span></div></li><li id="type-installer_result.root_hash" class="def record field anchored"><a href="#type-installer_result.root_hash" class="anchor"></a><code><span>root_hash : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Root hash of the boot sector.</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-prepare_installer_kernel"><a href="#val-prepare_installer_kernel" class="anchor"></a><code><span><span class="keyword">val</span> prepare_installer_kernel : 
  <span><span class="optlabel">?output</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?runner</span>:<span class="xref-unresolved">Tezt_wrapper</span>.Runner.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">preimages_dir</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?config</span>:
    <span>[&lt; <span>`Config of <a href="Installer_kernel_config/index.html#type-t">Installer_kernel_config.t</a></span>
    <span><span>| `Path</span> of string</span>
    <span><span>| `Both</span> of <a href="Installer_kernel_config/index.html#type-t">Installer_kernel_config.t</a> * string</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../octez-libs/Tezt_wrapper/Uses/index.html#type-t">Tezt_wrapper.Uses.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-installer_result">installer_result</a> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>prepare_installer_kernel ~preimages_dir ?config installee</code> feeds the <code>smart-rollup-installer</code> with a kernel (<code>installee</code>), and returns the boot sector corresponding to the installer for this specific kernel.</p><p>A <a href="Installer_kernel_config/index.html#type-t"><code>Installer_kernel_config.t</code></a> can optionally be provided to the installer via <code>config</code>.</p><p>The preimages of the <code>installee</code> are saved to <code>preimages_dir</code>. This should be the reveal data directory of the rollup node.</p><p>The returned installer is hex-encoded and may be passed to <code>originate_sc_rollup</code> directly.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-prepare_installer_kernel_with_arbitrary_file"><a href="#val-prepare_installer_kernel_with_arbitrary_file" class="anchor"></a><code><span><span class="keyword">val</span> prepare_installer_kernel_with_arbitrary_file : 
  <span><span class="optlabel">?output</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?smart_rollup_installer_path</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?runner</span>:<span class="xref-unresolved">Tezt_wrapper</span>.Runner.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?boot_sector</span>:<span>[ `Content <span>| `Filename</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">preimages_dir</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?config</span>:
    <span>[&lt; <span>`Config of <a href="Installer_kernel_config/index.html#type-t">Installer_kernel_config.t</a></span>
    <span><span>| `Path</span> of string</span>
    <span><span>| `Both</span> of <a href="Installer_kernel_config/index.html#type-t">Installer_kernel_config.t</a> * string</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-installer_result">installer_result</a> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Same as <code>prepare_installer_kernel</code> but not forcing to use pre-generated kernels. Should be used for kernel generated by the test itself.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-setup_l1"><a href="#val-setup_l1" class="anchor"></a><code><span><span class="keyword">val</span> setup_l1 : 
  <span><span class="optlabel">?timestamp</span>:<a href="../Client/index.html#type-timestamp">Client.timestamp</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?bootstrap_smart_rollups</span>:<span><a href="../Protocol/index.html#type-bootstrap_smart_rollup">Protocol.bootstrap_smart_rollup</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?bootstrap_contracts</span>:<span><a href="../Protocol/index.html#type-bootstrap_contract">Protocol.bootstrap_contract</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?commitment_period</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?challenge_window</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?timeout</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?whitelist_enable</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?rpc_external</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?riscv_pvm_enable</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?minimal_block_delay</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Protocol/index.html#type-t">Protocol.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../Node/index.html#type-t">Node.t</a> * <a href="../Client/index.html#type-t">Client.t</a>)</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>setup_l1 protocol</code> initializes a protocol with the given parameters, and returns the L1 node and client.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-originate_sc_rollup"><a href="#val-originate_sc_rollup" class="anchor"></a><code><span><span class="keyword">val</span> originate_sc_rollup : 
  <span><span class="optlabel">?keys</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?hooks</span>:<span class="xref-unresolved">Tezt_wrapper</span>.Process_hooks.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?burn_cap</span>:<a href="../Tez/index.html#type-t">Tez.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?whitelist</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?alias</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?src</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">kind</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?parameters_ty</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?boot_sector</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>originate_sc_rollup</code> is a wrapper above <code>Client.originate_sc_rollup</code> that waits for the block to be included.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-setup_rollup"><a href="#val-setup_rollup" class="anchor"></a><code><span><span class="keyword">val</span> setup_rollup : 
  <span><span class="label">kind</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?hooks</span>:<span class="xref-unresolved">Tezt_wrapper</span>.Process_hooks.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?alias</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?mode</span>:<a href="../Sc_rollup_node/index.html#type-mode">Sc_rollup_node.mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?boot_sector</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?parameters_ty</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?src</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?operator</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?operators</span>:<span><span>(<a href="../Sc_rollup_node/index.html#type-purpose">Sc_rollup_node.purpose</a> * string)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?data_dir</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?rollup_node_name</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?whitelist</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?sc_rollup</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?allow_degraded</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Node/index.html#type-t">Node.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../Sc_rollup_node/index.html#type-t">Sc_rollup_node.t</a> * string)</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-originate_forward_smart_contract"><a href="#val-originate_forward_smart_contract" class="anchor"></a><code><span><span class="keyword">val</span> originate_forward_smart_contract : 
  <span><span class="optlabel">?src</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Protocol/index.html#type-t">Protocol.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_boot_sector_of"><a href="#val-default_boot_sector_of" class="anchor"></a><code><span><span class="keyword">val</span> default_boot_sector_of : <span><span class="label">kind</span>:string <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>default_boot_sector_of k</code> returns a valid boot sector for a PVM of kind <code>kind</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-last_cemented_commitment_hash_with_level"><a href="#val-last_cemented_commitment_hash_with_level" class="anchor"></a><code><span><span class="keyword">val</span> last_cemented_commitment_hash_with_level : 
  <span><span class="label">sc_rollup</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(string * int)</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-genesis_commitment"><a href="#val-genesis_commitment" class="anchor"></a><code><span><span class="keyword">val</span> genesis_commitment : 
  <span><span class="label">sc_rollup</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../RPC/index.html#type-smart_rollup_commitment">RPC.smart_rollup_commitment</a> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>genesis_commitment ~sc_rollup client</code> returns the genesis commitment, fails if this commitment have been cleaned from the context.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-call_rpc"><a href="#val-call_rpc" class="anchor"></a><code><span><span class="keyword">val</span> call_rpc : 
  <span><span class="label">smart_rollup_node</span>:<a href="../Sc_rollup_node/index.html#type-t">Sc_rollup_node.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">service</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Tezt_wrapper</span>.JSON.t <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>call_rpc ~smart_rollup_node ~service</code> call the RPC for <code>service</code> on <code>smart_rollup_node</code>.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-bootstrap_smart_rollup_setup"><a href="#type-bootstrap_smart_rollup_setup" class="anchor"></a><code><span><span class="keyword">type</span> bootstrap_smart_rollup_setup</span><span> = </span><span>{</span></code><ol><li id="type-bootstrap_smart_rollup_setup.bootstrap_smart_rollup" class="def record field anchored"><a href="#type-bootstrap_smart_rollup_setup.bootstrap_smart_rollup" class="anchor"></a><code><span>bootstrap_smart_rollup : <a href="../Protocol/index.html#type-bootstrap_smart_rollup">Protocol.bootstrap_smart_rollup</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The bootstrap smart rollup to add in the parameter files.</p><span class="comment-delim">*)</span></div></li><li id="type-bootstrap_smart_rollup_setup.smart_rollup_node_data_dir" class="def record field anchored"><a href="#type-bootstrap_smart_rollup_setup.smart_rollup_node_data_dir" class="anchor"></a><code><span>smart_rollup_node_data_dir : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The data dir to use for the smart rollup node, where the smart rollup preimages are available.</p><span class="comment-delim">*)</span></div></li><li id="type-bootstrap_smart_rollup_setup.smart_rollup_node_extra_args" class="def record field anchored"><a href="#type-bootstrap_smart_rollup_setup.smart_rollup_node_extra_args" class="anchor"></a><code><span>smart_rollup_node_extra_args : <span><a href="../Sc_rollup_node/index.html#type-argument">Sc_rollup_node.argument</a> list</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The extra arguments needed by the smart rollup node when the smart rollup is a bootstrap smart rollup.</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Bootstrap smart rollup setup information.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-setup_bootstrap_smart_rollup"><a href="#val-setup_bootstrap_smart_rollup" class="anchor"></a><code><span><span class="keyword">val</span> setup_bootstrap_smart_rollup : 
  <span><span class="optlabel">?name</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">address</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?parameters_ty</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?whitelist</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">installee</span>:<a href="../../../octez-libs/Tezt_wrapper/Uses/index.html#type-t">Tezt_wrapper.Uses.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?config</span>:<span>[&lt; <span>`Config of <a href="Installer_kernel_config/index.html#type-t">Installer_kernel_config.t</a></span> <span><span>| `Path</span> of string</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-bootstrap_smart_rollup_setup">bootstrap_smart_rollup_setup</a> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>setup_bootstrap_smart_rollup ?name ~address ?parameters_ty ~installee ?config ()</code> creates a <a href="#type-bootstrap_smart_rollup_setup"><code>bootstrap_smart_rollup_setup</code></a> that can be used to run a bootstrap smart rollup.</p><p><code>name</code> is the smart rollup node data-dir's name. Defaults to <code>&quot;smart-rollup&quot;</code>. <code>address</code> is the smart rollup address. <code>parameters_ty</code> is the smart rollup type. Defaults to <code>&quot;string&quot;</code>. <code>config</code> is the optional smart rollup installer configuration, see <a href="#val-prepare_installer_kernel"><code>prepare_installer_kernel</code></a>.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-refutation_scenario_parameters"><a href="#type-refutation_scenario_parameters" class="anchor"></a><code><span><span class="keyword">type</span> refutation_scenario_parameters</span><span> = </span><span>{</span></code><ol><li id="type-refutation_scenario_parameters.loser_modes" class="def record field anchored"><a href="#type-refutation_scenario_parameters.loser_modes" class="anchor"></a><code><span>loser_modes : <span>string list</span>;</span></code></li><li id="type-refutation_scenario_parameters.inputs" class="def record field anchored"><a href="#type-refutation_scenario_parameters.inputs" class="anchor"></a><code><span>inputs : <span><span>string list</span> list</span>;</span></code></li><li id="type-refutation_scenario_parameters.final_level" class="def record field anchored"><a href="#type-refutation_scenario_parameters.final_level" class="anchor"></a><code><span>final_level : int;</span></code></li><li id="type-refutation_scenario_parameters.empty_levels" class="def record field anchored"><a href="#type-refutation_scenario_parameters.empty_levels" class="anchor"></a><code><span>empty_levels : <span>int list</span>;</span></code></li><li id="type-refutation_scenario_parameters.stop_loser_at" class="def record field anchored"><a href="#type-refutation_scenario_parameters.stop_loser_at" class="anchor"></a><code><span>stop_loser_at : <span>int list</span>;</span></code></li><li id="type-refutation_scenario_parameters.reset_honest_on" class="def record field anchored"><a href="#type-refutation_scenario_parameters.reset_honest_on" class="anchor"></a><code><span>reset_honest_on : <span><span>(string * int * <span><a href="../Sc_rollup_node/index.html#type-mode">Sc_rollup_node.mode</a> option</span>)</span> list</span>;</span></code></li><li id="type-refutation_scenario_parameters.bad_reveal_at" class="def record field anchored"><a href="#type-refutation_scenario_parameters.bad_reveal_at" class="anchor"></a><code><span>bad_reveal_at : <span>int list</span>;</span></code></li><li id="type-refutation_scenario_parameters.priority" class="def record field anchored"><a href="#type-refutation_scenario_parameters.priority" class="anchor"></a><code><span>priority : <span>[ `Priority_honest <span>| `Priority_loser</span> <span>| `No_priority</span> ]</span>;</span></code></li><li id="type-refutation_scenario_parameters.allow_degraded" class="def record field anchored"><a href="#type-refutation_scenario_parameters.allow_degraded" class="anchor"></a><code><span>allow_degraded : bool;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-refutation_scenario_parameters"><a href="#val-refutation_scenario_parameters" class="anchor"></a><code><span><span class="keyword">val</span> refutation_scenario_parameters : 
  <span><span class="optlabel">?loser_modes</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">final_level</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?empty_levels</span>:<span>int list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?stop_loser_at</span>:<span>int list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?reset_honest_on</span>:<span><span>(string * int * <span><a href="../Sc_rollup_node/index.html#type-mode">Sc_rollup_node.mode</a> option</span>)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?bad_reveal_at</span>:<span>int list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?priority</span>:<span>[ `No_priority <span>| `Priority_honest</span> <span>| `Priority_loser</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?allow_degraded</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>string list</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-refutation_scenario_parameters">refutation_scenario_parameters</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-test"><a href="#type-test" class="anchor"></a><code><span><span class="keyword">type</span> test</span><span> = </span><span>{</span></code><ol><li id="type-test.variant" class="def record field anchored"><a href="#type-test.variant" class="anchor"></a><code><span>variant : <span>string option</span>;</span></code></li><li id="type-test.tags" class="def record field anchored"><a href="#type-test.tags" class="anchor"></a><code><span>tags : <span>string list</span>;</span></code></li><li id="type-test.description" class="def record field anchored"><a href="#type-test.description" class="anchor"></a><code><span>description : string;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-format_title_scenario"><a href="#val-format_title_scenario" class="anchor"></a><code><span><span class="keyword">val</span> format_title_scenario : <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-test">test</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-send_message"><a href="#val-send_message" class="anchor"></a><code><span><span class="keyword">val</span> send_message : 
  <span><span class="optlabel">?hooks</span>:<span class="xref-unresolved">Tezt_wrapper</span>.Process_hooks.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?src</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-send_messages"><a href="#val-send_messages" class="anchor"></a><code><span><span class="keyword">val</span> send_messages : 
  <span><span class="optlabel">?hooks</span>:<span class="xref-unresolved">Tezt_wrapper</span>.Process_hooks.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?src</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?batch_size</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><p>Smart rollup constants</p><div class="odoc-spec"><div class="spec type anchored" id="type-sc_rollup_constants"><a href="#type-sc_rollup_constants" class="anchor"></a><code><span><span class="keyword">type</span> sc_rollup_constants</span><span> = </span><span>{</span></code><ol><li id="type-sc_rollup_constants.origination_size" class="def record field anchored"><a href="#type-sc_rollup_constants.origination_size" class="anchor"></a><code><span>origination_size : int;</span></code></li><li id="type-sc_rollup_constants.challenge_window_in_blocks" class="def record field anchored"><a href="#type-sc_rollup_constants.challenge_window_in_blocks" class="anchor"></a><code><span>challenge_window_in_blocks : int;</span></code></li><li id="type-sc_rollup_constants.stake_amount" class="def record field anchored"><a href="#type-sc_rollup_constants.stake_amount" class="anchor"></a><code><span>stake_amount : <a href="../Tez/index.html#type-t">Tez.t</a>;</span></code></li><li id="type-sc_rollup_constants.commitment_period_in_blocks" class="def record field anchored"><a href="#type-sc_rollup_constants.commitment_period_in_blocks" class="anchor"></a><code><span>commitment_period_in_blocks : int;</span></code></li><li id="type-sc_rollup_constants.max_lookahead_in_blocks" class="def record field anchored"><a href="#type-sc_rollup_constants.max_lookahead_in_blocks" class="anchor"></a><code><span>max_lookahead_in_blocks : int32;</span></code></li><li id="type-sc_rollup_constants.max_active_outbox_levels" class="def record field anchored"><a href="#type-sc_rollup_constants.max_active_outbox_levels" class="anchor"></a><code><span>max_active_outbox_levels : int32;</span></code></li><li id="type-sc_rollup_constants.max_outbox_messages_per_level" class="def record field anchored"><a href="#type-sc_rollup_constants.max_outbox_messages_per_level" class="anchor"></a><code><span>max_outbox_messages_per_level : int;</span></code></li><li id="type-sc_rollup_constants.number_of_sections_in_dissection" class="def record field anchored"><a href="#type-sc_rollup_constants.number_of_sections_in_dissection" class="anchor"></a><code><span>number_of_sections_in_dissection : int;</span></code></li><li id="type-sc_rollup_constants.timeout_period_in_blocks" class="def record field anchored"><a href="#type-sc_rollup_constants.timeout_period_in_blocks" class="anchor"></a><code><span>timeout_period_in_blocks : int;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_sc_rollup_constants"><a href="#val-get_sc_rollup_constants" class="anchor"></a><code><span><span class="keyword">val</span> get_sc_rollup_constants : <span><a href="../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-sc_rollup_constants">sc_rollup_constants</a> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-publish_commitment"><a href="#val-publish_commitment" class="anchor"></a><code><span><span class="keyword">val</span> publish_commitment : 
  <span><span class="optlabel">?src</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">commitment</span>:<a href="../RPC/index.html#type-smart_rollup_commitment">RPC.smart_rollup_commitment</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>unit <a href="../Runnable/index.html#type-process">Runnable.process</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-forge_and_publish_commitment_return_runnable"><a href="#val-forge_and_publish_commitment_return_runnable" class="anchor"></a><code><span><span class="keyword">val</span> forge_and_publish_commitment_return_runnable : 
  <span><span class="optlabel">?compressed_state</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?number_of_ticks</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">inbox_level</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">predecessor</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">sc_rollup</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">src</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="../RPC/index.html#type-smart_rollup_commitment">RPC.smart_rollup_commitment</a> * <span>unit <a href="../Runnable/index.html#type-process">Runnable.process</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_staked_on_commitment"><a href="#val-get_staked_on_commitment" class="anchor"></a><code><span><span class="keyword">val</span> get_staked_on_commitment : 
  <span><span class="label">sc_rollup</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">staker</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-forge_and_publish_commitment"><a href="#val-forge_and_publish_commitment" class="anchor"></a><code><span><span class="keyword">val</span> forge_and_publish_commitment : 
  <span><span class="optlabel">?compressed_state</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?number_of_ticks</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">inbox_level</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">predecessor</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">sc_rollup</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">src</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../RPC/index.html#type-smart_rollup_commitment">RPC.smart_rollup_commitment</a> * string)</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bake_period_then_publish_commitment"><a href="#val-bake_period_then_publish_commitment" class="anchor"></a><code><span><span class="keyword">val</span> bake_period_then_publish_commitment : 
  <span><span class="optlabel">?compressed_state</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?number_of_ticks</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">sc_rollup</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">src</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../RPC/index.html#type-smart_rollup_commitment">RPC.smart_rollup_commitment</a> * string)</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-cement_commitment"><a href="#val-cement_commitment" class="anchor"></a><code><span><span class="keyword">val</span> cement_commitment : 
  <span><a href="../Protocol/index.html#type-t">Protocol.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?src</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?fail</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">sc_rollup</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">hash</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bake_operation_via_rpc"><a href="#val-bake_operation_via_rpc" class="anchor"></a><code><span><span class="keyword">val</span> bake_operation_via_rpc : 
  <span><span class="label">__LOC__</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Operation_core/Manager/index.html#type-t">Operation_core.Manager.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-start_refute"><a href="#val-start_refute" class="anchor"></a><code><span><span class="keyword">val</span> start_refute : 
  <span><a href="../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">source</span>:<a href="../Account/index.html#type-key">Account.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">opponent</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">sc_rollup</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">player_commitment_hash</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">opponent_commitment_hash</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-move_refute_with_unique_state_hash"><a href="#val-move_refute_with_unique_state_hash" class="anchor"></a><code><span><span class="keyword">val</span> move_refute_with_unique_state_hash : 
  <span><span class="optlabel">?number_of_sections_in_dissection</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">source</span>:<a href="../Account/index.html#type-key">Account.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">opponent</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">sc_rollup</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">state_hash</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-timeout"><a href="#val-timeout" class="anchor"></a><code><span><span class="keyword">val</span> timeout : 
  <span><span class="optlabel">?expect_failure</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">sc_rollup</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">staker1</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">staker2</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?src</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-send_text_messages"><a href="#val-send_text_messages" class="anchor"></a><code><span><span class="keyword">val</span> send_text_messages : 
  <span><span class="optlabel">?format</span>:<span>[&lt; `Hex <span>| `Raw</span> Raw ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?hooks</span>:<span class="xref-unresolved">Tezt_wrapper</span>.Process_hooks.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?src</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-reveal_hash"><a href="#type-reveal_hash" class="anchor"></a><code><span><span class="keyword">type</span> reveal_hash</span><span> = </span><span>{</span></code><ol><li id="type-reveal_hash.message" class="def record field anchored"><a href="#type-reveal_hash.message" class="anchor"></a><code><span>message : string;</span></code></li><li id="type-reveal_hash.filename" class="def record field anchored"><a href="#type-reveal_hash.filename" class="anchor"></a><code><span>filename : string;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-reveal_hash"><a href="#val-reveal_hash" class="anchor"></a><code><span><span class="keyword">val</span> reveal_hash : <span><span class="label">protocol</span>:<span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">kind</span>:string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <a href="#type-reveal_hash">reveal_hash</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-test_refutation_scenario_aux"><a href="#val-test_refutation_scenario_aux" class="anchor"></a><code><span><span class="keyword">val</span> test_refutation_scenario_aux : 
  <span><span class="label">mode</span>:<a href="../Sc_rollup_node/index.html#type-mode">Sc_rollup_node.mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">kind</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-refutation_scenario_parameters">refutation_scenario_parameters</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Sc_rollup_node/index.html#type-t">Sc_rollup_node.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Node/index.html#type-t">Node.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>A common test that use both in sc_rollup and sc_rollup_migration for refutation tests</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-inputs_for"><a href="#val-inputs_for" class="anchor"></a><code><span><span class="keyword">val</span> inputs_for : <span>int <span class="arrow">&#45;&gt;</span></span> <span><span>string list</span> list</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-wait_for_injecting_event"><a href="#val-wait_for_injecting_event" class="anchor"></a><code><span><span class="keyword">val</span> wait_for_injecting_event : 
  <span><span class="optlabel">?tags</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?count</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Sc_rollup_node/index.html#type-t">Sc_rollup_node.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-injecting_refute_event"><a href="#val-injecting_refute_event" class="anchor"></a><code><span><span class="keyword">val</span> injecting_refute_event : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Sc_rollup_node/index.html#type-t">Sc_rollup_node.t</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-transaction"><a href="#type-transaction" class="anchor"></a><code><span><span class="keyword">type</span> transaction</span><span> = </span><span>{</span></code><ol><li id="type-transaction.destination" class="def record field anchored"><a href="#type-transaction.destination" class="anchor"></a><code><span>destination : string;</span></code></li><li id="type-transaction.entrypoint" class="def record field anchored"><a href="#type-transaction.entrypoint" class="anchor"></a><code><span>entrypoint : <span>string option</span>;</span></code></li><li id="type-transaction.parameters" class="def record field anchored"><a href="#type-transaction.parameters" class="anchor"></a><code><span>parameters : <span class="xref-unresolved">Tezt_wrapper</span>.JSON.u;</span></code></li><li id="type-transaction.parameters_ty" class="def record field anchored"><a href="#type-transaction.parameters_ty" class="anchor"></a><code><span>parameters_ty : <span><span class="xref-unresolved">Tezt_wrapper</span>.JSON.u option</span>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-json_of_output_tx_batch"><a href="#val-json_of_output_tx_batch" class="anchor"></a><code><span><span class="keyword">val</span> json_of_output_tx_batch : <span><span><a href="#type-transaction">transaction</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Tezt_wrapper</span>.JSON.u</span></code></div><div class="spec-doc"><p>Converts a list of transactions into a JSON object.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-prioritize_refute_operations"><a href="#val-prioritize_refute_operations" class="anchor"></a><code><span><span class="keyword">val</span> prioritize_refute_operations : <span><a href="../Sc_rollup_node/index.html#type-t">Sc_rollup_node.t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Configure the rollup node to pay more fees for its refute operations.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-serve_files"><a href="#val-serve_files" class="anchor"></a><code><span><span class="keyword">val</span> serve_files : 
  <span><span class="optlabel">?on_request</span>:<span>(<span>string <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">name</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">port</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">root</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Run simple http server on <code>port</code> that servers static files in the <code>root</code> directory.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ticks_per_snapshot"><a href="#val-ticks_per_snapshot" class="anchor"></a><code><span><span class="keyword">val</span> ticks_per_snapshot : int</span></code></div></div></div></body></html>
