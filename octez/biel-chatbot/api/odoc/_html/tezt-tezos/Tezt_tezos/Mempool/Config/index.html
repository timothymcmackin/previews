<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Config (tezt-tezos.Tezt_tezos.Mempool.Config)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">tezt-tezos</a> &#x00BB; <a href="../../index.html">Tezt_tezos</a> &#x00BB; <a href="../index.html">Mempool</a> &#x00BB; Config</nav><header class="odoc-preamble"><h1>Module <code><span>Mempool.Config</span></code></h1><p>Mempool filter configuration.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = </span><span>{</span></code><ol><li id="type-t.minimal_fees" class="def record field anchored"><a href="#type-t.minimal_fees" class="anchor"></a><code><span>minimal_fees : <span>int option</span>;</span></code></li><li id="type-t.minimal_nanotez_per_gas_unit" class="def record field anchored"><a href="#type-t.minimal_nanotez_per_gas_unit" class="anchor"></a><code><span>minimal_nanotez_per_gas_unit : <span><span>(int * int)</span> option</span>;</span></code></li><li id="type-t.minimal_nanotez_per_byte" class="def record field anchored"><a href="#type-t.minimal_nanotez_per_byte" class="anchor"></a><code><span>minimal_nanotez_per_byte : <span><span>(int * int)</span> option</span>;</span></code></li><li id="type-t.replace_by_fee_factor" class="def record field anchored"><a href="#type-t.replace_by_fee_factor" class="anchor"></a><code><span>replace_by_fee_factor : <span><span>(int * int)</span> option</span>;</span></code></li><li id="type-t.max_operations" class="def record field anchored"><a href="#type-t.max_operations" class="anchor"></a><code><span>max_operations : <span>int option</span>;</span></code></li><li id="type-t.max_total_bytes" class="def record field anchored"><a href="#type-t.max_total_bytes" class="anchor"></a><code><span>max_total_bytes : <span>int option</span>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Representation of the mempool configuration. <code>None</code> means that the field has been or will be omitted in the json encoding, in which case they are equal to the default values given below.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-to_string"><a href="#val-to_string" class="anchor"></a><code><span><span class="keyword">val</span> to_string : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Build the Ezjsonm representation then encode it as a string.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-check_equal"><a href="#val-check_equal" class="anchor"></a><code><span><span class="keyword">val</span> check_equal : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Call <code>Check.( = )</code> on two configurations.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-of_json"><a href="#val-of_json" class="anchor"></a><code><span><span class="keyword">val</span> of_json : <span><span class="xref-unresolved">Tezt_wrapper</span>.JSON.t <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Return the config corresponding to the given json. If any field is missing, it is set to <code>None</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_minimal_fees"><a href="#val-default_minimal_fees" class="anchor"></a><code><span><span class="keyword">val</span> default_minimal_fees : int</span></code></div><div class="spec-doc"><p>Default value for the <code>minimal_fees</code> field (see src/proto_alpha/lib_plugin/plugin.ml)</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_minimal_nanotez_per_gas_unit"><a href="#val-default_minimal_nanotez_per_gas_unit" class="anchor"></a><code><span><span class="keyword">val</span> default_minimal_nanotez_per_gas_unit : int * int</span></code></div><div class="spec-doc"><p>Default value for the <code>minimal_nanotez_per_gas_unit</code> field (see src/proto_alpha/lib_plugin/plugin.ml)</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_minimal_nanotez_per_byte"><a href="#val-default_minimal_nanotez_per_byte" class="anchor"></a><code><span><span class="keyword">val</span> default_minimal_nanotez_per_byte : int * int</span></code></div><div class="spec-doc"><p>Default value for the <code>minimal_nanotez_per_byte</code> field (see src/proto_alpha/lib_plugin/plugin.ml)</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_replace_by_fee_factor"><a href="#val-default_replace_by_fee_factor" class="anchor"></a><code><span><span class="keyword">val</span> default_replace_by_fee_factor : int * int</span></code></div><div class="spec-doc"><p>Default value for the <code>replace_by_fee_factor</code> field (see src/proto_alpha/lib_plugin/plugin.ml)</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_max_operations"><a href="#val-default_max_operations" class="anchor"></a><code><span><span class="keyword">val</span> default_max_operations : int</span></code></div><div class="spec-doc"><p>Default value for the <code>max_operations</code> field (see src/lib_shell/prevalidator_bounding.ml)</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_max_total_bytes"><a href="#val-default_max_total_bytes" class="anchor"></a><code><span><span class="keyword">val</span> default_max_total_bytes : int</span></code></div><div class="spec-doc"><p>Default value for the <code>max_total_bytes</code> field (see src/lib_shell/prevalidator_bounding.ml)</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default"><a href="#val-default" class="anchor"></a><code><span><span class="keyword">val</span> default : <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Configuration where each field is explicitely set to its default value.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-fill_with_default"><a href="#val-fill_with_default" class="anchor"></a><code><span><span class="keyword">val</span> fill_with_default : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Returns a copy of the given filter config, where missing fields (i.e. containing <code>None</code>) have been set to their default value.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-call_get_filter"><a href="#val-call_get_filter" class="anchor"></a><code><span><span class="keyword">val</span> call_get_filter : 
  <span><span class="optlabel">?endpoint</span>:<a href="../../Client/index.html#type-endpoint">Client.endpoint</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?hooks</span>:<span class="xref-unresolved">Tezt_wrapper</span>.Process.hooks <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?include_default</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Tezt_wrapper</span>.JSON.t <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Call the RPC <code>GET /chains/main/mempool/filter</code> with query parameter <code>include_default</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-check_get_filter_all_variations"><a href="#val-check_get_filter_all_variations" class="anchor"></a><code><span><span class="keyword">val</span> check_get_filter_all_variations : 
  <span><span class="optlabel">?log</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?endpoint</span>:<a href="../../Client/index.html#type-endpoint">Client.endpoint</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?hooks</span>:<span class="xref-unresolved">Tezt_wrapper</span>.Process.hooks <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Check that the RPC <code>GET /chains/main/mempool/filter</code> returns the json corresponding to the provided <a href="#type-t"><code>t</code></a>, testing all possibilities for the optional argument <code>include_default</code> (omitted/<code>true</code>/<code>false</code>).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-post_filter"><a href="#val-post_filter" class="anchor"></a><code><span><span class="keyword">val</span> post_filter : 
  <span><span class="optlabel">?log</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?endpoint</span>:<a href="../../Client/index.html#type-endpoint">Client.endpoint</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?hooks</span>:<span class="xref-unresolved">Tezt_wrapper</span>.Process.hooks <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Tezt_wrapper</span>.JSON.t <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Call the RPC <code>POST /chains/main/mempool/filter</code> with data set to the json representation of the given config <a href="#type-t"><code>t</code></a>.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">log</span> <p>When true, log the input config at the info level. Defaults to false.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-post_filter_str"><a href="#val-post_filter_str" class="anchor"></a><code><span><span class="keyword">val</span> post_filter_str : 
  <span><span class="optlabel">?log</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?endpoint</span>:<a href="../../Client/index.html#type-endpoint">Client.endpoint</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?hooks</span>:<span class="xref-unresolved">Tezt_wrapper</span>.Process.hooks <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Tezt_wrapper</span>.JSON.t <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Same as <a href="#val-post_filter"><code>post_filter</code></a> but takes the data config as a string.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set_filter"><a href="#val-set_filter" class="anchor"></a><code><span><span class="keyword">val</span> set_filter : 
  <span><span class="optlabel">?log</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?endpoint</span>:<a href="../../Client/index.html#type-endpoint">Client.endpoint</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?hooks</span>:<span class="xref-unresolved">Tezt_wrapper</span>.Process.hooks <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?minimal_fees</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?minimal_nanotez_per_gas_unit</span>:<span>(int * int)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?minimal_nanotez_per_byte</span>:<span>(int * int)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?replace_by_fee_factor</span>:<span>(int * int)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?max_operations</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?max_total_bytes</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Set the mempool filter config to the provided parameters. Note that every omitted parameter will be set back to its default value, even if it previously held a different value.</p><p>More precisely, call <a href="#val-post_filter"><code>post_filter</code></a> on the config corresponding to the arguments named after config fields. Then, check that the config returned by the RPC is the same as the input one (where each omitted field has been filled with its default value).</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">log</span> <p>is passed on to <a href="#val-post_filter"><code>post_filter</code></a>.</p></li></ul></div></div></div></body></html>
