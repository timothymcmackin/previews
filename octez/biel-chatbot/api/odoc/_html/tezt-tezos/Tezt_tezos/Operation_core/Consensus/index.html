<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Consensus (tezt-tezos.Tezt_tezos.Operation_core.Consensus)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">tezt-tezos</a> &#x00BB; <a href="../../index.html">Tezt_tezos</a> &#x00BB; <a href="../index.html">Operation_core</a> &#x00BB; Consensus</nav><header class="odoc-preamble"><h1>Module <code><span>Operation_core.Consensus</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div><div class="spec-doc"><p>A representation of a consensus operation.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-consensus"><a href="#val-consensus" class="anchor"></a><code><span><span class="keyword">val</span> consensus : 
  <span><span class="label">kind</span>:<a href="../index.html#type-consensus_kind">consensus_kind</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">slot</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">level</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">round</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">block_payload_hash</span>:string <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>consensus ~kind ~level ~round ~slot ~block_payload_hash</code> crafts a consensus operation with the <code>kind</code> at <code>level</code> on the <code>round</code> with the <code>slot</code> and <code>block_payload_hash</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-preattestation"><a href="#val-preattestation" class="anchor"></a><code><span><span class="keyword">val</span> preattestation : 
  <span><span class="label">slot</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">level</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">round</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">block_payload_hash</span>:string <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>preattestation ~level ~round ~slot ~block_payload_hash</code> crafts a preattestation operation at <code>level</code> on the <code>round</code> with the <code>slot</code> and <code>block_payload_hash</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-attestation"><a href="#val-attestation" class="anchor"></a><code><span><span class="keyword">val</span> attestation : 
  <span><span class="label">slot</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">level</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">round</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">block_payload_hash</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dal_attestation</span>:<span>bool array</span> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>attestation ~level ~round ~slot ~block_payload_hash
      ?dal_attestation ()</code> crafts an attestation operation at the given <code>level</code> on the given <code>round</code> with the given <code>slot</code> and <code>block_payload_hash</code> and optionally the given <code>dal_attestation</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-kind_to_string"><a href="#val-kind_to_string" class="anchor"></a><code><span><span class="keyword">val</span> kind_to_string : <span><a href="../index.html#type-consensus_kind">consensus_kind</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>kind_to_string kind </code> returns the name of the <code>kind</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-operation"><a href="#val-operation" class="anchor"></a><code><span><span class="keyword">val</span> operation : 
  <span><span class="optlabel">?branch</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?chain_id</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">signer</span>:<a href="../../Account/index.html#type-key">Account.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../index.html#type-operation">operation</a> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>operation</code> constructs an operation from a consensus operation. the <code>client</code> is used to fetch the branch and the <code>chain_id</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-inject"><a href="#val-inject" class="anchor"></a><code><span><span class="keyword">val</span> inject : 
  <span><span class="optlabel">?request</span>:<span>[ `Inject <span>| `Notify</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?force</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?branch</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?chain_id</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?error</span>:<span class="xref-unresolved">Tezt_wrapper</span>.Base.rex <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">signer</span>:<a href="../../Account/index.html#type-key">Account.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ <span>`OpHash of string</span> ]</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>A wrapper for <a href="#val-inject"><code>inject</code></a> with consensus operations. The client is used to get all the data that was not provided if it can be recovered via RPCs. Mainly those are the <code>branch</code> and the <code>chain_id</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_slots"><a href="#val-get_slots" class="anchor"></a><code><span><span class="keyword">val</span> get_slots : <span><span class="label">level</span>:int <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Tezt_wrapper</span>.JSON.t <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Retrieves the attestation slots at <code>level</code> by calling the <code>GET
      /chains/&lt;chain&gt;/blocks/&lt;block&gt;/helpers/validators</code> RPC.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-first_slot"><a href="#val-first_slot" class="anchor"></a><code><span><span class="keyword">val</span> first_slot : <span><span class="label">slots_json</span>:<span class="xref-unresolved">Tezt_wrapper</span>.JSON.t <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Account/index.html#type-key">Account.key</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p>Returns the first slot of the provided delegate in the <code>slots_json</code> that describes all attestation rights at some level.</p><p>Causes the test to fail if the delegate is not found.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_block_payload_hash"><a href="#val-get_block_payload_hash" class="anchor"></a><code><span><span class="keyword">val</span> get_block_payload_hash : <span><span class="optlabel">?block</span>:string <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Calls the <code>GET /chains/&lt;chain&gt;/blocks/&lt;block&gt;/header</code> RPC and extracts the head block's payload hash from the result.</p></div></div></div></body></html>
