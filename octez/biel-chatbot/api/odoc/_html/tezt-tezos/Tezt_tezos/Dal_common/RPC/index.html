<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>RPC (tezt-tezos.Tezt_tezos.Dal_common.RPC)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">tezt-tezos</a> &#x00BB; <a href="../../index.html">Tezt_tezos</a> &#x00BB; <a href="../index.html">Dal_common</a> &#x00BB; RPC</nav><header class="odoc-preamble"><h1>Module <code><span>Dal_common.RPC</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-default_uri_provider"><a href="#type-default_uri_provider" class="anchor"></a><code><span><span class="keyword">type</span> default_uri_provider</span><span> = <span><span>(<a href="../../Dal_node/index.html#type-t">Dal_node.t</a>, <a href="../../Endpoint/index.html#type-t">Endpoint.t</a>)</span> <span class="xref-unresolved">Either</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-local_uri_provider"><a href="#type-local_uri_provider" class="anchor"></a><code><span><span class="keyword">type</span> local_uri_provider</span><span> = <a href="../../Dal_node/index.html#type-t">Dal_node.t</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-remote_uri_provider"><a href="#type-remote_uri_provider" class="anchor"></a><code><span><span class="keyword">type</span> remote_uri_provider</span><span> = <a href="../../Endpoint/index.html#type-t">Endpoint.t</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-commitment"><a href="#type-commitment" class="anchor"></a><code><span><span class="keyword">type</span> commitment</span><span> = string</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-operator_profile"><a href="#type-operator_profile" class="anchor"></a><code><span><span class="keyword">type</span> operator_profile</span><span> = </span></code><ol><li id="type-operator_profile.Attester" class="def variant constructor anchored"><a href="#type-operator_profile.Attester" class="anchor"></a><code><span>| </span><span><span class="constructor">Attester</span> <span class="keyword">of</span> string</span></code></li><li id="type-operator_profile.Producer" class="def variant constructor anchored"><a href="#type-operator_profile.Producer" class="anchor"></a><code><span>| </span><span><span class="constructor">Producer</span> <span class="keyword">of</span> int</span></code></li><li id="type-operator_profile.Observer" class="def variant constructor anchored"><a href="#type-operator_profile.Observer" class="anchor"></a><code><span>| </span><span><span class="constructor">Observer</span> <span class="keyword">of</span> int</span></code></li></ol></div><div class="spec-doc"><p>Profiles that operate on shards/slots.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-operator_profiles"><a href="#type-operator_profiles" class="anchor"></a><code><span><span class="keyword">type</span> operator_profiles</span><span> = <span><a href="#type-operator_profile">operator_profile</a> list</span></span></code></div><div class="spec-doc"><p>List of operator profiles.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-profile"><a href="#type-profile" class="anchor"></a><code><span><span class="keyword">type</span> profile</span><span> = </span></code><ol><li id="type-profile.Bootstrap" class="def variant constructor anchored"><a href="#type-profile.Bootstrap" class="anchor"></a><code><span>| </span><span><span class="constructor">Bootstrap</span></span></code></li><li id="type-profile.Operator" class="def variant constructor anchored"><a href="#type-profile.Operator" class="anchor"></a><code><span>| </span><span><span class="constructor">Operator</span> <span class="keyword">of</span> <a href="#type-operator_profiles">operator_profiles</a></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-slot_header"><a href="#type-slot_header" class="anchor"></a><code><span><span class="keyword">type</span> slot_header</span><span> = </span><span>{</span></code><ol><li id="type-slot_header.slot_level" class="def record field anchored"><a href="#type-slot_header.slot_level" class="anchor"></a><code><span>slot_level : int;</span></code></li><li id="type-slot_header.slot_index" class="def record field anchored"><a href="#type-slot_header.slot_index" class="anchor"></a><code><span>slot_index : int;</span></code></li><li id="type-slot_header.commitment" class="def record field anchored"><a href="#type-slot_header.commitment" class="anchor"></a><code><span>commitment : string;</span></code></li><li id="type-slot_header.status" class="def record field anchored"><a href="#type-slot_header.status" class="anchor"></a><code><span>status : string;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Information contained in a slot header fetched from the DAL node.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-slot_header_of_json"><a href="#val-slot_header_of_json" class="anchor"></a><code><span><span class="keyword">val</span> slot_header_of_json : <span><span class="xref-unresolved">Tezt_wrapper</span>.JSON.t <span class="arrow">&#45;&gt;</span></span> <a href="#type-slot_header">slot_header</a></span></code></div><div class="spec-doc"><p><code>slot_header_of_json json</code> decodes <code>json</code> as a slot header. The function fails if the given <code>json</code> cannot be decoded.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-slot_headers_of_json"><a href="#val-slot_headers_of_json" class="anchor"></a><code><span><span class="keyword">val</span> slot_headers_of_json : <span><span class="xref-unresolved">Tezt_wrapper</span>.JSON.t <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-slot_header">slot_header</a> list</span></span></code></div><div class="spec-doc"><p><code>slot_header_of_json json_</code> similar to <a href="#val-slot_header_of_json"><code>slot_header_of_json</code></a>, but the input (and output) is expected to be a list.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-commitment_proof"><a href="#type-commitment_proof" class="anchor"></a><code><span><span class="keyword">type</span> commitment_proof</span><span> = string</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-post_slot"><a href="#val-post_slot" class="anchor"></a><code><span><span class="keyword">val</span> post_slot : 
  <span><span class="optlabel">?slot_index</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Helpers/index.html#type-slot">Helpers.slot</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="#type-commitment">commitment</a> * <a href="#type-commitment_proof">commitment_proof</a>)</span> <a href="../../RPC_core/index.html#type-t">RPC_core.t</a></span></span></code></div><div class="spec-doc"><p>Call RPC &quot;POST /slots&quot; to store a slot and return the commitment and its proof in case of success.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_level_slot_content"><a href="#val-get_level_slot_content" class="anchor"></a><code><span><span class="keyword">val</span> get_level_slot_content : 
  <span><span class="label">slot_level</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">slot_index</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Helpers/index.html#type-slot">Helpers.slot</a> <a href="../../RPC_core/index.html#type-t">RPC_core.t</a></span></span></code></div><div class="spec-doc"><p>Call RPC &quot;GET /levels/&lt;slot_level&gt;/slot/&lt;slot_index&gt;/content&quot; to retrieve the slot content associated with the given level and index.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_level_slot_pages"><a href="#val-get_level_slot_pages" class="anchor"></a><code><span><span class="keyword">val</span> get_level_slot_pages : 
  <span><span class="label">published_level</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">slot_index</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span>string list</span> <a href="../../RPC_core/index.html#type-t">RPC_core.t</a></span></span></code></div><div class="spec-doc"><p><code>get_level_slot_pages ~published_level ~slot_index</code> gets the pages of the slot published at level <code>published_level</code> on slot index <code>slot_index</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_level_index_commitment"><a href="#val-get_level_index_commitment" class="anchor"></a><code><span><span class="keyword">val</span> get_level_index_commitment : 
  <span><span class="label">slot_level</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">slot_index</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-commitment">commitment</a> <a href="../../RPC_core/index.html#type-t">RPC_core.t</a></span></span></code></div><div class="spec-doc"><p>Call RPC &quot;GET /levels/&lt;published_level&gt;/slot_indices/&lt;slot_index&gt;/commitment&quot; to get the commitment associated to the given level and index.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-patch_profiles"><a href="#val-patch_profiles" class="anchor"></a><code><span><span class="keyword">val</span> patch_profiles : <span><a href="#type-operator_profiles">operator_profiles</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="../../RPC_core/index.html#type-t">RPC_core.t</a></span></span></code></div><div class="spec-doc"><p>Call RPC &quot;PATCH /profiles&quot; to update the list of profiles tracked by the DAL node.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_profiles"><a href="#val-get_profiles" class="anchor"></a><code><span><span class="keyword">val</span> get_profiles : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-profile">profile</a> <a href="../../RPC_core/index.html#type-t">RPC_core.t</a></span></span></code></div><div class="spec-doc"><p>Call RPC &quot;GET /profiles&quot; to retrieve the list of profiles tracked by the DAL node.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_level_slot_status"><a href="#val-get_level_slot_status" class="anchor"></a><code><span><span class="keyword">val</span> get_level_slot_status : 
  <span><span class="label">slot_level</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">slot_index</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span>string <a href="../../RPC_core/index.html#type-t">RPC_core.t</a></span></span></code></div><div class="spec-doc"><p>Call RPC &quot;GET /levels/&lt;slot_level&gt;/slots/&lt;slot_index&gt;/status&quot; to get the status known about the given slot.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_assigned_shard_indices"><a href="#val-get_assigned_shard_indices" class="anchor"></a><code><span><span class="keyword">val</span> get_assigned_shard_indices : <span><span class="label">level</span>:int <span class="arrow">&#45;&gt;</span></span> <span><span class="label">pkh</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span>int list</span> <a href="../../RPC_core/index.html#type-t">RPC_core.t</a></span></span></code></div><div class="spec-doc"><p>Call RPC &quot;GET /profiles/&lt;public_key_hash&gt;/attested_levels/&lt;level&gt;/assigned_shard_indices&quot; to get shard ids assigned to the given public key hash at the given level.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-slot_set"><a href="#type-slot_set" class="anchor"></a><code><span><span class="keyword">type</span> slot_set</span><span> = <span>bool list</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-attestable_slots"><a href="#type-attestable_slots" class="anchor"></a><code><span><span class="keyword">type</span> attestable_slots</span><span> = </span></code><ol><li id="type-attestable_slots.Not_in_committee" class="def variant constructor anchored"><a href="#type-attestable_slots.Not_in_committee" class="anchor"></a><code><span>| </span><span><span class="constructor">Not_in_committee</span></span></code></li><li id="type-attestable_slots.Attestable_slots" class="def variant constructor anchored"><a href="#type-attestable_slots.Attestable_slots" class="anchor"></a><code><span>| </span><span><span class="constructor">Attestable_slots</span> <span class="keyword">of</span> <a href="#type-slot_set">slot_set</a></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_attestable_slots"><a href="#val-get_attestable_slots" class="anchor"></a><code><span><span class="keyword">val</span> get_attestable_slots : 
  <span><span class="label">attester</span>:<a href="../../Account/index.html#type-key">Account.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">attested_level</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-attestable_slots">attestable_slots</a> <a href="../../RPC_core/index.html#type-t">RPC_core.t</a></span></span></code></div><div class="spec-doc"><p>Call RPC &quot;GET /profiles/&lt;public_key_hash&gt;/attested_levels/&lt;level&gt;/attestable_slots&quot; to get the slots currently attestable by the given public key hash at the given attested level. The result is either a <code>Not_in_committee</code> or a <code>Attestable_slots flags</code>, where <code>flags</code> is a boolean list of length <code>num_slots</code>. A slot is attestable if it is published at level <code>level -
        attestation_lag</code>) and all the shards assigned to the given attester at level <code>level</code> are available in the DAL node's store.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-delete_p2p_peer_disconnect"><a href="#val-delete_p2p_peer_disconnect" class="anchor"></a><code><span><span class="keyword">val</span> delete_p2p_peer_disconnect : <span><span class="label">peer_id</span>:string <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="../../RPC_core/index.html#type-t">RPC_core.t</a></span></span></code></div><div class="spec-doc"><p>Call RPC &quot;DELETE /p2p/peers/disconnect&quot; to disconnect the node whose identity is given.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-patch_p2p_peers_by_id"><a href="#val-patch_p2p_peers_by_id" class="anchor"></a><code><span><span class="keyword">val</span> patch_p2p_peers_by_id : 
  <span><span class="label">peer_id</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?acl</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span>unit <a href="../../RPC_core/index.html#type-t">RPC_core.t</a></span></span></code></div><div class="spec-doc"><p>Call RPC &quot;PATCH /p2p/peers/by-id/&lt;peer_id&gt;&quot; to patch the ACL of the node whose identity is given. Ignores the output of the RPC.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-topic"><a href="#type-topic" class="anchor"></a><code><span><span class="keyword">type</span> topic</span><span> = </span><span>{</span></code><ol><li id="type-topic.topic_slot_index" class="def record field anchored"><a href="#type-topic.topic_slot_index" class="anchor"></a><code><span>topic_slot_index : int;</span></code></li><li id="type-topic.topic_pkh" class="def record field anchored"><a href="#type-topic.topic_pkh" class="anchor"></a><code><span>topic_pkh : string;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_topics"><a href="#val-get_topics" class="anchor"></a><code><span><span class="keyword">val</span> get_topics : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-topic">topic</a> list</span> <a href="../../RPC_core/index.html#type-t">RPC_core.t</a></span></span></code></div><div class="spec-doc"><p>Call RPC &quot;GET /p2p/gossipsub/topics&quot; to list the topics</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_topics_peers"><a href="#val-get_topics_peers" class="anchor"></a><code><span><span class="keyword">val</span> get_topics_peers : 
  <span><span class="optlabel">?all</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="#type-topic">topic</a> * <span>string list</span>)</span> list</span> <a href="../../RPC_core/index.html#type-t">RPC_core.t</a></span></span></code></div><div class="spec-doc"><p>Call RPC &quot;GET /p2p/gossipsub/topics/peers&quot; to list the peers on each subscribed topic. If <code>all</code> is <code>true</code> (the default is <code>false</code>) then list the peers on each known topic (not only the subscribed ones).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_slot_indexes_peers"><a href="#val-get_slot_indexes_peers" class="anchor"></a><code><span><span class="keyword">val</span> get_slot_indexes_peers : 
  <span><span class="optlabel">?all</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(int * <span>string list</span>)</span> list</span> <a href="../../RPC_core/index.html#type-t">RPC_core.t</a></span></span></code></div><div class="spec-doc"><p>Call RPC &quot;GET /p2p/gossipsub/slot_indexes/peers&quot; to list the peers on each slot index part of a subscribed topic. If <code>all</code> is <code>true</code> (the default is <code>false</code>) then list the peers on each known topic (not only the subscribed ones).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_pkhs_peers"><a href="#val-get_pkhs_peers" class="anchor"></a><code><span><span class="keyword">val</span> get_pkhs_peers : 
  <span><span class="optlabel">?all</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(string * <span>string list</span>)</span> list</span> <a href="../../RPC_core/index.html#type-t">RPC_core.t</a></span></span></code></div><div class="spec-doc"><p>Call RPC &quot;GET /p2p/gossipsub/pkhs/peers&quot; to list the peers on each pkh part of a (all) topic. If <code>all</code> is <code>true</code> (the default is <code>false</code>) then list the peers on each known topic (not only the subscribed ones).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_gossipsub_connections"><a href="#val-get_gossipsub_connections" class="anchor"></a><code><span><span class="keyword">val</span> get_gossipsub_connections : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Tezt_wrapper</span>.JSON.t <a href="../../RPC_core/index.html#type-t">RPC_core.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-peer_score"><a href="#type-peer_score" class="anchor"></a><code><span><span class="keyword">type</span> peer_score</span><span> = </span><span>{</span></code><ol><li id="type-peer_score.peer" class="def record field anchored"><a href="#type-peer_score.peer" class="anchor"></a><code><span>peer : string;</span></code></li><li id="type-peer_score.score" class="def record field anchored"><a href="#type-peer_score.score" class="anchor"></a><code><span>score : float;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_scores"><a href="#val-get_scores" class="anchor"></a><code><span><span class="keyword">val</span> get_scores : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-peer_score">peer_score</a> list</span> <a href="../../RPC_core/index.html#type-t">RPC_core.t</a></span></span></code></div><div class="spec-doc"><p>Call RPC &quot;GET /p2p/gossipsub/scores&quot; to list the scores of peers with a known score.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_plugin_commitments_history_hash"><a href="#val-get_plugin_commitments_history_hash" class="anchor"></a><code><span><span class="keyword">val</span> get_plugin_commitments_history_hash : 
  <span><span class="label">proto_hash</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">hash</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Tezt_wrapper</span>.JSON.t <a href="../../RPC_core/index.html#type-t">RPC_core.t</a></span></span></code></div><div class="spec-doc"><p>Call RPC /plugin/<code>proto_hash</code>/&lt;commitments_history/hash/<code>hash</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_level_slot_shard_content"><a href="#val-get_level_slot_shard_content" class="anchor"></a><code><span><span class="keyword">val</span> get_level_slot_shard_content : 
  <span><span class="label">slot_level</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">slot_index</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">shard_index</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span>string <a href="../../RPC_core/index.html#type-t">RPC_core.t</a></span></span></code></div><div class="spec-doc"><p>Call /levels/&lt;slot_level&gt;/slots/&lt;slot_index&gt;/shards/&lt;shard_index&gt;/content</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unistring_to_json"><a href="#val-unistring_to_json" class="anchor"></a><code><span><span class="keyword">val</span> unistring_to_json : <span>string <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Tezt_wrapper</span>.JSON.u</span></code></div><div class="spec-doc"><p><code>unistring_to_json s</code> converts a possibly invalid UTF-8 string into a JSON object using Data-encoding's unistring representation.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Local"><a href="#module-Local" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Local/index.html">Local</a></span><span> : <a href="../../RPC_core/module-type-CALLERS/index.html">RPC_core.CALLERS</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="../../RPC_core/module-type-CALLERS/index.html#type-uri_provider">uri_provider</a> := <a href="#type-local_uri_provider">local_uri_provider</a></span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Remote"><a href="#module-Remote" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Remote/index.html">Remote</a></span><span> : <a href="../../RPC_core/module-type-CALLERS/index.html">RPC_core.CALLERS</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="../../RPC_core/module-type-CALLERS/index.html#type-uri_provider">uri_provider</a> := <a href="#type-remote_uri_provider">remote_uri_provider</a></span></span></code></div></div></div></body></html>
