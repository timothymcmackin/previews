<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Apply (tezos-protocol-012-Psithaca.Tezos_raw_protocol_012_Psithaca.Apply)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">tezos-protocol-012-Psithaca</a> &#x00BB; <a href="../index.html">Tezos_raw_protocol_012_Psithaca</a> &#x00BB; Apply</nav><header class="odoc-preamble"><h1>Module <code><span>Tezos_raw_protocol_012_Psithaca.Apply</span></code></h1><p>This module supports advancing the ledger state by applying <code>operation</code>s.</p><p>Each operation application takes and returns an <code>Alpha_context.t</code>, representing the old and new state, respectively.</p><p>The <code>Main</code> module provides wrappers for the functionality in this module, satisfying the Protocol signature.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-Wrong_consensus_operation_branch"><a href="#extension-decl-Wrong_consensus_operation_branch" class="anchor"></a><code><span><span class="keyword">type</span> <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-error">Tezos_protocol_environment_012_Psithaca.Error_monad.error</a> += </span></code><ol><li id="extension-Wrong_consensus_operation_branch" class="def variant extension anchored"><a href="#extension-Wrong_consensus_operation_branch" class="anchor"></a><code><span>| </span><span><span class="extension">Wrong_consensus_operation_branch</span> <span class="keyword">of</span> <a href="../../Tezos_protocol_environment_012_Psithaca/Block_hash/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Block_hash.t</a>
  * <a href="../../Tezos_protocol_environment_012_Psithaca/Block_hash/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Block_hash.t</a></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-Wrong_level_for_consensus_operation"><a href="#extension-decl-Wrong_level_for_consensus_operation" class="anchor"></a><code><span><span class="keyword">type</span> <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-error">Tezos_protocol_environment_012_Psithaca.Error_monad.error</a> += </span></code><ol><li id="extension-Wrong_level_for_consensus_operation" class="def variant extension anchored"><a href="#extension-Wrong_level_for_consensus_operation" class="anchor"></a><code><span>| </span><span><span class="extension">Wrong_level_for_consensus_operation</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="module-Apply.expected" class="def record field anchored"><a href="#module-Apply.expected" class="anchor"></a><code><span>expected : <a href="../Alpha_context/Raw_level/index.html#type-t">Alpha_context.Raw_level.t</a>;</span></code></li><li id="module-Apply.provided" class="def record field anchored"><a href="#module-Apply.provided" class="anchor"></a><code><span>provided : <a href="../Alpha_context/Raw_level/index.html#type-t">Alpha_context.Raw_level.t</a>;</span></code></li></ol><code><span>}</span></code></li><li id="extension-Wrong_round_for_consensus_operation" class="def variant extension anchored"><a href="#extension-Wrong_round_for_consensus_operation" class="anchor"></a><code><span>| </span><span><span class="extension">Wrong_round_for_consensus_operation</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="module-Apply.expected" class="def record field anchored"><a href="#module-Apply.expected" class="anchor"></a><code><span>expected : <a href="../Alpha_context/Round/index.html#type-t">Alpha_context.Round.t</a>;</span></code></li><li id="module-Apply.provided" class="def record field anchored"><a href="#module-Apply.provided" class="anchor"></a><code><span>provided : <a href="../Alpha_context/Round/index.html#type-t">Alpha_context.Round.t</a>;</span></code></li></ol><code><span>}</span></code></li><li id="extension-Preendorsement_round_too_high" class="def variant extension anchored"><a href="#extension-Preendorsement_round_too_high" class="anchor"></a><code><span>| </span><span><span class="extension">Preendorsement_round_too_high</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="module-Apply.block_round" class="def record field anchored"><a href="#module-Apply.block_round" class="anchor"></a><code><span>block_round : <a href="../Alpha_context/Round/index.html#type-t">Alpha_context.Round.t</a>;</span></code></li><li id="module-Apply.provided" class="def record field anchored"><a href="#module-Apply.provided" class="anchor"></a><code><span>provided : <a href="../Alpha_context/Round/index.html#type-t">Alpha_context.Round.t</a>;</span></code></li></ol><code><span>}</span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-Internal_operation_replay"><a href="#extension-decl-Internal_operation_replay" class="anchor"></a><code><span><span class="keyword">type</span> <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-error">Tezos_protocol_environment_012_Psithaca.Error_monad.error</a> += </span></code><ol><li id="extension-Internal_operation_replay" class="def variant extension anchored"><a href="#extension-Internal_operation_replay" class="anchor"></a><code><span>| </span><span><span class="extension">Internal_operation_replay</span> <span class="keyword">of</span> <a href="../Alpha_context/index.html#type-packed_internal_operation">Alpha_context.packed_internal_operation</a></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-denunciation_kind"><a href="#type-denunciation_kind" class="anchor"></a><code><span><span class="keyword">type</span> denunciation_kind</span><span> = </span></code><ol><li id="type-denunciation_kind.Preendorsement" class="def variant constructor anchored"><a href="#type-denunciation_kind.Preendorsement" class="anchor"></a><code><span>| </span><span><span class="constructor">Preendorsement</span></span></code></li><li id="type-denunciation_kind.Endorsement" class="def variant constructor anchored"><a href="#type-denunciation_kind.Endorsement" class="anchor"></a><code><span>| </span><span><span class="constructor">Endorsement</span></span></code></li><li id="type-denunciation_kind.Block" class="def variant constructor anchored"><a href="#type-denunciation_kind.Block" class="anchor"></a><code><span>| </span><span><span class="constructor">Block</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-Invalid_denunciation"><a href="#extension-decl-Invalid_denunciation" class="anchor"></a><code><span><span class="keyword">type</span> <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-error">Tezos_protocol_environment_012_Psithaca.Error_monad.error</a> += </span></code><ol><li id="extension-Invalid_denunciation" class="def variant extension anchored"><a href="#extension-Invalid_denunciation" class="anchor"></a><code><span>| </span><span><span class="extension">Invalid_denunciation</span> <span class="keyword">of</span> <a href="#type-denunciation_kind">denunciation_kind</a></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-Inconsistent_denunciation"><a href="#extension-decl-Inconsistent_denunciation" class="anchor"></a><code><span><span class="keyword">type</span> <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-error">Tezos_protocol_environment_012_Psithaca.Error_monad.error</a> += </span></code><ol><li id="extension-Inconsistent_denunciation" class="def variant extension anchored"><a href="#extension-Inconsistent_denunciation" class="anchor"></a><code><span>| </span><span><span class="extension">Inconsistent_denunciation</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="module-Apply.kind" class="def record field anchored"><a href="#module-Apply.kind" class="anchor"></a><code><span>kind : <a href="#type-denunciation_kind">denunciation_kind</a>;</span></code></li><li id="module-Apply.delegate1" class="def record field anchored"><a href="#module-Apply.delegate1" class="anchor"></a><code><span>delegate1 : <a href="../../Tezos_protocol_environment_012_Psithaca/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Signature.Public_key_hash.t</a>;</span></code></li><li id="module-Apply.delegate2" class="def record field anchored"><a href="#module-Apply.delegate2" class="anchor"></a><code><span>delegate2 : <a href="../../Tezos_protocol_environment_012_Psithaca/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Signature.Public_key_hash.t</a>;</span></code></li></ol><code><span>}</span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-Too_early_denunciation"><a href="#extension-decl-Too_early_denunciation" class="anchor"></a><code><span><span class="keyword">type</span> <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-error">Tezos_protocol_environment_012_Psithaca.Error_monad.error</a> += </span></code><ol><li id="extension-Too_early_denunciation" class="def variant extension anchored"><a href="#extension-Too_early_denunciation" class="anchor"></a><code><span>| </span><span><span class="extension">Too_early_denunciation</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="module-Apply.kind" class="def record field anchored"><a href="#module-Apply.kind" class="anchor"></a><code><span>kind : <a href="#type-denunciation_kind">denunciation_kind</a>;</span></code></li><li id="module-Apply.level" class="def record field anchored"><a href="#module-Apply.level" class="anchor"></a><code><span>level : <a href="../Alpha_context/Raw_level/index.html#type-t">Alpha_context.Raw_level.t</a>;</span></code></li><li id="module-Apply.current" class="def record field anchored"><a href="#module-Apply.current" class="anchor"></a><code><span>current : <a href="../Alpha_context/Raw_level/index.html#type-t">Alpha_context.Raw_level.t</a>;</span></code></li></ol><code><span>}</span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-Outdated_denunciation"><a href="#extension-decl-Outdated_denunciation" class="anchor"></a><code><span><span class="keyword">type</span> <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-error">Tezos_protocol_environment_012_Psithaca.Error_monad.error</a> += </span></code><ol><li id="extension-Outdated_denunciation" class="def variant extension anchored"><a href="#extension-Outdated_denunciation" class="anchor"></a><code><span>| </span><span><span class="extension">Outdated_denunciation</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="module-Apply.kind" class="def record field anchored"><a href="#module-Apply.kind" class="anchor"></a><code><span>kind : <a href="#type-denunciation_kind">denunciation_kind</a>;</span></code></li><li id="module-Apply.level" class="def record field anchored"><a href="#module-Apply.level" class="anchor"></a><code><span>level : <a href="../Alpha_context/Raw_level/index.html#type-t">Alpha_context.Raw_level.t</a>;</span></code></li><li id="module-Apply.last_cycle" class="def record field anchored"><a href="#module-Apply.last_cycle" class="anchor"></a><code><span>last_cycle : <a href="../Alpha_context/Cycle/index.html#type-t">Alpha_context.Cycle.t</a>;</span></code></li></ol><code><span>}</span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-Invalid_double_baking_evidence"><a href="#extension-decl-Invalid_double_baking_evidence" class="anchor"></a><code><span><span class="keyword">type</span> <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-error">Tezos_protocol_environment_012_Psithaca.Error_monad.error</a> += </span></code><ol><li id="extension-Invalid_double_baking_evidence" class="def variant extension anchored"><a href="#extension-Invalid_double_baking_evidence" class="anchor"></a><code><span>| </span><span><span class="extension">Invalid_double_baking_evidence</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="module-Apply.hash1" class="def record field anchored"><a href="#module-Apply.hash1" class="anchor"></a><code><span>hash1 : <a href="../../Tezos_protocol_environment_012_Psithaca/Block_hash/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Block_hash.t</a>;</span></code></li><li id="module-Apply.level1" class="def record field anchored"><a href="#module-Apply.level1" class="anchor"></a><code><span>level1 : <a href="../Alpha_context/Raw_level/index.html#type-t">Alpha_context.Raw_level.t</a>;</span></code></li><li id="module-Apply.round1" class="def record field anchored"><a href="#module-Apply.round1" class="anchor"></a><code><span>round1 : <a href="../Alpha_context/Round/index.html#type-t">Alpha_context.Round.t</a>;</span></code></li><li id="module-Apply.hash2" class="def record field anchored"><a href="#module-Apply.hash2" class="anchor"></a><code><span>hash2 : <a href="../../Tezos_protocol_environment_012_Psithaca/Block_hash/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Block_hash.t</a>;</span></code></li><li id="module-Apply.level2" class="def record field anchored"><a href="#module-Apply.level2" class="anchor"></a><code><span>level2 : <a href="../Alpha_context/Raw_level/index.html#type-t">Alpha_context.Raw_level.t</a>;</span></code></li><li id="module-Apply.round2" class="def record field anchored"><a href="#module-Apply.round2" class="anchor"></a><code><span>round2 : <a href="../Alpha_context/Round/index.html#type-t">Alpha_context.Round.t</a>;</span></code></li></ol><code><span>}</span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-Invalid_activation"><a href="#extension-decl-Invalid_activation" class="anchor"></a><code><span><span class="keyword">type</span> <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-error">Tezos_protocol_environment_012_Psithaca.Error_monad.error</a> += </span></code><ol><li id="extension-Invalid_activation" class="def variant extension anchored"><a href="#extension-Invalid_activation" class="anchor"></a><code><span>| </span><span><span class="extension">Invalid_activation</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="module-Apply.pkh" class="def record field anchored"><a href="#module-Apply.pkh" class="anchor"></a><code><span>pkh : <a href="../../Tezos_protocol_environment_012_Psithaca/Ed25519/Public_key_hash/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Ed25519.Public_key_hash.t</a>;</span></code></li></ol><code><span>}</span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-Gas_quota_exceeded_init_deserialize"><a href="#extension-decl-Gas_quota_exceeded_init_deserialize" class="anchor"></a><code><span><span class="keyword">type</span> <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-error">Tezos_protocol_environment_012_Psithaca.Error_monad.error</a> += </span></code><ol><li id="extension-Gas_quota_exceeded_init_deserialize" class="def variant extension anchored"><a href="#extension-Gas_quota_exceeded_init_deserialize" class="anchor"></a><code><span>| </span><span><span class="extension">Gas_quota_exceeded_init_deserialize</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-Inconsistent_sources"><a href="#extension-decl-Inconsistent_sources" class="anchor"></a><code><span><span class="keyword">type</span> <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-error">Tezos_protocol_environment_012_Psithaca.Error_monad.error</a> += </span></code><ol><li id="extension-Inconsistent_sources" class="def variant extension anchored"><a href="#extension-Inconsistent_sources" class="anchor"></a><code><span>| </span><span><span class="extension">Inconsistent_sources</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-Failing_noop_error"><a href="#extension-decl-Failing_noop_error" class="anchor"></a><code><span><span class="keyword">type</span> <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-error">Tezos_protocol_environment_012_Psithaca.Error_monad.error</a> += </span></code><ol><li id="extension-Failing_noop_error" class="def variant extension anchored"><a href="#extension-Failing_noop_error" class="anchor"></a><code><span>| </span><span><span class="extension">Failing_noop_error</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-Empty_transaction"><a href="#extension-decl-Empty_transaction" class="anchor"></a><code><span><span class="keyword">type</span> <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-error">Tezos_protocol_environment_012_Psithaca.Error_monad.error</a> += </span></code><ol><li id="extension-Empty_transaction" class="def variant extension anchored"><a href="#extension-Empty_transaction" class="anchor"></a><code><span>| </span><span><span class="extension">Empty_transaction</span> <span class="keyword">of</span> <a href="../Alpha_context/Contract/index.html#type-t">Alpha_context.Contract.t</a></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-begin_partial_construction"><a href="#val-begin_partial_construction" class="anchor"></a><code><span><span class="keyword">val</span> begin_partial_construction : 
  <span><a href="../Alpha_context/index.html#type-t">Alpha_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">predecessor_level</span>:<a href="../Alpha_context/Level/index.html#type-t">Alpha_context.Level.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">escape_vote</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../Alpha_context/index.html#type-t">Alpha_context.t</a>
   * <span><a href="../Apply_results/index.html#type-packed_successful_manager_operation_result">Apply_results.packed_successful_manager_operation_result</a> list</span>
   * <a href="../Alpha_context/Liquidity_baking/index.html#type-escape_ema">Alpha_context.Liquidity_baking.escape_ema</a>,
    <span><a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-error">Tezos_protocol_environment_012_Psithaca.Error_monad.error</a>
      <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-trace">Tezos_protocol_environment_012_Psithaca.Error_monad.trace</a></span>)</span>
    <a href="../../Tezos_protocol_environment_012_Psithaca/Pervasives/index.html#type-result">Tezos_protocol_environment_012_Psithaca.Pervasives.result</a></span>
    <a href="../../Tezos_protocol_environment_012_Psithaca/Lwt/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Lwt.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-full_construction"><a href="#type-full_construction" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a full_construction</span></span><span> = </span><span>{</span></code><ol><li id="type-full_construction.ctxt" class="def record field anchored"><a href="#type-full_construction.ctxt" class="anchor"></a><code><span>ctxt : <a href="../Alpha_context/index.html#type-t">Alpha_context.t</a>;</span></code></li><li id="type-full_construction.protocol_data" class="def record field anchored"><a href="#type-full_construction.protocol_data" class="anchor"></a><code><span>protocol_data : <span class="type-var">'a</span>;</span></code></li><li id="type-full_construction.payload_producer" class="def record field anchored"><a href="#type-full_construction.payload_producer" class="anchor"></a><code><span>payload_producer : <a href="../../Tezos_protocol_environment_012_Psithaca/Signature/index.html#type-public_key_hash">Tezos_protocol_environment_012_Psithaca.Signature.public_key_hash</a>;</span></code></li><li id="type-full_construction.block_producer" class="def record field anchored"><a href="#type-full_construction.block_producer" class="anchor"></a><code><span>block_producer : <a href="../../Tezos_protocol_environment_012_Psithaca/Signature/index.html#type-public_key_hash">Tezos_protocol_environment_012_Psithaca.Signature.public_key_hash</a>;</span></code></li><li id="type-full_construction.round" class="def record field anchored"><a href="#type-full_construction.round" class="anchor"></a><code><span>round : <a href="../Alpha_context/Round/index.html#type-t">Alpha_context.Round.t</a>;</span></code></li><li id="type-full_construction.implicit_operations_results" class="def record field anchored"><a href="#type-full_construction.implicit_operations_results" class="anchor"></a><code><span>implicit_operations_results : <span><a href="../Apply_results/index.html#type-packed_successful_manager_operation_result">Apply_results.packed_successful_manager_operation_result</a>
                                list</span>;</span></code></li><li id="type-full_construction.liquidity_baking_escape_ema" class="def record field anchored"><a href="#type-full_construction.liquidity_baking_escape_ema" class="anchor"></a><code><span>liquidity_baking_escape_ema : <a href="../Alpha_context/Liquidity_baking/index.html#type-escape_ema">Alpha_context.Liquidity_baking.escape_ema</a>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-begin_full_construction"><a href="#val-begin_full_construction" class="anchor"></a><code><span><span class="keyword">val</span> begin_full_construction : 
  <span><a href="../Alpha_context/index.html#type-t">Alpha_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">predecessor_timestamp</span>:<a href="../../Tezos_protocol_environment_012_Psithaca/Time/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Time.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">predecessor_level</span>:<a href="../Alpha_context/Level/index.html#type-t">Alpha_context.Level.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">predecessor_round</span>:<a href="../Alpha_context/Round/index.html#type-t">Alpha_context.Round.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">round</span>:<a href="../Alpha_context/Round/index.html#type-t">Alpha_context.Round.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Alpha_context/Block_header/index.html#type-contents">Alpha_context.Block_header.contents</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><a href="../Alpha_context/Block_header/index.html#type-contents">Alpha_context.Block_header.contents</a> <a href="#type-full_construction">full_construction</a></span>
    <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_012_Psithaca.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_012_Psithaca/Lwt/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Lwt.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-begin_application"><a href="#val-begin_application" class="anchor"></a><code><span><span class="keyword">val</span> begin_application : 
  <span><a href="../Alpha_context/index.html#type-t">Alpha_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Tezos_protocol_environment_012_Psithaca/Chain_id/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Chain_id.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Alpha_context/Block_header/index.html#type-t">Alpha_context.Block_header.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Alpha_context/Fitness/index.html#type-t">Alpha_context.Fitness.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">predecessor_timestamp</span>:<a href="../../Tezos_protocol_environment_012_Psithaca/Time/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Time.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">predecessor_level</span>:<a href="../Alpha_context/Level/index.html#type-t">Alpha_context.Level.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">predecessor_round</span>:<a href="../Alpha_context/Round/index.html#type-t">Alpha_context.Round.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../Alpha_context/index.html#type-t">Alpha_context.t</a>
   * <a href="../../Tezos_protocol_environment_012_Psithaca/Signature/index.html#type-public_key">Tezos_protocol_environment_012_Psithaca.Signature.public_key</a>
   * <a href="../../Tezos_protocol_environment_012_Psithaca/Signature/index.html#type-public_key_hash">Tezos_protocol_environment_012_Psithaca.Signature.public_key_hash</a>
   * <span><a href="../Apply_results/index.html#type-packed_successful_manager_operation_result">Apply_results.packed_successful_manager_operation_result</a> list</span>
   * <a href="../Alpha_context/Liquidity_baking/index.html#type-escape_ema">Alpha_context.Liquidity_baking.escape_ema</a>)</span>
    <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_012_Psithaca.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_012_Psithaca/Lwt/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Lwt.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-apply_mode"><a href="#type-apply_mode" class="anchor"></a><code><span><span class="keyword">type</span> apply_mode</span><span> = </span></code><ol><li id="type-apply_mode.Application" class="def variant constructor anchored"><a href="#type-apply_mode.Application" class="anchor"></a><code><span>| </span><span><span class="constructor">Application</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-apply_mode.predecessor_block" class="def record field anchored"><a href="#type-apply_mode.predecessor_block" class="anchor"></a><code><span>predecessor_block : <a href="../../Tezos_protocol_environment_012_Psithaca/Block_hash/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Block_hash.t</a>;</span></code></li><li id="type-apply_mode.payload_hash" class="def record field anchored"><a href="#type-apply_mode.payload_hash" class="anchor"></a><code><span>payload_hash : <a href="../Block_payload_hash/index.html#type-t">Block_payload_hash.t</a>;</span></code></li><li id="type-apply_mode.locked_round" class="def record field anchored"><a href="#type-apply_mode.locked_round" class="anchor"></a><code><span>locked_round : <span><a href="../Alpha_context/Round/index.html#type-t">Alpha_context.Round.t</a> option</span>;</span></code></li><li id="type-apply_mode.predecessor_level" class="def record field anchored"><a href="#type-apply_mode.predecessor_level" class="anchor"></a><code><span>predecessor_level : <a href="../Alpha_context/Level/index.html#type-t">Alpha_context.Level.t</a>;</span></code></li><li id="type-apply_mode.predecessor_round" class="def record field anchored"><a href="#type-apply_mode.predecessor_round" class="anchor"></a><code><span>predecessor_round : <a href="../Alpha_context/Round/index.html#type-t">Alpha_context.Round.t</a>;</span></code></li><li id="type-apply_mode.round" class="def record field anchored"><a href="#type-apply_mode.round" class="anchor"></a><code><span>round : <a href="../Alpha_context/Round/index.html#type-t">Alpha_context.Round.t</a>;</span></code></li></ol><code><span>}</span></code></li><li id="type-apply_mode.Full_construction" class="def variant constructor anchored"><a href="#type-apply_mode.Full_construction" class="anchor"></a><code><span>| </span><span><span class="constructor">Full_construction</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-apply_mode.predecessor_block" class="def record field anchored"><a href="#type-apply_mode.predecessor_block" class="anchor"></a><code><span>predecessor_block : <a href="../../Tezos_protocol_environment_012_Psithaca/Block_hash/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Block_hash.t</a>;</span></code></li><li id="type-apply_mode.payload_hash" class="def record field anchored"><a href="#type-apply_mode.payload_hash" class="anchor"></a><code><span>payload_hash : <a href="../Block_payload_hash/index.html#type-t">Block_payload_hash.t</a>;</span></code></li><li id="type-apply_mode.predecessor_level" class="def record field anchored"><a href="#type-apply_mode.predecessor_level" class="anchor"></a><code><span>predecessor_level : <a href="../Alpha_context/Level/index.html#type-t">Alpha_context.Level.t</a>;</span></code></li><li id="type-apply_mode.predecessor_round" class="def record field anchored"><a href="#type-apply_mode.predecessor_round" class="anchor"></a><code><span>predecessor_round : <a href="../Alpha_context/Round/index.html#type-t">Alpha_context.Round.t</a>;</span></code></li><li id="type-apply_mode.round" class="def record field anchored"><a href="#type-apply_mode.round" class="anchor"></a><code><span>round : <a href="../Alpha_context/Round/index.html#type-t">Alpha_context.Round.t</a>;</span></code></li></ol><code><span>}</span></code></li><li id="type-apply_mode.Partial_construction" class="def variant constructor anchored"><a href="#type-apply_mode.Partial_construction" class="anchor"></a><code><span>| </span><span><span class="constructor">Partial_construction</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-apply_mode.predecessor_level" class="def record field anchored"><a href="#type-apply_mode.predecessor_level" class="anchor"></a><code><span>predecessor_level : <a href="../Alpha_context/Level/index.html#type-t">Alpha_context.Level.t</a>;</span></code></li><li id="type-apply_mode.predecessor_round" class="def record field anchored"><a href="#type-apply_mode.predecessor_round" class="anchor"></a><code><span>predecessor_round : <a href="../Alpha_context/Round/index.html#type-t">Alpha_context.Round.t</a>;</span></code></li><li id="type-apply_mode.grand_parent_round" class="def record field anchored"><a href="#type-apply_mode.grand_parent_round" class="anchor"></a><code><span>grand_parent_round : <a href="../Alpha_context/Round/index.html#type-t">Alpha_context.Round.t</a>;</span></code></li></ol><code><span>}</span></code></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-apply_operation"><a href="#val-apply_operation" class="anchor"></a><code><span><span class="keyword">val</span> apply_operation : 
  <span><a href="../Alpha_context/index.html#type-t">Alpha_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Tezos_protocol_environment_012_Psithaca/Chain_id/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Chain_id.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-apply_mode">apply_mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Script_ir_translator/index.html#type-unparsing_mode">Script_ir_translator.unparsing_mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">payload_producer</span>:<a href="../Alpha_context/index.html#type-public_key_hash">Alpha_context.public_key_hash</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Tezos_protocol_environment_012_Psithaca/Operation_list_hash/index.html#type-elt">Tezos_protocol_environment_012_Psithaca.Operation_list_hash.elt</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="../Alpha_context/index.html#type-operation">Alpha_context.operation</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../Alpha_context/index.html#type-t">Alpha_context.t</a> * <span><span class="type-var">'a</span> <a href="../Apply_results/index.html#type-operation_metadata">Apply_results.operation_metadata</a></span>,
    <span><a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-error">Tezos_protocol_environment_012_Psithaca.Error_monad.error</a>
      <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-trace">Tezos_protocol_environment_012_Psithaca.Error_monad.trace</a></span>)</span>
    <a href="../../Tezos_protocol_environment_012_Psithaca/Pervasives/index.html#type-result">Tezos_protocol_environment_012_Psithaca.Pervasives.result</a></span>
    <a href="../../Tezos_protocol_environment_012_Psithaca/Lwt/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Lwt.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-finalize_application_mode"><a href="#type-finalize_application_mode" class="anchor"></a><code><span><span class="keyword">type</span> finalize_application_mode</span><span> = </span></code><ol><li id="type-finalize_application_mode.Finalize_full_construction" class="def variant constructor anchored"><a href="#type-finalize_application_mode.Finalize_full_construction" class="anchor"></a><code><span>| </span><span><span class="constructor">Finalize_full_construction</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-finalize_application_mode.level" class="def record field anchored"><a href="#type-finalize_application_mode.level" class="anchor"></a><code><span>level : <a href="../Alpha_context/Raw_level/index.html#type-t">Alpha_context.Raw_level.t</a>;</span></code></li><li id="type-finalize_application_mode.predecessor_round" class="def record field anchored"><a href="#type-finalize_application_mode.predecessor_round" class="anchor"></a><code><span>predecessor_round : <a href="../Alpha_context/Round/index.html#type-t">Alpha_context.Round.t</a>;</span></code></li></ol><code><span>}</span></code></li><li id="type-finalize_application_mode.Finalize_application" class="def variant constructor anchored"><a href="#type-finalize_application_mode.Finalize_application" class="anchor"></a><code><span>| </span><span><span class="constructor">Finalize_application</span> <span class="keyword">of</span> <a href="../Alpha_context/Fitness/index.html#type-t">Alpha_context.Fitness.t</a></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-finalize_application"><a href="#val-finalize_application" class="anchor"></a><code><span><span class="keyword">val</span> finalize_application : 
  <span><a href="../Alpha_context/index.html#type-t">Alpha_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-finalize_application_mode">finalize_application_mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Alpha_context/Block_header/index.html#type-contents">Alpha_context.Block_header.contents</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">payload_producer</span>:<a href="../Alpha_context/index.html#type-public_key_hash">Alpha_context.public_key_hash</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">block_producer</span>:<a href="../Alpha_context/index.html#type-public_key_hash">Alpha_context.public_key_hash</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Alpha_context/Liquidity_baking/index.html#type-escape_ema">Alpha_context.Liquidity_baking.escape_ema</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Apply_results/index.html#type-packed_successful_manager_operation_result">Apply_results.packed_successful_manager_operation_result</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">round</span>:<a href="../Alpha_context/Round/index.html#type-t">Alpha_context.Round.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">predecessor</span>:<a href="../../Tezos_protocol_environment_012_Psithaca/Block_hash/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Block_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">migration_balance_updates</span>:<a href="../Alpha_context/Receipt/index.html#type-balance_updates">Alpha_context.Receipt.balance_updates</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../Alpha_context/index.html#type-t">Alpha_context.t</a> * <a href="../Alpha_context/Fitness/index.html#type-t">Alpha_context.Fitness.t</a> * <a href="../Apply_results/index.html#type-block_metadata">Apply_results.block_metadata</a>,
    <span><a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-error">Tezos_protocol_environment_012_Psithaca.Error_monad.error</a>
      <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-trace">Tezos_protocol_environment_012_Psithaca.Error_monad.trace</a></span>)</span>
    <a href="../../Tezos_protocol_environment_012_Psithaca/Pervasives/index.html#type-result">Tezos_protocol_environment_012_Psithaca.Pervasives.result</a></span>
    <a href="../../Tezos_protocol_environment_012_Psithaca/Lwt/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Lwt.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-apply_manager_contents_list"><a href="#val-apply_manager_contents_list" class="anchor"></a><code><span><span class="keyword">val</span> apply_manager_contents_list : 
  <span><a href="../Alpha_context/index.html#type-t">Alpha_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Script_ir_translator/index.html#type-unparsing_mode">Script_ir_translator.unparsing_mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">payload_producer</span>:<a href="../Alpha_context/index.html#type-public_key_hash">Alpha_context.public_key_hash</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Tezos_protocol_environment_012_Psithaca/Chain_id/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Chain_id.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><span class="type-var">'a</span> <a href="../Alpha_context/Kind/index.html#type-manager">Alpha_context.Kind.manager</a></span> <a href="../Apply_results/index.html#type-prechecked_contents_list">Apply_results.prechecked_contents_list</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../Alpha_context/index.html#type-t">Alpha_context.t</a>
   * <span><span><span class="type-var">'a</span> <a href="../Alpha_context/Kind/index.html#type-manager">Alpha_context.Kind.manager</a></span> <a href="../Apply_results/index.html#type-contents_result_list">Apply_results.contents_result_list</a></span>)</span>
    <a href="../../Tezos_protocol_environment_012_Psithaca/Lwt/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Lwt.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-apply_contents_list"><a href="#val-apply_contents_list" class="anchor"></a><code><span><span class="keyword">val</span> apply_contents_list : 
  <span><a href="../Alpha_context/index.html#type-t">Alpha_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Tezos_protocol_environment_012_Psithaca/Chain_id/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Chain_id.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-apply_mode">apply_mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Script_ir_translator/index.html#type-unparsing_mode">Script_ir_translator.unparsing_mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">payload_producer</span>:<a href="../Alpha_context/index.html#type-public_key_hash">Alpha_context.public_key_hash</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'kind</span> <a href="../Alpha_context/index.html#type-operation">Alpha_context.operation</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'kind</span> <a href="../Alpha_context/index.html#type-contents_list">Alpha_context.contents_list</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../Alpha_context/index.html#type-t">Alpha_context.t</a> * <span><span class="type-var">'kind</span> <a href="../Apply_results/index.html#type-contents_result_list">Apply_results.contents_result_list</a></span>)</span>
    <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_012_Psithaca.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_012_Psithaca/Lwt/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Lwt.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-precheck_manager_contents_list"><a href="#val-precheck_manager_contents_list" class="anchor"></a><code><span><span class="keyword">val</span> precheck_manager_contents_list : 
  <span><a href="../Alpha_context/index.html#type-t">Alpha_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><span class="type-var">'kind</span> <a href="../Alpha_context/Kind/index.html#type-manager">Alpha_context.Kind.manager</a></span> <a href="../Alpha_context/index.html#type-contents_list">Alpha_context.contents_list</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">mempool_mode</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../Alpha_context/index.html#type-context">Alpha_context.context</a>
   * <span><span><span class="type-var">'kind</span> <a href="../Alpha_context/Kind/index.html#type-manager">Alpha_context.Kind.manager</a></span> <a href="../Apply_results/index.html#type-prechecked_contents_list">Apply_results.prechecked_contents_list</a></span>)</span>
    <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_012_Psithaca.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_012_Psithaca/Lwt/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Lwt.t</a></span></span></code></div><div class="spec-doc"><p><code>precheck_manager_contents_list validation_state contents_list</code> Returns an updated context, and a list of prechecked contents containing balance updates for fees related to each manager operation in <code>contents_list</code></p><p>If <code>mempool_mode</code>, the function checks whether the total gas limit of this batch of operation is below the <code>gas_limit</code> of a block and fails with a permanent error when above. Otherwise, the gas limit of the batch is removed from the one of the block (when possible) before moving on.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-value_of_key"><a href="#val-value_of_key" class="anchor"></a><code><span><span class="keyword">val</span> value_of_key : 
  <span><a href="../Alpha_context/index.html#type-t">Alpha_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Tezos_protocol_environment_012_Psithaca/Context/Cache/index.html#type-key">Tezos_protocol_environment_012_Psithaca.Context.Cache.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../../Tezos_protocol_environment_012_Psithaca/Context/Cache/index.html#type-value">Tezos_protocol_environment_012_Psithaca.Context.Cache.value</a>
    <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_012_Psithaca.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_012_Psithaca/Lwt/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Lwt.t</a></span></span></code></div><div class="spec-doc"><p><code>value_of_key ctxt k</code> builds a value identified by key <code>k</code> so that it can be put into the cache.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-cache_layout"><a href="#val-cache_layout" class="anchor"></a><code><span><span class="keyword">val</span> cache_layout : <span>int list</span></span></code></div><div class="spec-doc"><p><code>cache_layout</code> describes how the caches needed by the protocol. The length of the list defines the number of caches while each element of this list corresponds to the size limit of each cache.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-are_endorsements_required"><a href="#val-are_endorsements_required" class="anchor"></a><code><span><span class="keyword">val</span> are_endorsements_required : 
  <span><a href="../Alpha_context/index.html#type-t">Alpha_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">level</span>:<a href="../Alpha_context/Raw_level/index.html#type-t">Alpha_context.Raw_level.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>bool <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_012_Psithaca.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_012_Psithaca/Lwt/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Lwt.t</a></span></span></code></div><div class="spec-doc"><p>Check if endorsements are required for a given level.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-check_minimum_endorsements"><a href="#val-check_minimum_endorsements" class="anchor"></a><code><span><span class="keyword">val</span> check_minimum_endorsements : 
  <span><span class="label">endorsing_power</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">minimum</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span>unit <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_012_Psithaca.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_012_Psithaca/Lwt/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Lwt.t</a></span></span></code></div><div class="spec-doc"><p>Check if a block's endorsing power is at least the minim required.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-check_manager_signature"><a href="#val-check_manager_signature" class="anchor"></a><code><span><span class="keyword">val</span> check_manager_signature : 
  <span><a href="../Alpha_context/index.html#type-t">Alpha_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Tezos_protocol_environment_012_Psithaca/Chain_id/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Chain_id.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><span class="type-var">'a</span> <a href="../Alpha_context/Kind/index.html#type-manager">Alpha_context.Kind.manager</a></span> <a href="../Alpha_context/index.html#type-contents_list">Alpha_context.contents_list</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'b</span> <a href="../Alpha_context/index.html#type-operation">Alpha_context.operation</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(unit,
    <span><a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-error">Tezos_protocol_environment_012_Psithaca.Error_monad.error</a>
      <a href="../../Tezos_protocol_environment_012_Psithaca/Error_monad/index.html#type-trace">Tezos_protocol_environment_012_Psithaca.Error_monad.trace</a></span>)</span>
    <a href="../../Tezos_protocol_environment_012_Psithaca/Pervasives/index.html#type-result">Tezos_protocol_environment_012_Psithaca.Pervasives.result</a></span>
    <a href="../../Tezos_protocol_environment_012_Psithaca/Lwt/index.html#type-t">Tezos_protocol_environment_012_Psithaca.Lwt.t</a></span></span></code></div><div class="spec-doc"><p><code>check_manager_signature validation_state op raw_operation</code> The function starts by retrieving the public key hash <code>pkh</code> of the manager operation. In case the operation is batched, the function also checks that the sources are all the same. Once the <code>pkh</code> is retrieved, the function looks for its associated public key. For that, the manager operation is inspected to check if it contains a public key revelation. If not, the public key is searched in the context.</p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p><code>Error Invalid_signature</code> if the signature check fails</p></li></ul><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p><code>Error Unrevealed_manager_key</code> if the manager has not yet been revealed</p></li></ul><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p><code>Error Failure &quot;get_manager_key&quot;</code> if the key is not found in the context</p></li></ul><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p><code>Error Inconsistent_sources</code> if the operations in a batch are not from the same manager</p></li></ul></div></div></div></body></html>
