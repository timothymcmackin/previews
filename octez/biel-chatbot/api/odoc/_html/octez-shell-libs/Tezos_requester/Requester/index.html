<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Requester (octez-shell-libs.Tezos_requester.Requester)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">octez-shell-libs</a> &#x00BB; <a href="../index.html">Tezos_requester</a> &#x00BB; Requester</nav><header class="odoc-preamble"><h1>Module <code><span>Tezos_requester.Requester</span></code></h1><p>Generic resource fetching/requesting service.</p><p>This module defines a generic resource fetching service <code>Requester</code>. It is parameterized by abstract services <code>Disk</code>, <code>Request</code>, <code>Memory_table</code> and <code>Probe</code>.</p><p>It offers a key/value store interface. Values are looked up successively in <code>Memory_table.t</code>, then in <code>Disk.store</code>. If not found, they are *requested* using the <code>Request</code> service. Ultimately, values are *cached* in the <code>Memory_table</code> for faster retrieval on subsequent queries. This is similar to a *read-through* cache except that values are never evicted from the <code>Memory_table</code>.</p><p>Internally, the service schedules requests to an abstract external source (e.g. network) for missing keys. The key is then *pending* and the caller waits for the value to be available.</p><p>When a value is missing, the requester sends a request via <code>Request.send</code> to query a value to the network. The requester must be *notified* by an external component when the requested value is available using <code>Requester.notify</code>.</p><p>Notified values are validated before being inserted in the requester, using the <code>Probe</code> module.</p><p>The full resource fetching service is realized by the conjunction of two components. The requester component, defined by this library, and a notifying component (for instance, a worker thread waiting for network messages).</p><p>The requester offers two interfaces. <code>FULL_REQUESTER</code> is the full view, which includes the creation, shutdown, and notification functions. It is to be used by the controller setting up the service, and the notifying component. <code>REQUESTER</code> is the restricted view, exported to the service final user.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-REQUESTER"><a href="#module-type-REQUESTER" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-REQUESTER/index.html">REQUESTER</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-FULL_REQUESTER"><a href="#module-type-FULL_REQUESTER" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-FULL_REQUESTER/index.html">FULL_REQUESTER</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-DISK_TABLE"><a href="#module-type-DISK_TABLE" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-DISK_TABLE/index.html">DISK_TABLE</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-MEMORY_TABLE"><a href="#module-type-MEMORY_TABLE" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-MEMORY_TABLE/index.html">MEMORY_TABLE</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-REQUEST"><a href="#module-type-REQUEST" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-REQUEST/index.html">REQUEST</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><code>Requests</code> abstracts a service used to send asynchronous key requests to peers.</p></div></div><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-PROBE"><a href="#module-type-PROBE" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-PROBE/index.html">PROBE</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>When a requested value is received, it goes to a validation phase.</p></div></div><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-HASH"><a href="#module-type-HASH" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-HASH/index.html">HASH</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>An input module of <a href="Make/index.html"><code>Make</code></a></p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Make"><a href="#module-Make" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Make/index.html">Make</a></span><span>
  (<a href="Make/argument-1-Hash/index.html">Hash</a> : <a href="module-type-HASH/index.html">HASH</a>)
  (<a href="Make/argument-2-Disk_table/index.html">Disk_table</a> : <a href="module-type-DISK_TABLE/index.html">DISK_TABLE</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-DISK_TABLE/index.html#type-key">key</a> := <a href="Make/argument-1-Hash/index.html#type-t">Hash.t</a></span>)
  (<a href="Make/argument-3-Memory_table/index.html">Memory_table</a> : <a href="module-type-MEMORY_TABLE/index.html">MEMORY_TABLE</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-MEMORY_TABLE/index.html#type-key">key</a> := <a href="Make/argument-1-Hash/index.html#type-t">Hash.t</a></span>)
  (<a href="Make/argument-4-Request/index.html">Request</a> : <a href="module-type-REQUEST/index.html">REQUEST</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-REQUEST/index.html#type-key">key</a> := <a href="Make/argument-1-Hash/index.html#type-t">Hash.t</a></span>)
  (<a href="Make/argument-5-Probe/index.html">Probe</a> : <a href="module-type-PROBE/index.html">PROBE</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-PROBE/index.html#type-key">key</a> := <a href="Make/argument-1-Hash/index.html#type-t">Hash.t</a></span> <span class="keyword">and</span> <span><span class="keyword">type</span> <a href="module-type-PROBE/index.html#type-value">value</a> := <a href="Make/argument-2-Disk_table/index.html#type-value">Disk_table.value</a></span>) : 
  <a href="module-type-FULL_REQUESTER/index.html">FULL_REQUESTER</a>
    <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-FULL_REQUESTER/index.html#type-key">key</a> = <a href="Make/argument-1-Hash/index.html#type-t">Hash.t</a></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <a href="module-type-FULL_REQUESTER/index.html#type-value">value</a> = <a href="Make/argument-2-Disk_table/index.html#type-value">Disk_table.value</a></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <a href="module-type-FULL_REQUESTER/index.html#type-param">param</a> = <a href="Make/argument-5-Probe/index.html#type-param">Probe.param</a></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <a href="module-type-FULL_REQUESTER/index.html#type-request_param">request_param</a> = <a href="Make/argument-4-Request/index.html#type-param">Request.param</a></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <a href="module-type-FULL_REQUESTER/index.html#type-notified_value">notified_value</a> = <a href="Make/argument-5-Probe/index.html#type-notified_value">Probe.notified_value</a></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <a href="module-type-FULL_REQUESTER/index.html#type-store">store</a> = <a href="Make/argument-2-Disk_table/index.html#type-store">Disk_table.store</a></span></span></code></div></div></div></body></html>
