<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Staking (tezos-protocol-021-PsQuebec.Tezos_raw_protocol_021_PsQuebec.Alpha_context.Staking)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">tezos-protocol-021-PsQuebec</a> &#x00BB; <a href="../../index.html">Tezos_raw_protocol_021_PsQuebec</a> &#x00BB; <a href="../index.html">Alpha_context</a> &#x00BB; Staking</nav><header class="odoc-preamble"><h1>Module <code><span>Alpha_context.Staking</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value anchored" id="val-stake"><a href="#val-stake" class="anchor"></a><code><span><span class="keyword">val</span> stake : 
  <span><a href="../index.html#type-context">context</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">amount</span>:<span>[ <span>`At_most of <a href="../Tez/index.html#type-t">Tez.t</a></span> <span><span>| `Exactly</span> of <a href="../Tez/index.html#type-t">Tez.t</a></span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">sender</span>:<a href="../index.html#type-public_key_hash">public_key_hash</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">delegate</span>:<a href="../index.html#type-public_key_hash">public_key_hash</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../index.html#type-context">context</a> * <a href="../Receipt/index.html#type-balance_updates">Receipt.balance_updates</a>)</span>
    <a href="../../../Tezos_protocol_environment_021_PsQuebec/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_021_PsQuebec.Error_monad.tzresult</a></span>
    <a href="../../../Tezos_protocol_environment_021_PsQuebec/Lwt/index.html#type-t">Tezos_protocol_environment_021_PsQuebec.Lwt.t</a></span></span></code></div><div class="spec-doc"><p><code>stake ctxt ~sender ~delegate amount</code> add <code>amount</code> as <code>sender</code>'s stake to <code>delegate</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-request_unstake"><a href="#val-request_unstake" class="anchor"></a><code><span><span class="keyword">val</span> request_unstake : 
  <span><a href="../index.html#type-context">context</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">sender_contract</span>:<a href="../Contract/index.html#type-t">Contract.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">delegate</span>:<a href="../index.html#type-public_key_hash">public_key_hash</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Tez/index.html#type-t">Tez.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../index.html#type-context">context</a> * <a href="../Receipt/index.html#type-balance_updates">Receipt.balance_updates</a>)</span>
    <a href="../../../Tezos_protocol_environment_021_PsQuebec/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_021_PsQuebec.Error_monad.tzresult</a></span>
    <a href="../../../Tezos_protocol_environment_021_PsQuebec/Lwt/index.html#type-t">Tezos_protocol_environment_021_PsQuebec.Lwt.t</a></span></span></code></div><div class="spec-doc"><p><code>request_unstake ctxt ~sender_contract ~delegate amount</code> records a request from <code>sender_contract</code> to unstake <code>amount</code> from <code>delegate</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-finalize_unstake"><a href="#val-finalize_unstake" class="anchor"></a><code><span><span class="keyword">val</span> finalize_unstake : 
  <span><a href="../index.html#type-context">context</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Contract/index.html#type-t">Contract.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../index.html#type-context">context</a> * <a href="../Receipt/index.html#type-balance_updates">Receipt.balance_updates</a>)</span>
    <a href="../../../Tezos_protocol_environment_021_PsQuebec/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_021_PsQuebec.Error_monad.tzresult</a></span>
    <a href="../../../Tezos_protocol_environment_021_PsQuebec/Lwt/index.html#type-t">Tezos_protocol_environment_021_PsQuebec.Lwt.t</a></span></span></code></div><div class="spec-doc"><p><code>finalize_unstake ctxt contract</code> performs the finalization of all unstake requests from <code>contract</code> that can be finalized. An unstake request can be finalized if it is old enough, specifically the requested amount must not be at stake anymore and must not be slashable anymore, i.e. after <code>consensus_rights_delay + max_slashing_period</code> after the request. Amounts are transferred from the <code>contract</code>'s delegate (at request time) unstaked frozen deposits to <code>contract</code>'s spendable balance, minus slashing the requested stake undergone in between.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-staking_automation"><a href="#type-staking_automation" class="anchor"></a><code><span><span class="keyword">type</span> staking_automation</span><span> = </span></code><ol><li id="type-staking_automation.Auto_staking" class="def variant constructor anchored"><a href="#type-staking_automation.Auto_staking" class="anchor"></a><code><span>| </span><span><span class="constructor">Auto_staking</span></span></code></li><li id="type-staking_automation.Manual_staking" class="def variant constructor anchored"><a href="#type-staking_automation.Manual_staking" class="anchor"></a><code><span>| </span><span><span class="constructor">Manual_staking</span></span></code></li></ol></div><div class="spec-doc"><p>Staking can be either automated or manual. If Adaptive Issuance is enabled, staking must be manual.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-staking_automation"><a href="#val-staking_automation" class="anchor"></a><code><span><span class="keyword">val</span> staking_automation : <span><a href="../index.html#type-context">context</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-staking_automation">staking_automation</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-check_manual_staking_allowed"><a href="#val-check_manual_staking_allowed" class="anchor"></a><code><span><span class="keyword">val</span> check_manual_staking_allowed : 
  <span><a href="../index.html#type-context">context</a> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <a href="../../../Tezos_protocol_environment_021_PsQuebec/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_021_PsQuebec.Error_monad.tzresult</a></span></span></code></div></div></div></body></html>
