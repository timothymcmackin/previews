<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Worker (octez-libs.Tezos_gossipsub.Worker)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">octez-libs</a> &#x00BB; <a href="../index.html">Tezos_gossipsub</a> &#x00BB; Worker</nav><header class="odoc-preamble"><h1>Module <code><span>Tezos_gossipsub.Worker</span></code></h1></header><nav class="odoc-toc"><ul><li><a href="#parameters">Parameters</a></li><li><a href="#signature">Signature</a></li></ul></nav><div class="odoc-content"><h2 id="parameters"><a href="#parameters" class="anchor"></a>Parameters</h2><div class="odoc-spec"><div class="spec parameter anchored" id="argument-1-C"><a href="#argument-1-C" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="argument-1-C/index.html">C</a></span><span> : <a href="../Gossipsub_intf/module-type-WORKER_CONFIGURATION/index.html">Gossipsub_intf.WORKER_CONFIGURATION</a></span></code></div></div><h2 id="signature"><a href="#signature" class="anchor"></a>Signature</h2><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div><div class="spec-doc"><p>The state of a gossipsub worker.</p></div></div><div class="odoc-include"><div class="spec-doc"><p>We (re-)export the GS, Monad and Stream modules.</p></div><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <a href="../Gossipsub_intf/module-type-WORKER_CONFIGURATION/index.html">Gossipsub_intf.WORKER_CONFIGURATION</a>
  <span class="keyword">with</span> <span><span class="keyword">module</span> <a href="../Gossipsub_intf/module-type-WORKER_CONFIGURATION/GS/index.html">GS</a> = <a href="argument-1-C/GS/index.html">C.GS</a></span>
  <span class="keyword">with</span> <span><span class="keyword">module</span> <a href="argument-1-C/GS/Topic/index.html">GS.Topic</a> = <a href="argument-1-C/GS/Topic/index.html">C.GS.Topic</a></span>
  <span class="keyword">with</span> <span><span class="keyword">module</span> <a href="argument-1-C/GS/Peer/index.html">GS.Peer</a> = <a href="argument-1-C/GS/Peer/index.html">C.GS.Peer</a></span>
  <span class="keyword">with</span> <span><span class="keyword">module</span> <a href="../Gossipsub_intf/module-type-WORKER_CONFIGURATION/Monad/index.html">Monad</a> = <a href="argument-1-C/Monad/index.html">C.Monad</a></span>
  <span class="keyword">with</span> <span><span class="keyword">module</span> <a href="../Gossipsub_intf/module-type-WORKER_CONFIGURATION/Stream/index.html">Stream</a> = <a href="argument-1-C/Stream/index.html">C.Stream</a></span>
  <span class="keyword">with</span> <span><span class="keyword">module</span> <a href="../Gossipsub_intf/module-type-WORKER_CONFIGURATION/Point/index.html">Point</a> = <a href="argument-1-C/Point/index.html">C.Point</a></span></span></code></summary><div class="odoc-spec"><div class="spec module anchored" id="module-GS"><a href="#module-GS" class="anchor"></a><code><span><span class="keyword">module</span> <a href="GS/index.html">GS</a></span><span> : 
  <span class="keyword">module</span> <span class="keyword">type</span> <span class="keyword">of</span> <span class="keyword">struct</span> <span class="keyword">include</span> <a href="argument-1-C/GS/index.html">C.GS</a> <span class="keyword">end</span>
    <span class="keyword">with</span> <span><span class="keyword">module</span> <a href="argument-1-C/GS/Topic/index.html">Topic</a> = <a href="argument-1-C/GS/Topic/index.html">C.GS.Topic</a></span>
    <span class="keyword">with</span> <span><span class="keyword">module</span> <a href="argument-1-C/GS/Peer/index.html">Peer</a> = <a href="argument-1-C/GS/Peer/index.html">C.GS.Peer</a></span></span></code></div><div class="spec-doc"><p>The gossipsub automaton that will be used by the worker.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Point"><a href="#module-Point" class="anchor"></a><code><span><span class="keyword">module</span> Point</span><span> = <a href="argument-1-C/Point/index.html">C.Point</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-maybe_reachable_point"><a href="#val-maybe_reachable_point" class="anchor"></a><code><span><span class="keyword">val</span> maybe_reachable_point : <span><a href="argument-1-C/GS/Peer/index.html#type-t">GS.Peer.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="argument-1-C/Point/index.html#type-t">Point.t</a></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Monad"><a href="#module-Monad" class="anchor"></a><code><span><span class="keyword">module</span> Monad</span><span> = <a href="argument-1-C/Monad/index.html">C.Monad</a></span></code></div><div class="spec-doc"><p>Abstraction of the IO monad used by the worker.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Stream"><a href="#module-Stream" class="anchor"></a><code><span><span class="keyword">module</span> Stream</span><span> = <a href="argument-1-C/Stream/index.html">C.Stream</a></span></code></div><div class="spec-doc"><p>A mutable (FIFO) stream of data.</p></div></div></details></div><div class="odoc-spec"><div class="spec type anchored" id="type-message_with_header"><a href="#type-message_with_header" class="anchor"></a><code><span><span class="keyword">type</span> message_with_header</span><span> = </span><span>{</span></code><ol><li id="type-message_with_header.message" class="def record field anchored"><a href="#type-message_with_header.message" class="anchor"></a><code><span>message : <a href="argument-1-C/GS/Message/index.html#type-t">GS.Message.t</a>;</span></code></li><li id="type-message_with_header.topic" class="def record field anchored"><a href="#type-message_with_header.topic" class="anchor"></a><code><span>topic : <a href="argument-1-C/GS/Topic/index.html#type-t">GS.Topic.t</a>;</span></code></li><li id="type-message_with_header.message_id" class="def record field anchored"><a href="#type-message_with_header.message_id" class="anchor"></a><code><span>message_id : <a href="argument-1-C/GS/Message_id/index.html#type-t">GS.Message_id.t</a>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>A message together with a header, that is, a topic and an id. This corresponds to what the spec calls a &quot;full message&quot;.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-p2p_message"><a href="#type-p2p_message" class="anchor"></a><code><span><span class="keyword">type</span> p2p_message</span><span> = </span></code><ol><li id="type-p2p_message.Graft" class="def variant constructor anchored"><a href="#type-p2p_message.Graft" class="anchor"></a><code><span>| </span><span><span class="constructor">Graft</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-p2p_message.topic" class="def record field anchored"><a href="#type-p2p_message.topic" class="anchor"></a><code><span>topic : <a href="argument-1-C/GS/Topic/index.html#type-t">GS.Topic.t</a>;</span></code></li></ol><code><span>}</span></code></li><li id="type-p2p_message.Prune" class="def variant constructor anchored"><a href="#type-p2p_message.Prune" class="anchor"></a><code><span>| </span><span><span class="constructor">Prune</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-p2p_message.topic" class="def record field anchored"><a href="#type-p2p_message.topic" class="anchor"></a><code><span>topic : <a href="argument-1-C/GS/Topic/index.html#type-t">GS.Topic.t</a>;</span></code></li><li id="type-p2p_message.px" class="def record field anchored"><a href="#type-p2p_message.px" class="anchor"></a><code><span>px : <span><a href="argument-1-C/GS/Peer/index.html#type-t">GS.Peer.t</a> <a href="../../Tezos_error_monad/TzLwtreslib/Seq/index.html#type-t">Tezos_base.TzPervasives.Seq.t</a></span>;</span></code></li><li id="type-p2p_message.backoff" class="def record field anchored"><a href="#type-p2p_message.backoff" class="anchor"></a><code><span>backoff : <a href="argument-1-C/GS/Span/index.html#type-t">GS.Span.t</a>;</span></code></li></ol><code><span>}</span></code></li><li id="type-p2p_message.IHave" class="def variant constructor anchored"><a href="#type-p2p_message.IHave" class="anchor"></a><code><span>| </span><span><span class="constructor">IHave</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-p2p_message.topic" class="def record field anchored"><a href="#type-p2p_message.topic" class="anchor"></a><code><span>topic : <a href="argument-1-C/GS/Topic/index.html#type-t">GS.Topic.t</a>;</span></code></li><li id="type-p2p_message.message_ids" class="def record field anchored"><a href="#type-p2p_message.message_ids" class="anchor"></a><code><span>message_ids : <span><a href="argument-1-C/GS/Message_id/index.html#type-t">GS.Message_id.t</a> list</span>;</span></code></li></ol><code><span>}</span></code></li><li id="type-p2p_message.IWant" class="def variant constructor anchored"><a href="#type-p2p_message.IWant" class="anchor"></a><code><span>| </span><span><span class="constructor">IWant</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-p2p_message.message_ids" class="def record field anchored"><a href="#type-p2p_message.message_ids" class="anchor"></a><code><span>message_ids : <span><a href="argument-1-C/GS/Message_id/index.html#type-t">GS.Message_id.t</a> list</span>;</span></code></li></ol><code><span>}</span></code></li><li id="type-p2p_message.Subscribe" class="def variant constructor anchored"><a href="#type-p2p_message.Subscribe" class="anchor"></a><code><span>| </span><span><span class="constructor">Subscribe</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-p2p_message.topic" class="def record field anchored"><a href="#type-p2p_message.topic" class="anchor"></a><code><span>topic : <a href="argument-1-C/GS/Topic/index.html#type-t">GS.Topic.t</a>;</span></code></li></ol><code><span>}</span></code></li><li id="type-p2p_message.Unsubscribe" class="def variant constructor anchored"><a href="#type-p2p_message.Unsubscribe" class="anchor"></a><code><span>| </span><span><span class="constructor">Unsubscribe</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-p2p_message.topic" class="def record field anchored"><a href="#type-p2p_message.topic" class="anchor"></a><code><span>topic : <a href="argument-1-C/GS/Topic/index.html#type-t">GS.Topic.t</a>;</span></code></li></ol><code><span>}</span></code></li><li id="type-p2p_message.Message_with_header" class="def variant constructor anchored"><a href="#type-p2p_message.Message_with_header" class="anchor"></a><code><span>| </span><span><span class="constructor">Message_with_header</span> <span class="keyword">of</span> <a href="#type-message_with_header">message_with_header</a></span></code></li></ol></div><div class="spec-doc"><p>The following type defines the different kinds of messages a peer could receive from or sent to the P2P layer.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-p2p_input"><a href="#type-p2p_input" class="anchor"></a><code><span><span class="keyword">type</span> p2p_input</span><span> = </span></code><ol><li id="type-p2p_input.In_message" class="def variant constructor anchored"><a href="#type-p2p_input.In_message" class="anchor"></a><code><span>| </span><span><span class="constructor">In_message</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-p2p_input.from_peer" class="def record field anchored"><a href="#type-p2p_input.from_peer" class="anchor"></a><code><span>from_peer : <a href="argument-1-C/GS/Peer/index.html#type-t">GS.Peer.t</a>;</span></code></li><li id="type-p2p_input.p2p_message" class="def record field anchored"><a href="#type-p2p_input.p2p_message" class="anchor"></a><code><span>p2p_message : <a href="#type-p2p_message">p2p_message</a>;</span></code></li></ol><code><span>}</span></code></li><li id="type-p2p_input.New_connection" class="def variant constructor anchored"><a href="#type-p2p_input.New_connection" class="anchor"></a><code><span>| </span><span><span class="constructor">New_connection</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-p2p_input.peer" class="def record field anchored"><a href="#type-p2p_input.peer" class="anchor"></a><code><span>peer : <a href="argument-1-C/GS/Peer/index.html#type-t">GS.Peer.t</a>;</span></code></li><li id="type-p2p_input.direct" class="def record field anchored"><a href="#type-p2p_input.direct" class="anchor"></a><code><span>direct : bool;</span></code></li><li id="type-p2p_input.trusted" class="def record field anchored"><a href="#type-p2p_input.trusted" class="anchor"></a><code><span>trusted : bool;</span></code></li><li id="type-p2p_input.bootstrap" class="def record field anchored"><a href="#type-p2p_input.bootstrap" class="anchor"></a><code><span>bootstrap : bool;</span></code></li></ol><code><span>}</span></code></li><li id="type-p2p_input.Disconnection" class="def variant constructor anchored"><a href="#type-p2p_input.Disconnection" class="anchor"></a><code><span>| </span><span><span class="constructor">Disconnection</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-p2p_input.peer" class="def record field anchored"><a href="#type-p2p_input.peer" class="anchor"></a><code><span>peer : <a href="argument-1-C/GS/Peer/index.html#type-t">GS.Peer.t</a>;</span></code></li></ol><code><span>}</span></code></li></ol></div><div class="spec-doc"><p>The different kinds of input events that could be received from the P2P layer.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-app_input"><a href="#type-app_input" class="anchor"></a><code><span><span class="keyword">type</span> app_input</span><span> = </span></code><ol><li id="type-app_input.Publish_message" class="def variant constructor anchored"><a href="#type-app_input.Publish_message" class="anchor"></a><code><span>| </span><span><span class="constructor">Publish_message</span> <span class="keyword">of</span> <a href="#type-message_with_header">message_with_header</a></span></code></li><li id="type-app_input.Join" class="def variant constructor anchored"><a href="#type-app_input.Join" class="anchor"></a><code><span>| </span><span><span class="constructor">Join</span> <span class="keyword">of</span> <a href="argument-1-C/GS/Topic/index.html#type-t">GS.Topic.t</a></span></code></li><li id="type-app_input.Leave" class="def variant constructor anchored"><a href="#type-app_input.Leave" class="anchor"></a><code><span>| </span><span><span class="constructor">Leave</span> <span class="keyword">of</span> <a href="argument-1-C/GS/Topic/index.html#type-t">GS.Topic.t</a></span></code></li></ol></div><div class="spec-doc"><p>The different kinds of input events that could be received from the application layer.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-peer_origin"><a href="#type-peer_origin" class="anchor"></a><code><span><span class="keyword">type</span> peer_origin</span><span> = </span></code><ol><li id="type-peer_origin.PX" class="def variant constructor anchored"><a href="#type-peer_origin.PX" class="anchor"></a><code><span>| </span><span><span class="constructor">PX</span> <span class="keyword">of</span> <a href="argument-1-C/GS/Peer/index.html#type-t">GS.Peer.t</a></span></code></li><li id="type-peer_origin.Trusted" class="def variant constructor anchored"><a href="#type-peer_origin.Trusted" class="anchor"></a><code><span>| </span><span><span class="constructor">Trusted</span></span></code></li></ol></div><div class="spec-doc"><p>A peer's origin is either another peer (i.e. advertised via PX), or none if it is trusted.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-p2p_output"><a href="#type-p2p_output" class="anchor"></a><code><span><span class="keyword">type</span> p2p_output</span><span> = </span></code><ol><li id="type-p2p_output.Out_message" class="def variant constructor anchored"><a href="#type-p2p_output.Out_message" class="anchor"></a><code><span>| </span><span><span class="constructor">Out_message</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-p2p_output.to_peer" class="def record field anchored"><a href="#type-p2p_output.to_peer" class="anchor"></a><code><span>to_peer : <a href="argument-1-C/GS/Peer/index.html#type-t">GS.Peer.t</a>;</span></code></li><li id="type-p2p_output.p2p_message" class="def record field anchored"><a href="#type-p2p_output.p2p_message" class="anchor"></a><code><span>p2p_message : <a href="#type-p2p_message">p2p_message</a>;</span></code></li></ol><code><span>}</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Emit the given <code>p2p_message</code> to the remote peer <code>to_peer</code>.</p><span class="comment-delim">*)</span></div></li><li id="type-p2p_output.Disconnect" class="def variant constructor anchored"><a href="#type-p2p_output.Disconnect" class="anchor"></a><code><span>| </span><span><span class="constructor">Disconnect</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-p2p_output.peer" class="def record field anchored"><a href="#type-p2p_output.peer" class="anchor"></a><code><span>peer : <a href="argument-1-C/GS/Peer/index.html#type-t">GS.Peer.t</a>;</span></code></li></ol><code><span>}</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>End the connection with the peer <code>peer</code>.</p><span class="comment-delim">*)</span></div></li><li id="type-p2p_output.Kick" class="def variant constructor anchored"><a href="#type-p2p_output.Kick" class="anchor"></a><code><span>| </span><span><span class="constructor">Kick</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-p2p_output.peer" class="def record field anchored"><a href="#type-p2p_output.peer" class="anchor"></a><code><span>peer : <a href="argument-1-C/GS/Peer/index.html#type-t">GS.Peer.t</a>;</span></code></li></ol><code><span>}</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Kick the peer <code>peer</code>: the peer is disconnected and blacklisted.</p><span class="comment-delim">*)</span></div></li><li id="type-p2p_output.Connect" class="def variant constructor anchored"><a href="#type-p2p_output.Connect" class="anchor"></a><code><span>| </span><span><span class="constructor">Connect</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-p2p_output.peer" class="def record field anchored"><a href="#type-p2p_output.peer" class="anchor"></a><code><span>peer : <a href="argument-1-C/GS/Peer/index.html#type-t">GS.Peer.t</a>;</span></code></li><li id="type-p2p_output.origin" class="def record field anchored"><a href="#type-p2p_output.origin" class="anchor"></a><code><span>origin : <a href="#type-peer_origin">peer_origin</a>;</span></code></li></ol><code><span>}</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Inform the p2p_output messages processor that we want to connect to the peer <code>peer</code> advertised by some other peer <code>origin</code>.</p><span class="comment-delim">*)</span></div></li><li id="type-p2p_output.Connect_point" class="def variant constructor anchored"><a href="#type-p2p_output.Connect_point" class="anchor"></a><code><span>| </span><span><span class="constructor">Connect_point</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-p2p_output.point" class="def record field anchored"><a href="#type-p2p_output.point" class="anchor"></a><code><span>point : <a href="argument-1-C/Point/index.html#type-t">Point.t</a>;</span></code></li></ol><code><span>}</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Version of connect where we provide a point directly.</p><span class="comment-delim">*)</span></div></li><li id="type-p2p_output.Forget" class="def variant constructor anchored"><a href="#type-p2p_output.Forget" class="anchor"></a><code><span>| </span><span><span class="constructor">Forget</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-p2p_output.peer" class="def record field anchored"><a href="#type-p2p_output.peer" class="anchor"></a><code><span>peer : <a href="argument-1-C/GS/Peer/index.html#type-t">GS.Peer.t</a>;</span></code></li><li id="type-p2p_output.origin" class="def record field anchored"><a href="#type-p2p_output.origin" class="anchor"></a><code><span>origin : <a href="argument-1-C/GS/Peer/index.html#type-t">GS.Peer.t</a>;</span></code></li></ol><code><span>}</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Inform the p2p_output messages processor that we don't want to connect to the peer <code>peer</code> advertised by some other peer <code>origin</code>.</p><span class="comment-delim">*)</span></div></li></ol></div><div class="spec-doc"><p>The different kinds of outputs that could be emitted by the worker for the P2P layer.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-app_output"><a href="#type-app_output" class="anchor"></a><code><span><span class="keyword">type</span> app_output</span><span> = <a href="#type-message_with_header">message_with_header</a></span></code></div><div class="spec-doc"><p>The application layer will be advertised about full messages it's interested in.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-event"><a href="#type-event" class="anchor"></a><code><span><span class="keyword">type</span> event</span><span> = <span class="keyword">private</span> </span></code><ol><li id="type-event.Heartbeat" class="def variant constructor anchored"><a href="#type-event.Heartbeat" class="anchor"></a><code><span>| </span><span><span class="constructor">Heartbeat</span></span></code></li><li id="type-event.P2P_input" class="def variant constructor anchored"><a href="#type-event.P2P_input" class="anchor"></a><code><span>| </span><span><span class="constructor">P2P_input</span> <span class="keyword">of</span> <a href="#type-p2p_input">p2p_input</a></span></code></li><li id="type-event.App_input" class="def variant constructor anchored"><a href="#type-event.App_input" class="anchor"></a><code><span>| </span><span><span class="constructor">App_input</span> <span class="keyword">of</span> <a href="#type-app_input">app_input</a></span></code></li><li id="type-event.Check_unknown_messages" class="def variant constructor anchored"><a href="#type-event.Check_unknown_messages" class="anchor"></a><code><span>| </span><span><span class="constructor">Check_unknown_messages</span></span></code></li></ol></div><div class="spec-doc"><p>The different kinds of events the Gossipsub worker handles.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-make"><a href="#val-make" class="anchor"></a><code><span><span class="keyword">val</span> make : 
  <span><span class="optlabel">?events_logging</span>:<span>(<span><a href="#type-event">event</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="argument-1-C/Monad/index.html#type-t">Monad.t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?bootstrap_points</span>:<span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="argument-1-C/Point/index.html#type-t">Point.t</a> list</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">self</span>:<a href="argument-1-C/GS/Peer/index.html#type-t">GS.Peer.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Stdlib</span>.Random.State.t <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="argument-1-C/GS/Topic/index.html#type-t">GS.Topic.t</a>, <a href="argument-1-C/GS/Peer/index.html#type-t">GS.Peer.t</a>, <a href="argument-1-C/GS/Message_id/index.html#type-t">GS.Message_id.t</a>, <a href="GS/index.html#type-span">GS.span</a>)</span> <a href="../Gossipsub_intf/index.html#type-limits">Gossipsub_intf.limits</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="argument-1-C/GS/Peer/index.html#type-t">GS.Peer.t</a>, <a href="argument-1-C/GS/Message_id/index.html#type-t">GS.Message_id.t</a>)</span> <a href="../Gossipsub_intf/index.html#type-parameters">Gossipsub_intf.parameters</a></span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>make ~events_logging ~bootstrap_points rng limits parameters</code> initializes a new Gossipsub automaton with the given arguments. Then, it initializes and returns a worker for it. The <code>events_logging</code> function can be used to define a handler for logging the worker's events. <code>bootstrap_points</code> allows to resolve a list of known peers' addresses to which we may want to reconnect in the worker.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-start"><a href="#val-start" class="anchor"></a><code><span><span class="keyword">val</span> start : <span><span><a href="argument-1-C/GS/Topic/index.html#type-t">GS.Topic.t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>start topics state</code> runs the (not already started) worker whose <code>state</code> is given together with the initial list of <code>topics</code> the caller is interested in.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-shutdown"><a href="#val-shutdown" class="anchor"></a><code><span><span class="keyword">val</span> shutdown : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="argument-1-C/Monad/index.html#type-t">Monad.t</a></span></span></code></div><div class="spec-doc"><p><code>shutdown state</code> allows stopping the worker whose <code>state</code> is given.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-app_input"><a href="#val-app_input" class="anchor"></a><code><span><span class="keyword">val</span> app_input : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-app_input">app_input</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>app_input state app_input</code> adds the given application input <code>app_input</code> to the worker's input stream.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set_unreachable_point"><a href="#val-set_unreachable_point" class="anchor"></a><code><span><span class="keyword">val</span> set_unreachable_point : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="argument-1-C/Point/index.html#type-t">Point.t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>set_unreachable_point state point</code> declares this point as unreachable.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-p2p_input"><a href="#val-p2p_input" class="anchor"></a><code><span><span class="keyword">val</span> p2p_input : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-p2p_input">p2p_input</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>p2p_input state p2p_input</code> adds the given P2P input <code>p2p_input</code> to the worker's input stream.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-p2p_output_stream"><a href="#val-p2p_output_stream" class="anchor"></a><code><span><span class="keyword">val</span> p2p_output_stream : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-p2p_output">p2p_output</a> <a href="argument-1-C/Stream/index.html#type-t">Stream.t</a></span></span></code></div><div class="spec-doc"><p><code>p2p_output_stream t</code> returns the output stream containing data for the P2P layer.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-app_output_stream"><a href="#val-app_output_stream" class="anchor"></a><code><span><span class="keyword">val</span> app_output_stream : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-app_output">app_output</a> <a href="argument-1-C/Stream/index.html#type-t">Stream.t</a></span></span></code></div><div class="spec-doc"><p><code>app_output_stream t</code> returns the output stream containing data for the application layer.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-input_events_stream"><a href="#val-input_events_stream" class="anchor"></a><code><span><span class="keyword">val</span> input_events_stream : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-event">event</a> <a href="argument-1-C/Stream/index.html#type-t">Stream.t</a></span></span></code></div><div class="spec-doc"><p><code>input_events_stream t</code> returns the input stream in which we push events to be processed by the worker.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_subscribed"><a href="#val-is_subscribed" class="anchor"></a><code><span><span class="keyword">val</span> is_subscribed : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="argument-1-C/GS/Topic/index.html#type-t">GS.Topic.t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_subscribed t topic</code> checks whether <code>topic</code> is in the mesh of <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_p2p_output"><a href="#val-pp_p2p_output" class="anchor"></a><code><span><span class="keyword">val</span> pp_p2p_output : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-p2p_output">p2p_output</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Pretty-printer for values of type <a href="#type-p2p_output"><code>p2p_output</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_app_output"><a href="#val-pp_app_output" class="anchor"></a><code><span><span class="keyword">val</span> pp_app_output : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-app_output">app_output</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Pretty-printer for values of type <a href="#type-app_output"><code>app_output</code></a>.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Introspection"><a href="#module-Introspection" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Introspection/index.html">Introspection</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Introspection and stats facilities</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-stats"><a href="#val-stats" class="anchor"></a><code><span><span class="keyword">val</span> stats : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="Introspection/index.html#type-stats">Introspection.stats</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-state"><a href="#val-state" class="anchor"></a><code><span><span class="keyword">val</span> state : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="argument-1-C/GS/Introspection/index.html#type-view">GS.Introspection.view</a></span></code></div></div></div></body></html>
