<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Score (octez-libs.Tezos_gossipsub.Gossipsub_intf.AUTOMATON.Score)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../../index.html">octez-libs</a> &#x00BB; <a href="../../../index.html">Tezos_gossipsub</a> &#x00BB; <a href="../../index.html">Gossipsub_intf</a> &#x00BB; <a href="../index.html">AUTOMATON</a> &#x00BB; Score</nav><header class="odoc-preamble"><h1>Module <code><span>AUTOMATON.Score</span></code></h1><p>Module for peers scores</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div><div class="spec-doc"><p>The type of peer scoring statistics.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-value"><a href="#type-value" class="anchor"></a><code><span><span class="keyword">type</span> value</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-span"><a href="#type-span" class="anchor"></a><code><span><span class="keyword">type</span> span</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-time"><a href="#type-time" class="anchor"></a><code><span><span class="keyword">type</span> time</span><span> = <a href="../Time/index.html#type-t">Time.t</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-topic"><a href="#type-topic" class="anchor"></a><code><span><span class="keyword">type</span> topic</span><span> = <a href="../Topic/index.html#type-t">Topic.t</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-newly_connected"><a href="#val-newly_connected" class="anchor"></a><code><span><span class="keyword">val</span> newly_connected : <span><span><span>(<a href="#type-topic">topic</a>, <a href="#type-span">span</a>)</span> <a href="../../index.html#type-score_limits">score_limits</a></span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>newly_connected params</code> creates a fresh statistics record.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-value"><a href="#val-value" class="anchor"></a><code><span><span class="keyword">val</span> value : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-value">value</a></span></code></div><div class="spec-doc"><p><code>value ps</code> evaluates the score of <code>ps</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-penalty"><a href="#val-penalty" class="anchor"></a><code><span><span class="keyword">val</span> penalty : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>penalty ps penalty</code> increments the behavioural penalty of <code>ps</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set_connected"><a href="#val-set_connected" class="anchor"></a><code><span><span class="keyword">val</span> set_connected : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>set_connected ps</code> marks <code>ps</code> as being associated to a connected peer.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-remove_peer"><a href="#val-remove_peer" class="anchor"></a><code><span><span class="keyword">val</span> remove_peer : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">retain_duration</span>:<a href="#type-span">span</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> option</span></span></code></div><div class="spec-doc"><p><code>remove_peer ps ~retain_duration</code> will either return <code>None</code> if the peer statistics can be cleared, or <code>Some ps'</code> with <code>ps'</code> some statistics to be retained for at least <code>retain_duration</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-expires"><a href="#val-expires" class="anchor"></a><code><span><span class="keyword">val</span> expires : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-time">time</a> option</span></span></code></div><div class="spec-doc"><p><code>expires ps</code> returns <code>None</code> if the score statistics has no expiration time or <code>Some t</code> if it expires at time <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-graft"><a href="#val-graft" class="anchor"></a><code><span><span class="keyword">val</span> graft : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-topic">topic</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>graft ps topic</code> allows to measure the time spent by the peer in the mesh. It is to be called upon grafting a peer to <code>topic</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-prune"><a href="#val-prune" class="anchor"></a><code><span><span class="keyword">val</span> prune : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-topic">topic</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>prune ps topic</code> allows to measure the time spent by the peer in the mesh. It is to be called upon pruning a peer from <code>topic</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-first_message_delivered"><a href="#val-first_message_delivered" class="anchor"></a><code><span><span class="keyword">val</span> first_message_delivered : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-topic">topic</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>first_message_delivered ps topic</code> increments the counter related to first message deliveries and mesh message deliveries on <code>topic</code> by the associated peer.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-duplicate_message_delivered"><a href="#val-duplicate_message_delivered" class="anchor"></a><code><span><span class="keyword">val</span> duplicate_message_delivered : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-topic">topic</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-time">time</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>duplicate_message_delivered ps topic validated</code> increments the counter related to near-first mesh message deliveries on <code>topic</code> by the associated peer. <code>validated</code> is the time at which the message was seen by the automaton for the first time.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-invalid_message_delivered"><a href="#val-invalid_message_delivered" class="anchor"></a><code><span><span class="keyword">val</span> invalid_message_delivered : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-topic">topic</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>invalid_message_delivered ps topic</code> increments the counter related to invalid messages sent by the associated peer.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set_application_score"><a href="#val-set_application_score" class="anchor"></a><code><span><span class="keyword">val</span> set_application_score : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>float <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>set_application_score ps score</code> sets the application-specific score. This score can be positive or negative.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-refresh"><a href="#val-refresh" class="anchor"></a><code><span><span class="keyword">val</span> refresh : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> option</span></span></code></div><div class="spec-doc"><p><code>refresh ps</code> returns <code>Some ps'</code> with <code>ps'</code> a refreshed score record or <code>None</code> if the score expired. Refreshing a <code>ps</code> allows to update time-dependent spects of the scoring statistics.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-zero"><a href="#val-zero" class="anchor"></a><code><span><span class="keyword">val</span> zero : <a href="#type-value">value</a></span></code></div><div class="spec-doc"><p>The zero score value, corresponding to a neutral score.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-of_float"><a href="#val-of_float" class="anchor"></a><code><span><span class="keyword">val</span> of_float : <span>float <span class="arrow">&#45;&gt;</span></span> <a href="#type-value">value</a></span></code></div><div class="spec-doc"><p>Convert a float into a score value.</p></div></div><div class="odoc-include"><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <a href="../../../../Tezos_stdlib/Compare/module-type-S/index.html">Tezos_stdlib.Compare.S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="../../../../Tezos_stdlib/Compare/module-type-S/index.html#type-t">t</a> := <a href="#type-value">value</a></span></span></code></summary><div class="odoc-spec"><div class="spec value anchored" id="val-(=)"><a href="#val-(=)" class="anchor"></a><code><span><span class="keyword">val</span> (=) : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>x = y</code> iff <code>compare x y = 0</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-(&lt;&gt;)"><a href="#val-(&lt;&gt;)" class="anchor"></a><code><span><span class="keyword">val</span> (&lt;&gt;) : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>x &lt;&gt; y</code> iff <code>compare x y &lt;&gt; 0</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-(&lt;)"><a href="#val-(&lt;)" class="anchor"></a><code><span><span class="keyword">val</span> (&lt;) : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>x &lt; y</code> iff <code>compare x y &lt; 0</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-(&lt;=)"><a href="#val-(&lt;=)" class="anchor"></a><code><span><span class="keyword">val</span> (&lt;=) : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>x &lt;= y</code> iff <code>compare x y &lt;= 0</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-(&gt;=)"><a href="#val-(&gt;=)" class="anchor"></a><code><span><span class="keyword">val</span> (&gt;=) : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>x &gt;= y</code> iff <code>compare x y &gt;= 0</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-(&gt;)"><a href="#val-(&gt;)" class="anchor"></a><code><span><span class="keyword">val</span> (&gt;) : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>x &gt; y</code> iff <code>compare x y &gt; 0</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-compare"><a href="#val-compare" class="anchor"></a><code><span><span class="keyword">val</span> compare : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p><code>compare</code> an alias for the functor parameter's <code>compare</code> function</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-equal"><a href="#val-equal" class="anchor"></a><code><span><span class="keyword">val</span> equal : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>equal x y</code> iff <code>compare x y = 0</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-max"><a href="#val-max" class="anchor"></a><code><span><span class="keyword">val</span> max : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-value">value</a></span></code></div><div class="spec-doc"><p><code>max x y</code> is <code>x</code> if <code>x &gt;= y</code> otherwise it is <code>y</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-min"><a href="#val-min" class="anchor"></a><code><span><span class="keyword">val</span> min : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-value">value</a></span></code></div><div class="spec-doc"><p><code>min x y</code> is <code>x</code> if <code>x &lt;= y</code> otherwise it is <code>y</code></p></div></div></details></div><div class="odoc-include"><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <a href="../../../../Tezos_base/TzPervasives/module-type-PRINTABLE/index.html">Tezos_base.TzPervasives.PRINTABLE</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="../../../../Tezos_base/TzPervasives/module-type-PRINTABLE/index.html#type-t">t</a> := <a href="#type-t">t</a></span></span></code></summary><div class="odoc-spec"><div class="spec value anchored" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span><span class="keyword">val</span> pp : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div></details></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_value"><a href="#val-pp_value" class="anchor"></a><code><span><span class="keyword">val</span> pp_value : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Introspection"><a href="#module-Introspection" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Introspection/index.html">Introspection</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Internal_for_tests"><a href="#module-Internal_for_tests" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Internal_for_tests/index.html">Internal_for_tests</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div></div></body></html>
