<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>GS (octez-libs.Tezos_gossipsub.Gossipsub_intf.WORKER_CONFIGURATION.GS)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../../index.html">octez-libs</a> &#x00BB; <a href="../../../index.html">Tezos_gossipsub</a> &#x00BB; <a href="../../index.html">Gossipsub_intf</a> &#x00BB; <a href="../index.html">WORKER_CONFIGURATION</a> &#x00BB; GS</nav><header class="odoc-preamble"><h1>Module <code><span>WORKER_CONFIGURATION.GS</span></code></h1><p>The gossipsub automaton that will be used by the worker.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec module anchored" id="module-Peer"><a href="#module-Peer" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Peer/index.html">Peer</a></span><span> : <a href="../../module-type-ITERABLE/index.html">ITERABLE</a></span></code></div><div class="spec-doc"><p>Module for peer</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Topic"><a href="#module-Topic" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Topic/index.html">Topic</a></span><span> : <a href="../../module-type-ITERABLE/index.html">ITERABLE</a></span></code></div><div class="spec-doc"><p>Module for topic</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Message_id"><a href="#module-Message_id" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Message_id/index.html">Message_id</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Module for message_id</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Message"><a href="#module-Message" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Message/index.html">Message</a></span><span> : <a href="../../../../Tezos_base/TzPervasives/module-type-PRINTABLE/index.html">Tezos_base.TzPervasives.PRINTABLE</a></span></code></div><div class="spec-doc"><p>Module for message</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Time"><a href="#module-Time" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Time/index.html">Time</a></span><span> : <a href="../../../../Tezos_base/TzPervasives/module-type-PRINTABLE/index.html">Tezos_base.TzPervasives.PRINTABLE</a></span></code></div><div class="spec-doc"><p>Module for time</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Span"><a href="#module-Span" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Span/index.html">Span</a></span><span> : <a href="../../module-type-SPAN/index.html">SPAN</a></span></code></div><div class="spec-doc"><p>Module for time duration</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Score"><a href="#module-Score" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Score/index.html">Score</a></span><span> : <a href="../../module-type-SCORE/index.html">SCORE</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="../../module-type-SCORE/index.html#type-time">time</a> = <a href="Time/index.html#type-t">Time.t</a></span> <span class="keyword">and</span> <span><span class="keyword">type</span> <a href="../../module-type-SCORE/index.html#type-topic">topic</a> = <a href="Topic/index.html#type-t">Topic.t</a></span></span></code></div><div class="spec-doc"><p>Module for peers scores</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-message"><a href="#type-message" class="anchor"></a><code><span><span class="keyword">type</span> message</span><span> = <a href="Message/index.html#type-t">Message.t</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-span"><a href="#type-span" class="anchor"></a><code><span><span class="keyword">type</span> span</span><span> = <a href="Span/index.html#type-t">Span.t</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-state"><a href="#type-state" class="anchor"></a><code><span><span class="keyword">type</span> state</span></code></div><div class="spec-doc"><p>The state managed by the gossipsub automaton. The state is purely functional.</p></div></div><div class="odoc-spec"><div class="spec type subst anchored" id="type-limits"><a href="#type-limits" class="anchor"></a><code><span><span class="keyword">type</span> limits</span><span> := <span><span>(<a href="Topic/index.html#type-t">Topic.t</a>, <a href="Peer/index.html#type-t">Peer.t</a>, <a href="Message_id/index.html#type-t">Message_id.t</a>, <a href="#type-span">span</a>)</span> <a href="../../index.html#type-limits">limits</a></span></span></code></div><div class="spec-doc"><p>Limits of the gossipsub protocol.</p></div></div><div class="odoc-spec"><div class="spec type subst anchored" id="type-parameters"><a href="#type-parameters" class="anchor"></a><code><span><span class="keyword">type</span> parameters</span><span> := <span><span>(<a href="Peer/index.html#type-t">Peer.t</a>, <a href="Message_id/index.html#type-t">Message_id.t</a>)</span> <a href="../../index.html#type-parameters">parameters</a></span></span></code></div><div class="spec-doc"><p>Parameters of the gossipsub protocol.</p></div></div><p>The types of payloads for inputs to the gossipsub automaton.</p><div class="odoc-spec"><div class="spec type anchored" id="type-add_peer"><a href="#type-add_peer" class="anchor"></a><code><span><span class="keyword">type</span> add_peer</span><span> = </span><span>{</span></code><ol><li id="type-add_peer.direct" class="def record field anchored"><a href="#type-add_peer.direct" class="anchor"></a><code><span>direct : bool;</span></code></li><li id="type-add_peer.outbound" class="def record field anchored"><a href="#type-add_peer.outbound" class="anchor"></a><code><span>outbound : bool;</span></code></li><li id="type-add_peer.peer" class="def record field anchored"><a href="#type-add_peer.peer" class="anchor"></a><code><span>peer : <a href="Peer/index.html#type-t">Peer.t</a>;</span></code></li><li id="type-add_peer.bootstrap" class="def record field anchored"><a href="#type-add_peer.bootstrap" class="anchor"></a><code><span>bootstrap : bool;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-remove_peer"><a href="#type-remove_peer" class="anchor"></a><code><span><span class="keyword">type</span> remove_peer</span><span> = </span><span>{</span></code><ol><li id="type-remove_peer.peer" class="def record field anchored"><a href="#type-remove_peer.peer" class="anchor"></a><code><span>peer : <a href="Peer/index.html#type-t">Peer.t</a>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-ihave"><a href="#type-ihave" class="anchor"></a><code><span><span class="keyword">type</span> ihave</span><span> = </span><span>{</span></code><ol><li id="type-ihave.peer" class="def record field anchored"><a href="#type-ihave.peer" class="anchor"></a><code><span>peer : <a href="Peer/index.html#type-t">Peer.t</a>;</span></code></li><li id="type-ihave.topic" class="def record field anchored"><a href="#type-ihave.topic" class="anchor"></a><code><span>topic : <a href="Topic/index.html#type-t">Topic.t</a>;</span></code></li><li id="type-ihave.message_ids" class="def record field anchored"><a href="#type-ihave.message_ids" class="anchor"></a><code><span>message_ids : <span><a href="Message_id/index.html#type-t">Message_id.t</a> list</span>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-iwant"><a href="#type-iwant" class="anchor"></a><code><span><span class="keyword">type</span> iwant</span><span> = </span><span>{</span></code><ol><li id="type-iwant.peer" class="def record field anchored"><a href="#type-iwant.peer" class="anchor"></a><code><span>peer : <a href="Peer/index.html#type-t">Peer.t</a>;</span></code></li><li id="type-iwant.message_ids" class="def record field anchored"><a href="#type-iwant.message_ids" class="anchor"></a><code><span>message_ids : <span><a href="Message_id/index.html#type-t">Message_id.t</a> list</span>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-graft"><a href="#type-graft" class="anchor"></a><code><span><span class="keyword">type</span> graft</span><span> = </span><span>{</span></code><ol><li id="type-graft.peer" class="def record field anchored"><a href="#type-graft.peer" class="anchor"></a><code><span>peer : <a href="Peer/index.html#type-t">Peer.t</a>;</span></code></li><li id="type-graft.topic" class="def record field anchored"><a href="#type-graft.topic" class="anchor"></a><code><span>topic : <a href="Topic/index.html#type-t">Topic.t</a>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-prune"><a href="#type-prune" class="anchor"></a><code><span><span class="keyword">type</span> prune</span><span> = </span><span>{</span></code><ol><li id="type-prune.peer" class="def record field anchored"><a href="#type-prune.peer" class="anchor"></a><code><span>peer : <a href="Peer/index.html#type-t">Peer.t</a>;</span></code></li><li id="type-prune.topic" class="def record field anchored"><a href="#type-prune.topic" class="anchor"></a><code><span>topic : <a href="Topic/index.html#type-t">Topic.t</a>;</span></code></li><li id="type-prune.px" class="def record field anchored"><a href="#type-prune.px" class="anchor"></a><code><span>px : <span><a href="Peer/index.html#type-t">Peer.t</a> <a href="../../../../Tezos_error_monad/TzLwtreslib/Seq/index.html#type-t">Tezos_base.TzPervasives.Seq.t</a></span>;</span></code></li><li id="type-prune.backoff" class="def record field anchored"><a href="#type-prune.backoff" class="anchor"></a><code><span>backoff : <a href="#type-span">span</a>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-publish_message"><a href="#type-publish_message" class="anchor"></a><code><span><span class="keyword">type</span> publish_message</span><span> = </span><span>{</span></code><ol><li id="type-publish_message.topic" class="def record field anchored"><a href="#type-publish_message.topic" class="anchor"></a><code><span>topic : <a href="Topic/index.html#type-t">Topic.t</a>;</span></code></li><li id="type-publish_message.message_id" class="def record field anchored"><a href="#type-publish_message.message_id" class="anchor"></a><code><span>message_id : <a href="Message_id/index.html#type-t">Message_id.t</a>;</span></code></li><li id="type-publish_message.message" class="def record field anchored"><a href="#type-publish_message.message" class="anchor"></a><code><span>message : <a href="#type-message">message</a>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-receive_message"><a href="#type-receive_message" class="anchor"></a><code><span><span class="keyword">type</span> receive_message</span><span> = </span><span>{</span></code><ol><li id="type-receive_message.sender" class="def record field anchored"><a href="#type-receive_message.sender" class="anchor"></a><code><span>sender : <a href="Peer/index.html#type-t">Peer.t</a>;</span></code></li><li id="type-receive_message.topic" class="def record field anchored"><a href="#type-receive_message.topic" class="anchor"></a><code><span>topic : <a href="Topic/index.html#type-t">Topic.t</a>;</span></code></li><li id="type-receive_message.message_id" class="def record field anchored"><a href="#type-receive_message.message_id" class="anchor"></a><code><span>message_id : <a href="Message_id/index.html#type-t">Message_id.t</a>;</span></code></li><li id="type-receive_message.message" class="def record field anchored"><a href="#type-receive_message.message" class="anchor"></a><code><span>message : <a href="#type-message">message</a>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-join"><a href="#type-join" class="anchor"></a><code><span><span class="keyword">type</span> join</span><span> = </span><span>{</span></code><ol><li id="type-join.topic" class="def record field anchored"><a href="#type-join.topic" class="anchor"></a><code><span>topic : <a href="Topic/index.html#type-t">Topic.t</a>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-leave"><a href="#type-leave" class="anchor"></a><code><span><span class="keyword">type</span> leave</span><span> = </span><span>{</span></code><ol><li id="type-leave.topic" class="def record field anchored"><a href="#type-leave.topic" class="anchor"></a><code><span>topic : <a href="Topic/index.html#type-t">Topic.t</a>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-subscribe"><a href="#type-subscribe" class="anchor"></a><code><span><span class="keyword">type</span> subscribe</span><span> = </span><span>{</span></code><ol><li id="type-subscribe.topic" class="def record field anchored"><a href="#type-subscribe.topic" class="anchor"></a><code><span>topic : <a href="Topic/index.html#type-t">Topic.t</a>;</span></code></li><li id="type-subscribe.peer" class="def record field anchored"><a href="#type-subscribe.peer" class="anchor"></a><code><span>peer : <a href="Peer/index.html#type-t">Peer.t</a>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-unsubscribe"><a href="#type-unsubscribe" class="anchor"></a><code><span><span class="keyword">type</span> unsubscribe</span><span> = </span><span>{</span></code><ol><li id="type-unsubscribe.topic" class="def record field anchored"><a href="#type-unsubscribe.topic" class="anchor"></a><code><span>topic : <a href="Topic/index.html#type-t">Topic.t</a>;</span></code></li><li id="type-unsubscribe.peer" class="def record field anchored"><a href="#type-unsubscribe.peer" class="anchor"></a><code><span>peer : <a href="Peer/index.html#type-t">Peer.t</a>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-set_application_score"><a href="#type-set_application_score" class="anchor"></a><code><span><span class="keyword">type</span> set_application_score</span><span> = </span><span>{</span></code><ol><li id="type-set_application_score.peer" class="def record field anchored"><a href="#type-set_application_score.peer" class="anchor"></a><code><span>peer : <a href="Peer/index.html#type-t">Peer.t</a>;</span></code></li><li id="type-set_application_score.score" class="def record field anchored"><a href="#type-set_application_score.score" class="anchor"></a><code><span>score : float;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-output"><a href="#type-output" class="anchor"></a><code><span><span class="keyword">type</span> <span>_ output</span></span><span> = </span></code><ol><li id="type-output.Ihave_from_peer_with_low_score" class="def variant constructor anchored"><a href="#type-output.Ihave_from_peer_with_low_score" class="anchor"></a><code><span>| </span><span><span class="constructor">Ihave_from_peer_with_low_score</span> : </span><span>{</span></code><ol><li id="type-output.score" class="def record field anchored"><a href="#type-output.score" class="anchor"></a><code><span>score : <a href="Score/index.html#type-t">Score.t</a>;</span></code></li><li id="type-output.threshold" class="def record field anchored"><a href="#type-output.threshold" class="anchor"></a><code><span>threshold : float;</span></code></li></ol><code><span>}</span><span> <span class="arrow">&#45;&gt;</span> <span><span>[ `IHave ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The peer who sent an IHave message has a <code>score</code> below <code>threshold</code>.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Too_many_recv_ihave_messages" class="def variant constructor anchored"><a href="#type-output.Too_many_recv_ihave_messages" class="anchor"></a><code><span>| </span><span><span class="constructor">Too_many_recv_ihave_messages</span> : </span><span>{</span></code><ol><li id="type-output.count" class="def record field anchored"><a href="#type-output.count" class="anchor"></a><code><span>count : int;</span></code></li><li id="type-output.max" class="def record field anchored"><a href="#type-output.max" class="anchor"></a><code><span>max : int;</span></code></li></ol><code><span>}</span><span> <span class="arrow">&#45;&gt;</span> <span><span>[ `IHave ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The peer sent us more than <code>max</code> IHave messages within two successive heartbeat calls.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Too_many_sent_iwant_messages" class="def variant constructor anchored"><a href="#type-output.Too_many_sent_iwant_messages" class="anchor"></a><code><span>| </span><span><span class="constructor">Too_many_sent_iwant_messages</span> : </span><span>{</span></code><ol><li id="type-output.count" class="def record field anchored"><a href="#type-output.count" class="anchor"></a><code><span>count : int;</span></code></li><li id="type-output.max" class="def record field anchored"><a href="#type-output.max" class="anchor"></a><code><span>max : int;</span></code></li></ol><code><span>}</span><span> <span class="arrow">&#45;&gt;</span> <span><span>[ `IHave ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>We sent more than <code>max</code> IWant messages to this peer within two successive heartbeat calls.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Message_topic_not_tracked" class="def variant constructor anchored"><a href="#type-output.Message_topic_not_tracked" class="anchor"></a><code><span>| </span><span><span class="constructor">Message_topic_not_tracked</span> : <span><span>[ `IHave ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>We received an IHave message for a topic we don't track.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Message_requested_message_ids" class="def variant constructor anchored"><a href="#type-output.Message_requested_message_ids" class="anchor"></a><code><span>| </span><span><span class="constructor">Message_requested_message_ids</span> : <span><a href="Message_id/index.html#type-t">Message_id.t</a> list</span> <span class="arrow">&#45;&gt;</span> <span><span>[ `IHave ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The messages ids we want to request from the peer which sent us an IHave message. The implementation honors the <code>max_sent_iwant_per_heartbeat</code> limit.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Invalid_message_id" class="def variant constructor anchored"><a href="#type-output.Invalid_message_id" class="anchor"></a><code><span>| </span><span><span class="constructor">Invalid_message_id</span> : <span><span>[ `IHave ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>A message id received via IHave message is invalid.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Iwant_from_peer_with_low_score" class="def variant constructor anchored"><a href="#type-output.Iwant_from_peer_with_low_score" class="anchor"></a><code><span>| </span><span><span class="constructor">Iwant_from_peer_with_low_score</span> : </span><span>{</span></code><ol><li id="type-output.score" class="def record field anchored"><a href="#type-output.score" class="anchor"></a><code><span>score : <a href="Score/index.html#type-t">Score.t</a>;</span></code></li><li id="type-output.threshold" class="def record field anchored"><a href="#type-output.threshold" class="anchor"></a><code><span>threshold : float;</span></code></li></ol><code><span>}</span><span> <span class="arrow">&#45;&gt;</span> <span><span>[ `IWant ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The peer who sent an IWant message has a <code>score</code> below <code>threshold</code>.</p><span class="comment-delim">*)</span></div></li><li id="type-output.On_iwant_messages_to_route" class="def variant constructor anchored"><a href="#type-output.On_iwant_messages_to_route" class="anchor"></a><code><span>| </span><span><span class="constructor">On_iwant_messages_to_route</span> : </span><span>{</span></code><ol><li id="type-output.routed_message_ids" class="def record field anchored"><a href="#type-output.routed_message_ids" class="anchor"></a><code><span>routed_message_ids : <span><span>[ `Ignored
                     <span>| `Not_found</span>
                     <span>| `Too_many_requests</span>
                     <span><span>| `Message</span> of <a href="#type-message">message</a></span> ]</span>
                       <a href="Message_id/Map/index.html#type-t">Message_id.Map.t</a></span>;</span></code></li></ol><code><span>}</span><span> <span class="arrow">&#45;&gt;</span> <span><span>[ `IWant ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>As an answer for an <code>`IWant</code> message, the automaton returns a map associating to each requested message_id either <code>`Ignored</code> if the peer is filtered out by <code>peer_filter</code>, <code>`Not_found</code> if the message is not found, or <code>Message m</code> if <code>m</code> is the message with the given id.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Peer_filtered" class="def variant constructor anchored"><a href="#type-output.Peer_filtered" class="anchor"></a><code><span>| </span><span><span class="constructor">Peer_filtered</span> : <span><span>[ `Graft ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The peer we attempt to graft has not been selected by <code>peer_filter</code>.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Unsubscribed_topic" class="def variant constructor anchored"><a href="#type-output.Unsubscribed_topic" class="anchor"></a><code><span>| </span><span><span class="constructor">Unsubscribed_topic</span> : <span><span>[ `Graft ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>We didn't join the topic for which we are attempting to graft a peer.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Peer_already_in_mesh" class="def variant constructor anchored"><a href="#type-output.Peer_already_in_mesh" class="anchor"></a><code><span>| </span><span><span class="constructor">Peer_already_in_mesh</span> : <span><span>[ `Graft ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Attempting to graft a peer which has already been grafted.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Grafting_direct_peer" class="def variant constructor anchored"><a href="#type-output.Grafting_direct_peer" class="anchor"></a><code><span>| </span><span><span class="constructor">Grafting_direct_peer</span> : <span><span>[ `Graft ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Attempting to graft a direct peer.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Unexpected_grafting_peer" class="def variant constructor anchored"><a href="#type-output.Unexpected_grafting_peer" class="anchor"></a><code><span>| </span><span><span class="constructor">Unexpected_grafting_peer</span> : <span><span>[ `Graft ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The peer we attempt to graft is not known.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Grafting_peer_with_negative_score" class="def variant constructor anchored"><a href="#type-output.Grafting_peer_with_negative_score" class="anchor"></a><code><span>| </span><span><span class="constructor">Grafting_peer_with_negative_score</span> : <span><span>[ `Graft ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Attempting to graft a peer with a negative score.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Grafting_successfully" class="def variant constructor anchored"><a href="#type-output.Grafting_successfully" class="anchor"></a><code><span>| </span><span><span class="constructor">Grafting_successfully</span> : <span><span>[ `Graft ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Grafting the given peer for the provided topic succeeded.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Peer_backed_off" class="def variant constructor anchored"><a href="#type-output.Peer_backed_off" class="anchor"></a><code><span>| </span><span><span class="constructor">Peer_backed_off</span> : <span><span>[ `Graft ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>We cannot graft the given peer because it is backed off.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Mesh_full" class="def variant constructor anchored"><a href="#type-output.Mesh_full" class="anchor"></a><code><span>| </span><span><span class="constructor">Mesh_full</span> : <span><span>[ `Graft ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Grafting a peer for a topic whose mesh has already sufficiently many peers.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Prune_topic_not_tracked" class="def variant constructor anchored"><a href="#type-output.Prune_topic_not_tracked" class="anchor"></a><code><span>| </span><span><span class="constructor">Prune_topic_not_tracked</span> : <span><span>[ `Prune ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Attempting to prune a peer for a non-tracked topic.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Peer_not_in_mesh" class="def variant constructor anchored"><a href="#type-output.Peer_not_in_mesh" class="anchor"></a><code><span>| </span><span><span class="constructor">Peer_not_in_mesh</span> : <span><span>[ `Prune ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Attempting to prune a peer which is not in the mesh.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Ignore_PX_score_too_low" class="def variant constructor anchored"><a href="#type-output.Ignore_PX_score_too_low" class="anchor"></a><code><span>| </span><span><span class="constructor">Ignore_PX_score_too_low</span> : <a href="Score/index.html#type-t">Score.t</a> <span class="arrow">&#45;&gt;</span> <span><span>[ `Prune ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The given peer has been pruned for the given topic, but no alternative peers are returned because the peer's score is too low. The score of the peer is included in the return value.</p><span class="comment-delim">*)</span></div></li><li id="type-output.No_PX" class="def variant constructor anchored"><a href="#type-output.No_PX" class="anchor"></a><code><span>| </span><span><span class="constructor">No_PX</span> : <span><span>[ `Prune ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The given peer has been pruned for the given topic. No alternatives peers was provided in <a href="#type-prune"><code>prune</code></a>.</p><span class="comment-delim">*)</span></div></li><li id="type-output.PX" class="def variant constructor anchored"><a href="#type-output.PX" class="anchor"></a><code><span>| </span><span><span class="constructor">PX</span> : <a href="Peer/Set/index.html#type-t">Peer.Set.t</a> <span class="arrow">&#45;&gt;</span> <span><span>[ `Prune ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The given peer has been pruned for the given topic. The given set of peers alternatives in <a href="#type-prune"><code>prune</code></a> for that topic is returned.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Publish_message" class="def variant constructor anchored"><a href="#type-output.Publish_message" class="anchor"></a><code><span>| </span><span><span class="constructor">Publish_message</span> : </span><span>{</span></code><ol><li id="type-output.to_publish" class="def record field anchored"><a href="#type-output.to_publish" class="anchor"></a><code><span>to_publish : <a href="Peer/Set/index.html#type-t">Peer.Set.t</a>;</span></code></li></ol><code><span>}</span><span> <span class="arrow">&#45;&gt;</span> <span><span>[ `Publish_message ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>to_publish</code> contains:</p><ul><li>Direct peers for the message's topic;</li><li>The peers in the topic's mesh, if the peer is subscribed to the topic. Otherwise, the peers in the topic's fanout.</li></ul><span class="comment-delim">*)</span></div></li><li id="type-output.Already_published" class="def variant constructor anchored"><a href="#type-output.Already_published" class="anchor"></a><code><span>| </span><span><span class="constructor">Already_published</span> : <span><span>[ `Publish_message ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Attempting to publish a message that has already been published.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Route_message" class="def variant constructor anchored"><a href="#type-output.Route_message" class="anchor"></a><code><span>| </span><span><span class="constructor">Route_message</span> : </span><span>{</span></code><ol><li id="type-output.to_route" class="def record field anchored"><a href="#type-output.to_route" class="anchor"></a><code><span>to_route : <a href="Peer/Set/index.html#type-t">Peer.Set.t</a>;</span></code></li></ol><code><span>}</span><span> <span class="arrow">&#45;&gt;</span> <span><span>[ `Receive_message ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>to_route</code> contains:</p><ul><li>Direct peers for the message's topic;</li><li>The peers in the topic's mesh minus the original sender of the message.</li></ul><span class="comment-delim">*)</span></div></li><li id="type-output.Already_received" class="def variant constructor anchored"><a href="#type-output.Already_received" class="anchor"></a><code><span>| </span><span><span class="constructor">Already_received</span> : <span><span>[ `Receive_message ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Received a message that has already been recevied before.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Not_subscribed" class="def variant constructor anchored"><a href="#type-output.Not_subscribed" class="anchor"></a><code><span>| </span><span><span class="constructor">Not_subscribed</span> : <span><span>[ `Receive_message ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Received a message from a remote peer for a topic we are not subscribed to (called &quot;unknown topic&quot; in the Go implementation).</p><span class="comment-delim">*)</span></div></li><li id="type-output.Invalid_message" class="def variant constructor anchored"><a href="#type-output.Invalid_message" class="anchor"></a><code><span>| </span><span><span class="constructor">Invalid_message</span> : <span><span>[ `Receive_message ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Attempting to publish a message that is invalid.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Unknown_validity" class="def variant constructor anchored"><a href="#type-output.Unknown_validity" class="anchor"></a><code><span>| </span><span><span class="constructor">Unknown_validity</span> : <span><span>[ `Receive_message ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Validity cannot be decided yet.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Outdated" class="def variant constructor anchored"><a href="#type-output.Outdated" class="anchor"></a><code><span>| </span><span><span class="constructor">Outdated</span> : <span><span>[ `Receive_message ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The message is outdated.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Already_joined" class="def variant constructor anchored"><a href="#type-output.Already_joined" class="anchor"></a><code><span>| </span><span><span class="constructor">Already_joined</span> : <span><span>[ `Join ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Attempting to join a topic we already joined.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Joining_topic" class="def variant constructor anchored"><a href="#type-output.Joining_topic" class="anchor"></a><code><span>| </span><span><span class="constructor">Joining_topic</span> : </span><span>{</span></code><ol><li id="type-output.to_graft" class="def record field anchored"><a href="#type-output.to_graft" class="anchor"></a><code><span>to_graft : <a href="Peer/Set/index.html#type-t">Peer.Set.t</a>;</span></code></li></ol><code><span>}</span><span> <span class="arrow">&#45;&gt;</span> <span><span>[ `Join ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>When successfully joining a topic, the set of grafted peers for that topic is returned.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Not_joined" class="def variant constructor anchored"><a href="#type-output.Not_joined" class="anchor"></a><code><span>| </span><span><span class="constructor">Not_joined</span> : <span><span>[ `Leave ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Attempting to leave a topic which we didn't join or had already left.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Leaving_topic" class="def variant constructor anchored"><a href="#type-output.Leaving_topic" class="anchor"></a><code><span>| </span><span><span class="constructor">Leaving_topic</span> : </span><span>{</span></code><ol><li id="type-output.to_prune" class="def record field anchored"><a href="#type-output.to_prune" class="anchor"></a><code><span>to_prune : <a href="Peer/Set/index.html#type-t">Peer.Set.t</a>;</span></code></li><li id="type-output.noPX_peers" class="def record field anchored"><a href="#type-output.noPX_peers" class="anchor"></a><code><span>noPX_peers : <a href="Peer/Set/index.html#type-t">Peer.Set.t</a>;</span></code></li></ol><code><span>}</span><span> <span class="arrow">&#45;&gt;</span> <span><span>[ `Leave ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>When successfully leaving a topic, the set of pruned peers for that topic is returned alongside a subset of those peers for which no alternative PX will be proposed.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Heartbeat" class="def variant constructor anchored"><a href="#type-output.Heartbeat" class="anchor"></a><code><span>| </span><span><span class="constructor">Heartbeat</span> : </span><span>{</span></code><ol><li id="type-output.to_graft" class="def record field anchored"><a href="#type-output.to_graft" class="anchor"></a><code><span>to_graft : <span><a href="Topic/Set/index.html#type-t">Topic.Set.t</a> <a href="Peer/Map/index.html#type-t">Peer.Map.t</a></span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The set of topics per peer that have been grafted.</p><span class="comment-delim">*)</span></div></li><li id="type-output.to_prune" class="def record field anchored"><a href="#type-output.to_prune" class="anchor"></a><code><span>to_prune : <span><a href="Topic/Set/index.html#type-t">Topic.Set.t</a> <a href="Peer/Map/index.html#type-t">Peer.Map.t</a></span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The set of topics per peer that have been pruned.</p><span class="comment-delim">*)</span></div></li><li id="type-output.noPX_peers" class="def record field anchored"><a href="#type-output.noPX_peers" class="anchor"></a><code><span>noPX_peers : <a href="Peer/Set/index.html#type-t">Peer.Set.t</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Set of peers for which peer exchange (PX) will not be proposed.</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span><span> <span class="arrow">&#45;&gt;</span> <span><span>[ `Heartbeat ]</span> <a href="#type-output">output</a></span></span></code></li><li id="type-output.Peer_added" class="def variant constructor anchored"><a href="#type-output.Peer_added" class="anchor"></a><code><span>| </span><span><span class="constructor">Peer_added</span> : <span><span>[ `Add_peer ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The output returned when successfully adding a peer.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Peer_already_known" class="def variant constructor anchored"><a href="#type-output.Peer_already_known" class="anchor"></a><code><span>| </span><span><span class="constructor">Peer_already_known</span> : <span><span>[ `Add_peer ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The output returned when attempting to add a peer which is already known.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Removing_peer" class="def variant constructor anchored"><a href="#type-output.Removing_peer" class="anchor"></a><code><span>| </span><span><span class="constructor">Removing_peer</span> : <span><span>[ `Remove_peer ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The output returned when successfully removing a peer.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Subscribed" class="def variant constructor anchored"><a href="#type-output.Subscribed" class="anchor"></a><code><span>| </span><span><span class="constructor">Subscribed</span> : <span><span>[ `Subscribe ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The output returned once we successfully processed a subscribe request sent from a peer.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Subscribe_to_unknown_peer" class="def variant constructor anchored"><a href="#type-output.Subscribe_to_unknown_peer" class="anchor"></a><code><span>| </span><span><span class="constructor">Subscribe_to_unknown_peer</span> : <span><span>[ `Subscribe ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The output returned when we receive a subscribe message from a peer we don't know.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Unsubscribed" class="def variant constructor anchored"><a href="#type-output.Unsubscribed" class="anchor"></a><code><span>| </span><span><span class="constructor">Unsubscribed</span> : <span><span>[ `Unsubscribe ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The output returned once we successfully processed an unsubscribe request sent from a peer.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Unsubscribe_from_unknown_peer" class="def variant constructor anchored"><a href="#type-output.Unsubscribe_from_unknown_peer" class="anchor"></a><code><span>| </span><span><span class="constructor">Unsubscribe_from_unknown_peer</span> : <span><span>[ `Unsubscribe ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The output returned when we receive an unsubscribe message from a peer we don't know.</p><span class="comment-delim">*)</span></div></li><li id="type-output.Set_application_score" class="def variant constructor anchored"><a href="#type-output.Set_application_score" class="anchor"></a><code><span>| </span><span><span class="constructor">Set_application_score</span> : <span><span>[ `Set_application_score ]</span> <a href="#type-output">output</a></span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The output returned when we set the application score of a peer</p><span class="comment-delim">*)</span></div></li></ol></div><div class="spec-doc"><p>Output produced by one of the actions below.</p></div></div><div class="odoc-spec"><div class="spec type subst anchored" id="type-monad"><a href="#type-monad" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a monad</span></span><span> := <span><a href="#type-state">state</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-state">state</a> * <span><span class="type-var">'a</span> <a href="#type-output">output</a></span></span></code></div><div class="spec-doc"><p>A type alias for the state monad.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-make"><a href="#val-make" class="anchor"></a><code><span><span class="keyword">val</span> make : <span><span class="xref-unresolved">Stdlib</span>.Random.State.t <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-limits">limits</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-parameters">parameters</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-state">state</a></span></code></div><div class="spec-doc"><p>Initialise a state.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-add_peer"><a href="#val-add_peer" class="anchor"></a><code><span><span class="keyword">val</span> add_peer : <span><a href="#type-add_peer">add_peer</a> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Add_peer ]</span> <a href="#type-monad">monad</a></span></span></code></div><div class="spec-doc"><p><code>add_peer { direct; outbound; peer }</code> is called to notify a new connection. If <code>direct</code> is <code>true</code>, the gossipsub always forwards messages to those peers. <code>outbound</code> is <code>true</code> if it is an outbound connection, that is, a connection initiated by the local (not the remote) peer. Note however that the notion of &quot;outbound&quot; connections can be refined, relaxed or redefined by the application layer to fit its own needs.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-remove_peer"><a href="#val-remove_peer" class="anchor"></a><code><span><span class="keyword">val</span> remove_peer : <span><a href="#type-remove_peer">remove_peer</a> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Remove_peer ]</span> <a href="#type-monad">monad</a></span></span></code></div><div class="spec-doc"><p><code>remove_peer { peer }</code> notifies gossipsub that we are disconnected from a peer. Do note that the <code>state</code> still maintain information for this connection for <code>retain_duration</code> seconds.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-handle_subscribe"><a href="#val-handle_subscribe" class="anchor"></a><code><span><span class="keyword">val</span> handle_subscribe : <span><a href="#type-subscribe">subscribe</a> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Subscribe ]</span> <a href="#type-monad">monad</a></span></span></code></div><div class="spec-doc"><p><code>handle_subscribe {topic; peer}</code> handles a request from a remote <code>peer</code> informing us that it is subscribed to <code>topic</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-handle_unsubscribe"><a href="#val-handle_unsubscribe" class="anchor"></a><code><span><span class="keyword">val</span> handle_unsubscribe : <span><a href="#type-unsubscribe">unsubscribe</a> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Unsubscribe ]</span> <a href="#type-monad">monad</a></span></span></code></div><div class="spec-doc"><p><code>handle_unsubscribe {topic; peer}</code> handles a request from a remote <code>peer</code> informing us that it unsubscribed from <code>topic</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-handle_ihave"><a href="#val-handle_ihave" class="anchor"></a><code><span><span class="keyword">val</span> handle_ihave : <span><a href="#type-ihave">ihave</a> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `IHave ]</span> <a href="#type-monad">monad</a></span></span></code></div><div class="spec-doc"><p><code>handle_ihave { peer; topic; message_ids }</code> handles the gossip message <code>IHave</code> emitted by <code>peer</code> for <code>topic</code> with the <code>message_ids</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-handle_iwant"><a href="#val-handle_iwant" class="anchor"></a><code><span><span class="keyword">val</span> handle_iwant : <span><a href="#type-iwant">iwant</a> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `IWant ]</span> <a href="#type-monad">monad</a></span></span></code></div><div class="spec-doc"><p><code>handle_iwant { peer; message_ids }</code> handles the gossip message <code>IWant</code> emitted by <code>peer</code> for <code>topic</code> with the <code>message_ids</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-handle_graft"><a href="#val-handle_graft" class="anchor"></a><code><span><span class="keyword">val</span> handle_graft : <span><a href="#type-graft">graft</a> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Graft ]</span> <a href="#type-monad">monad</a></span></span></code></div><div class="spec-doc"><p><code>handle_graft { peer; topic }</code> handles the gossip message <code>Graft</code> emitted by <code>peer</code> for <code>topic</code>. This action allows to graft a connection to a full connection allowing the transmission of full messages for the given topic.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-handle_prune"><a href="#val-handle_prune" class="anchor"></a><code><span><span class="keyword">val</span> handle_prune : <span><a href="#type-prune">prune</a> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Prune ]</span> <a href="#type-monad">monad</a></span></span></code></div><div class="spec-doc"><p><code>handle_prune { peer; topic; px; backoff }</code> handles the gossip message <code>Prune</code> emitted by <code>peer</code> for <code>topic</code>. This action allows to prune a full connection. In that case, the remote peer can send a list of peers to connect to as well as a backoff time, which is a duration for which we cannot <code>Graft</code> this peer on this topic.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-handle_receive_message"><a href="#val-handle_receive_message" class="anchor"></a><code><span><span class="keyword">val</span> handle_receive_message : <span><a href="#type-receive_message">receive_message</a> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Receive_message ]</span> <a href="#type-monad">monad</a></span></span></code></div><div class="spec-doc"><p><code>handle_receive_message { sender; topic; message_id; message }</code> handles a message received from <code>sender</code> on the gossip network. The function returns a set of peers to which the (full) message will be directly forwarded.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-publish_message"><a href="#val-publish_message" class="anchor"></a><code><span><span class="keyword">val</span> publish_message : <span><a href="#type-publish_message">publish_message</a> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Publish_message ]</span> <a href="#type-monad">monad</a></span></span></code></div><div class="spec-doc"><p><code>publish { topic; message_id; message }</code> allows to publish a message on the gossip network from the local node. The function returns a set of peers to which the (full) message will be directly forwarded.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-heartbeat"><a href="#val-heartbeat" class="anchor"></a><code><span><span class="keyword">val</span> heartbeat : <span><span>[ `Heartbeat ]</span> <a href="#type-monad">monad</a></span></span></code></div><div class="spec-doc"><p><code>heartbeat</code> executes the heartbeat routine of the algorithm.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-join"><a href="#val-join" class="anchor"></a><code><span><span class="keyword">val</span> join : <span><a href="#type-join">join</a> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Join ]</span> <a href="#type-monad">monad</a></span></span></code></div><div class="spec-doc"><p><code>join { topic }</code> handles a join to a new topic. On success, the function returns the set of peers that have been grafted to form the mesh of the joined topic.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-leave"><a href="#val-leave" class="anchor"></a><code><span><span class="keyword">val</span> leave : <span><a href="#type-leave">leave</a> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Leave ]</span> <a href="#type-monad">monad</a></span></span></code></div><div class="spec-doc"><p><code>leave { topic }</code> handles a leave from a topic. On success, the function returns the set of peers, forming the mesh, that have been pruned for that topic.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set_application_score"><a href="#val-set_application_score" class="anchor"></a><code><span><span class="keyword">val</span> set_application_score : 
  <span><a href="#type-set_application_score">set_application_score</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ `Set_application_score ]</span> <a href="#type-monad">monad</a></span></span></code></div><div class="spec-doc"><p><code>set_application_score {peer; score}</code> handles setting the application score of <code>peer</code>. If the peer is not known, this does nothing.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-select_px_peers"><a href="#val-select_px_peers" class="anchor"></a><code><span><span class="keyword">val</span> select_px_peers : 
  <span><a href="#type-state">state</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">peer_to_prune</span>:<a href="Peer/index.html#type-t">Peer.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="Topic/index.html#type-t">Topic.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">noPX_peers</span>:<a href="Peer/Set/index.html#type-t">Peer.Set.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="Peer/index.html#type-t">Peer.t</a> list</span></span></code></div><div class="spec-doc"><p>Select random peers for Peer eXchange. Note that function is deterministic; however, it has side effects in that it updates the <code>state</code>'s random state.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-select_gossip_messages"><a href="#val-select_gossip_messages" class="anchor"></a><code><span><span class="keyword">val</span> select_gossip_messages : <span><a href="#type-state">state</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-ihave">ihave</a> list</span></span></code></div><div class="spec-doc"><p>Select the gossip messages to be sent. These are IHave control messages referring to recently seen messages (that is, sent during the last <code>history_gossip_length</code> heartbeat ticks), to be sent to a random selection of peers. The message ids for a peer and a topic are also selected at random among the possible ones. At most <code>max_sent_iwant_per_heartbeat</code> message ids are sent.</p><p>The local peer will send gossip to at most <code>gossip_factor</code> * (total number of non-mesh/non-fanout peers), or <code>degree_lazy</code> random peers, whichever is greater.</p><p>Note that function is deterministic; however, it has side effects in that it updates the <code>state</code>'s random state.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_add_peer"><a href="#val-pp_add_peer" class="anchor"></a><code><span><span class="keyword">val</span> pp_add_peer : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-add_peer">add_peer</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_remove_peer"><a href="#val-pp_remove_peer" class="anchor"></a><code><span><span class="keyword">val</span> pp_remove_peer : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-remove_peer">remove_peer</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_ihave"><a href="#val-pp_ihave" class="anchor"></a><code><span><span class="keyword">val</span> pp_ihave : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-ihave">ihave</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_iwant"><a href="#val-pp_iwant" class="anchor"></a><code><span><span class="keyword">val</span> pp_iwant : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-iwant">iwant</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_graft"><a href="#val-pp_graft" class="anchor"></a><code><span><span class="keyword">val</span> pp_graft : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-graft">graft</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_prune"><a href="#val-pp_prune" class="anchor"></a><code><span><span class="keyword">val</span> pp_prune : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-prune">prune</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_receive_message"><a href="#val-pp_receive_message" class="anchor"></a><code><span><span class="keyword">val</span> pp_receive_message : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-receive_message">receive_message</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_publish_message"><a href="#val-pp_publish_message" class="anchor"></a><code><span><span class="keyword">val</span> pp_publish_message : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-publish_message">publish_message</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_join"><a href="#val-pp_join" class="anchor"></a><code><span><span class="keyword">val</span> pp_join : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-join">join</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_leave"><a href="#val-pp_leave" class="anchor"></a><code><span><span class="keyword">val</span> pp_leave : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-leave">leave</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_subscribe"><a href="#val-pp_subscribe" class="anchor"></a><code><span><span class="keyword">val</span> pp_subscribe : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-subscribe">subscribe</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_unsubscribe"><a href="#val-pp_unsubscribe" class="anchor"></a><code><span><span class="keyword">val</span> pp_unsubscribe : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-unsubscribe">unsubscribe</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_set_application_score"><a href="#val-pp_set_application_score" class="anchor"></a><code><span><span class="keyword">val</span> pp_set_application_score : 
  <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-set_application_score">set_application_score</a> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_output"><a href="#val-pp_output" class="anchor"></a><code><span><span class="keyword">val</span> pp_output : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-output">output</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Introspection"><a href="#module-Introspection" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Introspection/index.html">Introspection</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div></div></body></html>
