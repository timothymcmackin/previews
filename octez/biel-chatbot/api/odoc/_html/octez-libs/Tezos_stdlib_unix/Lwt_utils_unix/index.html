<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Lwt_utils_unix (octez-libs.Tezos_stdlib_unix.Lwt_utils_unix)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">octez-libs</a> &#x00BB; <a href="../index.html">Tezos_stdlib_unix</a> &#x00BB; Lwt_utils_unix</nav><header class="odoc-preamble"><h1>Module <code><span>Tezos_stdlib_unix.Lwt_utils_unix</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value anchored" id="val-default_net_timeout"><a href="#val-default_net_timeout" class="anchor"></a><code><span><span class="keyword">val</span> default_net_timeout : <span><span class="xref-unresolved">Ptime</span>.Span.t <span class="xref-unresolved">Stdlib</span>.ref</span></span></code></div><div class="spec-doc"><p><code>default_net_timeout</code> is the default timeout used by functions in this library which admit a timeout value, i.e. <code>read_bytes_with_timeout</code>, <code>Socket.connect</code>, <code>Socket.recv</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-read_bytes_with_timeout"><a href="#val-read_bytes_with_timeout" class="anchor"></a><code><span><span class="keyword">val</span> read_bytes_with_timeout : 
  <span><span class="optlabel">?timeout</span>:<span class="xref-unresolved">Ptime</span>.Span.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?file_offset</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?pos</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?len</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Lwt_unix</span>.file_descr <span class="arrow">&#45;&gt;</span></span>
  <span>bytes <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>read_bytes_with_timeout ?timeout ?file_offset ?pos ?len fd buf</code> reads <code>len-pos</code> bytes from <code>fd</code> into <code>bytes</code>. If <code>file_offset</code> is given, <code>Lwt_unix.pread</code> will be used instead of <code>Lwt_unix.read</code>.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Lwt_unix.Timeout</code> <p>if the operation failed to finish within a <code>timeout</code> time span.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-read_bytes"><a href="#val-read_bytes" class="anchor"></a><code><span><span class="keyword">val</span> read_bytes : 
  <span><span class="optlabel">?file_offset</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?pos</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?len</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Lwt_unix</span>.file_descr <span class="arrow">&#45;&gt;</span></span>
  <span>bytes <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>read_bytes ?file_offset ?pos ?len fd buf</code> reads <code>len-pos</code> bytes from <code>fd</code> into <code>bytes</code>. If <code>file_offset</code> is given, <code>Lwt_unix.pread</code> will be used instead of <code>Lwt_unix.read</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-write_string"><a href="#val-write_string" class="anchor"></a><code><span><span class="keyword">val</span> write_string : 
  <span><span class="optlabel">?pos</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?len</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Lwt_unix</span>.file_descr <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-write_bytes"><a href="#val-write_bytes" class="anchor"></a><code><span><span class="keyword">val</span> write_bytes : 
  <span><span class="optlabel">?file_offset</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?pos</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?len</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Lwt_unix</span>.file_descr <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Stdlib</span>.Bytes.t <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>write_bytes ?file_offset ?pos ?len fd buf</code> writes <code>len-pos</code> bytes from <code>bytes</code> to <code>fd</code>. If <code>file_offset</code> is given, <code>Lwt_unix.pwrite</code> will be used instead of <code>Lwt_unix.write</code>.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Lwt_unix.Timeout</code> <p>if the operation failed to finish within a <code>timeout</code> time span.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_directory"><a href="#val-is_directory" class="anchor"></a><code><span><span class="keyword">val</span> is_directory : <span>string <span class="arrow">&#45;&gt;</span></span> <span>bool <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>is_directory path</code> tests if the given <code>path</code> (or the target of the symbolic link located at <code>path</code>) refers to a directory (file kind is <code>S_DIR</code>).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-dir_exists"><a href="#val-dir_exists" class="anchor"></a><code><span><span class="keyword">val</span> dir_exists : <span>string <span class="arrow">&#45;&gt;</span></span> <span>bool <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>dir_exists</code> tests if the given <code>path</code> (or the target of the symbolic link located at <code>path</code>) is an existing directory. <code>false</code> is returned either if the target does not exist or if it is not a directory.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-remove_dir"><a href="#val-remove_dir" class="anchor"></a><code><span><span class="keyword">val</span> remove_dir : <span>string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-create_dir"><a href="#val-create_dir" class="anchor"></a><code><span><span class="keyword">val</span> create_dir : <span><span class="optlabel">?perm</span>:int <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>create_dir ?perm dir</code> creates the directory at the path <code>dir</code> and its parents recursively if they doesn't exist</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-copy_dir"><a href="#val-copy_dir" class="anchor"></a><code><span><span class="keyword">val</span> copy_dir : <span><span class="optlabel">?perm</span>:int <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>copy_dir ?perm src dst</code> copies the content of directory <code>src</code> in a fresh directory <code>dst</code> created with <code>perm</code> (0o755 by default).</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Unix_error(ENOTDIR,_,_)</code> <p>if the given file is not a directory.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-read_file"><a href="#val-read_file" class="anchor"></a><code><span><span class="keyword">val</span> read_file : <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-copy_file"><a href="#val-copy_file" class="anchor"></a><code><span><span class="keyword">val</span> copy_file : 
  <span><span class="optlabel">?buffer_size</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">src</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">dst</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>copy_file ?buffer_size ~src ~dst ()</code> copies the file from <code>src</code> to <code>dst</code>. The permissions of the <code>dst</code> file are inherited from `Lwt_io.with_file`. The <code>buffer_size</code> parameter, which defaults to 4096, can be adjusted to improve performance.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-copy_file_raw"><a href="#val-copy_file_raw" class="anchor"></a><code><span><span class="keyword">val</span> copy_file_raw : 
  <span><span class="optlabel">?buffer_size</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dst_perm</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">src</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">dst</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>copy_file_raw ?buffer_size ?dst_perm ~src ~dst ()</code> is very similar to <code>copy_file</code> but it uses an alternate implementation using raw file descriptors, enabling better performances. It copies the file from <code>src</code> to <code>dst</code>. The permissions of the <code>dst</code> file is 0o666 by default. The <code>buffer_size</code> parameter, which defaults to 4096*1024, can be adjusted to improve performance.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-create_file"><a href="#val-create_file" class="anchor"></a><code><span><span class="keyword">val</span> create_file : 
  <span><span class="optlabel">?close_on_exec</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?perm</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-with_tempdir"><a href="#val-with_tempdir" class="anchor"></a><code><span><span class="keyword">val</span> with_tempdir : 
  <span><span class="optlabel">?temp_dir</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span>string <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-safe_close"><a href="#val-safe_close" class="anchor"></a><code><span><span class="keyword">val</span> safe_close : 
  <span><span class="xref-unresolved">Lwt_unix</span>.file_descr <span class="arrow">&#45;&gt;</span></span>
  <span><span>unit <a href="../../Tezos_error_monad/Error_monad/index.html#type-tzresult">Tezos_error_monad.Error_monad.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-getaddrinfo"><a href="#val-getaddrinfo" class="anchor"></a><code><span><span class="keyword">val</span> getaddrinfo : 
  <span><span class="label">passive</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">node</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">service</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="xref-unresolved">Ipaddr</span>.V6.t * int)</span> list</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-getpass"><a href="#val-getpass" class="anchor"></a><code><span><span class="keyword">val</span> getpass : <span>unit <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>getpass ()</code> reads a password from stdio while setting-up the terminal to not display the password being typed.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Json"><a href="#module-Json" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Json/index.html">Json</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-retry"><a href="#val-retry" class="anchor"></a><code><span><span class="keyword">val</span> retry : 
  <span><span class="optlabel">?log</span>:<span>(<span><span class="type-var">'error</span> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?n</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?sleep</span>:float <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'error</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'error</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-io_error"><a href="#type-io_error" class="anchor"></a><code><span><span class="keyword">type</span> <span>'action io_error</span></span><span> = </span><span>{</span></code><ol><li id="type-io_error.action" class="def record field anchored"><a href="#type-io_error.action" class="anchor"></a><code><span>action : <span class="type-var">'action</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>action which triggerred the error.</p><span class="comment-delim">*)</span></div></li><li id="type-io_error.unix_code" class="def record field anchored"><a href="#type-io_error.unix_code" class="anchor"></a><code><span>unix_code : <span class="xref-unresolved">Unix</span>.error;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Unix code error.</p><span class="comment-delim">*)</span></div></li><li id="type-io_error.caller" class="def record field anchored"><a href="#type-io_error.caller" class="anchor"></a><code><span>caller : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Unix function which triggerred the error.</p><span class="comment-delim">*)</span></div></li><li id="type-io_error.arg" class="def record field anchored"><a href="#type-io_error.arg" class="anchor"></a><code><span>arg : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Argument given to the unix function: generally a path.</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p><code>with_io_error</code> aims to be used as the error type for the <code>with_*</code> functions below. The <code>action</code> type is the action which trigerred the error.</p></div></div><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-Io_error"><a href="#extension-decl-Io_error" class="anchor"></a><code><span><span class="keyword">type</span> <a href="../../Tezos_error_monad/Error_monad/index.html#type-error">Tezos_error_monad.Error_monad.error</a> += </span></code><ol><li id="extension-Io_error" class="def variant extension anchored"><a href="#extension-Io_error" class="anchor"></a><code><span>| </span><span><span class="extension">Io_error</span> <span class="keyword">of</span> <span><span>[ `Close <span>| `Open</span> <span>| `Rename</span> <span>| `Unlink</span> <span>| `Lock</span> ]</span> <a href="#type-io_error">io_error</a></span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-tzfail_of_io_error"><a href="#val-tzfail_of_io_error" class="anchor"></a><code><span><span class="keyword">val</span> tzfail_of_io_error : 
  <span><span><span>[ `Close <span>| `Open</span> <span>| `Rename</span> <span>| `Unlink</span> <span>| `Lock</span> ]</span> <a href="#type-io_error">io_error</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'b</span> <a href="../../Tezos_error_monad/Error_monad/index.html#type-tzresult">Tezos_error_monad.Error_monad.tzresult</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-with_open_file"><a href="#val-with_open_file" class="anchor"></a><code><span><span class="keyword">val</span> with_open_file : 
  <span><span class="label">flags</span>:<span><span class="xref-unresolved">Unix</span>.open_flag list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?perm</span>:<span class="xref-unresolved">Unix</span>.file_perm <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="xref-unresolved">Lwt_unix</span>.file_descr <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, <span><span>[&gt; `Open <span>| `Close</span> ]</span> <a href="#type-io_error">io_error</a></span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>with_open_file ~flags ~perm filename f</code> opens the given file using <code>Lwt_unix.open_file</code> and passes the resulting file-descriptor to <code>f</code>. <code>with_open_file</code> ensures that the file-descriptor is closed when the promise returned by <code>f</code> resolves, or if <code>f</code> raises an exception.</p><p>See <code>Lwt_unix.openfile</code> for a description of the arguments, warnings, and other notes. Default values for <code>perm</code> is <code>0o640</code>.</p><p>Exceptions raised whilst opening or closing the file are wrapped in <code>Error</code>. When the error is <code>`Open</code>, the file could not be opened, and therefore the function <code>f</code> has not been run. When the error is <code>`Closed</code>, the function <code>f</code> was run but the file could not be closed.</p><p>Other exceptions are reraised.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-with_open_out"><a href="#val-with_open_out" class="anchor"></a><code><span><span class="keyword">val</span> with_open_out : 
  <span><span class="optlabel">?overwrite</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="xref-unresolved">Lwt_unix</span>.file_descr <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, <span><span>[&gt; `Open <span>| `Close</span> ]</span> <a href="#type-io_error">io_error</a></span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>with_open_out ?overwrite filename f</code> uses <code>with_open_file</code> with the flags <code>O_WRONLY; O_CREAT; O_CLOEXEC</code> and the default permissions. The flag <code>O_TRUNC</code> is added if <code>overwrite</code> is <code>true</code>, which is the case by default.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-with_atomic_open_out"><a href="#val-with_atomic_open_out" class="anchor"></a><code><span><span class="keyword">val</span> with_atomic_open_out : 
  <span><span class="optlabel">?overwrite</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?temp_dir</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="xref-unresolved">Lwt_unix</span>.file_descr <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, <span><span>[&gt; `Open <span>| `Close</span> <span>| `Rename</span> ]</span> <a href="#type-io_error">io_error</a></span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>with_atomic_open_out ?(overwrite=true) filename ?temp_dir f</code> is a wrapper around <code>with_open_out</code> that ensures that the data are written onto <code>filename</code> in an atomic way.</p><p>This function uses a temporary file stored in the <code>temp_dir</code> directory. Then, this temporary filed is renamed as <code>filename</code>.</p><p>The renaming may fail, for example if the temporary file is not on the same partition as <code>filename</code>.</p><p>If the renaming fails, an error <code>`Rename</code> is returned. See <a href="#val-with_open_file"><code>with_open_file</code></a> for a description of the other errors. In that case, no write have been done on <code>filename</code>.</p><p>The default value of <code>temp_dir</code> is the same as <code>Filename.temp_file</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-with_open_in"><a href="#val-with_open_in" class="anchor"></a><code><span><span class="keyword">val</span> with_open_in : 
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="xref-unresolved">Lwt_unix</span>.file_descr <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, <span><span>[&gt; `Open <span>| `Close</span> ]</span> <a href="#type-io_error">io_error</a></span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>with_open_in filename f</code> uses <code>with_open_file</code> with the flags <code>O_RDONLY; O_CLOEXEC</code> and the default permissions.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-safe_cancel_on_exit"><a href="#val-safe_cancel_on_exit" class="anchor"></a><code><span><span class="keyword">val</span> safe_cancel_on_exit : <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div></div></body></html>
