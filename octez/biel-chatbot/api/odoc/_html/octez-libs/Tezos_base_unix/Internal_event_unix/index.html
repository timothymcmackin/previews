<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Internal_event_unix (octez-libs.Tezos_base_unix.Internal_event_unix)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">octez-libs</a> &#x00BB; <a href="../index.html">Tezos_base_unix</a> &#x00BB; Internal_event_unix</nav><header class="odoc-preamble"><h1>Module <code><span>Tezos_base_unix.Internal_event_unix</span></code></h1><p>Configure the event-logging framework for UNIX-based applications.</p></header><div class="odoc-content"><p>The JSON-file-friendly definition of the configuration of the internal-events framework. It allows one to activate registered event sinks.</p><div class="odoc-spec"><div class="spec module anchored" id="module-Configuration"><a href="#module-Configuration" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Configuration/index.html">Configuration</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-env_var_name"><a href="#val-env_var_name" class="anchor"></a><code><span><span class="keyword">val</span> env_var_name : string</span></code></div><div class="spec-doc"><p>This is the environment variable name that contains the a list of URIs on which events can be reported (see <a href="#val-init"><code>init</code></a>).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-close"><a href="#val-close" class="anchor"></a><code><span><span class="keyword">val</span> close : <span>unit <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Call <code>close</code> on all the sinks.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-make_with_defaults"><a href="#val-make_with_defaults" class="anchor"></a><code><span><span class="keyword">val</span> make_with_defaults : 
  <span><span class="optlabel">?verbosity</span>:<a href="../../Tezos_event_logging/Internal_event/index.html#type-level">Tezos_event_logging.Internal_event.level</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?enable_default_daily_logs_at</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?daily_logs_section_prefixes</span>:
    <span><span>(string * <span><a href="../../Tezos_event_logging/Internal_event/index.html#type-level">Tezos_event_logging.Internal_event.level</a> option</span>)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?log_cfg</span>:<a href="../Logs_simple_config/index.html#type-cfg">Logs_simple_config.cfg</a> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <a href="../../Tezos_base/Internal_event_config/index.html#type-t">Tezos_base.Internal_event_config.t</a></span></code></div><div class="spec-doc"><p><code>make_defaults ?verbosity ?enable_default_daily_logs_at
    ?daily_logs_section_prefixes ?internal_events</code> creates internal event configuration using default values depending on parameters.</p><ul><li><code>verbosity</code> overrides the default level on stdout. Usually provided through -v instead of configuration.</li></ul><ul><li>If <code>internal_events</code> is provided, nothing is modified. Otherwise default values are used.</li></ul><ul><li><code>enable_default_daily_logs_at</code> adds daily rotating sink at the given path with the following value: <code>&quot;file-descriptor-path:///&lt;daily_logs_path&gt;/daily.log
    ?create-dirs=true&amp;daily-logs=7&amp;section-prefix=info&amp;format=pp&quot;</code></li></ul><p>This function handles <code>TEZOS_LOG</code> environment variables and rules provided through it. It also optionally accepts <code>?daily_logs_section_prefixes</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-init"><a href="#val-init" class="anchor"></a><code><span><span class="keyword">val</span> init : <span><span class="optlabel">?config</span>:<a href="../../Tezos_base/Internal_event_config/index.html#type-t">Tezos_base.Internal_event_config.t</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>init ?config ()</code> initializes the internal-event sinks using either</p><ul><li><code>&quot;TEZOS_EVENTS_CONFIG&quot;</code> environment variable,</li><li><code>config</code>, the value of configured sinks of command calling init, if provided,</li></ul><p>Note that if <code>config</code> is provided,the environment variable <code>TEZOS_LOG</code> is ignored.</p><p><code>&quot;TEZOS_EVENTS_CONFIG&quot;</code> is expected to be a (whitespace separated) list of URIs. If an URI does not have a scheme it is expected to be a path to a configuration JSON file (cf. <a href="Configuration/index.html#val-of_file"><code>Configuration.of_file</code></a>), e.g.: <code>export
  TEZOS_EVENTS_CONFIG=&quot;unix-files:///tmp/events-unix debug://&quot;</code>, or <code>export
  TEZOS_EVENTS_CONFIG=&quot;debug:// /path/to/config.json&quot;</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-enable_default_daily_logs_at"><a href="#val-enable_default_daily_logs_at" class="anchor"></a><code><span><span class="keyword">val</span> enable_default_daily_logs_at : 
  <span><span class="label">daily_logs_path</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span>unit <a href="../../Tezos_error_monad/Error_monad/index.html#type-tzresult">Tezos_base.TzPervasives.Error_monad.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Adds a daily rotating sink at the given path with the following value: <code>&quot;file-descriptor-path:///&lt;daily_logs_path&gt;/daily.log
    ?create-dirs=true&amp;daily-logs=7&amp;section-prefix=info&amp;format=pp&quot;</code></p></div></div></div></body></html>
