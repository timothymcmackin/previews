<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>tezos_lwt_result_stdlib (octez-libs.tezos_lwt_result_stdlib)</title><meta charset="utf-8"/><link rel="stylesheet" href="../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="index.html">Up</a> â€“ <a href="index.html">octez-libs</a> &#x00BB; tezos_lwt_result_stdlib</nav><header class="odoc-preamble"><h1 id="lwtreslib:-an-lwt--and-result-friendly-addition/replacement-for-the-stdlib"><a href="#lwtreslib:-an-lwt--and-result-friendly-addition/replacement-for-the-stdlib" class="anchor"></a>Lwtreslib: an Lwt- and Result-friendly addition/replacement for the Stdlib</h1><p>The OCaml's Stdlib modules are orthogonal: each define their own datatype and a set of functions operating on this datatype. <code>Result</code> for <code>result</code>, <code>Option</code> for <code>option</code>, <code>List</code> for <code>list</code>, etc. This orthogonality provides a high expressive power for a low lines-of-code count. E.g.,</p><pre class="language-ocaml"><code>let fold f init xs =
   List.fold_left
      (fun acc x -&gt; Result.bind acc (fun acc -&gt; f acc x))
      (Result.ok init)
      xs</code></pre><p>However, in code-bases that make heavy uses of some datatypes, a little more integration is welcome. For example, in code bases that use the <code>result</code> type pervasively, the <code>fold</code> function above should be available in a module of list-traversing functions.</p><p>Lwtreslib is a library that supplement some of the OCaml's Stdlib modules with a tight integration of Lwt and Result. It focuses on data-structures that can be traversed (iterated, mapped, folded, what have you).</p></header><nav class="odoc-toc"><ul><li><a href="#designprinciples">Design principles</a></li><li><a href="#api">API</a></li><li><a href="#reading-guide">Reading guide</a></li></ul></nav><div class="odoc-content"><h2 id="designprinciples"><a href="#designprinciples" class="anchor"></a>Design principles</h2><ol><li><p>Exception-safety</p><p>The functions exported by Lwtreslib do not raise exceptions. These functions may return <code>option</code> or <code>result</code> to indicate that some error happened during traversal, and they may propagate <code>result</code>.</p><p>(For convenience, the module <code>WithExceptions</code> provides a few exception-raising functions which are convenient in specific contexts.)</p></li><li><p>Coverage</p><p>As much as it makes sense, for each function <code>foo</code>, Lwtreslib also provides</p><ul><li><code>foo_e</code>: a variant operating on <code>result</code>,</li><li><code>foo_s</code>: a variant operating on <code>Lwt</code> promises, sequentially,</li><li><code>foo_es</code>: a variant operating on <code>Lwt</code> promises of results, sequentially,</li><li><code>foo_p</code>: a variant operating on <code>Lwt</code> promises, concurrently, and</li><li><code>foo_ep</code>: a variant operating on <code>Lwt</code> promises of results, concurrently.</li></ul><p>As mentioned, this is only applied when it makes sense. E.g., some traversals cannot happen concurrently in which case the <code>_p</code> and <code>_ep</code> are not provided.</p></li><li><p>Semantic consistency</p><p>Exported functions and values have consistent names that reflect their consistent semantic. For example, all <code>_e</code> and <code>_es</code> functions have a fail-early semantic wherein the traversal is interrupted as soon as an <code>Error</code> occurs.</p></li></ol><h2 id="api"><a href="#api" class="anchor"></a>API</h2><p>The <a href="Tezos_lwt_result_stdlib/index.html"><code>Tezos_lwt_result_stdlib</code></a> library exports a single top-level module <a href="Tezos_lwt_result_stdlib/Lwtreslib/index.html" title="Tezos_lwt_result_stdlib.Lwtreslib"><code>Lwtreslib</code></a>. This module exports <a href="Tezos_lwt_result_stdlib/Lwtreslib/Bare/index.html" title="Tezos_lwt_result_stdlib.Lwtreslib.Bare"><code>Bare</code></a> for simple traversal functions, and <a href="Tezos_lwt_result_stdlib/Lwtreslib/Traced/index.html" title="Tezos_lwt_result_stdlib.Lwtreslib.Traced"><code>Traced</code></a> for traversal with automatic composition of errors.</p><h2 id="reading-guide"><a href="#reading-guide" class="anchor"></a>Reading guide</h2><p>It is recommended to read the entirety of <a href="Tezos_lwt_result_stdlib/Lwtreslib/index.html" title="Tezos_lwt_result_stdlib.Lwtreslib">the documentation of the entry-point <code>Lwtreslib</code> module.</a> It contains a high-level overview as well as some details about notable features of the library.</p></div></body></html>
