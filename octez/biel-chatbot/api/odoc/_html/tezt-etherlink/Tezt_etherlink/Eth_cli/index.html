<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Eth_cli (tezt-etherlink.Tezt_etherlink.Eth_cli)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">tezt-etherlink</a> &#x00BB; <a href="../index.html">Tezt_etherlink</a> &#x00BB; Eth_cli</nav><header class="odoc-preamble"><h1>Module <code><span>Tezt_etherlink.Eth_cli</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value anchored" id="val-balance"><a href="#val-balance" class="anchor"></a><code><span><span class="keyword">val</span> balance : <span><span class="label">account</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="label">endpoint</span>:string <span class="arrow">&#45;&gt;</span></span> <span><a href="../Wei/index.html#type-t">Wei.t</a> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>balance ~account ~endpoint</code> asks the balance of <code>account</code> to the JSON-RPC API server listening at <code>endpoint</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-transaction_send"><a href="#val-transaction_send" class="anchor"></a><code><span><span class="keyword">val</span> transaction_send : 
  <span><span class="label">source_private_key</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">to_public_key</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">value</span>:<a href="../Wei/index.html#type-t">Wei.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">endpoint</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?data</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?gas_limit</span>:<span class="xref-unresolved">Z</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?gas_price</span>:<a href="../Wei/index.html#type-t">Wei.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>transaction_send ~source_private_key ~to_public_key ~value
    ~endpoint</code> crafts and signs a transaction transferring <code>value</code> (as Wei) from <code>source_private_key</code> to <code>to_public_key</code>, sends the raw transaction to the JSON-RPI API server listening at <code>endpoint</code>. It is allowed to optionally provide:</p><ul><li><code>data</code> The raw data field of the transaction. NB: Consider using <code>contract_send</code> instead of this function.</li><li><code>gas_limit</code> The gas limit of the transaction. Will be estimated if not specified.</li><li><code>gas_price</code> The gas price of the transaction, in wei. Defaults to 1 gwei.</li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-transaction_get"><a href="#val-transaction_get" class="anchor"></a><code><span><span class="keyword">val</span> transaction_get : 
  <span><span class="label">endpoint</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">tx_hash</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Transaction/index.html#type-transaction_object">Transaction.transaction_object</a> option</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>transaction_get ~endpoint ~tx_hash</code> returns the transaction object of <code>tx_hash</code> if it exists.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-add_abi"><a href="#val-add_abi" class="anchor"></a><code><span><span class="keyword">val</span> add_abi : <span><span class="label">label</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="label">abi</span>:string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>add_abi ~label ~abi ()</code> register an ABI (Application Binary Interface) in the client. <code>abi</code> should be a path to the json file. <code>label</code> is a string used by the client to register the ABI in memory so it can be refered to later.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-update_abi"><a href="#val-update_abi" class="anchor"></a><code><span><span class="keyword">val</span> update_abi : <span><span class="label">label</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="label">abi</span>:string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>update_abi ~label ~abi ()</code> update an ABI (Application Binary Interface) in the client. <code>abi</code> should be a path to the json file. <code>label</code> is a string used by the client to register the ABI in memory so it can be refered to later.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-check_abi"><a href="#val-check_abi" class="anchor"></a><code><span><span class="keyword">val</span> check_abi : <span><span class="label">label</span>:string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <span>bool <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>check_abi ~label ()</code> checks if an ABI is registered in the client.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-show_abi"><a href="#val-show_abi" class="anchor"></a><code><span><span class="keyword">val</span> show_abi : <span><span class="label">label</span>:string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <span>string <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>show_abi</code> ~label () returns the ABI registered in the client.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-deploy"><a href="#val-deploy" class="anchor"></a><code><span><span class="keyword">val</span> deploy : 
  <span><span class="optlabel">?args</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">source_private_key</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">endpoint</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">abi</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">bin</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span>(string * string)</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>deploy ?args ~source_private_key ~endpoint ~abi ~bin ()</code> crafts and sign a transaction deploying <code>bin</code> whose interface <code>abi</code> is registered in the client, and sends the raw transaction to the JSON-API server listening at <code>endpoint</code>. <code>bin</code> is a path to the binary file, and <code>abi</code> is the label used while registering the ABI in the client.</p><p>Returns a pair <code>(address, tx_hash)</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-contract_send"><a href="#val-contract_send" class="anchor"></a><code><span><span class="keyword">val</span> contract_send : 
  <span><span class="optlabel">?expect_failure</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">source_private_key</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">endpoint</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">abi_label</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">address</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">method_call</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?value</span>:<a href="../Wei/index.html#type-t">Wei.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?gas</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?gas_price</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>contract_send ~source_private_key ~endpoint ~abi_label ~address
    ~method_call ?value ?gas ()</code> makes a call to a contract found at <code>address</code>, with interface registered as <code>abi_labbel</code> in the client, signed with a user's <code>source_private_key</code>. <code>method_call</code> is the call data, as a solidity expression. If <code>gas</code> is specified, it will not try to estimate it.</p><p>This is a transaction to be included in a block.</p><p>example: <code>contract_send
      ~source_private_key
      ~endpoint
      ~abi_label:&quot;storage&quot;
      ~address:&quot;0xaaaa....aaaa&quot;
      ~method_call:&quot;set(42)&quot;
      ()</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-contract_call"><a href="#val-contract_call" class="anchor"></a><code><span><span class="keyword">val</span> contract_call : 
  <span><span class="optlabel">?expect_failure</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">endpoint</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">abi_label</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">address</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">method_call</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>contract_call ~endpoint ~abi_label ~address ~method_call ()</code> makes a call to a contract found at <code>address</code>, with interface registered as <code>abi_label</code> in the client, signed with a user's <code>source_private_key</code>. <code>method_call</code> is the call data, as a solidity expression.</p><p>This is a NOT transaction to be included in a block, but a simulation. It can be a state modifying transaction, in which case the modification are not included in a block. It can still be useful to test the result of a transaction before executing it &quot;for real&quot;, however the result might be different as the state could change between testing and execution.</p><p>example: <code>contract_call
      ~endpoint
      ~abi_label:&quot;storage&quot;
      ~address:&quot;0xaaaa....aaaa&quot;
      ~method_call:&quot;get()&quot;
      ()</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_block"><a href="#val-get_block" class="anchor"></a><code><span><span class="keyword">val</span> get_block : <span><span class="label">block_id</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="label">endpoint</span>:string <span class="arrow">&#45;&gt;</span></span> <span><a href="../Block/index.html#type-t">Block.t</a> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>get_block ~block_id ~endpoint</code> asks the block <code>block_id</code> (it can be a hash or a number) to the JSON-RPC API server listening at <code>endpoint</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-block_number"><a href="#val-block_number" class="anchor"></a><code><span><span class="keyword">val</span> block_number : <span><span class="label">endpoint</span>:string <span class="arrow">&#45;&gt;</span></span> <span>int <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>block_number ~endpoint</code> asks the current block number to the JSON-RPC API server listening at <code>endpoint</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_receipt"><a href="#val-get_receipt" class="anchor"></a><code><span><span class="keyword">val</span> get_receipt : 
  <span><span class="label">endpoint</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">tx</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Transaction/index.html#type-transaction_receipt">Transaction.transaction_receipt</a> option</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>get_receipt ~endpoint ~tx</code> returns the <code>transaction_receipt</code> objects of a mined transaction if it exists.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-encode_method"><a href="#val-encode_method" class="anchor"></a><code><span><span class="keyword">val</span> encode_method : <span><span class="label">abi_label</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="label">method_</span>:string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>encode_method ~abi_label ~method_</code> returns the data corresponding to <code>method_</code> call considering the given <code>abi</code>.</p></div></div></div></body></html>
