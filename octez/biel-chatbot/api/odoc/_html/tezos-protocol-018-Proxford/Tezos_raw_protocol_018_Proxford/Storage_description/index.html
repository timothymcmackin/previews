<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Storage_description (tezos-protocol-018-Proxford.Tezos_raw_protocol_018_Proxford.Storage_description)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">tezos-protocol-018-Proxford</a> &#x00BB; <a href="../index.html">Tezos_raw_protocol_018_Proxford</a> &#x00BB; Storage_description</nav><header class="odoc-preamble"><h1>Module <code><span>Tezos_raw_protocol_018_Proxford.Storage_description</span></code></h1><p>This module is responsible for building the description of the current state of the storage, which is then used to build specification of the RPC endpoints for accessing the storage. It produces <code>resto</code> <code>RPC_directory.t</code> values, which can be used directly to construct the RPC endpoint tree.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>'key t</span></span></code></div><div class="spec-doc"><p>Typed description of the key-value context.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span><span class="keyword">val</span> pp : 
  <span><a href="../../Tezos_protocol_environment_018_Proxford/Format/index.html#type-formatter">Tezos_protocol_environment_018_Proxford.Format.formatter</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'key</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p>Trivial display of the key-value context layout.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-build_directory"><a href="#val-build_directory" class="anchor"></a><code><span><span class="keyword">val</span> build_directory : 
  <span><span><span class="type-var">'key</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'key</span> <a href="../../Tezos_protocol_environment_018_Proxford/RPC_directory/index.html#type-t">Tezos_protocol_environment_018_Proxford.RPC_directory.t</a></span></span></code></div><div class="spec-doc"><p>Export an RPC hierarchy for querying the context. There is one service by possible path in the context. Services for &quot;directory&quot; are able to aggregate in one JSON object the whole subtree.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-create"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'key</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Create a empty context description, keys will be registered by side effects.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-register_value"><a href="#val-register_value" class="anchor"></a><code><span><span class="keyword">val</span> register_value : 
  <span><span><span class="type-var">'key</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">get</span>:
    <span>(<span><span class="type-var">'key</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span><span><span class="type-var">'a</span> option</span> <a href="../../Tezos_protocol_environment_018_Proxford/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_018_Proxford.Error_monad.tzresult</a></span>
        <a href="../../Tezos_protocol_environment_018_Proxford/Lwt/index.html#type-t">Tezos_protocol_environment_018_Proxford.Lwt.t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="../../Tezos_protocol_environment_018_Proxford/Data_encoding/index.html#type-t">Tezos_protocol_environment_018_Proxford.Data_encoding.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p>Register a single key accessor at a given path.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-register_named_subcontext"><a href="#val-register_named_subcontext" class="anchor"></a><code><span><span class="keyword">val</span> register_named_subcontext : <span><span><span class="type-var">'key</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'key</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Return a description for a prefixed fragment of the given context. All keys registered in the subcontext will be shared by the external context</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-args"><a href="#type-args" class="anchor"></a><code><span><span class="keyword">type</span> <span>(_, _, _) args</span></span><span> = </span></code><ol><li id="type-args.One" class="def variant constructor anchored"><a href="#type-args.One" class="anchor"></a><code><span>| </span><span><span class="constructor">One</span> : </span><span>{</span></code><ol><li id="type-args.rpc_arg" class="def record field anchored"><a href="#type-args.rpc_arg" class="anchor"></a><code><span>rpc_arg : <span><span class="type-var">'a</span> <a href="../../Tezos_protocol_environment_018_Proxford/RPC_arg/index.html#type-t">Tezos_protocol_environment_018_Proxford.RPC_arg.t</a></span>;</span></code></li><li id="type-args.encoding" class="def record field anchored"><a href="#type-args.encoding" class="anchor"></a><code><span>encoding : <span><span class="type-var">'a</span> <a href="../../Tezos_protocol_environment_018_Proxford/Data_encoding/index.html#type-t">Tezos_protocol_environment_018_Proxford.Data_encoding.t</a></span>;</span></code></li><li id="type-args.compare" class="def record field anchored"><a href="#type-args.compare" class="anchor"></a><code><span>compare : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> int;</span></code></li></ol><code><span>}</span><span> <span class="arrow">&#45;&gt;</span> <span><span>(<span class="type-var">'key</span>, <span class="type-var">'a</span>, <span class="type-var">'key</span> * <span class="type-var">'a</span>)</span> <a href="#type-args">args</a></span></span></code></li><li id="type-args.Pair" class="def variant constructor anchored"><a href="#type-args.Pair" class="anchor"></a><code><span>| </span><span><span class="constructor">Pair</span> : <span><span>(<span class="type-var">'key</span>, <span class="type-var">'a</span>, <span class="type-var">'inter_key</span>)</span> <a href="#type-args">args</a></span>
  * <span><span>(<span class="type-var">'inter_key</span>, <span class="type-var">'b</span>, <span class="type-var">'sub_key</span>)</span> <a href="#type-args">args</a></span> <span class="arrow">&#45;&gt;</span> <span><span>(<span class="type-var">'key</span>, <span class="type-var">'a</span> * <span class="type-var">'b</span>, <span class="type-var">'sub_key</span>)</span> <a href="#type-args">args</a></span></span></code></li></ol></div><div class="spec-doc"><p>Description of an index as a sequence of `RPC_arg.t`.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-register_indexed_subcontext"><a href="#val-register_indexed_subcontext" class="anchor"></a><code><span><span class="keyword">val</span> register_indexed_subcontext : 
  <span><span><span class="type-var">'key</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">list</span>:
    <span>(<span><span class="type-var">'key</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span><span><span class="type-var">'arg</span> list</span> <a href="../../Tezos_protocol_environment_018_Proxford/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_018_Proxford.Error_monad.tzresult</a></span>
        <a href="../../Tezos_protocol_environment_018_Proxford/Lwt/index.html#type-t">Tezos_protocol_environment_018_Proxford.Lwt.t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'key</span>, <span class="type-var">'arg</span>, <span class="type-var">'sub_key</span>)</span> <a href="#type-args">args</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'sub_key</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Return a description for a indexed sub-context. All keys registered in the subcontext will be shared by the external context. One should provide a function to list all the registered index in the context.</p></div></div><p>Helpers for manipulating and defining indexes.</p><div class="odoc-spec"><div class="spec value anchored" id="val-pack"><a href="#val-pack" class="anchor"></a><code><span><span class="keyword">val</span> pack : <span><span><span>(<span class="type-var">'key</span>, <span class="type-var">'a</span>, <span class="type-var">'sub_key</span>)</span> <a href="#type-args">args</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'key</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'sub_key</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unpack"><a href="#val-unpack" class="anchor"></a><code><span><span class="keyword">val</span> unpack : <span><span><span>(<span class="type-var">'key</span>, <span class="type-var">'a</span>, <span class="type-var">'sub_key</span>)</span> <a href="#type-args">args</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'sub_key</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'key</span> * <span class="type-var">'a</span></span></code></div></div><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-INDEX"><a href="#module-type-INDEX" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-INDEX/index.html">INDEX</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div></div></body></html>
