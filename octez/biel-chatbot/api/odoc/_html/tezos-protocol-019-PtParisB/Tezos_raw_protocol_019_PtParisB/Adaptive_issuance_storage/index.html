<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Adaptive_issuance_storage (tezos-protocol-019-PtParisB.Tezos_raw_protocol_019_PtParisB.Adaptive_issuance_storage)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">tezos-protocol-019-PtParisB</a> &#x00BB; <a href="../index.html">Tezos_raw_protocol_019_PtParisB</a> &#x00BB; Adaptive_issuance_storage</nav><header class="odoc-preamble"><h1>Module <code><span>Tezos_raw_protocol_019_PtParisB.Adaptive_issuance_storage</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value anchored" id="val-set_adaptive_issuance_enable"><a href="#val-set_adaptive_issuance_enable" class="anchor"></a><code><span><span class="keyword">val</span> set_adaptive_issuance_enable : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <a href="../../Tezos_protocol_environment_019_PtParisB/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_019_PtParisB.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_019_PtParisB/Lwt/index.html#type-t">Tezos_protocol_environment_019_PtParisB.Lwt.t</a></span></span></code></div><div class="spec-doc"><p><code>set_adaptive_issuance_enable ctxt</code> sets the feature flag in the in-memory part of the context if the adaptive issuance feature has already launched. This means that the activation vote resulted in an approbation from the stakeholders and this happened sufficiently long ago.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-load_reward_coeff"><a href="#val-load_reward_coeff" class="anchor"></a><code><span><span class="keyword">val</span> load_reward_coeff : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <a href="../../Tezos_protocol_environment_019_PtParisB/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_019_PtParisB.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_019_PtParisB/Lwt/index.html#type-t">Tezos_protocol_environment_019_PtParisB.Lwt.t</a></span></span></code></div><div class="spec-doc"><p><code>load_reward_coeff ctxt</code> loads the current cycle's reward coeff from the storage into the context</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-update_stored_rewards_at_cycle_end"><a href="#val-update_stored_rewards_at_cycle_end" class="anchor"></a><code><span><span class="keyword">val</span> update_stored_rewards_at_cycle_end : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">new_cycle</span>:<a href="../Cycle_repr/index.html#type-t">Cycle_repr.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <a href="../../Tezos_protocol_environment_019_PtParisB/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_019_PtParisB.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_019_PtParisB/Lwt/index.html#type-t">Tezos_protocol_environment_019_PtParisB.Lwt.t</a></span></span></code></div><div class="spec-doc"><p><code>update_stored_rewards_at_cycle_end ctxt ~new_cycle</code> updates <code>Storage.Issuance_coeff</code> with a new coefficient that will be applied <code>consensus_rights_delay</code> cycles after the given <code>new_cycle</code>. This new coefficient depends on the current <code>Storage.Total_supply</code>, and the total active stake for when this coefficient is computed.</p><p>This function also removes obsolete values from <code>Storage.Issuance_coeff</code>, and stores the current cycle's coefficient in the context for faster access.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-init"><a href="#val-init" class="anchor"></a><code><span><span class="keyword">val</span> init : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <a href="../../Tezos_protocol_environment_019_PtParisB/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_019_PtParisB.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_019_PtParisB/Lwt/index.html#type-t">Tezos_protocol_environment_019_PtParisB.Lwt.t</a></span></span></code></div><div class="spec-doc"><p><code>init ctxt</code> adds into the context an adaptive issuance vote EMA at 0, and adaptive issuance launch cycle at None.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-update_ema"><a href="#val-update_ema" class="anchor"></a><code><span><span class="keyword">val</span> update_ema : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">vote</span>:<a href="../Per_block_votes_repr/index.html#type-per_block_vote">Per_block_votes_repr.per_block_vote</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../Raw_context/index.html#type-t">Raw_context.t</a>
   * <span><a href="../Cycle_repr/index.html#type-t">Cycle_repr.t</a> option</span>
   * <a href="../Per_block_votes_repr/Adaptive_issuance_launch_EMA/index.html#type-t">Per_block_votes_repr.Adaptive_issuance_launch_EMA.t</a>)</span>
    <a href="../../Tezos_protocol_environment_019_PtParisB/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_019_PtParisB.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_019_PtParisB/Lwt/index.html#type-t">Tezos_protocol_environment_019_PtParisB.Lwt.t</a></span></span></code></div><div class="spec-doc"><p><code>update_ema ctxt ~vote</code> returns the new context with the new EMA</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-launch_cycle"><a href="#val-launch_cycle" class="anchor"></a><code><span><span class="keyword">val</span> launch_cycle : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><a href="../Cycle_repr/index.html#type-t">Cycle_repr.t</a> option</span>
    <a href="../../Tezos_protocol_environment_019_PtParisB/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_019_PtParisB.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_019_PtParisB/Lwt/index.html#type-t">Tezos_protocol_environment_019_PtParisB.Lwt.t</a></span></span></code></div><div class="spec-doc"><p><code>launch_cycle ctxt</code> reads from the context the cycle at which the adaptive issuance feature is set to activate.</p><p>If this function returns <code>None</code>, then it means the feature has not been voted to be activated (yet).</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-For_RPC"><a href="#module-For_RPC" class="anchor"></a><code><span><span class="keyword">module</span> <a href="For_RPC/index.html">For_RPC</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Internal_for_tests"><a href="#module-Internal_for_tests" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Internal_for_tests/index.html">Internal_for_tests</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div></div></body></html>
