<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Tx_rollup_l2_batch (tezos-protocol-017-PtNairob.Tezos_raw_protocol_017_PtNairob.Tx_rollup_l2_batch)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../index.html">tezos-protocol-017-PtNairob</a> &#x00BB; <a href="../index.html">Tezos_raw_protocol_017_PtNairob</a> &#x00BB; Tx_rollup_l2_batch</nav><header class="odoc-preamble"><h1>Module <code><span>Tezos_raw_protocol_017_PtNairob.Tx_rollup_l2_batch</span></code></h1><p>This module introduces the batches of transactions that the layer-2 (1) reads from its inboxes (see <a href="../Tx_rollup_message_repr/index.html#type-t.Batch"><code>Tx_rollup_message_repr.t.Batch</code></a>), and (2) interprets off-chain.</p><p>One of the main concerns of the transaction rollups is to provide a high-throughput to its participants. That is, transaction rollups are expected to be able to process a significant number of operations “per second.”</p><p>Putting aside the computational power required by the rollup node, the main limit to the throughput of a transaction rollup is the number of operations that can fit in a Tezos block. As such, the number of bytes that are necessary to store the batches is of key importance.</p><p>To estimate the theoretical maximum throughput of the transaction rollups as a feature, we can use the following methodology:</p><ul><li>Determine the number of bytes that can be allocated to layer-2 batches in a Tezos block, under the hypothesis that only layer-2 batch submissions and the consensus-related operations are included in said block. Ideally, this needs to take into account the limitation of the size of a layer-2 batch imposed by the layer-1 protocol, and the size of the signature that comes with an individual batch.</li><li>Divide this number by the average size of a layer-2 operation, this gives an estimate of the maximum layer-2 operations per block.</li><li>Divide again the result by the average time (in seconds) between two Tezos blocks; the result is the theoretical maximum number of operations per second the transaction rollups allow to process.</li></ul><p>That is, there is three parameters that decide the throughput of transaction rollups, and the average size of an operation is the only one under the control of the layer-2 implementation. Henceforth, both the definitions of types of this module and the implementation of their encodings have been carefully crafted in order to allow for compact batches.</p></header><nav class="odoc-toc"><ul><li><a href="#layer-2-batches-definitions">Layer-2 Batches Definitions</a></li><li><a href="#versioning">Versioning</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-signer"><a href="#type-signer" class="anchor"></a><code><span><span class="keyword">type</span> signer</span><span> = </span></code><ol><li id="type-signer.Bls_pk" class="def variant constructor anchored"><a href="#type-signer.Bls_pk" class="anchor"></a><code><span>| </span><span><span class="constructor">Bls_pk</span> <span class="keyword">of</span> <a href="../../Tezos_protocol_environment_017_PtNairob/Bls/Public_key/index.html#type-t">Tezos_protocol_environment_017_PtNairob.Bls.Public_key.t</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>A signer identified by a BLS public key.</p><span class="comment-delim">*)</span></div></li><li id="type-signer.L2_addr" class="def variant constructor anchored"><a href="#type-signer.L2_addr" class="anchor"></a><code><span>| </span><span><span class="constructor">L2_addr</span> <span class="keyword">of</span> <a href="../Tx_rollup_l2_address/index.html#type-t">Tx_rollup_l2_address.t</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>A signer identified by a layer-2 address. Each such adress is in turn identified with a BLS public key.</p><span class="comment-delim">*)</span></div></li></ol></div><div class="spec-doc"><p>Represents the <code>signer</code> of an layer-2 operation. This is either a BLS public key or a layer-2 address index, whose metadata in turn contains a corresponding BLS public. key</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Signer_indexable"><a href="#module-Signer_indexable" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Signer_indexable/index.html">Signer_indexable</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><h2 id="layer-2-batches-definitions"><a href="#layer-2-batches-definitions" class="anchor"></a>Layer-2 Batches Definitions</h2><p>The operations are versioned, to let the possibility to propose new features in future iterations of the protocol.</p><div class="odoc-spec"><div class="spec module anchored" id="module-V1"><a href="#module-V1" class="anchor"></a><code><span><span class="keyword">module</span> <a href="V1/index.html">V1</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><h2 id="versioning"><a href="#versioning" class="anchor"></a>Versioning</h2><p>To pave the road towards being able to update the semantics of the transaction rollups without having to interfere with the rejection mechanism, we preemptively back the notion of semantics versioning into the definition of a layer-2 batch.</p><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>('signer, 'content) t</span></span><span> = </span></code><ol><li id="type-t.V1" class="def variant constructor anchored"><a href="#type-t.V1" class="anchor"></a><code><span>| </span><span><span class="constructor">V1</span> <span class="keyword">of</span> <span><span>(<span class="type-var">'signer</span>, <span class="type-var">'content</span>)</span> <a href="V1/index.html#type-t">V1.t</a></span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-encoding"><a href="#val-encoding" class="anchor"></a><code><span><span class="keyword">val</span> encoding : 
  <span><span><span>(<a href="../Indexable/index.html#type-unknown">Indexable.unknown</a>, <a href="../Indexable/index.html#type-unknown">Indexable.unknown</a>)</span> <a href="#type-t">t</a></span>
    <a href="../../Tezos_protocol_environment_017_PtNairob/Data_encoding/index.html#type-t">Tezos_protocol_environment_017_PtNairob.Data_encoding.t</a></span></span></code></div><div class="spec-doc"><p>An encoding for <code>t</code> that uses a specialized, space-efficient encoding for the list of transactions.</p></div></div></div></body></html>
