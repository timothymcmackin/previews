<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Tx_rollup_l2_context (tezos-protocol-017-PtNairob.Tezos_raw_protocol_017_PtNairob.Tx_rollup_l2_context)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">tezos-protocol-017-PtNairob</a> &#x00BB; <a href="../index.html">Tezos_raw_protocol_017_PtNairob</a> &#x00BB; Tx_rollup_l2_context</nav><header class="odoc-preamble"><h1>Module <code><span>Tezos_raw_protocol_017_PtNairob.Tx_rollup_l2_context</span></code></h1></header><nav class="odoc-toc"><ul><li><a href="#type-safe-storage-access-and-gas-accounting">Type-Safe Storage Access and Gas Accounting</a></li><li><a href="#errors">Errors</a></li><li><a href="#the-context-functor">The Context Functor</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec value anchored" id="val-metadata_encoding"><a href="#val-metadata_encoding" class="anchor"></a><code><span><span class="keyword">val</span> metadata_encoding : 
  <span><a href="../Tx_rollup_l2_context_sig/index.html#type-metadata">Tx_rollup_l2_context_sig.metadata</a>
    <a href="../../Tezos_protocol_environment_017_PtNairob/Data_encoding/index.html#type-encoding">Tezos_protocol_environment_017_PtNairob.Data_encoding.encoding</a></span></span></code></div></div><h2 id="type-safe-storage-access-and-gas-accounting"><a href="#type-safe-storage-access-and-gas-accounting" class="anchor"></a>Type-Safe Storage Access and Gas Accounting</h2><div class="odoc-spec"><div class="spec type anchored" id="type-key"><a href="#type-key" class="anchor"></a><code><span><span class="keyword">type</span> <span>_ key</span></span><span> = </span></code><ol><li id="type-key.Address_metadata" class="def variant constructor anchored"><a href="#type-key.Address_metadata" class="anchor"></a><code><span>| </span><span><span class="constructor">Address_metadata</span> : <a href="../Tx_rollup_l2_context_sig/index.html#type-address_index">Tx_rollup_l2_context_sig.address_index</a> <span class="arrow">&#45;&gt;</span> <span><a href="../Tx_rollup_l2_context_sig/index.html#type-metadata">Tx_rollup_l2_context_sig.metadata</a>
                                                               <a href="#type-key">key</a></span></span></code></li><li id="type-key.Address_count" class="def variant constructor anchored"><a href="#type-key.Address_count" class="anchor"></a><code><span>| </span><span><span class="constructor">Address_count</span> : <span>int32 <a href="#type-key">key</a></span></span></code></li><li id="type-key.Address_index" class="def variant constructor anchored"><a href="#type-key.Address_index" class="anchor"></a><code><span>| </span><span><span class="constructor">Address_index</span> : <a href="../Tx_rollup_l2_address/index.html#type-t">Tx_rollup_l2_address.t</a> <span class="arrow">&#45;&gt;</span> <span><a href="../Tx_rollup_l2_context_sig/index.html#type-address_index">Tx_rollup_l2_context_sig.address_index</a>
                                            <a href="#type-key">key</a></span></span></code></li><li id="type-key.Ticket_count" class="def variant constructor anchored"><a href="#type-key.Ticket_count" class="anchor"></a><code><span>| </span><span><span class="constructor">Ticket_count</span> : <span>int32 <a href="#type-key">key</a></span></span></code></li><li id="type-key.Ticket_index" class="def variant constructor anchored"><a href="#type-key.Ticket_index" class="anchor"></a><code><span>| </span><span><span class="constructor">Ticket_index</span> : <a href="../Alpha_context/Ticket_hash/index.html#type-t">Alpha_context.Ticket_hash.t</a> <span class="arrow">&#45;&gt;</span> <span><a href="../Tx_rollup_l2_context_sig/index.html#type-ticket_index">Tx_rollup_l2_context_sig.ticket_index</a>
                                                <a href="#type-key">key</a></span></span></code></li><li id="type-key.Ticket_ledger" class="def variant constructor anchored"><a href="#type-key.Ticket_ledger" class="anchor"></a><code><span>| </span><span><span class="constructor">Ticket_ledger</span> : <a href="../Tx_rollup_l2_context_sig/index.html#type-ticket_index">Tx_rollup_l2_context_sig.ticket_index</a>
  * <a href="../Tx_rollup_l2_context_sig/index.html#type-address_index">Tx_rollup_l2_context_sig.address_index</a> <span class="arrow">&#45;&gt;</span> <span><a href="../Tx_rollup_l2_qty/index.html#type-t">Tx_rollup_l2_qty.t</a> <a href="#type-key">key</a></span></span></code></li></ol></div><div class="spec-doc"><p>A value of type <code>'a key</code> identifies a value of type <code>'a</code> in an underlying, untyped storage.</p><p>This GADT is used to enforce type-safety of the abstraction of the transactions rollup context. For this abstraction to work, it is necessary to ensure that the serialization of values <code>'a
    key</code> and <code>'b key</code> cannot collide. To that end, we use <code>Data_encoding</code> (see <a href="#val-packed_key_encoding"><code>packed_key_encoding</code></a>).</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-packed_key"><a href="#type-packed_key" class="anchor"></a><code><span><span class="keyword">type</span> packed_key</span><span> = </span></code><ol><li id="type-packed_key.Key" class="def variant constructor anchored"><a href="#type-packed_key.Key" class="anchor"></a><code><span>| </span><span><span class="constructor">Key</span> : <span><span class="type-var">'a</span> <a href="#type-key">key</a></span> <span class="arrow">&#45;&gt;</span> <a href="#type-packed_key">packed_key</a></span></code></li></ol></div><div class="spec-doc"><p>A monomorphic version of <a href="#type-packed_key.Key"><code>Key</code></a>, used for serialization purposes.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-packed_key_encoding"><a href="#val-packed_key_encoding" class="anchor"></a><code><span><span class="keyword">val</span> packed_key_encoding : 
  <span><a href="#type-packed_key">packed_key</a> <a href="../../Tezos_protocol_environment_017_PtNairob/Data_encoding/index.html#type-t">Tezos_protocol_environment_017_PtNairob.Data_encoding.t</a></span></span></code></div><div class="spec-doc"><p>The encoding used to serialize keys to be used with an untyped storage.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-value_encoding"><a href="#val-value_encoding" class="anchor"></a><code><span><span class="keyword">val</span> value_encoding : 
  'a. <span><span><span class="type-var">'a</span> <a href="#type-key">key</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="../../Tezos_protocol_environment_017_PtNairob/Data_encoding/index.html#type-t">Tezos_protocol_environment_017_PtNairob.Data_encoding.t</a></span></span></code></div><div class="spec-doc"><p><code>value_encoding key</code> returns the encoding to be used to serialize and deserialize values associated to a <code>key</code> from and to the underlying storage.</p></div></div><h2 id="errors"><a href="#errors" class="anchor"></a>Errors</h2><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-Key_cannot_be_serialized"><a href="#extension-decl-Key_cannot_be_serialized" class="anchor"></a><code><span><span class="keyword">type</span> <a href="../../Tezos_protocol_environment_017_PtNairob/Error_monad/index.html#type-error">Tezos_protocol_environment_017_PtNairob.Error_monad.error</a> += </span></code><ol><li id="extension-Key_cannot_be_serialized" class="def variant extension anchored"><a href="#extension-Key_cannot_be_serialized" class="anchor"></a><code><span>| </span><span><span class="extension">Key_cannot_be_serialized</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-Value_cannot_be_serialized"><a href="#extension-decl-Value_cannot_be_serialized" class="anchor"></a><code><span><span class="keyword">type</span> <a href="../../Tezos_protocol_environment_017_PtNairob/Error_monad/index.html#type-error">Tezos_protocol_environment_017_PtNairob.Error_monad.error</a> += </span></code><ol><li id="extension-Value_cannot_be_serialized" class="def variant extension anchored"><a href="#extension-Value_cannot_be_serialized" class="anchor"></a><code><span>| </span><span><span class="extension">Value_cannot_be_serialized</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-Value_cannot_be_deserialized"><a href="#extension-decl-Value_cannot_be_deserialized" class="anchor"></a><code><span><span class="keyword">type</span> <a href="../../Tezos_protocol_environment_017_PtNairob/Error_monad/index.html#type-error">Tezos_protocol_environment_017_PtNairob.Error_monad.error</a> += </span></code><ol><li id="extension-Value_cannot_be_deserialized" class="def variant extension anchored"><a href="#extension-Value_cannot_be_deserialized" class="anchor"></a><code><span>| </span><span><span class="extension">Value_cannot_be_deserialized</span></span></code></li></ol></div></div><h2 id="the-context-functor"><a href="#the-context-functor" class="anchor"></a>The Context Functor</h2><div class="odoc-spec"><div class="spec module anchored" id="module-Make"><a href="#module-Make" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Make/index.html">Make</a></span><span>
  (<a href="Make/argument-1-S/index.html">S</a> : <a href="../Tx_rollup_l2_storage_sig/module-type-STORAGE/index.html">Tx_rollup_l2_storage_sig.STORAGE</a>) : 
  <a href="../Tx_rollup_l2_context_sig/module-type-CONTEXT/index.html">Tx_rollup_l2_context_sig.CONTEXT</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="../Tx_rollup_l2_context_sig/module-type-CONTEXT/index.html#type-t">t</a> = <a href="Make/argument-1-S/index.html#type-t">S.t</a></span> <span class="keyword">and</span> <span><span class="keyword">type</span> <span>'a <a href="../Tx_rollup_l2_context_sig/module-type-CONTEXT/index.html#type-m">m</a></span> = <span><span class="type-var">'a</span> <a href="Make/argument-1-S/index.html#type-m">S.m</a></span></span></span></code></div></div></div></body></html>
