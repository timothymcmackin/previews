<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Level_repr (tezos-protocol-011-PtHangz2.Tezos_raw_protocol_011_PtHangz2.Level_repr)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">tezos-protocol-011-PtHangz2</a> &#x00BB; <a href="../index.html">Tezos_raw_protocol_011_PtHangz2</a> &#x00BB; Level_repr</nav><header class="odoc-preamble"><h1>Module <code><span>Tezos_raw_protocol_011_PtHangz2.Level_repr</span></code></h1><p>This module defines the protocol representation of a level. Besides the &quot;raw level&quot;, which is the shell's notion of the level, this representation also contains additional information, like the cycle the level belongs to.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = <span class="keyword">private</span> </span><span>{</span></code><ol><li id="type-t.level" class="def record field anchored"><a href="#type-t.level" class="anchor"></a><code><span>level : <a href="../Raw_level_repr/index.html#type-t">Raw_level_repr.t</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The level of the block relative to genesis. This is also the Shell's notion of level.</p><span class="comment-delim">*)</span></div></li><li id="type-t.level_position" class="def record field anchored"><a href="#type-t.level_position" class="anchor"></a><code><span>level_position : int32;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The level of the block relative to the block that starts the alpha family of protocols.</p><span class="comment-delim">*)</span></div></li><li id="type-t.cycle" class="def record field anchored"><a href="#type-t.cycle" class="anchor"></a><code><span>cycle : <a href="../Cycle_repr/index.html#type-t">Cycle_repr.t</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The current cycle's number. Note that cycles are a protocol-specific notion. As a result, the cycle number starts at 0 with the first block of the first version of protocol alpha.</p><span class="comment-delim">*)</span></div></li><li id="type-t.cycle_position" class="def record field anchored"><a href="#type-t.cycle_position" class="anchor"></a><code><span>cycle_position : int32;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The current level of the block relative to the first block of the current cycle.</p><span class="comment-delim">*)</span></div></li><li id="type-t.expected_commitment" class="def record field anchored"><a href="#type-t.expected_commitment" class="anchor"></a><code><span>expected_commitment : bool;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-level"><a href="#type-level" class="anchor"></a><code><span><span class="keyword">type</span> level</span><span> = <a href="#type-t">t</a></span></code></div></div><div class="odoc-include"><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <a href="../../Tezos_protocol_environment_011_PtHangz2/Compare/module-type-S/index.html">Tezos_protocol_environment_011_PtHangz2.Compare.S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="../../Tezos_protocol_environment_011_PtHangz2/Compare/module-type-S/index.html#type-t">t</a> := <a href="#type-level">level</a></span></span></code></summary><div class="odoc-spec"><div class="spec value anchored" id="val-(=)"><a href="#val-(=)" class="anchor"></a><code><span><span class="keyword">val</span> (=) : <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-(&lt;&gt;)"><a href="#val-(&lt;&gt;)" class="anchor"></a><code><span><span class="keyword">val</span> (&lt;&gt;) : <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-(&lt;)"><a href="#val-(&lt;)" class="anchor"></a><code><span><span class="keyword">val</span> (&lt;) : <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-(&lt;=)"><a href="#val-(&lt;=)" class="anchor"></a><code><span><span class="keyword">val</span> (&lt;=) : <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-(&gt;=)"><a href="#val-(&gt;=)" class="anchor"></a><code><span><span class="keyword">val</span> (&gt;=) : <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-(&gt;)"><a href="#val-(&gt;)" class="anchor"></a><code><span><span class="keyword">val</span> (&gt;) : <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-compare"><a href="#val-compare" class="anchor"></a><code><span><span class="keyword">val</span> compare : <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-equal"><a href="#val-equal" class="anchor"></a><code><span><span class="keyword">val</span> equal : <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-max"><a href="#val-max" class="anchor"></a><code><span><span class="keyword">val</span> max : <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-level">level</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-min"><a href="#val-min" class="anchor"></a><code><span><span class="keyword">val</span> min : <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-level">level</a></span></code></div></div></details></div><div class="odoc-spec"><div class="spec value anchored" id="val-encoding"><a href="#val-encoding" class="anchor"></a><code><span><span class="keyword">val</span> encoding : <span><a href="#type-level">level</a> <a href="../../Tezos_protocol_environment_011_PtHangz2/Data_encoding/index.html#type-t">Tezos_protocol_environment_011_PtHangz2.Data_encoding.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span><span class="keyword">val</span> pp : 
  <span><a href="../../Tezos_protocol_environment_011_PtHangz2/Format/index.html#type-formatter">Tezos_protocol_environment_011_PtHangz2.Format.formatter</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_full"><a href="#val-pp_full" class="anchor"></a><code><span><span class="keyword">val</span> pp_full : 
  <span><a href="../../Tezos_protocol_environment_011_PtHangz2/Format/index.html#type-formatter">Tezos_protocol_environment_011_PtHangz2.Format.formatter</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-diff"><a href="#val-diff" class="anchor"></a><code><span><span class="keyword">val</span> diff : <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> int32</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-cycle_era"><a href="#type-cycle_era" class="anchor"></a><code><span><span class="keyword">type</span> cycle_era</span><span> = </span><span>{</span></code><ol><li id="type-cycle_era.first_level" class="def record field anchored"><a href="#type-cycle_era.first_level" class="anchor"></a><code><span>first_level : <a href="../Raw_level_repr/index.html#type-t">Raw_level_repr.t</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The first level of a cycle era.</p><span class="comment-delim">*)</span></div></li><li id="type-cycle_era.first_cycle" class="def record field anchored"><a href="#type-cycle_era.first_cycle" class="anchor"></a><code><span>first_cycle : <a href="../Cycle_repr/index.html#type-t">Cycle_repr.t</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The first cycle of a cycle era.</p><span class="comment-delim">*)</span></div></li><li id="type-cycle_era.blocks_per_cycle" class="def record field anchored"><a href="#type-cycle_era.blocks_per_cycle" class="anchor"></a><code><span>blocks_per_cycle : int32;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The value of the blocks_per_cycle constant used during the cycle era starting with first_level.</p><span class="comment-delim">*)</span></div></li><li id="type-cycle_era.blocks_per_commitment" class="def record field anchored"><a href="#type-cycle_era.blocks_per_commitment" class="anchor"></a><code><span>blocks_per_commitment : int32;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The value of the blocks_per_commitment constant used during the cycle era starting with first_level.</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>A cycle era is a chunk of cycles having the same number of levels per cycle and the same number of blocks per commitment.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-cycle_eras"><a href="#type-cycle_eras" class="anchor"></a><code><span><span class="keyword">type</span> cycle_eras</span></code></div><div class="spec-doc"><p>Stores the cycles eras of the Alpha family of protocols</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-cycle_eras_encoding"><a href="#val-cycle_eras_encoding" class="anchor"></a><code><span><span class="keyword">val</span> cycle_eras_encoding : 
  <span><a href="#type-cycle_eras">cycle_eras</a> <a href="../../Tezos_protocol_environment_011_PtHangz2/Data_encoding/index.html#type-t">Tezos_protocol_environment_011_PtHangz2.Data_encoding.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-create_cycle_eras"><a href="#val-create_cycle_eras" class="anchor"></a><code><span><span class="keyword">val</span> create_cycle_eras : 
  <span><span><a href="#type-cycle_era">cycle_era</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-cycle_eras">cycle_eras</a> <a href="../../Tezos_protocol_environment_011_PtHangz2/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_011_PtHangz2.Error_monad.tzresult</a></span></span></code></div><div class="spec-doc"><p>Preconditions on the input list of cycle eras:</p><ul><li>the list is not empty</li><li>the first levels and the first cycles are decreasing, meaning that the first era in the list is the current era, and the last era in the list is the oldest era Invariants:</li><li>the first era therefore contains the same constants as in Constants</li><li>the first level of an era is the first level of a cycle</li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-current_era"><a href="#val-current_era" class="anchor"></a><code><span><span class="keyword">val</span> current_era : <span><a href="#type-cycle_eras">cycle_eras</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-cycle_era">cycle_era</a></span></code></div><div class="spec-doc"><p>Returns the current era</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-root_level"><a href="#val-root_level" class="anchor"></a><code><span><span class="keyword">val</span> root_level : <span><a href="#type-cycle_eras">cycle_eras</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-level">level</a></span></code></div><div class="spec-doc"><p>Returns the first level of the oldest era</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-from_raw"><a href="#val-from_raw" class="anchor"></a><code><span><span class="keyword">val</span> from_raw : <span><span class="label">cycle_eras</span>:<a href="#type-cycle_eras">cycle_eras</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Raw_level_repr/index.html#type-t">Raw_level_repr.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-level">level</a></span></code></div><div class="spec-doc"><p>Returns the annotated level corresponding to a raw level</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-from_raw_with_offset"><a href="#val-from_raw_with_offset" class="anchor"></a><code><span><span class="keyword">val</span> from_raw_with_offset : 
  <span><span class="label">cycle_eras</span>:<a href="#type-cycle_eras">cycle_eras</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">offset</span>:int32 <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Raw_level_repr/index.html#type-t">Raw_level_repr.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-level">level</a> <a href="../../Tezos_protocol_environment_011_PtHangz2/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_011_PtHangz2.Error_monad.tzresult</a></span></span></code></div><div class="spec-doc"><p>Returns the annotated level corresponding to a raw level and an offset. A positive offset corresponds to a higher level. Fails with <code>Negative_level_and_offset_sum</code> if the sum of the raw_level and the offset is negative.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-first_level_in_cycle_from_eras"><a href="#val-first_level_in_cycle_from_eras" class="anchor"></a><code><span><span class="keyword">val</span> first_level_in_cycle_from_eras : 
  <span><span class="label">cycle_eras</span>:<a href="#type-cycle_eras">cycle_eras</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Cycle_repr/index.html#type-t">Cycle_repr.t</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-level">level</a></span></code></div><div class="spec-doc"><p>Returns the first level of the given cycle.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-last_of_cycle"><a href="#val-last_of_cycle" class="anchor"></a><code><span><span class="keyword">val</span> last_of_cycle : <span><span class="label">cycle_eras</span>:<a href="#type-cycle_eras">cycle_eras</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Returns true if the given level is the last of a cycle.</p></div></div></div></body></html>
