<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Block (octez-protocol-alpha-libs.Tezos_alpha_test_helpers.Block)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">octez-protocol-alpha-libs</a> &#x00BB; <a href="../index.html">Tezos_alpha_test_helpers</a> &#x00BB; Block</nav><header class="odoc-preamble"><h1>Module <code><span>Tezos_alpha_test_helpers.Block</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = </span><span>{</span></code><ol><li id="type-t.hash" class="def record field anchored"><a href="#type-t.hash" class="anchor"></a><code><span>hash : <a href="../../../octez-libs/Tezos_crypto/Hashed/Block_hash/index.html#type-t">Tezos_base.TzPervasives.Block_hash.t</a>;</span></code></li><li id="type-t.header" class="def record field anchored"><a href="#type-t.header" class="anchor"></a><code><span>header : <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Block_header/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Block_header.t</a>;</span></code></li><li id="type-t.operations" class="def record field anchored"><a href="#type-t.operations" class="anchor"></a><code><span>operations : <span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Operation/index.html#type-packed">Tezos_protocol_alpha.Protocol.Alpha_context.Operation.packed</a> list</span>;</span></code></li><li id="type-t.context" class="def record field anchored"><a href="#type-t.context" class="anchor"></a><code><span>context : <a href="../../../octez-proto-libs/Tezos_protocol_environment/Context/index.html#type-t">Tezos_protocol_environment.Context.t</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Resulting context</p><span class="comment-delim">*)</span></div></li><li id="type-t.constants" class="def record field anchored"><a href="#type-t.constants" class="anchor"></a><code><span>constants : <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Constants/Parametric/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Constants.Parametric.t</a>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-block"><a href="#type-block" class="anchor"></a><code><span><span class="keyword">type</span> block</span><span> = <a href="#type-t">t</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_alpha_ctxt"><a href="#val-get_alpha_ctxt" class="anchor"></a><code><span><span class="keyword">val</span> get_alpha_ctxt : 
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/index.html#type-context">Tezos_protocol_alpha.Protocol.Alpha_context.context</a>
    <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Not the same as <code>Context.get_alpha_ctxt</code> as it does not construct a new block</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-rpc_ctxt"><a href="#val-rpc_ctxt" class="anchor"></a><code><span><span class="keyword">val</span> rpc_ctxt : <span><a href="#type-t">t</a> <a href="../../../tezos-protocol-alpha/Tezos_protocol_environment_alpha/RPC_context/class-type-simple/index.html">Tezos_protocol_alpha.Environment.RPC_context.simple</a></span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-baker_policy"><a href="#type-baker_policy" class="anchor"></a><code><span><span class="keyword">type</span> baker_policy</span><span> = </span></code><ol><li id="type-baker_policy.By_round" class="def variant constructor anchored"><a href="#type-baker_policy.By_round" class="anchor"></a><code><span>| </span><span><span class="constructor">By_round</span> <span class="keyword">of</span> int</span></code></li><li id="type-baker_policy.By_account" class="def variant constructor anchored"><a href="#type-baker_policy.By_account" class="anchor"></a><code><span>| </span><span><span class="constructor">By_account</span> <span class="keyword">of</span> <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/index.html#type-public_key_hash">Tezos_protocol_alpha.Protocol.Alpha_context.public_key_hash</a></span></code></li><li id="type-baker_policy.Excluding" class="def variant constructor anchored"><a href="#type-baker_policy.Excluding" class="anchor"></a><code><span>| </span><span><span class="constructor">Excluding</span> <span class="keyword">of</span> <span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/index.html#type-public_key_hash">Tezos_protocol_alpha.Protocol.Alpha_context.public_key_hash</a> list</span></span></code></li></ol></div><div class="spec-doc"><p>Policies to select the next baker:</p><ul><li><code>By_round r</code> selects the baker at round <code>r</code></li><li><code>By_account pkh</code> selects the first slot for baker <code>pkh</code></li><li><code>Excluding pkhs</code> selects the first valid baker that doesn't belong to <code>pkhs</code></li></ul><p>Note that bakers can have active consensus keys different from their regular delegate keys. For the <code>By_account pkh</code> policy, <code>pkh</code> refers to the baker's delegate key. However, for the <code>Excluding pkhs</code> policy, <code>pkhs</code> refer to the baker's active consensus key.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-baking_mode"><a href="#type-baking_mode" class="anchor"></a><code><span><span class="keyword">type</span> baking_mode</span><span> = </span></code><ol><li id="type-baking_mode.Application" class="def variant constructor anchored"><a href="#type-baking_mode.Application" class="anchor"></a><code><span>| </span><span><span class="constructor">Application</span></span></code></li><li id="type-baking_mode.Baking" class="def variant constructor anchored"><a href="#type-baking_mode.Baking" class="anchor"></a><code><span>| </span><span><span class="constructor">Baking</span></span></code></li></ol></div><div class="spec-doc"><p>The default baking functions below is to use (blocks) <code>Application</code> mode. Setting <code>baking_mode</code> allows to switch to <code>Full_construction</code> mode.</p></div></div><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-No_slots_found_for"><a href="#extension-decl-No_slots_found_for" class="anchor"></a><code><span><span class="keyword">type</span> <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-error">Tezos_base.TzPervasives.error</a> += </span></code><ol><li id="extension-No_slots_found_for" class="def variant extension anchored"><a href="#extension-No_slots_found_for" class="anchor"></a><code><span>| </span><span><span class="extension">No_slots_found_for</span> <span class="keyword">of</span> <a href="../../../octez-libs/Tezos_crypto/Signature/Public_key_hash/index.html#type-t">Tezos_base.TzPervasives.Signature.Public_key_hash.t</a></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_next_baker"><a href="#val-get_next_baker" class="anchor"></a><code><span><span class="keyword">val</span> get_next_baker : 
  <span><span class="optlabel">?policy</span>:<a href="#type-baker_policy">baker_policy</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/index.html#type-public_key_hash">Tezos_protocol_alpha.Protocol.Alpha_context.public_key_hash</a>
   * <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/index.html#type-public_key_hash">Tezos_protocol_alpha.Protocol.Alpha_context.public_key_hash</a>
   * int
   * <a href="../../../octez-libs/Tezos_base/Time/Protocol/index.html#type-t">Tezos_base.TzPervasives.Time.Protocol.t</a>)</span>
    <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Returns (account, consensus_key, round, timestamp) of the next baker given a policy, defaults to By_round 0.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_round"><a href="#val-get_round" class="anchor"></a><code><span><span class="keyword">val</span> get_round : 
  <span><a href="#type-block">block</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Round/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Round.t</a>
    <a href="../../../tezos-protocol-alpha/Tezos_protocol_environment_alpha/Error_monad/index.html#type-tzresult">Tezos_protocol_alpha.Environment.Error_monad.tzresult</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-block_producer"><a href="#val-block_producer" class="anchor"></a><code><span><span class="keyword">val</span> block_producer : 
  <span><a href="#type-block">block</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Consensus_key/index.html#type-pk">Tezos_protocol_alpha.Protocol.Alpha_context.Consensus_key.pk</a>
    <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Returns the consensus key that was used to bake the block.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Forge"><a href="#module-Forge" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Forge/index.html">Forge</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-check_constants_consistency"><a href="#val-check_constants_consistency" class="anchor"></a><code><span><span class="keyword">val</span> check_constants_consistency : 
  <span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Constants/Parametric/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Constants.Parametric.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>unit <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-genesis"><a href="#val-genesis" class="anchor"></a><code><span><span class="keyword">val</span> genesis : 
  <span><span class="optlabel">?commitments</span>:<span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Commitment/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Commitment.t</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?consensus_committee_size</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?consensus_threshold</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?min_proposal_quorum</span>:int32 <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?bootstrap_contracts</span>:
    <span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Parameters/index.html#type-bootstrap_contract">Tezos_protocol_alpha.Protocol.Alpha_context.Parameters.bootstrap_contract</a>
      list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?level</span>:int32 <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?cost_per_byte</span>:<a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Tez/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Tez.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?issuance_weights</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Constants/Parametric/index.html#type-issuance_weights">Tezos_protocol_alpha.Protocol.Alpha_context.Constants.Parametric.issuance_weights</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?origination_size</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?blocks_per_cycle</span>:int32 <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?cycles_per_voting_period</span>:int32 <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?sc_rollup_arith_pvm_enable</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?sc_rollup_private_enable</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?sc_rollup_riscv_pvm_enable</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dal_enable</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?zk_rollup_enable</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?hard_gas_limit_per_block</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Gas/Arith/index.html#type-integral">Tezos_protocol_alpha.Protocol.Alpha_context.Gas.Arith.integral</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?nonce_revelation_threshold</span>:int32 <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dal</span>:<a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Constants/Parametric/index.html#type-dal">Tezos_protocol_alpha.Protocol.Alpha_context.Constants.Parametric.dal</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?adaptive_issuance</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Constants/Parametric/index.html#type-adaptive_issuance">Tezos_protocol_alpha.Protocol.Alpha_context.Constants.Parametric.adaptive_issuance</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?allow_tz4_delegate_enable</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?aggregate_attestation</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Parameters/index.html#type-bootstrap_account">Tezos_protocol_alpha.Protocol.Alpha_context.Parameters.bootstrap_account</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-block">block</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>genesis &lt;opts&gt; accounts</code> : generates an initial block with the given constants <code>&lt;opts&gt;</code> and initializes <code>accounts</code> with their associated amounts.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-genesis_with_parameters"><a href="#val-genesis_with_parameters" class="anchor"></a><code><span><span class="keyword">val</span> genesis_with_parameters : 
  <span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Parameters/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Parameters.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-block">block</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-alpha_context"><a href="#val-alpha_context" class="anchor"></a><code><span><span class="keyword">val</span> alpha_context : 
  <span><span class="optlabel">?commitments</span>:<span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Commitment/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Commitment.t</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?min_proposal_quorum</span>:int32 <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?consensus_rights_delay</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Parameters/index.html#type-bootstrap_account">Tezos_protocol_alpha.Protocol.Alpha_context.Parameters.bootstrap_account</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.t</a>
    <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>alpha_context &lt;opts&gt; accounts</code> : instantiates an alpha_context with the given constants <code>&lt;opts&gt;</code> and initializes <code>accounts</code> with their associated amounts.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_application_vstate"><a href="#val-get_application_vstate" class="anchor"></a><code><span><span class="keyword">val</span> get_application_vstate : 
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../../../tezos-protocol-alpha/Tezos_protocol_alpha/Protocol/index.html#type-operation">Tezos_protocol_alpha.Protocol.operation</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../../../tezos-protocol-alpha/Tezos_protocol_alpha/Protocol/index.html#type-validation_state">Tezos_protocol_alpha.Protocol.validation_state</a>
   * <a href="../../../tezos-protocol-alpha/Tezos_protocol_alpha/Protocol/index.html#type-application_state">Tezos_protocol_alpha.Protocol.application_state</a>)</span>
    <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>get_application_vstate pred operations</code> constructs a protocol validation environment for operations in application mode on top of the given block with the given operations. It's a shortcut for <code>begin_application</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_construction_vstate"><a href="#val-get_construction_vstate" class="anchor"></a><code><span><span class="keyword">val</span> get_construction_vstate : 
  <span><span class="optlabel">?policy</span>:<a href="#type-baker_policy">baker_policy</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?timestamp</span>:<a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Timestamp/index.html#type-time">Tezos_protocol_alpha.Protocol.Alpha_context.Timestamp.time</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?protocol_data</span>:<span><a href="../../../tezos-protocol-alpha/Tezos_protocol_alpha/Protocol/index.html#type-block_header_data">Tezos_protocol_alpha.Protocol.block_header_data</a> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-block">block</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../../../tezos-protocol-alpha/Tezos_protocol_alpha/Protocol/index.html#type-validation_state">Tezos_protocol_alpha.Protocol.validation_state</a>
   * <a href="../../../tezos-protocol-alpha/Tezos_protocol_alpha/Protocol/index.html#type-application_state">Tezos_protocol_alpha.Protocol.application_state</a>)</span>
    <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>get_construction_vstate ?policy ?timestamp ?protocol_data pred</code> constructs a protocol validation environment for operations in construction mode on top of the given block. The mode is full(baking)/partial(mempool) if <code>protocol_data</code> given/absent. It's a shortcut for <code>begin_construction</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-apply"><a href="#val-apply" class="anchor"></a><code><span><span class="keyword">val</span> apply : 
  <span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Block_header/index.html#type-block_header">Tezos_protocol_alpha.Protocol.Alpha_context.Block_header.block_header</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?operations</span>:<span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Operation/index.html#type-packed">Tezos_protocol_alpha.Protocol.Alpha_context.Operation.packed</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?allow_manager_failures</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-t">t</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>applies a signed header and its operations to a block and obtains a new block</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bake"><a href="#val-bake" class="anchor"></a><code><span><span class="keyword">val</span> bake : 
  <span><span class="optlabel">?baking_mode</span>:<a href="#type-baking_mode">baking_mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?allow_manager_failures</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?payload_round</span>:<span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Round/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Round.t</a> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?locked_round</span>:<span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Round/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Round.t</a> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?policy</span>:<a href="#type-baker_policy">baker_policy</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?timestamp</span>:<a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Timestamp/index.html#type-time">Tezos_protocol_alpha.Protocol.Alpha_context.Timestamp.time</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?operation</span>:<a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Operation/index.html#type-packed">Tezos_protocol_alpha.Protocol.Alpha_context.Operation.packed</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?operations</span>:<span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Operation/index.html#type-packed">Tezos_protocol_alpha.Protocol.Alpha_context.Operation.packed</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?liquidity_baking_toggle_vote</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Per_block_votes/index.html#type-per_block_vote">Tezos_protocol_alpha.Protocol.Alpha_context.Per_block_votes.per_block_vote</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?adaptive_issuance_vote</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Per_block_votes/index.html#type-per_block_vote">Tezos_protocol_alpha.Protocol.Alpha_context.Per_block_votes.per_block_vote</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?check_size</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-t">t</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>bake b</code> returns a block <code>b'</code> which has as predecessor block <code>b</code>. Optional parameter <code>policy</code> allows to pick the next baker in several ways. If <code>check_size</code> is <code>true</code> (the default case), then the function checks that the operations passed as arguments satisfy the size limit of Tezos operations, as defined in the protocol. This function bundles together <code>forge_header</code>, <code>sign_header</code> and <code>apply</code>. These functions should be used instead of bake to craft unusual blocks for testing together with setters for properties of the headers. Setting <code>allow_manager_failures</code> (default=false), allows baking blocks with manager operation(s) that are valid but that could fail during their application. If this is not set, the block is correctly baked but the operations' application will fail silently. For examples see seed.ml or double_baking.ml</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bake_with_metadata"><a href="#val-bake_with_metadata" class="anchor"></a><code><span><span class="keyword">val</span> bake_with_metadata : 
  <span><span class="optlabel">?locked_round</span>:<span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Round/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Round.t</a> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?policy</span>:<a href="#type-baker_policy">baker_policy</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?timestamp</span>:<a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Timestamp/index.html#type-time">Tezos_protocol_alpha.Protocol.Alpha_context.Timestamp.time</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?operation</span>:<a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Operation/index.html#type-packed">Tezos_protocol_alpha.Protocol.Alpha_context.Operation.packed</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?operations</span>:<span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Operation/index.html#type-packed">Tezos_protocol_alpha.Protocol.Alpha_context.Operation.packed</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?payload_round</span>:<span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Round/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Round.t</a> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?check_size</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?baking_mode</span>:<a href="#type-baking_mode">baking_mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?allow_manager_failures</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?liquidity_baking_toggle_vote</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Per_block_votes/index.html#type-per_block_vote">Tezos_protocol_alpha.Protocol.Alpha_context.Per_block_votes.per_block_vote</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?adaptive_issuance_vote</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Per_block_votes/index.html#type-per_block_vote">Tezos_protocol_alpha.Protocol.Alpha_context.Per_block_votes.per_block_vote</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="#type-t">t</a>
   * <span>(<a href="../../../tezos-protocol-alpha/Tezos_protocol_alpha/Protocol/index.html#type-block_header_metadata">Tezos_protocol_alpha.Protocol.block_header_metadata</a>
      * <span><a href="../../../tezos-protocol-alpha/Tezos_protocol_alpha/Protocol/index.html#type-operation_receipt">Tezos_protocol_alpha.Protocol.operation_receipt</a> list</span>)</span>)</span>
    <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Variant of <code>bake</code> that returns the block metadata of the baked block. *</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bake_n"><a href="#val-bake_n" class="anchor"></a><code><span><span class="keyword">val</span> bake_n : 
  <span><span class="optlabel">?baking_mode</span>:<a href="#type-baking_mode">baking_mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?policy</span>:<a href="#type-baker_policy">baker_policy</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?liquidity_baking_toggle_vote</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Per_block_votes/index.html#type-per_block_vote">Tezos_protocol_alpha.Protocol.Alpha_context.Per_block_votes.per_block_vote</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?adaptive_issuance_vote</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Per_block_votes/index.html#type-per_block_vote">Tezos_protocol_alpha.Protocol.Alpha_context.Per_block_votes.per_block_vote</a> <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-block">block</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Bakes <code>n</code> blocks.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bake_until_level"><a href="#val-bake_until_level" class="anchor"></a><code><span><span class="keyword">val</span> bake_until_level : 
  <span><span class="optlabel">?baking_mode</span>:<a href="#type-baking_mode">baking_mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?policy</span>:<a href="#type-baker_policy">baker_policy</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?liquidity_baking_toggle_vote</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Per_block_votes/index.html#type-per_block_vote">Tezos_protocol_alpha.Protocol.Alpha_context.Per_block_votes.per_block_vote</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?adaptive_issuance_vote</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Per_block_votes/index.html#type-per_block_vote">Tezos_protocol_alpha.Protocol.Alpha_context.Per_block_votes.per_block_vote</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Raw_level/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Raw_level.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-block">block</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Bakes until the given level is reached.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bake_n_with_all_balance_updates"><a href="#val-bake_n_with_all_balance_updates" class="anchor"></a><code><span><span class="keyword">val</span> bake_n_with_all_balance_updates : 
  <span><span class="optlabel">?baking_mode</span>:<a href="#type-baking_mode">baking_mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?policy</span>:<a href="#type-baker_policy">baker_policy</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?liquidity_baking_toggle_vote</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Per_block_votes/index.html#type-per_block_vote">Tezos_protocol_alpha.Protocol.Alpha_context.Per_block_votes.per_block_vote</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?adaptive_issuance_vote</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Per_block_votes/index.html#type-per_block_vote">Tezos_protocol_alpha.Protocol.Alpha_context.Per_block_votes.per_block_vote</a> <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="#type-block">block</a> * <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Receipt/index.html#type-balance_updates">Tezos_protocol_alpha.Protocol.Alpha_context.Receipt.balance_updates</a>)</span>
    <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Version of bake_n that returns a list of all balance updates included in the metadata of baked blocks. *</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bake_n_with_origination_results"><a href="#val-bake_n_with_origination_results" class="anchor"></a><code><span><span class="keyword">val</span> bake_n_with_origination_results : 
  <span><span class="optlabel">?baking_mode</span>:<a href="#type-baking_mode">baking_mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?policy</span>:<a href="#type-baker_policy">baker_policy</a> <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="#type-block">block</a>
   * <span><span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Kind/index.html#type-origination">Tezos_protocol_alpha.Protocol.Alpha_context.Kind.origination</a>
       <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Apply_results/index.html#type-successful_manager_operation_result">Tezos_protocol_alpha.Protocol.Apply_results.successful_manager_operation_result</a></span>
       list</span>)</span>
    <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Version of bake_n that returns a list of all origination results in the metadata of baked blocks. *</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bake_n_with_liquidity_baking_toggle_ema"><a href="#val-bake_n_with_liquidity_baking_toggle_ema" class="anchor"></a><code><span><span class="keyword">val</span> bake_n_with_liquidity_baking_toggle_ema : 
  <span><span class="optlabel">?baking_mode</span>:<a href="#type-baking_mode">baking_mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?policy</span>:<a href="#type-baker_policy">baker_policy</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?liquidity_baking_toggle_vote</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Per_block_votes/index.html#type-per_block_vote">Tezos_protocol_alpha.Protocol.Alpha_context.Per_block_votes.per_block_vote</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?adaptive_issuance_vote</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Per_block_votes/index.html#type-per_block_vote">Tezos_protocol_alpha.Protocol.Alpha_context.Per_block_votes.per_block_vote</a> <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="#type-block">block</a>
   * <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Per_block_votes/Liquidity_baking_toggle_EMA/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Per_block_votes.Liquidity_baking_toggle_EMA.t</a>)</span>
    <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Version of bake_n that returns the liquidity baking toggle EMA after <code>n</code> blocks. *</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bake_n_with_metadata"><a href="#val-bake_n_with_metadata" class="anchor"></a><code><span><span class="keyword">val</span> bake_n_with_metadata : 
  <span><span class="optlabel">?locked_round</span>:<span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Round/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Round.t</a> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?policy</span>:<a href="#type-baker_policy">baker_policy</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?timestamp</span>:<a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Timestamp/index.html#type-time">Tezos_protocol_alpha.Protocol.Alpha_context.Timestamp.time</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?payload_round</span>:<span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Round/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Round.t</a> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?check_size</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?baking_mode</span>:<a href="#type-baking_mode">baking_mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?allow_manager_failures</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?liquidity_baking_toggle_vote</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Per_block_votes_repr/index.html#type-per_block_vote">Tezos_protocol_alpha.Protocol.Per_block_votes_repr.per_block_vote</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?adaptive_issuance_vote</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Per_block_votes_repr/index.html#type-per_block_vote">Tezos_protocol_alpha.Protocol.Per_block_votes_repr.per_block_vote</a> <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-block">block</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="#type-block">block</a>
   * <span>(<a href="../../../tezos-protocol-alpha/Tezos_protocol_alpha/Protocol/index.html#type-block_header_metadata">Tezos_protocol_alpha.Protocol.block_header_metadata</a>
      * <span><a href="../../../tezos-protocol-alpha/Tezos_protocol_alpha/Protocol/index.html#type-operation_receipt">Tezos_protocol_alpha.Protocol.operation_receipt</a> list</span>)</span>)</span>
    <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Variant of <code>bake_n</code> that returns the block metadata of the last baked block. <code>n</code> must be positive, otherwise a single block is baked. *</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_balance_updates_from_metadata"><a href="#val-get_balance_updates_from_metadata" class="anchor"></a><code><span><span class="keyword">val</span> get_balance_updates_from_metadata : 
  <span><span>(<a href="../../../tezos-protocol-alpha/Tezos_protocol_alpha/Protocol/index.html#type-block_header_metadata">Tezos_protocol_alpha.Protocol.block_header_metadata</a>
   * <span><a href="../../../tezos-protocol-alpha/Tezos_protocol_alpha/Protocol/index.html#type-operation_receipt">Tezos_protocol_alpha.Protocol.operation_receipt</a> list</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Receipt/index.html#type-balance_updates">Tezos_protocol_alpha.Protocol.Alpha_context.Receipt.balance_updates</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bake_while"><a href="#val-bake_while" class="anchor"></a><code><span><span class="keyword">val</span> bake_while : 
  <span><span class="optlabel">?baking_mode</span>:<a href="#type-baking_mode">baking_mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?policy</span>:<a href="#type-baker_policy">baker_policy</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?liquidity_baking_toggle_vote</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Per_block_votes_repr/index.html#type-per_block_vote">Tezos_protocol_alpha.Protocol.Per_block_votes_repr.per_block_vote</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?adaptive_issuance_vote</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Per_block_votes_repr/index.html#type-per_block_vote">Tezos_protocol_alpha.Protocol.Per_block_votes_repr.per_block_vote</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?invariant</span>:<span>(<span><a href="#type-block">block</a> <span class="arrow">&#45;&gt;</span></span> <span><span>unit <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><a href="#type-block">block</a> <span class="arrow">&#45;&gt;</span></span> bool)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-block">block</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-block">block</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Bake blocks while a predicate over the block holds. The returned block is the last one for which the predicate holds; in case the predicate never holds, the input block is returned. When the optional <code>invariant</code> argument is provided, it is checked on the input block and on each baked block, including the returned one (the last one satisfy the predicate); it is however not checked on the next block (the first one to invalidate the predicate).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bake_while_with_metadata"><a href="#val-bake_while_with_metadata" class="anchor"></a><code><span><span class="keyword">val</span> bake_while_with_metadata : 
  <span><span class="optlabel">?baking_mode</span>:<a href="#type-baking_mode">baking_mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?policy</span>:<a href="#type-baker_policy">baker_policy</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?liquidity_baking_toggle_vote</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Per_block_votes_repr/index.html#type-per_block_vote">Tezos_protocol_alpha.Protocol.Per_block_votes_repr.per_block_vote</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?adaptive_issuance_vote</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Per_block_votes_repr/index.html#type-per_block_vote">Tezos_protocol_alpha.Protocol.Per_block_votes_repr.per_block_vote</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?invariant</span>:<span>(<span><a href="#type-block">block</a> <span class="arrow">&#45;&gt;</span></span> <span><span>unit <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><a href="#type-block">block</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../tezos-protocol-alpha/Tezos_protocol_alpha/Protocol/index.html#type-block_header_metadata">Tezos_protocol_alpha.Protocol.block_header_metadata</a> <span class="arrow">&#45;&gt;</span></span> bool)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-block">block</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="#type-block">block</a>
   * <span>(<span><a href="../../../tezos-protocol-alpha/Tezos_protocol_alpha/Protocol/index.html#type-block_header_metadata">Tezos_protocol_alpha.Protocol.block_header_metadata</a> option</span>
      * <a href="../../../tezos-protocol-alpha/Tezos_protocol_alpha/Protocol/index.html#type-block_header_metadata">Tezos_protocol_alpha.Protocol.block_header_metadata</a>)</span>)</span>
    <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-current_cycle_of_level"><a href="#val-current_cycle_of_level" class="anchor"></a><code><span><span class="keyword">val</span> current_cycle_of_level : 
  <span><span class="label">blocks_per_cycle</span>:int32 <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">current_level</span>:int32 <span class="arrow">&#45;&gt;</span></span>
  <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Cycle/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Cycle.t</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-current_level"><a href="#val-current_level" class="anchor"></a><code><span><span class="keyword">val</span> current_level : <span><a href="#type-block">block</a> <span class="arrow">&#45;&gt;</span></span> int32</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-current_cycle"><a href="#val-current_cycle" class="anchor"></a><code><span><span class="keyword">val</span> current_cycle : 
  <span><a href="#type-block">block</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Cycle/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Cycle.t</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-first_level_of_cycle"><a href="#val-first_level_of_cycle" class="anchor"></a><code><span><span class="keyword">val</span> first_level_of_cycle : 
  <span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Constants/Parametric/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Constants.Parametric.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">level</span>:int32 <span class="arrow">&#45;&gt;</span></span>
  bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-first_block_of_cycle"><a href="#val-first_block_of_cycle" class="anchor"></a><code><span><span class="keyword">val</span> first_block_of_cycle : <span><a href="#type-block">block</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-last_but_one_level_of_cycle"><a href="#val-last_but_one_level_of_cycle" class="anchor"></a><code><span><span class="keyword">val</span> last_but_one_level_of_cycle : 
  <span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Constants/Parametric/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Constants.Parametric.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">level</span>:int32 <span class="arrow">&#45;&gt;</span></span>
  bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-last_but_one_block_of_cycle"><a href="#val-last_but_one_block_of_cycle" class="anchor"></a><code><span><span class="keyword">val</span> last_but_one_block_of_cycle : <span><a href="#type-block">block</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-last_level_of_cycle"><a href="#val-last_level_of_cycle" class="anchor"></a><code><span><span class="keyword">val</span> last_level_of_cycle : 
  <span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Constants/Parametric/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Constants.Parametric.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">level</span>:int32 <span class="arrow">&#45;&gt;</span></span>
  bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-last_block_of_cycle"><a href="#val-last_block_of_cycle" class="anchor"></a><code><span><span class="keyword">val</span> last_block_of_cycle : <span><a href="#type-block">block</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bake_until_cycle_end"><a href="#val-bake_until_cycle_end" class="anchor"></a><code><span><span class="keyword">val</span> bake_until_cycle_end : 
  <span><span class="optlabel">?baking_mode</span>:<a href="#type-baking_mode">baking_mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?policy</span>:<a href="#type-baker_policy">baker_policy</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-t">t</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Given a block <code>b</code> at level <code>l</code> bakes enough blocks to complete a cycle, that is <code>blocks_per_cycle - (l % blocks_per_cycle)</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bake_until_cycle_end_with_metadata"><a href="#val-bake_until_cycle_end_with_metadata" class="anchor"></a><code><span><span class="keyword">val</span> bake_until_cycle_end_with_metadata : 
  <span><span class="optlabel">?baking_mode</span>:<a href="#type-baking_mode">baking_mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?policy</span>:<a href="#type-baker_policy">baker_policy</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-block">block</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="#type-block">block</a>
   * <span><a href="../../../tezos-protocol-alpha/Tezos_protocol_alpha/Protocol/index.html#type-block_header_metadata">Tezos_protocol_alpha.Protocol.block_header_metadata</a> option</span>
   * <a href="../../../tezos-protocol-alpha/Tezos_protocol_alpha/Protocol/index.html#type-block_header_metadata">Tezos_protocol_alpha.Protocol.block_header_metadata</a>)</span>
    <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Given a block <code>b</code> at level <code>l</code> bakes enough blocks to complete a cycle, that is <code>blocks_per_cycle - (l % blocks_per_cycle)</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bake_until_n_cycle_end"><a href="#val-bake_until_n_cycle_end" class="anchor"></a><code><span><span class="keyword">val</span> bake_until_n_cycle_end : 
  <span><span class="optlabel">?baking_mode</span>:<a href="#type-baking_mode">baking_mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?policy</span>:<a href="#type-baker_policy">baker_policy</a> <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-t">t</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Bakes enough blocks to end <code>n</code> cycles.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bake_until_n_cycle_end_with_metadata"><a href="#val-bake_until_n_cycle_end_with_metadata" class="anchor"></a><code><span><span class="keyword">val</span> bake_until_n_cycle_end_with_metadata : 
  <span><span class="optlabel">?baking_mode</span>:<a href="#type-baking_mode">baking_mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?policy</span>:<a href="#type-baker_policy">baker_policy</a> <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-block">block</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="#type-block">block</a>
   * <span><a href="../../../tezos-protocol-alpha/Tezos_protocol_alpha/Protocol/index.html#type-block_header_metadata">Tezos_protocol_alpha.Protocol.block_header_metadata</a> option</span>
   * <a href="../../../tezos-protocol-alpha/Tezos_protocol_alpha/Protocol/index.html#type-block_header_metadata">Tezos_protocol_alpha.Protocol.block_header_metadata</a>)</span>
    <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bake_until_cycle"><a href="#val-bake_until_cycle" class="anchor"></a><code><span><span class="keyword">val</span> bake_until_cycle : 
  <span><span class="optlabel">?baking_mode</span>:<a href="#type-baking_mode">baking_mode</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?policy</span>:<a href="#type-baker_policy">baker_policy</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Cycle/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Cycle.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-t">t</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Bakes enough blocks to reach the cycle.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-prepare_initial_context_params"><a href="#val-prepare_initial_context_params" class="anchor"></a><code><span><span class="keyword">val</span> prepare_initial_context_params : 
  <span><span class="optlabel">?consensus_committee_size</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?consensus_threshold</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?min_proposal_quorum</span>:int32 <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?level</span>:int32 <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?cost_per_byte</span>:<a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Tez/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Tez.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?issuance_weights</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Constants/Parametric/index.html#type-issuance_weights">Tezos_protocol_alpha.Protocol.Alpha_context.Constants.Parametric.issuance_weights</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?origination_size</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?blocks_per_cycle</span>:int32 <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?cycles_per_voting_period</span>:int32 <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?sc_rollup_arith_pvm_enable</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?sc_rollup_private_enable</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?sc_rollup_riscv_pvm_enable</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dal_enable</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?zk_rollup_enable</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?hard_gas_limit_per_block</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Gas/Arith/index.html#type-integral">Tezos_protocol_alpha.Protocol.Alpha_context.Gas.Arith.integral</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?nonce_revelation_threshold</span>:int32 <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?dal</span>:<a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Constants/Parametric/index.html#type-dal">Tezos_protocol_alpha.Protocol.Alpha_context.Constants.Parametric.dal</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?adaptive_issuance</span>:
    <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Constants/Parametric/index.html#type-adaptive_issuance">Tezos_protocol_alpha.Protocol.Alpha_context.Constants.Parametric.adaptive_issuance</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?consensus_rights_delay</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?allow_tz4_delegate_enable</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?aggregate_attestation</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Constants/Parametric/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Constants.Parametric.t</a>
   * <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Block_header/index.html#type-shell_header">Tezos_protocol_alpha.Protocol.Alpha_context.Block_header.shell_header</a>
   * <a href="../../../octez-libs/Tezos_crypto/Hashed/Block_hash/index.html#type-t">Tezos_base.TzPervasives.Block_hash.t</a>,
    <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tztrace">Tezos_base.TzPervasives.tztrace</a>)</span>
    <span class="xref-unresolved">Stdlib</span>.result</span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Common util function to create parameters for <code>initial_context</code> function</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-autostaked_opt"><a href="#val-autostaked_opt" class="anchor"></a><code><span><span class="keyword">val</span> autostaked_opt : 
  <span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/index.html#type-public_key_hash">Tezos_protocol_alpha.Protocol.Alpha_context.public_key_hash</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-alpha/Tezos_protocol_alpha/Protocol/index.html#type-block_header_metadata">Tezos_protocol_alpha.Protocol.block_header_metadata</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Tez/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Tez.t</a> option</span></span></code></div><div class="spec-doc"><p><code>autostaked_opt delegate metadata</code> returns <code>Some amount</code> if <code>amount</code> tez have been staked for the given <code>delegate</code>. <code>None</code> otherwise.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-autostaked"><a href="#val-autostaked" class="anchor"></a><code><span><span class="keyword">val</span> autostaked : 
  <span><span class="optlabel">?loc</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/index.html#type-public_key_hash">Tezos_protocol_alpha.Protocol.Alpha_context.public_key_hash</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-alpha/Tezos_protocol_alpha/Protocol/index.html#type-block_header_metadata">Tezos_protocol_alpha.Protocol.block_header_metadata</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="../../../tezos-protocol-alpha/Tezos_raw_protocol_alpha/Alpha_context/Tez/index.html#type-t">Tezos_protocol_alpha.Protocol.Alpha_context.Tez.t</a></span></code></div><div class="spec-doc"><p>same as <code>autostaked_opt</code> but fails in case autostaking didn't provoke a stake operation.</p></div></div></div></body></html>
