<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Delegate_storage (tezos-protocol-013-PtJakart.Tezos_raw_protocol_013_PtJakart.Delegate_storage)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">tezos-protocol-013-PtJakart</a> &#x00BB; <a href="../index.html">Tezos_raw_protocol_013_PtJakart</a> &#x00BB; Delegate_storage</nav><header class="odoc-preamble"><h1>Module <code><span>Tezos_raw_protocol_013_PtJakart.Delegate_storage</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value anchored" id="val-init"><a href="#val-init" class="anchor"></a><code><span><span class="keyword">val</span> init : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Contract_repr/index.html#type-t">Contract_repr.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div><div class="spec-doc"><p>Allow to register a delegate when creating an account.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pubkey"><a href="#val-pubkey" class="anchor"></a><code><span><span class="keyword">val</span> pubkey : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key.t</a>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set"><a href="#val-set" class="anchor"></a><code><span><span class="keyword">val</span> set : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Contract_repr/index.html#type-t">Contract_repr.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div><div class="spec-doc"><p>Updating the delegate of a contract.</p><p>When calling this function on an &quot;implicit contract&quot; and setting the delegate to the contract manager registers it as a delegate. One cannot unregister a delegate for now. The associate contract is now 'undeletable'.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-frozen_deposits_limit"><a href="#val-frozen_deposits_limit" class="anchor"></a><code><span><span class="keyword">val</span> frozen_deposits_limit : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><a href="../Tez_repr/index.html#type-t">Tez_repr.t</a> option</span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set_frozen_deposits_limit"><a href="#val-set_frozen_deposits_limit" class="anchor"></a><code><span><span class="keyword">val</span> set_frozen_deposits_limit : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Tez_repr/index.html#type-t">Tez_repr.t</a> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-No_deletion"><a href="#extension-decl-No_deletion" class="anchor"></a><code><span><span class="keyword">type</span> <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-error">Tezos_protocol_environment_013_PtJakart.Error_monad.error</a> += </span></code><ol><li id="extension-No_deletion" class="def variant extension anchored"><a href="#extension-No_deletion" class="anchor"></a><code><span>| </span><span><span class="extension">No_deletion</span> <span class="keyword">of</span> <a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a></span></code></li><li id="extension-Active_delegate" class="def variant extension anchored"><a href="#extension-Active_delegate" class="anchor"></a><code><span>| </span><span><span class="extension">Active_delegate</span></span></code></li><li id="extension-Current_delegate" class="def variant extension anchored"><a href="#extension-Current_delegate" class="anchor"></a><code><span>| </span><span><span class="extension">Current_delegate</span></span></code></li><li id="extension-Empty_delegate_account" class="def variant extension anchored"><a href="#extension-Empty_delegate_account" class="anchor"></a><code><span>| </span><span><span class="extension">Empty_delegate_account</span> <span class="keyword">of</span> <a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a></span></code></li><li id="extension-Unregistered_delegate" class="def variant extension anchored"><a href="#extension-Unregistered_delegate" class="anchor"></a><code><span>| </span><span><span class="extension">Unregistered_delegate</span> <span class="keyword">of</span> <a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a></span></code></li><li id="extension-Unassigned_validation_slot_for_level" class="def variant extension anchored"><a href="#extension-Unassigned_validation_slot_for_level" class="anchor"></a><code><span>| </span><span><span class="extension">Unassigned_validation_slot_for_level</span> <span class="keyword">of</span> <a href="../Level_repr/index.html#type-t">Level_repr.t</a> * int</span></code></li><li id="extension-Cannot_find_active_stake" class="def variant extension anchored"><a href="#extension-Cannot_find_active_stake" class="anchor"></a><code><span>| </span><span><span class="extension">Cannot_find_active_stake</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="module-Delegate_storage.cycle" class="def record field anchored"><a href="#module-Delegate_storage.cycle" class="anchor"></a><code><span>cycle : <a href="../Cycle_repr/index.html#type-t">Cycle_repr.t</a>;</span></code></li><li id="module-Delegate_storage.delegate" class="def record field anchored"><a href="#module-Delegate_storage.delegate" class="anchor"></a><code><span>delegate : <a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a>;</span></code></li></ol><code><span>}</span></code></li><li id="extension-Not_registered" class="def variant extension anchored"><a href="#extension-Not_registered" class="anchor"></a><code><span>| </span><span><span class="extension">Not_registered</span> <span class="keyword">of</span> <a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-check_delegate"><a href="#val-check_delegate" class="anchor"></a><code><span><span class="keyword">val</span> check_delegate : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>unit <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div><div class="spec-doc"><p>Check that a given implicit account is a registered delegate.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-participation_info"><a href="#type-participation_info" class="anchor"></a><code><span><span class="keyword">type</span> participation_info</span><span> = </span><span>{</span></code><ol><li id="type-participation_info.expected_cycle_activity" class="def record field anchored"><a href="#type-participation_info.expected_cycle_activity" class="anchor"></a><code><span>expected_cycle_activity : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The total expected slots to be endorsed in the cycle. (static)</p><span class="comment-delim">*)</span></div></li><li id="type-participation_info.minimal_cycle_activity" class="def record field anchored"><a href="#type-participation_info.minimal_cycle_activity" class="anchor"></a><code><span>minimal_cycle_activity : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The minimal endorsing slots in the cycle to get endorsing rewards. (static)</p><span class="comment-delim">*)</span></div></li><li id="type-participation_info.missed_slots" class="def record field anchored"><a href="#type-participation_info.missed_slots" class="anchor"></a><code><span>missed_slots : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The number of missed endorsing slots in the cycle. (dynamic)</p><span class="comment-delim">*)</span></div></li><li id="type-participation_info.missed_levels" class="def record field anchored"><a href="#type-participation_info.missed_levels" class="anchor"></a><code><span>missed_levels : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The number of missed endorsing levels in the cycle. (dynamic)</p><span class="comment-delim">*)</span></div></li><li id="type-participation_info.remaining_allowed_missed_slots" class="def record field anchored"><a href="#type-participation_info.remaining_allowed_missed_slots" class="anchor"></a><code><span>remaining_allowed_missed_slots : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Remaining amount of endorsing slots that can be missed in the cycle before forfeiting the rewards. (dynamic)</p><span class="comment-delim">*)</span></div></li><li id="type-participation_info.expected_endorsing_rewards" class="def record field anchored"><a href="#type-participation_info.expected_endorsing_rewards" class="anchor"></a><code><span>expected_endorsing_rewards : <a href="../Tez_repr/index.html#type-t">Tez_repr.t</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Endorsing rewards that will be distributed at the end of the cycle if activity at that point will be greater than the minimal required. If the activity is already known to be below the required minimum, then the rewards are zero. (dynamic)</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Participation information. We denote by:</p><ul><li>&quot;static&quot; information that does not change during the cycle</li><li>&quot;dynamic&quot; information that may change during the cycle</li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-delegate_participation_info"><a href="#val-delegate_participation_info" class="anchor"></a><code><span><span class="keyword">val</span> delegate_participation_info : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-participation_info">participation_info</a>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div><div class="spec-doc"><p>Only use this function for RPC: this is expensive.</p><p><code>delegate_participation_info</code> and <code>!val:check_delegate</code> forms the implementation of RPC call &quot;/context/delegates/&lt;pkh&gt;/participation&quot;.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-fold"><a href="#val-fold" class="anchor"></a><code><span><span class="keyword">val</span> fold : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">order</span>:<span>[ `Sorted <span>| `Undefined</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">init</span>:<span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">f</span>:
    <span>(<span><a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span class="type-var">'a</span> <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div><div class="spec-doc"><p>Iterate on all registered delegates.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-list"><a href="#val-list" class="anchor"></a><code><span><span class="keyword">val</span> list : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a> list</span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div><div class="spec-doc"><p>List all registered delegates.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-balance"><a href="#val-balance" class="anchor"></a><code><span><span class="keyword">val</span> balance : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Tezos_protocol_environment_013_PtJakart/Signature/index.html#type-public_key_hash">Tezos_protocol_environment_013_PtJakart.Signature.public_key_hash</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Tez_repr/index.html#type-tez">Tez_repr.tez</a> <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-level_participation"><a href="#type-level_participation" class="anchor"></a><code><span><span class="keyword">type</span> level_participation</span><span> = </span></code><ol><li id="type-level_participation.Participated" class="def variant constructor anchored"><a href="#type-level_participation.Participated" class="anchor"></a><code><span>| </span><span><span class="constructor">Participated</span></span></code></li><li id="type-level_participation.Didn't_participate" class="def variant constructor anchored"><a href="#type-level_participation.Didn't_participate" class="anchor"></a><code><span>| </span><span><span class="constructor">Didn't_participate</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-record_endorsing_participation"><a href="#val-record_endorsing_participation" class="anchor"></a><code><span><span class="keyword">val</span> record_endorsing_participation : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">delegate</span>:<a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">participation</span>:<a href="#type-level_participation">level_participation</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">endorsing_power</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div><div class="spec-doc"><p>Record the participation of a delegate as a validator.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-record_baking_activity_and_pay_rewards_and_fees"><a href="#val-record_baking_activity_and_pay_rewards_and_fees" class="anchor"></a><code><span><span class="keyword">val</span> record_baking_activity_and_pay_rewards_and_fees : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">payload_producer</span>:
    <a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">block_producer</span>:
    <a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">baking_reward</span>:<a href="../Tez_repr/index.html#type-t">Tez_repr.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">reward_bonus</span>:<span><a href="../Tez_repr/index.html#type-t">Tez_repr.t</a> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../Raw_context/index.html#type-t">Raw_context.t</a> * <a href="../Receipt_repr/index.html#type-balance_updates">Receipt_repr.balance_updates</a>)</span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div><div class="spec-doc"><p>Sets the payload and block producer as active. Pays the baking reward and the fees to the payload producer and the reward bonus to the payload producer (if the reward_bonus is not None).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-cycle_end"><a href="#val-cycle_end" class="anchor"></a><code><span><span class="keyword">val</span> cycle_end : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Cycle_repr/index.html#type-t">Cycle_repr.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Storage/Seed/index.html#type-unrevealed_nonce">Storage.Seed.unrevealed_nonce</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../Raw_context/index.html#type-t">Raw_context.t</a>
   * <a href="../Receipt_repr/index.html#type-balance_updates">Receipt_repr.balance_updates</a>
   * <span><a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a> list</span>)</span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div><div class="spec-doc"><p>Trigger the context maintenance at the end of cycle 'n', i.e.: unfreeze the endorsing rewards, potentially deactivate delegates. Return the corresponding balances updates and the list of deactivated delegates.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-already_slashed_for_double_baking"><a href="#val-already_slashed_for_double_baking" class="anchor"></a><code><span><span class="keyword">val</span> already_slashed_for_double_baking : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Level_repr/index.html#type-t">Level_repr.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>bool <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div><div class="spec-doc"><p>Returns true if the given delegate has already been slashed for double baking for the given level.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-already_slashed_for_double_endorsing"><a href="#val-already_slashed_for_double_endorsing" class="anchor"></a><code><span><span class="keyword">val</span> already_slashed_for_double_endorsing : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Level_repr/index.html#type-t">Level_repr.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>bool <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div><div class="spec-doc"><p>Returns true if the given delegate has already been slashed for double preendorsing or double endorsing for the given level.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-punish_double_endorsing"><a href="#val-punish_double_endorsing" class="anchor"></a><code><span><span class="keyword">val</span> punish_double_endorsing : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Level_repr/index.html#type-t">Level_repr.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../Raw_context/index.html#type-t">Raw_context.t</a> * <a href="../Tez_repr/index.html#type-t">Tez_repr.t</a> * <a href="../Receipt_repr/index.html#type-balance_updates">Receipt_repr.balance_updates</a>)</span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div><div class="spec-doc"><p>Burn some frozen deposit for a delegate at a given level. Returns the burned amount.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-punish_double_baking"><a href="#val-punish_double_baking" class="anchor"></a><code><span><span class="keyword">val</span> punish_double_baking : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Level_repr/index.html#type-t">Level_repr.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../Raw_context/index.html#type-t">Raw_context.t</a> * <a href="../Tez_repr/index.html#type-t">Tez_repr.t</a> * <a href="../Receipt_repr/index.html#type-balance_updates">Receipt_repr.balance_updates</a>)</span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-frozen_deposits"><a href="#val-frozen_deposits" class="anchor"></a><code><span><span class="keyword">val</span> frozen_deposits : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Storage/index.html#type-deposits">Storage.deposits</a> <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div><div class="spec-doc"><p>Returns a delegate's frozen deposits, both the current amount and the initial freezed amount.</p><p>A delegate's frozen balance is only composed of frozen deposits; rewards and fees are not frozen, but simply credited at the right moment.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-full_balance"><a href="#val-full_balance" class="anchor"></a><code><span><span class="keyword">val</span> full_balance : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Tez_repr/index.html#type-t">Tez_repr.t</a> <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div><div class="spec-doc"><p>Returns the full 'balance' of the implicit contract associated to a given key, i.e. the sum of the spendable balance (given by <code>balance</code> or <code>Contract_storage.get_balance</code>) and of the frozen balance. The frozen balance is composed of all frozen bonds associated to the contract (given by <code>Contract_storage.get_frozen_bonds</code>) and of the frozen deposits (given by <code>frozen_deposits</code>).</p><p>Only use this function for RPCs: this is expensive.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-staking_balance"><a href="#val-staking_balance" class="anchor"></a><code><span><span class="keyword">val</span> staking_balance : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Tez_repr/index.html#type-t">Tez_repr.t</a> <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-delegated_balance"><a href="#val-delegated_balance" class="anchor"></a><code><span><span class="keyword">val</span> delegated_balance : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Tez_repr/index.html#type-t">Tez_repr.t</a> <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div><div class="spec-doc"><p>Only use this function for RPCs: this is expensive.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-deactivated"><a href="#val-deactivated" class="anchor"></a><code><span><span class="keyword">val</span> deactivated : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>bool <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-slot_owner"><a href="#val-slot_owner" class="anchor"></a><code><span><span class="keyword">val</span> slot_owner : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Level_repr/index.html#type-t">Level_repr.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Slot_repr/index.html#type-t">Slot_repr.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../Raw_context/index.html#type-t">Raw_context.t</a>
   * <span>(<a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key.t</a>
      * <a href="../../Tezos_protocol_environment_013_PtJakart/Signature/Public_key_hash/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Signature.Public_key_hash.t</a>)</span>)</span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div><div class="spec-doc"><p>Participation slots potentially associated to accounts. The accounts that didn't place a deposit will be excluded from this list. This function should only be used to compute the deposits to freeze or initialize the protocol while stitching. RPCs can use this function to predict an approximation of long term future slot allocations. It shouldn't be used in the baker.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-baking_rights_owner"><a href="#val-baking_rights_owner" class="anchor"></a><code><span><span class="keyword">val</span> baking_rights_owner : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Level_repr/index.html#type-t">Level_repr.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">round</span>:<a href="../Round_repr/index.html#type-round">Round_repr.round</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../Raw_context/index.html#type-t">Raw_context.t</a>
   * <a href="../Slot_repr/index.html#type-t">Slot_repr.t</a>
   * <span>(<a href="../../Tezos_protocol_environment_013_PtJakart/Signature/index.html#type-public_key">Tezos_protocol_environment_013_PtJakart.Signature.public_key</a>
      * <a href="../../Tezos_protocol_environment_013_PtJakart/Signature/index.html#type-public_key_hash">Tezos_protocol_environment_013_PtJakart.Signature.public_key_hash</a>)</span>)</span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-freeze_deposits_do_not_call_except_for_migration"><a href="#val-freeze_deposits_do_not_call_except_for_migration" class="anchor"></a><code><span><span class="keyword">val</span> freeze_deposits_do_not_call_except_for_migration : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">new_cycle</span>:<a href="../Cycle_repr/index.html#type-t">Cycle_repr.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">balance_updates</span>:<a href="../Receipt_repr/index.html#type-balance_updates">Receipt_repr.balance_updates</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../Raw_context/index.html#type-t">Raw_context.t</a> * <a href="../Receipt_repr/index.html#type-balance_updates">Receipt_repr.balance_updates</a>)</span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-init_first_cycles"><a href="#val-init_first_cycles" class="anchor"></a><code><span><span class="keyword">val</span> init_first_cycles : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div><div class="spec-doc"><p><code>init_first_cycles ctxt</code> computes and records the distribution of the total active stake among active delegates. This concerns the total active stake involved in the calculation of baking rights for all cycles in the range <code>0, preserved_cycles</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-compute_snapshot_index"><a href="#val-compute_snapshot_index" class="anchor"></a><code><span><span class="keyword">val</span> compute_snapshot_index : 
  <span><a href="../Raw_context/index.html#type-t">Raw_context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Cycle_repr/index.html#type-t">Cycle_repr.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">max_snapshot_index</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span>int <a href="../../Tezos_protocol_environment_013_PtJakart/Error_monad/index.html#type-tzresult">Tezos_protocol_environment_013_PtJakart.Error_monad.tzresult</a></span>
    <a href="../../Tezos_protocol_environment_013_PtJakart/Lwt/index.html#type-t">Tezos_protocol_environment_013_PtJakart.Lwt.t</a></span></span></code></div><div class="spec-doc"><p><code>compute_snapshot_index ctxt cycle max_snapshot_index</code> Returns the index of the selected snapshot for the <code>cycle</code> passed as argument, and for the max index of snapshots taken so far, <code>max_snapshot_index</code> (see <code>Stake_storage.max_snapshot_index</code>.</p></div></div></div></body></html>
