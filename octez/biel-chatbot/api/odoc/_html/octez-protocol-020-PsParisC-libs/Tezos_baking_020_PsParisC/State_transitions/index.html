<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>State_transitions (octez-protocol-020-PsParisC-libs.Tezos_baking_020_PsParisC.State_transitions)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">octez-protocol-020-PsParisC-libs</a> &#x00BB; <a href="../index.html">Tezos_baking_020_PsParisC</a> &#x00BB; State_transitions</nav><header class="odoc-preamble"><h1>Module <code><span>Tezos_baking_020_PsParisC.State_transitions</span></code></h1><p>This module, and in particular the <a href="#val-step"><code>step</code></a> function, modifies the automaton state, while <a href="../Baking_actions/index.html"><code>Baking_actions</code></a> performs potentially failing side-effects.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value anchored" id="val-do_nothing"><a href="#val-do_nothing" class="anchor"></a><code><span><span class="keyword">val</span> do_nothing : 
  <span><a href="../Baking_state/index.html#type-state">Baking_state.state</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../Baking_state/index.html#type-state">Baking_state.state</a> * <a href="../Baking_actions/index.html#type-action">Baking_actions.action</a>)</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-proposal_acceptance"><a href="#type-proposal_acceptance" class="anchor"></a><code><span><span class="keyword">type</span> proposal_acceptance</span><span> = </span></code><ol><li id="type-proposal_acceptance.Invalid" class="def variant constructor anchored"><a href="#type-proposal_acceptance.Invalid" class="anchor"></a><code><span>| </span><span><span class="constructor">Invalid</span></span></code></li><li id="type-proposal_acceptance.Outdated_proposal" class="def variant constructor anchored"><a href="#type-proposal_acceptance.Outdated_proposal" class="anchor"></a><code><span>| </span><span><span class="constructor">Outdated_proposal</span></span></code></li><li id="type-proposal_acceptance.Valid_proposal" class="def variant constructor anchored"><a href="#type-proposal_acceptance.Valid_proposal" class="anchor"></a><code><span>| </span><span><span class="constructor">Valid_proposal</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_acceptable_proposal_for_current_level"><a href="#val-is_acceptable_proposal_for_current_level" class="anchor"></a><code><span><span class="keyword">val</span> is_acceptable_proposal_for_current_level : 
  <span><a href="../Baking_state/index.html#type-state">Baking_state.state</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Baking_state/index.html#type-proposal">Baking_state.proposal</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-proposal_acceptance">proposal_acceptance</a> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-make_consensus_vote_batch"><a href="#val-make_consensus_vote_batch" class="anchor"></a><code><span><span class="keyword">val</span> make_consensus_vote_batch : 
  <span><a href="../Baking_state/index.html#type-state">Baking_state.state</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Baking_state/index.html#type-proposal">Baking_state.proposal</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Baking_state/index.html#type-consensus_vote_kind">Baking_state.consensus_vote_kind</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="../Baking_state/index.html#type-unsigned_consensus_vote_batch">Baking_state.unsigned_consensus_vote_batch</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-may_update_proposal"><a href="#val-may_update_proposal" class="anchor"></a><code><span><span class="keyword">val</span> may_update_proposal : 
  <span><span class="label">is_proposal_applied</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Baking_state/index.html#type-state">Baking_state.state</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Baking_state/index.html#type-proposal">Baking_state.proposal</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Baking_state/index.html#type-state">Baking_state.state</a> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-preattest"><a href="#val-preattest" class="anchor"></a><code><span><span class="keyword">val</span> preattest : 
  <span><a href="../Baking_state/index.html#type-state">Baking_state.state</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Baking_state/index.html#type-proposal">Baking_state.proposal</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../Baking_state/index.html#type-state">Baking_state.state</a> * <a href="../Baking_actions/index.html#type-action">Baking_actions.action</a>)</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-extract_pqc"><a href="#val-extract_pqc" class="anchor"></a><code><span><span class="keyword">val</span> extract_pqc : 
  <span><a href="../Baking_state/index.html#type-state">Baking_state.state</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Baking_state/index.html#type-proposal">Baking_state.proposal</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Kind/index.html#type-preattestation">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Kind.preattestation</a>
     <a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/index.html#type-operation">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.operation</a></span>
     list</span>
   * <a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Round/index.html#type-t">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Round.t</a>)</span>
    option</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-handle_proposal"><a href="#val-handle_proposal" class="anchor"></a><code><span><span class="keyword">val</span> handle_proposal : 
  <span><span class="label">is_proposal_applied</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Baking_state/index.html#type-state">Baking_state.state</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Baking_state/index.html#type-proposal">Baking_state.proposal</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../Baking_state/index.html#type-state">Baking_state.state</a> * <a href="../Baking_actions/index.html#type-action">Baking_actions.action</a>)</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-propose_block_action"><a href="#val-propose_block_action" class="anchor"></a><code><span><span class="keyword">val</span> propose_block_action : 
  <span><a href="../Baking_state/index.html#type-state">Baking_state.state</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Baking_state/index.html#type-consensus_key_and_delegate">Baking_state.consensus_key_and_delegate</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Round/index.html#type-t">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Round.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">last_proposal</span>:<a href="../Baking_state/index.html#type-proposal">Baking_state.proposal</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Baking_actions/index.html#type-action">Baking_actions.action</a> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Propose a block at the start of the given round for the given delegate, given that there was already a proposal at the current level, the last one being <code>last_proposal</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-end_of_round"><a href="#val-end_of_round" class="anchor"></a><code><span><span class="keyword">val</span> end_of_round : 
  <span><a href="../Baking_state/index.html#type-state">Baking_state.state</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Round/index.html#type-t">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Round.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../Baking_state/index.html#type-state">Baking_state.state</a> * <a href="../Baking_actions/index.html#type-action">Baking_actions.action</a>)</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Increase the current round and propose at the new round (same level), if the baker has a proposer slot.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-time_to_prepare_next_level_block"><a href="#val-time_to_prepare_next_level_block" class="anchor"></a><code><span><span class="keyword">val</span> time_to_prepare_next_level_block : 
  <span><a href="../Baking_state/index.html#type-state">Baking_state.state</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Round/index.html#type-t">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Round.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../Baking_state/index.html#type-state">Baking_state.state</a> * <a href="../Baking_actions/index.html#type-action">Baking_actions.action</a>)</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Propose for the first time at a level at the given round. There was no previous proposal at the current level.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-update_locked_round"><a href="#val-update_locked_round" class="anchor"></a><code><span><span class="keyword">val</span> update_locked_round : 
  <span><a href="../Baking_state/index.html#type-state">Baking_state.state</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Round/index.html#type-t">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Round.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Block_payload_hash/index.html#type-t">Tezos_protocol_020_PsParisC.Protocol.Block_payload_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="../Baking_state/index.html#type-state">Baking_state.state</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-prepare_attest_action"><a href="#val-prepare_attest_action" class="anchor"></a><code><span><span class="keyword">val</span> prepare_attest_action : 
  <span><a href="../Baking_state/index.html#type-state">Baking_state.state</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Baking_state/index.html#type-proposal">Baking_state.proposal</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="../Baking_actions/index.html#type-action">Baking_actions.action</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-prequorum_reached_when_awaiting_preattestations"><a href="#val-prequorum_reached_when_awaiting_preattestations" class="anchor"></a><code><span><span class="keyword">val</span> prequorum_reached_when_awaiting_preattestations : 
  <span><a href="../Baking_state/index.html#type-state">Baking_state.state</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Operation_worker/index.html#type-candidate">Operation_worker.candidate</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Kind/index.html#type-preattestation">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Kind.preattestation</a>
    <a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/index.html#type-operation">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.operation</a></span>
    list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../Baking_state/index.html#type-state">Baking_state.state</a> * <a href="../Baking_actions/index.html#type-action">Baking_actions.action</a>)</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-quorum_reached_when_waiting_attestations"><a href="#val-quorum_reached_when_waiting_attestations" class="anchor"></a><code><span><span class="keyword">val</span> quorum_reached_when_waiting_attestations : 
  <span><a href="../Baking_state/index.html#type-state">Baking_state.state</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Operation_worker/index.html#type-candidate">Operation_worker.candidate</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Kind/index.html#type-attestation">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Kind.attestation</a>
    <a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/index.html#type-operation">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.operation</a></span>
    list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../Baking_state/index.html#type-state">Baking_state.state</a> * <a href="../Baking_actions/index.html#type-action">Baking_actions.action</a>)</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-step"><a href="#val-step" class="anchor"></a><code><span><span class="keyword">val</span> step : 
  <span><a href="../Baking_state/index.html#type-state">Baking_state.state</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Baking_state/index.html#type-event">Baking_state.event</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../Baking_state/index.html#type-state">Baking_state.state</a> * <a href="../Baking_actions/index.html#type-action">Baking_actions.action</a>)</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div></div></body></html>
