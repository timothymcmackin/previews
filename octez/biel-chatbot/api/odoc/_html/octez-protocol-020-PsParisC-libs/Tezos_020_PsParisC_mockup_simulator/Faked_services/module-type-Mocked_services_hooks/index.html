<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Mocked_services_hooks (octez-protocol-020-PsParisC-libs.Tezos_020_PsParisC_mockup_simulator.Faked_services.Mocked_services_hooks)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">octez-protocol-020-PsParisC-libs</a> &#x00BB; <a href="../../index.html">Tezos_020_PsParisC_mockup_simulator</a> &#x00BB; <a href="../index.html">Faked_services</a> &#x00BB; Mocked_services_hooks</nav><header class="odoc-preamble"><h1>Module type <code><span>Faked_services.Mocked_services_hooks</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-mempool"><a href="#type-mempool" class="anchor"></a><code><span><span class="keyword">type</span> mempool</span><span> = <a href="../../../Tezos_client_020_PsParisC/Mockup/M/Block_services/Mempool/index.html#type-t">Tezos_client_020_PsParisC.Mockup.M.Block_services.Mempool.t</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-monitor_validated_blocks"><a href="#val-monitor_validated_blocks" class="anchor"></a><code><span><span class="keyword">val</span> monitor_validated_blocks : 
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../../../../octez-libs/Tezos_crypto/Hashed/Chain_id/index.html#type-t">Tezos_base.TzPervasives.Chain_id.t</a>
   * <a href="../../../../octez-libs/Tezos_crypto/Hashed/Block_hash/index.html#type-t">Tezos_base.TzPervasives.Block_hash.t</a>
   * <a href="../../../../octez-libs/Tezos_base/Block_header/index.html#type-t">Tezos_base.TzPervasives.Block_header.t</a>
   * <span><span><a href="../../../../octez-libs/Tezos_base/Operation/index.html#type-t">Tezos_base.TzPervasives.Operation.t</a> list</span> list</span>)</span>
    <a href="../../../../octez-libs/Tezos_rpc/Answer/index.html#type-stream">Tezos_rpc.Answer.stream</a></span></span></code></div><div class="spec-doc"><p>The baker relies on this stream to be notified of new valid blocks.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-monitor_heads"><a href="#val-monitor_heads" class="anchor"></a><code><span><span class="keyword">val</span> monitor_heads : 
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../../../../octez-libs/Tezos_crypto/Hashed/Block_hash/index.html#type-t">Tezos_base.TzPervasives.Block_hash.t</a>
   * <a href="../../../../octez-libs/Tezos_base/Block_header/index.html#type-t">Tezos_base.TzPervasives.Block_header.t</a>)</span>
    <a href="../../../../octez-libs/Tezos_rpc/Answer/index.html#type-stream">Tezos_rpc.Answer.stream</a></span></span></code></div><div class="spec-doc"><p>The baker relies on this stream to be notified of new heads.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-protocols"><a href="#val-protocols" class="anchor"></a><code><span><span class="keyword">val</span> protocols : 
  <span><a href="../../../../octez-shell-libs/Tezos_shell_services/Block_services/index.html#type-block">Block_services.block</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../../../../octez-shell-libs/Tezos_shell_services/Block_services/index.html#type-protocols">Block_services.protocols</a> <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Returns current and next protocol for a block.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-raw_header"><a href="#val-raw_header" class="anchor"></a><code><span><span class="keyword">val</span> raw_header : 
  <span><a href="../../../../octez-shell-libs/Tezos_shell_services/Block_services/index.html#type-block">Block_services.block</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>bytes <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>raw_header</code> returns the byte encoded block header of the block associated to the given block specification.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-header"><a href="#val-header" class="anchor"></a><code><span><span class="keyword">val</span> header : 
  <span><a href="../../../../octez-shell-libs/Tezos_shell_services/Block_services/index.html#type-block">Block_services.block</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../../../Tezos_client_020_PsParisC/Mockup/M/Block_services/index.html#type-block_header">Tezos_client_020_PsParisC.Mockup.M.Block_services.block_header</a>
    <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>header</code> returns the block header of the block associated to the given block specification.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-resulting_context_hash"><a href="#val-resulting_context_hash" class="anchor"></a><code><span><span class="keyword">val</span> resulting_context_hash : 
  <span><a href="../../../../octez-shell-libs/Tezos_shell_services/Block_services/index.html#type-block">Block_services.block</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../../../../octez-libs/Tezos_crypto/Hashed/Context_hash/index.html#type-t">Tezos_base.TzPervasives.Context_hash.t</a> <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>resulting_context_hash</code> returns the context resulting hash of the given block.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-operations"><a href="#val-operations" class="anchor"></a><code><span><span class="keyword">val</span> operations : 
  <span><a href="../../../../octez-shell-libs/Tezos_shell_services/Block_services/index.html#type-block">Block_services.block</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><span><a href="../../../Tezos_client_020_PsParisC/Mockup/M/Block_services/index.html#type-operation">Tezos_client_020_PsParisC.Mockup.M.Block_services.operation</a> list</span> list</span>
    <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>operations</code> returns all operations included in the block.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-inject_block"><a href="#val-inject_block" class="anchor"></a><code><span><span class="keyword">val</span> inject_block : 
  <span><a href="../../../../octez-libs/Tezos_crypto/Hashed/Block_hash/index.html#type-t">Tezos_base.TzPervasives.Block_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../../octez-libs/Tezos_base/Block_header/index.html#type-t">Tezos_base.TzPervasives.Block_header.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><a href="../../../../octez-libs/Tezos_base/Operation/index.html#type-t">Tezos_base.TzPervasives.Operation.t</a> <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-trace">Tezos_base.TzPervasives.trace</a></span>
    <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-trace">Tezos_base.TzPervasives.trace</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>unit <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>inject_block_callback</code> is called when an RPC is performed on <code>Tezos_shell_services.Injection_services.S.block</code>, after checking that the block header can be deserialized.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-inject_operation"><a href="#val-inject_operation" class="anchor"></a><code><span><span class="keyword">val</span> inject_operation : 
  <span><a href="../../../../octez-libs/Tezos_base/Operation/index.html#type-t">Tezos_base.TzPervasives.Operation.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../../../../octez-libs/Tezos_crypto/Hashed/Operation_hash/index.html#type-t">Tezos_base.TzPervasives.Operation_hash.t</a> <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>inject_operation</code> is used by the baker (or the client) to inject operations, including attestations.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pending_operations"><a href="#val-pending_operations" class="anchor"></a><code><span><span class="keyword">val</span> pending_operations : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-mempool">mempool</a> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>pending_operations</code> returns the current contents of the mempool. It is used by the baker to fetch operations to potentially include in the block being baked. These operations might include attestations. If there aren't enough attestations, the baker waits on <code>monitor_operations</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-monitor_operations"><a href="#val-monitor_operations" class="anchor"></a><code><span><span class="keyword">val</span> monitor_operations : 
  <span><span class="label">version</span>:<a href="../../../../octez-shell-libs/Tezos_shell_services/Block_services/index.html#type-version">Block_services.version</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">validated</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">branch_delayed</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">branch_refused</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">refused</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../../../../octez-shell-libs/Tezos_shell_services/Block_services/index.html#type-version">Block_services.version</a>
   * <span><span>(<span>(<a href="../../../../octez-libs/Tezos_crypto/Hashed/Operation_hash/index.html#type-t">Tezos_base.TzPervasives.Operation_hash.t</a>
       * <a href="../../../../tezos-protocol-020-PsParisC/Tezos_protocol_020_PsParisC_lifted/Lifted_protocol/index.html#type-operation">Tezos_client_020_PsParisC.Mockup.M.Protocol.operation</a>)</span>
      * <span><span><a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-error">Tezos_base.TzPervasives.error</a> <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-trace">Tezos_base.TzPervasives.trace</a></span> option</span>)</span>
       list</span>)</span>
    <a href="../../../../octez-libs/Tezos_rpc/Answer/index.html#type-stream">Tezos_rpc.Answer.stream</a></span></span></code></div><div class="spec-doc"><p>Return a stream of list of operations. Used by the baker to wait on attestations. Invariant: the stream becomes empty when the node changes head.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-list_blocks"><a href="#val-list_blocks" class="anchor"></a><code><span><span class="keyword">val</span> list_blocks : 
  <span><span class="label">heads</span>:<span><a href="../../../../octez-libs/Tezos_crypto/Hashed/Block_hash/index.html#type-t">Tezos_base.TzPervasives.Block_hash.t</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">length</span>:<span>int option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">min_date</span>:<span><a href="../../../../octez-libs/Tezos_base/Time/Protocol/index.html#type-t">Tezos_base.TzPervasives.Time.Protocol.t</a> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><span><a href="../../../../octez-libs/Tezos_crypto/Hashed/Block_hash/index.html#type-t">Tezos_base.TzPervasives.Block_hash.t</a> list</span> list</span>
    <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Lists block hashes from the chain, up to the last checkpoint, sorted with decreasing fitness. Without arguments it returns the head of the chain. Optional arguments allow to return the list of predecessors of a given block or of a set of blocks.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-live_blocks"><a href="#val-live_blocks" class="anchor"></a><code><span><span class="keyword">val</span> live_blocks : 
  <span><a href="../../../../octez-shell-libs/Tezos_shell_services/Block_services/index.html#type-block">Block_services.block</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../../../../octez-libs/Tezos_crypto/Hashed/Block_hash/Set/index.html#type-t">Tezos_base.TzPervasives.Block_hash.Set.t</a> <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>List the ancestors of the given block which, if referred to as the branch in an operation header, are recent enough for that operation to be included in the current block.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-rpc_context_callback"><a href="#val-rpc_context_callback" class="anchor"></a><code><span><span class="keyword">val</span> rpc_context_callback : 
  <span><a href="../../../../octez-shell-libs/Tezos_shell_services/Block_services/index.html#type-block">Block_services.block</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../../../../octez-proto-libs/Tezos_protocol_environment/index.html#type-rpc_context">Tezos_protocol_environment.rpc_context</a> <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>rpc_context_callback</code> is used in the implementations of several RPCs (see local_services.ml). It should correspond to the rpc_context constructed from the context at the requested block.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-raw_protocol_data"><a href="#val-raw_protocol_data" class="anchor"></a><code><span><span class="keyword">val</span> raw_protocol_data : 
  <span><a href="../../../../octez-shell-libs/Tezos_shell_services/Block_services/index.html#type-block">Block_services.block</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../../../../octez-libs/Tezos_base/TzPervasives/Bytes/index.html#type-t">Tezos_base.TzPervasives.Bytes.t</a> <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Return raw protocol data as a block.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-broadcast_block"><a href="#val-broadcast_block" class="anchor"></a><code><span><span class="keyword">val</span> broadcast_block : 
  <span><span class="optlabel">?dests</span>:<span>int list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../../octez-libs/Tezos_crypto/Hashed/Block_hash/index.html#type-t">Tezos_base.TzPervasives.Block_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../../octez-libs/Tezos_base/Block_header/index.html#type-t">Tezos_base.TzPervasives.Block_header.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><a href="../../../../octez-libs/Tezos_base/Operation/index.html#type-t">Tezos_base.TzPervasives.Operation.t</a> <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-trace">Tezos_base.TzPervasives.trace</a></span>
    <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-trace">Tezos_base.TzPervasives.trace</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>unit <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Broadcast block manually to nodes <code>dests</code> (given by their number, starting from 0). If <code>dests</code> is not provided, broadcast to all nodes.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-broadcast_operation"><a href="#val-broadcast_operation" class="anchor"></a><code><span><span class="keyword">val</span> broadcast_operation : 
  <span><span class="optlabel">?dests</span>:<span>int list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/index.html#type-packed_operation">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.packed_operation</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>unit <a href="../../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Broadcast operation manually to nodes <code>dests</code> (given by their number, starting from 0). If <code>dests</code> is not provided, broadcast to all nodes.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-monitor_bootstrapped"><a href="#val-monitor_bootstrapped" class="anchor"></a><code><span><span class="keyword">val</span> monitor_bootstrapped : 
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../../../../octez-libs/Tezos_crypto/Hashed/Block_hash/index.html#type-t">Tezos_base.TzPervasives.Block_hash.t</a>
   * <a href="../../../../octez-libs/Tezos_base/Time/Protocol/index.html#type-t">Tezos_base.TzPervasives.Time.Protocol.t</a>)</span>
    <a href="../../../../octez-libs/Tezos_rpc/Answer/index.html#type-stream">Tezos_rpc.Answer.stream</a></span></span></code></div><div class="spec-doc"><p>Simulate waiting for the node to be bootstrapped. Because the simulated node is already bootstrapped, returns the current head immediately.</p></div></div></div></body></html>
