<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Liquidity_baking_generator (octez-protocol-020-PsParisC-libs.Tezos_020_PsParisC_test_helpers.Liquidity_baking_generator)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../index.html">octez-protocol-020-PsParisC-libs</a> &#x00BB; <a href="../index.html">Tezos_020_PsParisC_test_helpers</a> &#x00BB; Liquidity_baking_generator</nav><header class="odoc-preamble"><h1>Module <code><span>Tezos_020_PsParisC_test_helpers.Liquidity_baking_generator</span></code></h1><p>This module provides a set of abstractions to reason about the so-called “liquidity baking” feature<code>1</code>.</p><p><code>1</code>: https://gitlab.com/tezos/tzip/-/blob/367628e1a576c3926bedc1d6107b2945607c2605/drafts/current/draft-liquidity_baking.md</p><p>We remind that this feature is built upon three smart contracts: (1) a CPMM contract initially based on Dexter 2, and (2) two tokens contracts.</p><p>Our purpose for Liquidity Baking is to easily express and test invariants regarding the execution of these contracts. To that end, we have introduced a set of dedicated types to describe arbitrary contexts in terms of account balances (see <code>Liquidity_baking_machine.specs</code>), along with <code>build</code> functions that turn a description of a context into concrete states.</p><p>In this module, we provide QCheck2 generators which allow to construct arbitrary specifications for states, and so-called scenarios (<i>i.e.</i>, sequences of entrypoint calls).</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value anchored" id="val-gen_specs"><a href="#val-gen_specs" class="anchor"></a><code><span><span class="keyword">val</span> gen_specs : 
  <span><a href="../Liquidity_baking_machine/index.html#type-tzbtc">Liquidity_baking_machine.tzbtc</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Liquidity_baking_machine/index.html#type-liquidity">Liquidity_baking_machine.liquidity</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Liquidity_baking_machine/index.html#type-specs">Liquidity_baking_machine.specs</a> <span class="xref-unresolved">QCheck2</span>.Gen.t</span></span></code></div><div class="spec-doc"><p><code>gen_specs max_tzbtc max_liquidity</code> constructs arbitrary Liquidity Baking <code>specs</code> for an initial state, where at most <code>max_tzbtc</code> and <code>max_liquidity</code> are shared among an arbitrary number of implicit accounts.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-gen_scenario"><a href="#val-gen_scenario" class="anchor"></a><code><span><span class="keyword">val</span> gen_scenario : 
  <span><a href="../Liquidity_baking_machine/index.html#type-tzbtc">Liquidity_baking_machine.tzbtc</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Liquidity_baking_machine/index.html#type-liquidity">Liquidity_baking_machine.liquidity</a> <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../Liquidity_baking_machine/index.html#type-specs">Liquidity_baking_machine.specs</a>
   * <span><span><a href="../Liquidity_baking_machine/index.html#type-contract_id">Liquidity_baking_machine.contract_id</a> <a href="../Liquidity_baking_machine/index.html#type-step">Liquidity_baking_machine.step</a></span> list</span>)</span>
    <span class="xref-unresolved">QCheck2</span>.Gen.t</span></span></code></div><div class="spec-doc"><p><code>gen_scenario max_tzbtc max_liquidity size</code> constructs arbitrary Liquidity Baking <code>specs</code> with a semantics similar to <code>gen_specs</code>, along with sequences of <b>valid</b> scenarios (<i>i.e.</i>, sequences of entrypoint calls) of length <code>size</code>. By valid, we mean that running the scenario using a Liquidity baking machine initialized with the <code>specs</code> should succeed.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-print_scenario"><a href="#val-print_scenario" class="anchor"></a><code><span><span class="keyword">val</span> print_scenario : 
  <span><span>(<a href="../Liquidity_baking_machine/index.html#type-specs">Liquidity_baking_machine.specs</a>
   * <span><span><a href="../Liquidity_baking_machine/index.html#type-contract_id">Liquidity_baking_machine.contract_id</a> <a href="../Liquidity_baking_machine/index.html#type-step">Liquidity_baking_machine.step</a></span> list</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  string</span></code></div><div class="spec-doc"><p><code>print_scenario scenario</code> produces a string representation of <code>scenario</code>, as produced by <code>gen_scenario</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-gen_adversary_scenario"><a href="#val-gen_adversary_scenario" class="anchor"></a><code><span><span class="keyword">val</span> gen_adversary_scenario : 
  <span><a href="../Liquidity_baking_machine/index.html#type-tzbtc">Liquidity_baking_machine.tzbtc</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Liquidity_baking_machine/index.html#type-liquidity">Liquidity_baking_machine.liquidity</a> <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../Liquidity_baking_machine/index.html#type-specs">Liquidity_baking_machine.specs</a>
   * <a href="../Liquidity_baking_machine/index.html#type-contract_id">Liquidity_baking_machine.contract_id</a>
   * <span><span><a href="../Liquidity_baking_machine/index.html#type-contract_id">Liquidity_baking_machine.contract_id</a> <a href="../Liquidity_baking_machine/index.html#type-step">Liquidity_baking_machine.step</a></span> list</span>)</span>
    <span class="xref-unresolved">QCheck2</span>.Gen.t</span></span></code></div><div class="spec-doc"><p><code>gen_adversary_scenario max_tzbtc max_liquidity size</code> constructs arbitrary scenarios that can be used to challenge the “no global gain” property of Liquidity Baking.</p><p>The key idea of this property is the following: a given contract cannot profit from Liquidity Baking if they are the only one to interact with the CPMM (in the absence of subsidies). The scenario generated by <code>gen_adversary_scenario</code> only consists in <code>step</code> performed by one contract. This contract is identified by the <code>contract_id</code> returned by this function.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-print_adversary_scenario"><a href="#val-print_adversary_scenario" class="anchor"></a><code><span><span class="keyword">val</span> print_adversary_scenario : 
  <span><span>(<a href="../Liquidity_baking_machine/index.html#type-specs">Liquidity_baking_machine.specs</a>
   * <a href="../Liquidity_baking_machine/index.html#type-contract_id">Liquidity_baking_machine.contract_id</a>
   * <span><span><a href="../Liquidity_baking_machine/index.html#type-contract_id">Liquidity_baking_machine.contract_id</a> <a href="../Liquidity_baking_machine/index.html#type-step">Liquidity_baking_machine.step</a></span> list</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  string</span></code></div><div class="spec-doc"><p><code>print_adversary_scenario scenario</code> produces a string representation of <code>scenario</code>, as produced by <code>gen_adversary_scenario</code>.</p></div></div></div></body></html>
