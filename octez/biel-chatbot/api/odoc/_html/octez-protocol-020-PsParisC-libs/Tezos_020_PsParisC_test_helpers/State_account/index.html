<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>State_account (octez-protocol-020-PsParisC-libs.Tezos_020_PsParisC_test_helpers.State_account)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">octez-protocol-020-PsParisC-libs</a> &#x00BB; <a href="../index.html">Tezos_020_PsParisC_test_helpers</a> &#x00BB; State_account</nav><header class="odoc-preamble"><h1>Module <code><span>Tezos_020_PsParisC_test_helpers.State_account</span></code></h1><p><code>State_account</code> is dedicated to operations in <code>State.t</code> that would modify an <code>account_state</code>. This includes any operation like <code>transfer</code>, <code>stake</code>, <code>unstake</code>, <code>set_delegate_parameters</code>, anything related to slashing or rewards, etc...</p></header><div class="odoc-content"><div class="odoc-include"><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <span class="keyword">module</span> <span class="keyword">type</span> <span class="keyword">of</span> <span class="keyword">struct</span> <span class="keyword">include</span> <a href="../Tez_staking_helpers/index.html">Tez_staking_helpers</a> <span class="keyword">end</span></span></code></summary><div class="odoc-spec"><div class="spec module anchored" id="module-Cycle"><a href="#module-Cycle" class="anchor"></a><code><span><span class="keyword">module</span> Cycle</span><span> = <a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Cycle/index.html">Tezos_020_PsParisC_test_helpers.Tez_staking_helpers.Cycle</a></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Tez"><a href="#module-Tez" class="anchor"></a><code><span><span class="keyword">module</span> Tez</span><span> = <a href="../Tez_staking_helpers/Tez/index.html">Tez_staking_helpers.Tez</a></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Partial_tez"><a href="#module-Partial_tez" class="anchor"></a><code><span><span class="keyword">module</span> Partial_tez</span><span> = <a href="../Tez_staking_helpers/Partial_tez/index.html">Tez_staking_helpers.Partial_tez</a></span></code></div><div class="spec-doc"><p>Representation of Tez with non integer values</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Frozen_tez"><a href="#module-Frozen_tez" class="anchor"></a><code><span><span class="keyword">module</span> Frozen_tez</span><span> = <a href="../Tez_staking_helpers/Frozen_tez/index.html">Tez_staking_helpers.Frozen_tez</a></span></code></div><div class="spec-doc"><p><code>Frozen_tez</code> represents frozen stake and frozen unstaked funds. Properties:</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Unstaked_frozen"><a href="#module-Unstaked_frozen" class="anchor"></a><code><span><span class="keyword">module</span> Unstaked_frozen</span><span> = <a href="../Tez_staking_helpers/Unstaked_frozen/index.html">Tez_staking_helpers.Unstaked_frozen</a></span></code></div><div class="spec-doc"><p>Representation of Unstaked frozen deposits</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Unstaked_finalizable"><a href="#module-Unstaked_finalizable" class="anchor"></a><code><span><span class="keyword">module</span> Unstaked_finalizable</span><span> = <a href="../Tez_staking_helpers/Unstaked_finalizable/index.html">Tez_staking_helpers.Unstaked_finalizable</a></span></code></div><div class="spec-doc"><p>Representation of unstaked finalizable tez</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-tez_to_pseudo"><a href="#val-tez_to_pseudo" class="anchor"></a><code><span><span class="keyword">val</span> tez_to_pseudo : 
  <span><span class="label">round</span>:<span>[ `Down <span>| `Up</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Tez_staking_helpers/Tez/index.html#type-t">Tez.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Z</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Tez_staking_helpers/Frozen_tez/index.html#type-t">Frozen_tez.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Z</span>.t</span></code></div><div class="spec-doc"><p>Pseudotoken helpers</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pseudo_to_partial_tez"><a href="#val-pseudo_to_partial_tez" class="anchor"></a><code><span><span class="keyword">val</span> pseudo_to_partial_tez : <span><span class="xref-unresolved">Z</span>.t <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Z</span>.t <span class="arrow">&#45;&gt;</span></span> <span><a href="../Tez_staking_helpers/Frozen_tez/index.html#type-t">Frozen_tez.t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Q</span>.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-stake_values_real"><a href="#val-stake_values_real" class="anchor"></a><code><span><span class="keyword">val</span> stake_values_real : <span><a href="../Tez_staking_helpers/Tez/index.html#type-t">Tez.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Z</span>.t <span class="arrow">&#45;&gt;</span></span> <span><a href="../Tez_staking_helpers/Frozen_tez/index.html#type-t">Frozen_tez.t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Z</span>.t * <span class="xref-unresolved">Q</span>.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unstake_values_real"><a href="#val-unstake_values_real" class="anchor"></a><code><span><span class="keyword">val</span> unstake_values_real : <span><a href="../Tez_staking_helpers/Tez/index.html#type-t">Tez.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Z</span>.t <span class="arrow">&#45;&gt;</span></span> <span><a href="../Tez_staking_helpers/Frozen_tez/index.html#type-t">Frozen_tez.t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Z</span>.t * <span class="xref-unresolved">Q</span>.t</span></code></div></div></details></div><div class="odoc-include"><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <span class="keyword">module</span> <span class="keyword">type</span> <span class="keyword">of</span> <span class="keyword">struct</span> <span class="keyword">include</span> <a href="../Account_helpers/index.html">Account_helpers</a> <span class="keyword">end</span></span></code></summary><div class="odoc-spec"><div class="spec value anchored" id="val-fail_account_not_found"><a href="#val-fail_account_not_found" class="anchor"></a><code><span><span class="keyword">val</span> fail_account_not_found : <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-CycleMap"><a href="#module-CycleMap" class="anchor"></a><code><span><span class="keyword">module</span> CycleMap</span><span> = <a href="../Account_helpers/CycleMap/index.html">Account_helpers.CycleMap</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-account_state"><a href="#type-account_state" class="anchor"></a><code><span><span class="keyword">type</span> account_state</span><span> = <a href="../Account_helpers/index.html#type-account_state">Account_helpers.account_state</a></span><span> = </span><span>{</span></code><ol><li id="type-account_state.pkh" class="def record field anchored"><a href="#type-account_state.pkh" class="anchor"></a><code><span>pkh : <a href="../../../octez-libs/Tezos_crypto/Signature/Public_key_hash/index.html#type-t">Tezos_base.TzPervasives.Signature.Public_key_hash.t</a>;</span></code></li><li id="type-account_state.contract" class="def record field anchored"><a href="#type-account_state.contract" class="anchor"></a><code><span>contract : <a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Contract/index.html#type-t">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Contract.t</a>;</span></code></li><li id="type-account_state.delegate" class="def record field anchored"><a href="#type-account_state.delegate" class="anchor"></a><code><span>delegate : <span>string option</span>;</span></code></li><li id="type-account_state.parameters" class="def record field anchored"><a href="#type-account_state.parameters" class="anchor"></a><code><span>parameters : <a href="../Adaptive_issuance_helpers/index.html#type-staking_parameters">Adaptive_issuance_helpers.staking_parameters</a>;</span></code></li><li id="type-account_state.liquid" class="def record field anchored"><a href="#type-account_state.liquid" class="anchor"></a><code><span>liquid : <a href="../Tez_staking_helpers/Tez/index.html#type-t">Tez_staking_helpers.Tez.t</a>;</span></code></li><li id="type-account_state.bonds" class="def record field anchored"><a href="#type-account_state.bonds" class="anchor"></a><code><span>bonds : <a href="../Tez_staking_helpers/Tez/index.html#type-t">Tez_staking_helpers.Tez.t</a>;</span></code></li><li id="type-account_state.frozen_deposits" class="def record field anchored"><a href="#type-account_state.frozen_deposits" class="anchor"></a><code><span>frozen_deposits : <a href="../Tez_staking_helpers/Frozen_tez/index.html#type-t">Tez_staking_helpers.Frozen_tez.t</a>;</span></code></li><li id="type-account_state.unstaked_frozen" class="def record field anchored"><a href="#type-account_state.unstaked_frozen" class="anchor"></a><code><span>unstaked_frozen : <a href="../Tez_staking_helpers/Unstaked_frozen/index.html#type-t">Tez_staking_helpers.Unstaked_frozen.t</a>;</span></code></li><li id="type-account_state.unstaked_finalizable" class="def record field anchored"><a href="#type-account_state.unstaked_finalizable" class="anchor"></a><code><span>unstaked_finalizable : <a href="../Tez_staking_helpers/Unstaked_finalizable/index.html#type-t">Tez_staking_helpers.Unstaked_finalizable.t</a>;</span></code></li><li id="type-account_state.staking_delegator_numerator" class="def record field anchored"><a href="#type-account_state.staking_delegator_numerator" class="anchor"></a><code><span>staking_delegator_numerator : <span class="xref-unresolved">Z</span>.t;</span></code></li><li id="type-account_state.staking_delegate_denominator" class="def record field anchored"><a href="#type-account_state.staking_delegate_denominator" class="anchor"></a><code><span>staking_delegate_denominator : <span class="xref-unresolved">Z</span>.t;</span></code></li><li id="type-account_state.frozen_rights" class="def record field anchored"><a href="#type-account_state.frozen_rights" class="anchor"></a><code><span>frozen_rights : <span><a href="../Tez_staking_helpers/Tez/index.html#type-t">Tez_staking_helpers.Tez.t</a> <a href="../Account_helpers/CycleMap/index.html#type-t">CycleMap.t</a></span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The portion of rights that comes from staking, used for baking/attesting during the specified cycle.</p><p>At the end of cycle <code>c</code>, the current frozen deposits of the delegate (own + co-staked, taking limit_of_staking_over_baking into account) are added to this table for cycle <code>c + consensus_rights_delay + 1</code>. The table is unmodified if at that time, the account is not a delegate or is a deactivated delegate.</p><span class="comment-delim">*)</span></div></li><li id="type-account_state.slashed_cycles" class="def record field anchored"><a href="#type-account_state.slashed_cycles" class="anchor"></a><code><span>slashed_cycles : <span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Cycle/index.html#type-t">Tezos_020_PsParisC_test_helpers.Tez_staking_helpers.Cycle.t</a>
                   list</span>;</span></code></li><li id="type-account_state.last_active_cycle" class="def record field anchored"><a href="#type-account_state.last_active_cycle" class="anchor"></a><code><span>last_active_cycle : <a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Cycle/index.html#type-t">Tezos_020_PsParisC_test_helpers.Tez_staking_helpers.Cycle.t</a>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Abstract information of accounts</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-init_account"><a href="#val-init_account" class="anchor"></a><code><span><span class="keyword">val</span> init_account : 
  <span><span class="optlabel">?delegate</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">pkh</span>:<a href="../../../octez-libs/Tezos_crypto/Signature/Public_key_hash/index.html#type-t">Tezos_base.TzPervasives.Signature.Public_key_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">contract</span>:<a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Contract/index.html#type-t">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Contract.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">parameters</span>:<a href="../Adaptive_issuance_helpers/index.html#type-staking_parameters">Adaptive_issuance_helpers.staking_parameters</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?liquid</span>:<a href="../Tez_staking_helpers/Tez/index.html#type-t">Tez_staking_helpers.Tez.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?bonds</span>:<a href="../Tez_staking_helpers/Tez/index.html#type-t">Tez_staking_helpers.Tez.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?frozen_deposits</span>:<a href="../Tez_staking_helpers/Frozen_tez/index.html#type-t">Tez_staking_helpers.Frozen_tez.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?unstaked_frozen</span>:<a href="../Tez_staking_helpers/Unstaked_frozen/index.html#type-t">Tez_staking_helpers.Unstaked_frozen.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?unstaked_finalizable</span>:<a href="../Tez_staking_helpers/Unstaked_finalizable/index.html#type-t">Tez_staking_helpers.Unstaked_finalizable.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?staking_delegator_numerator</span>:<span class="xref-unresolved">Z</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?staking_delegate_denominator</span>:<span class="xref-unresolved">Z</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?frozen_rights</span>:<span><a href="../Tez_staking_helpers/Tez/index.html#type-t">Tez_staking_helpers.Tez.t</a> <a href="../Account_helpers/CycleMap/index.html#type-t">CycleMap.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?slashed_cycles</span>:
    <span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Cycle/index.html#type-t">Tezos_020_PsParisC_test_helpers.Tez_staking_helpers.Cycle.t</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?last_active_cycle</span>:
    <a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Cycle/index.html#type-cycle">Tezos_020_PsParisC_test_helpers.Tez_staking_helpers.Cycle.cycle</a> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-account_state">account_state</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-account_map"><a href="#type-account_map" class="anchor"></a><code><span><span class="keyword">type</span> account_map</span><span> = <span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-balance"><a href="#type-balance" class="anchor"></a><code><span><span class="keyword">type</span> balance</span><span> = <a href="../Account_helpers/index.html#type-balance">Account_helpers.balance</a></span><span> = </span><span>{</span></code><ol><li id="type-balance.liquid_b" class="def record field anchored"><a href="#type-balance.liquid_b" class="anchor"></a><code><span>liquid_b : <a href="../Tez_staking_helpers/Tez/index.html#type-t">Tez_staking_helpers.Tez.t</a>;</span></code></li><li id="type-balance.bonds_b" class="def record field anchored"><a href="#type-balance.bonds_b" class="anchor"></a><code><span>bonds_b : <a href="../Tez_staking_helpers/Tez/index.html#type-t">Tez_staking_helpers.Tez.t</a>;</span></code></li><li id="type-balance.staked_b" class="def record field anchored"><a href="#type-balance.staked_b" class="anchor"></a><code><span>staked_b : <a href="../Tez_staking_helpers/Partial_tez/index.html#type-t">Tez_staking_helpers.Partial_tez.t</a>;</span></code></li><li id="type-balance.unstaked_frozen_b" class="def record field anchored"><a href="#type-balance.unstaked_frozen_b" class="anchor"></a><code><span>unstaked_frozen_b : <a href="../Tez_staking_helpers/Tez/index.html#type-t">Tez_staking_helpers.Tez.t</a>;</span></code></li><li id="type-balance.unstaked_finalizable_b" class="def record field anchored"><a href="#type-balance.unstaked_finalizable_b" class="anchor"></a><code><span>unstaked_finalizable_b : <a href="../Tez_staking_helpers/Tez/index.html#type-t">Tez_staking_helpers.Tez.t</a>;</span></code></li><li id="type-balance.staking_delegator_numerator_b" class="def record field anchored"><a href="#type-balance.staking_delegator_numerator_b" class="anchor"></a><code><span>staking_delegator_numerator_b : <span class="xref-unresolved">Z</span>.t;</span></code></li><li id="type-balance.staking_delegate_denominator_b" class="def record field anchored"><a href="#type-balance.staking_delegate_denominator_b" class="anchor"></a><code><span>staking_delegate_denominator_b : <span class="xref-unresolved">Z</span>.t;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Balance returned by RPCs. Partial tez are rounded down</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-balance_zero"><a href="#val-balance_zero" class="anchor"></a><code><span><span class="keyword">val</span> balance_zero : <a href="#type-balance">balance</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-balance_of_account"><a href="#val-balance_of_account" class="anchor"></a><code><span><span class="keyword">val</span> balance_of_account : 
  <span><a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-key">Tezos_base.TzPervasives.String.Map.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-account_map">account_map</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-balance">balance</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-balance_pp"><a href="#val-balance_pp" class="anchor"></a><code><span><span class="keyword">val</span> balance_pp : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-balance">balance</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-balance_update_pp"><a href="#val-balance_update_pp" class="anchor"></a><code><span><span class="keyword">val</span> balance_update_pp : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><span>(<a href="#type-balance">balance</a> * <a href="#type-balance">balance</a>)</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-assert_balance_equal"><a href="#val-assert_balance_equal" class="anchor"></a><code><span><span class="keyword">val</span> assert_balance_equal : 
  <span><span class="label">loc</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-balance">balance</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-balance">balance</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(unit, <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tztrace">Tezos_base.TzPervasives.tztrace</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-update_account"><a href="#val-update_account" class="anchor"></a><code><span><span class="keyword">val</span> update_account : 
  <span><span class="label">f</span>:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-key">Tezos_base.TzPervasives.String.Map.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-balance_and_total_balance_of_account"><a href="#val-balance_and_total_balance_of_account" class="anchor"></a><code><span><span class="keyword">val</span> balance_and_total_balance_of_account : 
  <span><a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-key">Tezos_base.TzPervasives.String.Map.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-account_map">account_map</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-balance">balance</a> * <a href="../Tez_staking_helpers/Tez/index.html#type-t">Tez_staking_helpers.Tez.t</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-assert_pseudotokens_consistency"><a href="#val-assert_pseudotokens_consistency" class="anchor"></a><code><span><span class="keyword">val</span> assert_pseudotokens_consistency : 
  <span><span class="label">loc</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-balance">balance</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-account_state">account_state</a> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>unit <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_balance_from_context"><a href="#val-get_balance_from_context" class="anchor"></a><code><span><span class="keyword">val</span> get_balance_from_context : 
  <span><span class="xref-unresolved">Tezos_020_PsParisC_test_helpers__Context.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Contract/index.html#type-t">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Contract.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="#type-balance">balance</a> * <a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Tez/index.html#type-t">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Tez.t</a>,
    <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tztrace">Tezos_base.TzPervasives.tztrace</a>)</span>
    <span class="xref-unresolved">Stdlib</span>.result</span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-assert_balance_check"><a href="#val-assert_balance_check" class="anchor"></a><code><span><span class="keyword">val</span> assert_balance_check : 
  <span><span class="label">loc</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Tezos_020_PsParisC_test_helpers__Context.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-key">Tezos_base.TzPervasives.String.Map.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(unit, <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tztrace">Tezos_base.TzPervasives.tztrace</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-log_debug_balance"><a href="#val-log_debug_balance" class="anchor"></a><code><span><span class="keyword">val</span> log_debug_balance : 
  <span><a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-key">Tezos_base.TzPervasives.String.Map.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-account_map">account_map</a> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-log_debug_rpc_balance"><a href="#val-log_debug_rpc_balance" class="anchor"></a><code><span><span class="keyword">val</span> log_debug_rpc_balance : 
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Contract/index.html#type-t">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Contract.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Block/index.html#type-t">Block.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>unit <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tzresult">Tezos_base.TzPervasives.tzresult</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-log_debug_balance_update"><a href="#val-log_debug_balance_update" class="anchor"></a><code><span><span class="keyword">val</span> log_debug_balance_update : 
  <span><a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-key">Tezos_base.TzPervasives.String.Map.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-account_map">account_map</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-account_map">account_map</a> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-current_total_frozen_deposits_with_limits"><a href="#val-current_total_frozen_deposits_with_limits" class="anchor"></a><code><span><span class="keyword">val</span> current_total_frozen_deposits_with_limits : 
  <span><a href="#type-account_state">account_state</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Tez/index.html#type-t">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Tez.t</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-update_activity"><a href="#val-update_activity" class="anchor"></a><code><span><span class="keyword">val</span> update_activity : 
  <span><a href="#type-account_state">account_state</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Constants/Parametric/index.html#type-t">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Constants.Parametric.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">level</span>:int32 <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Cycle/index.html#type-t">Tezos_020_PsParisC_test_helpers.Tez_staking_helpers.Cycle.t</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-account_state">account_state</a></span></code></div></div></details></div><div class="odoc-spec"><div class="spec value anchored" id="val-add_liquid_rewards"><a href="#val-add_liquid_rewards" class="anchor"></a><code><span><span class="keyword">val</span> add_liquid_rewards : 
  <span><a href="../Tez_staking_helpers/Tez/index.html#type-t">Tez.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-key">Tezos_base.TzPervasives.String.Map.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-add_frozen_rewards"><a href="#val-add_frozen_rewards" class="anchor"></a><code><span><span class="keyword">val</span> add_frozen_rewards : 
  <span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Tez/index.html#type-t">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Tez.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-key">Tezos_base.TzPervasives.String.Map.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-apply_burn"><a href="#val-apply_burn" class="anchor"></a><code><span><span class="keyword">val</span> apply_burn : 
  <span><a href="../Tez_staking_helpers/Tez/index.html#type-t">Tez.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-key">Tezos_base.TzPervasives.String.Map.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-apply_transfer"><a href="#val-apply_transfer" class="anchor"></a><code><span><span class="keyword">val</span> apply_transfer : 
  <span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Tez/index.html#type-t">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Tez.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-key">Tezos_base.TzPervasives.String.Map.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-key">Tezos_base.TzPervasives.String.Map.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-stake_from_unstake"><a href="#val-stake_from_unstake" class="anchor"></a><code><span><span class="keyword">val</span> stake_from_unstake : 
  <span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Tez/index.html#type-t">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Tez.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Cycle/index.html#type-cycle">Cycle.cycle</a> <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-key">Tezos_base.TzPervasives.String.Map.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span>
  * <a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Tez/index.html#type-t">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Tez.t</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-apply_stake"><a href="#val-apply_stake" class="anchor"></a><code><span><span class="keyword">val</span> apply_stake : 
  <span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Tez/index.html#type-t">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Tez.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Cycle/index.html#type-cycle">Cycle.cycle</a> <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-key">Tezos_base.TzPervasives.String.Map.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-apply_unstake"><a href="#val-apply_unstake" class="anchor"></a><code><span><span class="keyword">val</span> apply_unstake : 
  <span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Cycle/index.html#type-t">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Cycle.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Tez/index.html#type-t">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Tez.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-key">Tezos_base.TzPervasives.String.Map.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-apply_unslashable_f"><a href="#val-apply_unslashable_f" class="anchor"></a><code><span><span class="keyword">val</span> apply_unslashable_f : 
  <span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Cycle/index.html#type-t">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Cycle.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-account_state">account_state</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-account_state">account_state</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-apply_unslashable"><a href="#val-apply_unslashable" class="anchor"></a><code><span><span class="keyword">val</span> apply_unslashable : 
  <span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Cycle/index.html#type-t">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Cycle.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-key">Tezos_base.TzPervasives.String.Map.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-apply_unslashable_for_all"><a href="#val-apply_unslashable_for_all" class="anchor"></a><code><span><span class="keyword">val</span> apply_unslashable_for_all : 
  <span><a href="../../../tezos-protocol-020-PsParisC/Tezos_raw_protocol_020_PsParisC/Alpha_context/Cycle/index.html#type-t">Tezos_protocol_020_PsParisC.Protocol.Alpha_context.Cycle.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-apply_finalize"><a href="#val-apply_finalize" class="anchor"></a><code><span><span class="keyword">val</span> apply_finalize : 
  <span><a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-key">Tezos_base.TzPervasives.String.Map.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-compute_future_frozen_rights"><a href="#val-compute_future_frozen_rights" class="anchor"></a><code><span><span class="keyword">val</span> compute_future_frozen_rights : 
  <span><a href="../Block/index.html#type-block">Block.block</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span><a href="#type-account_state">account_state</a> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/Map/index.html#type-t">Tezos_base.TzPervasives.String.Map.t</a></span>,
    <a href="../../../octez-libs/Tezos_base/TzPervasives/index.html#type-tztrace">Tezos_base.TzPervasives.tztrace</a>)</span>
    <span class="xref-unresolved">Stdlib</span>.result</span>
    <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Compute the staking rights for <code>current_cycle +
    consensus_rights_delay + 1</code> and save them into <code>account.frozen_rights</code> for each delegate.</p></div></div></div></body></html>
