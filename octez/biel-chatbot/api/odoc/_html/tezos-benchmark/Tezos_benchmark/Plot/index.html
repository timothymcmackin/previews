<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Plot (tezos-benchmark.Tezos_benchmark.Plot)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">tezos-benchmark</a> &#x00BB; <a href="../index.html">Tezos_benchmark</a> &#x00BB; Plot</nav><header class="odoc-preamble"><h1>Module <code><span>Tezos_benchmark.Plot</span></code></h1><p><code>prbnmcn-gnuplot</code>: a self-contained interface to Gnuplot.</p></header><nav class="odoc-toc"><ul><li><a href="#introduction">Introduction</a><ul><li><a href="#data:-1d,-2d,-3d">Data: 1d, 2d, 3d</a></li><li><a href="#scatter-plot-example">Scatter plot example</a></li><li><a href="#line-plot-example">Line plot example</a></li><li><a href="#histogram-example">Histogram example</a></li></ul></li><li><a href="#api">API</a><ul><li><a href="#raw-data">Raw data</a></li><li><a href="#colors,-styles,-etc">Colors, styles, etc</a></li><li><a href="#datasets">Datasets</a></li><li><a href="#plot-specifications">Plot specifications</a><ul><li><a href="#scatter-plots">Scatter plots</a></li><li><a href="#line-plots">Line plots</a></li><li><a href="#histograms">Histograms</a></li></ul></li><li><a href="#plot-rendering">Plot rendering</a></li></ul></li></ul></nav><div class="odoc-content"><h2 id="introduction"><a href="#introduction" class="anchor"></a>Introduction</h2><p>We give an introduction to the library by giving some examples. These examples can be run by performing</p><pre class="language-ocaml"><code>&gt; dune exec ./test/example.exe</code></pre><p>in the root of the library.</p><p>Let's assume throughout we've access to some sampler for the standard normal distribution:</p><pre class="language-ocaml"><code>val normal : Random.State.t -&gt; float</code></pre><h3 id="data:-1d,-2d,-3d"><a href="#data:-1d,-2d,-3d" class="anchor"></a>Data: 1d, 2d, 3d</h3><p>The library encapsulates 1d, 2d and 3d data points using the types <code>Plot.r1</code>, <code>Plot.r2</code> and <code>Plot.r3</code>. Similarly named functions allow to inject floating-point values into these types.</p><p>As an example, we can write samplers for 2d and 3d normal variates with specified means:</p><pre class="language-ocaml"><code>(** [st] is the random state *)
let normal2 (mu_x, mu_y)
  st = Plot.r2 (normal st +. mu_x) (normal st +. mu_y)</code></pre><h3 id="scatter-plot-example"><a href="#scatter-plot-example" class="anchor"></a>Scatter plot example</h3><p>Let's plot some clouds of points using <code>normal2</code>. For 2d scatter plots, we use <a href="Scatter/index.html#val-points_2d"><code>Plot.Scatter.points_2d</code></a>. We need to feed this function with a value of type <code>r2 Plot.Data.t</code>. For instance, the following function specifies a 2d scatter plot with 100 random normally distributed points with mean <code>mu</code>.</p><pre class="language-ocaml"><code>let scatter ~mu st =
  Plot.Scatter.points_2d
    ~points:(Plot.Data.of_array (Array.init 100 (fun _ -&gt; normal2 mu st)))
    ()</code></pre><p>Let's produce a plot with two clouds around <code>(3, 2)</code> and <code>(10, 8)</code> and display it using the <a href="#val-plot2"><code>Plot.plot2</code></a> function.</p><pre class="language-ocaml"><code>let st = Random.State.make_self_init ()

let scatter2d_example =
  Plot.plot2
    ~xaxis:&quot;x&quot;
    ~yaxis:&quot;y&quot;
    ~title:&quot;Clouds&quot;
    [scatter ~mu:(3., 2.) st; scatter ~mu:(10., 8.) st]</code></pre><p>Finally, we can produce the plot and save it, say to a .png file.</p><pre class="language-ocaml"><code>let () =
  let target = Plot.png ~pixel_size:(1024, 1024) ~png_file:&quot;scatter.png&quot; () in
  Plot.(run ~plot:scatter2d_example ~target exec)</code></pre><p>3d plots work similarly, using the <a href="Scatter/index.html#val-points_3d"><code>Plot.Scatter.points_3d</code></a> function.</p><h3 id="line-plot-example"><a href="#line-plot-example" class="anchor"></a>Line plot example</h3><p>The library also handles line plots, through the functions exposed in <a href="Line/index.html"><code>Plot.Line</code></a>. The API works similarly. Functions must be discretized before being plotted: for the sake of the example, let's introduce the following function.</p><pre class="language-ocaml"><code>let discretize f =
  Array.init 100 (fun i -&gt;
      let x = float_of_int i *. 0.1 in
      let y = f x in
      Plot.r2 x y)</code></pre><p>We prepare a fancy plot for the discretized sine function as follows.</p><pre class="language-ocaml"><code>let sine_with_points =
  let open Plot in
  Line.line_2d
    ~points:(Data.of_array (discretize sin))
    ~style:
      Style.(default |&gt; set_color Color.red |&gt; set_point ~ptyp:Pointtype.box)
    ~with_points:true
    ()</code></pre><p>We display it similarly as in the scatter plot case.</p><pre class="language-ocaml"><code>let line2d_example =
  Plot.plot2 ~xaxis:&quot;x&quot; ~yaxis:&quot;y&quot; ~title:&quot;Lines&quot; [sine_with_points]

let () =
  let target = Plot.png ~pixel_size:(1024, 1024) ~png_file:&quot;lines.png&quot; () in
  Plot.(run ~plot:line2d_example ~target exec)</code></pre><h3 id="histogram-example"><a href="#histogram-example" class="anchor"></a>Histogram example</h3><p>Finally, the library allows to prepare histograms.</p><pre class="language-ocaml"><code>let gaussian =
  let open Plot in
  Histogram.hist
    ~points:(Data.of_array (Array.init 100 (fun _ -&gt; r1 @@ normal st)))
    ()

let histogram_example =
  Plot.plot2 ~xaxis:&quot;x&quot; ~yaxis:&quot;freq&quot; ~title:&quot;Histogram&quot; [gaussian]

let () =
  let target = Plot.png ~pixel_size:(1024, 1024) ~png_file:&quot;histogram.png&quot; () in
  Plot.(run ~plot:histogram_example ~target exec)</code></pre><p>The binning is performed automatically by Gnuplot: currently, the API does not provide any functionality for manually specifed box plots.</p><h2 id="api"><a href="#api" class="anchor"></a>API</h2><h3 id="raw-data"><a href="#raw-data" class="anchor"></a>Raw data</h3><div class="odoc-spec"><div class="spec type anchored" id="type-r1"><a href="#type-r1" class="anchor"></a><code><span><span class="keyword">type</span> r1</span></code></div><div class="spec-doc"><p><code>r1, r2, r3</code> encode elements of <code>R^n</code> for <code>n</code> equal to 1, 2 or 3.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-r2"><a href="#type-r2" class="anchor"></a><code><span><span class="keyword">type</span> r2</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-r3"><a href="#type-r3" class="anchor"></a><code><span><span class="keyword">type</span> r3</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-r1"><a href="#val-r1" class="anchor"></a><code><span><span class="keyword">val</span> r1 : <span>float <span class="arrow">&#45;&gt;</span></span> <a href="#type-r1">r1</a></span></code></div><div class="spec-doc"><p><code>r1, r2, r3</code> are injections into their respective types.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-r2"><a href="#val-r2" class="anchor"></a><code><span><span class="keyword">val</span> r2 : <span>float <span class="arrow">&#45;&gt;</span></span> <span>float <span class="arrow">&#45;&gt;</span></span> <a href="#type-r2">r2</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-r3"><a href="#val-r3" class="anchor"></a><code><span><span class="keyword">val</span> r3 : <span>float <span class="arrow">&#45;&gt;</span></span> <span>float <span class="arrow">&#45;&gt;</span></span> <span>float <span class="arrow">&#45;&gt;</span></span> <a href="#type-r3">r3</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-tup_r2"><a href="#val-tup_r2" class="anchor"></a><code><span><span class="keyword">val</span> tup_r2 : <span><span>(float * float)</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-r2">r2</a></span></code></div><div class="spec-doc"><p><code>tup_r2, tup_r3</code> proceed on tuples.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-tup_r3"><a href="#val-tup_r3" class="anchor"></a><code><span><span class="keyword">val</span> tup_r3 : <span><span>(float * float * float)</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-r3">r3</a></span></code></div></div><h3 id="colors,-styles,-etc"><a href="#colors,-styles,-etc" class="anchor"></a>Colors, styles, etc</h3><div class="odoc-spec"><div class="spec module anchored" id="module-Color"><a href="#module-Color" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Color/index.html">Color</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Colors</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Pointtype"><a href="#module-Pointtype" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Pointtype/index.html">Pointtype</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Pointtypes</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Fill"><a href="#module-Fill" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Fill/index.html">Fill</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Filling shapes.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Style"><a href="#module-Style" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Style/index.html">Style</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Styles</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Tics"><a href="#module-Tics" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Tics/index.html">Tics</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Tics. See the gnuplot documentation for the <code>xtics</code> command for the meaning of these options.</p></div></div><h3 id="datasets"><a href="#datasets" class="anchor"></a>Datasets</h3><div class="odoc-spec"><div class="spec module anchored" id="module-Data"><a href="#module-Data" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Data/index.html">Data</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Datasets</p></div></div><h3 id="plot-specifications"><a href="#plot-specifications" class="anchor"></a>Plot specifications</h3><div class="odoc-spec"><div class="spec type anchored" id="type-spec"><a href="#type-spec" class="anchor"></a><code><span><span class="keyword">type</span> <span>'dim spec</span></span></code></div><div class="spec-doc"><p><code>'dim spec</code> is the type of a declarative plot specification for data of type <code>'dim</code>.</p></div></div><h4 id="scatter-plots"><a href="#scatter-plots" class="anchor"></a>Scatter plots</h4><div class="odoc-spec"><div class="spec module anchored" id="module-Scatter"><a href="#module-Scatter" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Scatter/index.html">Scatter</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Preparing scatter plots.</p></div></div><h4 id="line-plots"><a href="#line-plots" class="anchor"></a>Line plots</h4><div class="odoc-spec"><div class="spec module anchored" id="module-Line"><a href="#module-Line" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Line/index.html">Line</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Preparing line plots.</p></div></div><h4 id="histograms"><a href="#histograms" class="anchor"></a>Histograms</h4><div class="odoc-spec"><div class="spec module anchored" id="module-Histogram"><a href="#module-Histogram" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Histogram/index.html">Histogram</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Preparing histograms.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Bar"><a href="#module-Bar" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Bar/index.html">Bar</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><h3 id="plot-rendering"><a href="#plot-rendering" class="anchor"></a>Plot rendering</h3><div class="odoc-spec"><div class="spec type anchored" id="type-plot"><a href="#type-plot" class="anchor"></a><code><span><span class="keyword">type</span> plot</span></code></div><div class="spec-doc"><p>A <code>plot</code> consists of</p><ul><li>a choice of <code>axes</code> (2d or 3d, with a name for each axis)</li><li>a list of plot <code>spec</code>s consistent with the dimension of the <code>axes</code></li><li>a title</li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-plot2"><a href="#val-plot2" class="anchor"></a><code><span><span class="keyword">val</span> plot2 : 
  <span><span class="label">xaxis</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">yaxis</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?xtics</span>:<a href="Tics/index.html#type-t">Tics.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?ytics</span>:<a href="Tics/index.html#type-t">Tics.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?title</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><a href="#type-r2">r2</a> <a href="#type-spec">spec</a></span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-plot">plot</a></span></code></div><div class="spec-doc"><p><code>plot2 ~xaxis ~yaxis ?xtics ?ytics ?title specs</code> construct a 2d plot. The plots <code>specs</code> are stacked together in the same figure. All the plots share the same 2d axis system, with names <code>xaxis</code> and <code>yaxis</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-plot3"><a href="#val-plot3" class="anchor"></a><code><span><span class="keyword">val</span> plot3 : 
  <span><span class="label">xaxis</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">yaxis</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">zaxis</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?xtics</span>:<a href="Tics/index.html#type-t">Tics.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?ytics</span>:<a href="Tics/index.html#type-t">Tics.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?ztics</span>:<a href="Tics/index.html#type-t">Tics.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?title</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><a href="#type-r3">r3</a> <a href="#type-spec">spec</a></span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-plot">plot</a></span></code></div><div class="spec-doc"><p><code>plot3 ~xaxis ~yaxis ~zaxis ~title specs</code> construct a 3d plot. The plots <code>specs</code> are stacked together in the same figure. All the plots share the same 3d axis system, with names <code>xaxis</code>, <code>yaxis</code> and <code>zaxis</code>.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-target"><a href="#type-target" class="anchor"></a><code><span><span class="keyword">type</span> target</span></code></div><div class="spec-doc"><p>Plot target. Note that the <code>Qt</code> and <code>X11</code> targets do not work well with multiple (&quot;matrix&quot;) plots on some tiling window managers or generally when resizing windows. In this case, it is recommended to use the <code>Pdf</code> or <code>Png</code> targets and use a third-party visualizer.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pdf"><a href="#val-pdf" class="anchor"></a><code><span><span class="keyword">val</span> pdf : <span><span class="optlabel">?cm_size</span>:<span>(float * float)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">pdf_file</span>:string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="#type-target">target</a></span></code></div><div class="spec-doc"><p><code>pdf ?cm_size ~pdf_file ()</code> specifies that the plot should be written to the file <code>pdf_file</code> using the pdf format. The optional argument <code>?cm_size</code> specifies the width and height of the figure in <code>cm</code>. If not specified, Gnuplot will select the aspect ratio and size automatically.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-png"><a href="#val-png" class="anchor"></a><code><span><span class="keyword">val</span> png : <span><span class="optlabel">?pixel_size</span>:<span>(int * int)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">png_file</span>:string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="#type-target">target</a></span></code></div><div class="spec-doc"><p><code>png ?pixel_size ~png_file ()</code> specifies that the plot should be written to the file <code>png_file</code> using the PNG format. The optional argument <code>?pixel_size</code> specifies the width and height of the figure in <code>pixels</code>. If not specified, Gnuplot will select the aspect ratio and size automatically.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-x11"><a href="#val-x11" class="anchor"></a><code><span><span class="keyword">val</span> x11 : <a href="#type-target">target</a></span></code></div><div class="spec-doc"><p>The X11 target. This target is interactive (it will open a window).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-qt"><a href="#val-qt" class="anchor"></a><code><span><span class="keyword">val</span> qt : <span><span class="optlabel">?pixel_size</span>:<span>(int * int)</span> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="#type-target">target</a></span></code></div><div class="spec-doc"><p>The qt target. This target is interactive (it will open a window). The optional argument <code>?pixel_size</code> specifies the width and height of the figure in <code>cm</code>. If not specified, Gnuplot will select the aspect ratio and size automatically.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_targets"><a href="#val-get_targets" class="anchor"></a><code><span><span class="keyword">val</span> get_targets : <span><span class="optlabel">?path</span>:string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>string list</span> option</span></span></code></div><div class="spec-doc"><p><code>get_targets ()</code> returns a list of all available targets (called 'terminals' by gnuplot). Returns <code>None</code> if the list of targets could not be obtained.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-run"><a href="#val-run" class="anchor"></a><code><span><span class="keyword">val</span> run : 
  <span><span class="optlabel">?path</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?detach</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?filename</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?exec</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">target</span>:<a href="#type-target">target</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-plot">plot</a> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>run ?path ?detach ?filename ?exec ~target plot</code> performs plotting of <code>plot</code> using <code>target</code>.</p><ul><li><code>path</code> : The path of Gnuplot, defaults to <code>&quot;gnuplot&quot;</code></li><li><code>detach</code> : If <code>true</code>, Gnuplot process does not block the main process. The default is <code>false</code>.</li><li><code>filename</code> : If specified, the plot script is saved to this file.</li><li><code>exec</code> : If <code>false</code>, execution of Gnuplot is skipped. The default is <code>true</code>.</li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-run_matrix"><a href="#val-run_matrix" class="anchor"></a><code><span><span class="keyword">val</span> run_matrix : 
  <span><span class="optlabel">?path</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?detach</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?filename</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?exec</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">target</span>:<a href="#type-target">target</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?title</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><span><a href="#type-plot">plot</a> option</span> array</span> array</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>run_matrix ?path ?detach ?filename ?exec ~target ?title plots</code> performs plotting of <code>plots</code> using <code>target</code>.</p><ul><li><code>path</code> : The path of Gnuplot, defaults to <code>&quot;gnuplot&quot;</code></li><li><code>detach</code> : If <code>true</code>, Gnuplot process does not block the main process. The default is <code>false</code>.</li><li><code>filename</code> : If specified, the plot script is saved to this file.</li><li><code>exec</code> : If <code>false</code>, execution of Gnuplot is skipped. The default is <code>true</code>.</li><li><code>title</code> : The title of the plots. The default is <code>&quot;&quot;</code></li></ul></div></div></div></body></html>
