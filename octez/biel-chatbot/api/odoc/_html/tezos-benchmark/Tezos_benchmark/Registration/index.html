<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Registration (tezos-benchmark.Tezos_benchmark.Registration)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">tezos-benchmark</a> &#x00BB; <a href="../index.html">Tezos_benchmark</a> &#x00BB; Registration</nav><header class="odoc-preamble"><h1>Module <code><span>Tezos_benchmark.Registration</span></code></h1><p>The <code>Registration</code> module contains functions regarding the registration of benchmarks, models, parameters and commands for the Snoop tool.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec exception anchored" id="exception-Benchmark_not_found"><a href="#exception-Benchmark_not_found" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Benchmark_not_found</span> <span class="keyword">of</span> <a href="../Namespace/index.html#type-t">Namespace.t</a></span></code></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Model_not_found"><a href="#exception-Model_not_found" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Model_not_found</span> <span class="keyword">of</span> <a href="../Namespace/index.html#type-t">Namespace.t</a></span></code></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Local_model_not_found"><a href="#exception-Local_model_not_found" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Local_model_not_found</span> <span class="keyword">of</span> <a href="../../../octez-libs/Tezos_base/TzPervasives/String/index.html#type-t">Tezos_base.TzPervasives.String.t</a></span></code></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-Parameter_not_found"><a href="#exception-Parameter_not_found" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Parameter_not_found</span> <span class="keyword">of</span> <a href="../Free_variable/index.html#type-t">Free_variable.t</a></span></code></div></div><p>Types of the registered informations for each kind of item. These informations are retrieved with the query functions <code>all_*</code> and <code>find_*</code> defined below</p><div class="odoc-spec"><div class="spec type anchored" id="type-benchmark_info"><a href="#type-benchmark_info" class="anchor"></a><code><span><span class="keyword">type</span> benchmark_info</span><span> = <a href="../Benchmark/index.html#type-t">Benchmark.t</a></span></code></div><div class="spec-doc"><p>The information registered for a benchmark is the benchmark itself</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-model_info"><a href="#type-model_info" class="anchor"></a><code><span><span class="keyword">type</span> model_info</span><span> = </span><span>{</span></code><ol><li id="type-model_info.model" class="def record field anchored"><a href="#type-model_info.model" class="anchor"></a><code><span>model : <a href="../Model/index.html#type-packed_model">Model.packed_model</a>;</span></code></li><li id="type-model_info.from" class="def record field anchored"><a href="#type-model_info.from" class="anchor"></a><code><span>from : <span><a href="#type-local_model_info">local_model_info</a> list</span>;</span></code></li><li id="type-model_info.codegen_destination" class="def record field anchored"><a href="#type-model_info.codegen_destination" class="anchor"></a><code><span>codegen_destination : <span>string option</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Specifies the code generation destination for codegen models. If <code>None</code> the detination is determined from the benchmmark the model belongs to.</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>We only register abstract models. For each of them, we store the model itself, as well as each of its occurences in benchmarks</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-local_model_info"><a href="#type-local_model_info" class="anchor"></a><code><span><span class="keyword">and</span> local_model_info</span><span> = </span><span>{</span></code><ol><li id="type-local_model_info.bench_name" class="def record field anchored"><a href="#type-local_model_info.bench_name" class="anchor"></a><code><span>bench_name : <a href="../Namespace/index.html#type-t">Namespace.t</a>;</span></code></li><li id="type-local_model_info.local_model_name" class="def record field anchored"><a href="#type-local_model_info.local_model_name" class="anchor"></a><code><span>local_model_name : string;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>We only store the name of the benchmark and the local name of the model, as it is enough information to retrieve the associated model</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-parameter_info"><a href="#type-parameter_info" class="anchor"></a><code><span><span class="keyword">type</span> parameter_info</span><span> = <span><a href="../Namespace/index.html#type-t">Namespace.t</a> list</span></span></code></div><div class="spec-doc"><p>For each parameter, we register the list of models (by name) in which they occur</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-register"><a href="#val-register" class="anchor"></a><code><span><span class="keyword">val</span> register : <span><span class="optlabel">?add_timer</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="../Benchmark/index.html#type-t">Benchmark.t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Register a benchmark. Recursively registers any relevant model and parameter included in it. Add timer latency to the model if <code>add_timer</code> is <code>true</code> (default). It is expected that <code>add_timer</code> is set to <code>false</code> when registering a benchmark which uses <code>Calculated</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-register_simple"><a href="#val-register_simple" class="anchor"></a><code><span><span class="keyword">val</span> register_simple : <span><span class="optlabel">?add_timer</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="../Benchmark/index.html#type-simple">Benchmark.simple</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Register a <code>Benchmark.Simple</code>. Recursively registers any relevant model and parameter included in it.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-register_simple_with_num"><a href="#val-register_simple_with_num" class="anchor"></a><code><span><span class="keyword">val</span> register_simple_with_num : 
  <span><span class="optlabel">?add_timer</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Benchmark/index.html#type-simple_with_num">Benchmark.simple_with_num</a> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p>Register a <code>Benchmark.Simple_with_num</code>. Recursively registers any relevant model and parameter included in it.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-register_model_for_code_generation"><a href="#val-register_model_for_code_generation" class="anchor"></a><code><span><span class="keyword">val</span> register_model_for_code_generation : 
  <span><span class="optlabel">?destination</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="../Model/index.html#type-t">Model.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>register_model_for_code_generation ?destination s model</code> registers a model <code>model</code> with a local model name <code>s</code> for code generation. Use <code>register</code> if a model is associated with a benchmark.</p><p><code>destination</code> specifies the code generation destination. If <code>destination = &quot;michelson_v1_gas&quot;</code>, the code will be generated to <code>&quot;DIR/michelson_v1_gas_costs_generated.ml&quot;</code> by <code>octez-snoop generate code for solutions SOL --split-to DIR</code> command. The command will not generate the code under <code>DIR</code> if <code>destination</code> is not specified.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-add_command"><a href="#val-add_command" class="anchor"></a><code><span><span class="keyword">val</span> add_command : <span><span>unit <a href="../../../octez-libs/Tezos_clic/index.html#type-command">Tezos_clic.command</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Register a <a href="../../../octez-libs/Tezos_clic/index.html#type-command"><code>Tezos_clic.command</code></a> for the command line</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-all_benchmarks"><a href="#val-all_benchmarks" class="anchor"></a><code><span><span class="keyword">val</span> all_benchmarks : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(<a href="../Namespace/index.html#type-t">Namespace.t</a> * <a href="#type-benchmark_info">benchmark_info</a>)</span> list</span></span></code></div><div class="spec-doc"><p>Returns the list of all registered benchmarks</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-all_models"><a href="#val-all_models" class="anchor"></a><code><span><span class="keyword">val</span> all_models : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(<a href="../Namespace/index.html#type-t">Namespace.t</a> * <a href="#type-model_info">model_info</a>)</span> list</span></span></code></div><div class="spec-doc"><p>Returns the list of all registered models</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-all_parameters"><a href="#val-all_parameters" class="anchor"></a><code><span><span class="keyword">val</span> all_parameters : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(<a href="../Free_variable/index.html#type-t">Free_variable.t</a> * <a href="#type-parameter_info">parameter_info</a>)</span> list</span></span></code></div><div class="spec-doc"><p>Returns the list of all registered parameters</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-all_custom_commands"><a href="#val-all_custom_commands" class="anchor"></a><code><span><span class="keyword">val</span> all_custom_commands : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>unit <a href="../../../octez-libs/Tezos_clic/index.html#type-command">Tezos_clic.command</a></span> list</span></span></code></div><div class="spec-doc"><p>Returns the list of all registered commands</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-all_tags"><a href="#val-all_tags" class="anchor"></a><code><span><span class="keyword">val</span> all_tags : <span>unit <span class="arrow">&#45;&gt;</span></span> <span>string list</span></span></code></div><div class="spec-doc"><p>Returns the list of all the tags from registered benchmarks</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-all_model_names"><a href="#val-all_model_names" class="anchor"></a><code><span><span class="keyword">val</span> all_model_names : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="../Namespace/index.html#type-t">Namespace.t</a> list</span></span></code></div><div class="spec-doc"><p>Returns the list of all the model names Same as <code>all_models () |&gt; List.map fst</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-all_local_model_names"><a href="#val-all_local_model_names" class="anchor"></a><code><span><span class="keyword">val</span> all_local_model_names : <span>unit <span class="arrow">&#45;&gt;</span></span> <span>string list</span></span></code></div><div class="spec-doc"><p>Returns the list of all local model names as they appear in registered benchmarks</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_benchmarks_with_tags"><a href="#val-find_benchmarks_with_tags" class="anchor"></a><code><span><span class="keyword">val</span> find_benchmarks_with_tags : 
  <span><span class="label">mode</span>:<span>[&lt; `All <span>| `Exact</span> <span>| `Any</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../Namespace/index.html#type-t">Namespace.t</a> * <a href="#type-benchmark_info">benchmark_info</a>)</span> list</span></span></code></div><div class="spec-doc"><p><code>find_benchmarks_with_tags ~mode tag_list</code> returns all the benchmarks which tags match the given <code>tag_list</code> with the given mode. <code>`All</code> means all tags in <code>tag_list</code> appear in the tags of the returned benchmarks <code>`Exact</code> means the returned benchmarks' tags match exactly with <code>tag_list</code> <code>`Any</code> means the returned benchmarks have at least one tag also present in <code>tag_list</code></p></div></div><p>The following query functions take a <code>string</code> as input. This <code>string</code> is converted into a <code>Namespace.t</code> with <a href="../Namespace/index.html#val-of_string"><code>Namespace.of_string</code></a>. This conversion is then returned as output. This ensures that the returned <code>Namespace.t</code> values correspond to registered items.</p><div class="odoc-spec"><div class="spec value anchored" id="val-find_benchmark"><a href="#val-find_benchmark" class="anchor"></a><code><span><span class="keyword">val</span> find_benchmark : <span><a href="../Namespace/index.html#type-t">Namespace.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-benchmark_info">benchmark_info</a> option</span></span></code></div><div class="spec-doc"><p><code>find_benchmark s</code> returns <code>Some (name,b)</code> with <code>name = s</code> if the benchmark <code>b</code> is named <code>name</code> and has been registered, else returns <code>None</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_benchmark_exn"><a href="#val-find_benchmark_exn" class="anchor"></a><code><span><span class="keyword">val</span> find_benchmark_exn : <span><a href="../Namespace/index.html#type-t">Namespace.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-benchmark_info">benchmark_info</a></span></code></div><div class="spec-doc"><p><code>find_benchmark_exn s</code> returns <code>(name,b)</code> with <code>name = s</code> if the benchmark <code>b</code> is named <code>name</code> and has been registered, else raises the exception <code>Benchmark_not_founds</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_benchmarks_in_namespace"><a href="#val-find_benchmarks_in_namespace" class="anchor"></a><code><span><span class="keyword">val</span> find_benchmarks_in_namespace : 
  <span><a href="../Namespace/index.html#type-t">Namespace.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../Namespace/index.html#type-t">Namespace.t</a> * <a href="#type-benchmark_info">benchmark_info</a>)</span> list</span></span></code></div><div class="spec-doc"><p><code>find_benchmarks_in_namespace s</code> returns all registered benchmarks which name has <code>s</code> as a parent namespace. For instance, if two benchmarks <code>a/b/bench1</code> and <code>a/b/bench2</code> are registered, then</p><ul><li>if <code>s = a</code> or <code>s = a/b</code>, then the function returns both benchmarks</li><li>if <code>s = a/b/bench</code>, the empty list is returned</li><li>if <code>s = a/b/bench1</code>, then <code>a/b/bench1</code> is returned</li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_model"><a href="#val-find_model" class="anchor"></a><code><span><span class="keyword">val</span> find_model : <span><a href="../Namespace/index.html#type-t">Namespace.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-model_info">model_info</a> option</span></span></code></div><div class="spec-doc"><p><code>find_model s</code> returns <code>Some (name,m)</code> with <code>name = s</code> if the model of <code>m</code> is named <code>name</code> and has been registered, else returns <code>None</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_model_exn"><a href="#val-find_model_exn" class="anchor"></a><code><span><span class="keyword">val</span> find_model_exn : <span><a href="../Namespace/index.html#type-t">Namespace.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-model_info">model_info</a></span></code></div><div class="spec-doc"><p><code>find_model_exn s</code> returns <code>(name,m)</code> with <code>name = s</code> if the model of <code>m</code> is named <code>name</code> and has been registered, else raises the exception <code>Local_model_not_founds</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_local_model"><a href="#val-find_local_model" class="anchor"></a><code><span><span class="keyword">val</span> find_local_model : 
  <span><a href="../../../octez-libs/Tezos_base/TzPervasives/String/index.html#type-t">Tezos_base.TzPervasives.String.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Namespace/index.html#type-t">Namespace.t</a> list</span> option</span></span></code></div><div class="spec-doc"><p><code>find_local_model s</code> returns the list of benchmark names whose local model name is <code>s</code>, if the latter has been registered, else returns <code>None</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_local_model_exn"><a href="#val-find_local_model_exn" class="anchor"></a><code><span><span class="keyword">val</span> find_local_model_exn : <span><a href="../../../octez-libs/Tezos_base/TzPervasives/String/index.html#type-t">Tezos_base.TzPervasives.String.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Namespace/index.html#type-t">Namespace.t</a> list</span></span></code></div><div class="spec-doc"><p><code>find_local_model s</code> returns the list of benchmark names whose local model name is <code>s</code>, if the latter has been registered, else raises the exception <code>Model_not_founds</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_models_in_namespace"><a href="#val-find_models_in_namespace" class="anchor"></a><code><span><span class="keyword">val</span> find_models_in_namespace : <span><a href="../Namespace/index.html#type-t">Namespace.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<a href="../Namespace/index.html#type-t">Namespace.t</a> * <a href="#type-model_info">model_info</a>)</span> list</span></span></code></div><div class="spec-doc"><p><code>find_models_in_namespace s</code> returns all registered models which name has <code>s</code> as a parent namespace.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_parameter"><a href="#val-find_parameter" class="anchor"></a><code><span><span class="keyword">val</span> find_parameter : <span><a href="../Free_variable/index.html#type-t">Free_variable.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-parameter_info">parameter_info</a> option</span></span></code></div><div class="spec-doc"><p><code>find_parameter s</code> returns <code>Some (name,p)</code> if the parameter <code>name = s</code> has been registered, and <code>p</code> is the registered info on <code>s</code>, else returns <code>None</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_parameter_exn"><a href="#val-find_parameter_exn" class="anchor"></a><code><span><span class="keyword">val</span> find_parameter_exn : <span><a href="../Free_variable/index.html#type-t">Free_variable.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-parameter_info">parameter_info</a></span></code></div><div class="spec-doc"><p><code>find_parameter_exn s</code> returns <code>(name,p)</code> if the parameter <code>name = s</code> has been registered, and <code>p</code> is the registered info on <code>s</code>, else raises the exception <code>Parameter_not_founds</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_parameters_in_namespace"><a href="#val-find_parameters_in_namespace" class="anchor"></a><code><span><span class="keyword">val</span> find_parameters_in_namespace : 
  <span><a href="../Namespace/index.html#type-t">Namespace.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../Free_variable/index.html#type-t">Free_variable.t</a> * <a href="#type-parameter_info">parameter_info</a>)</span> list</span></span></code></div><div class="spec-doc"><p><code>find_parameters_in_namespace s</code> returns all registered info for parameters which name has <code>s</code> as a parent namespace.</p></div></div></div></body></html>
