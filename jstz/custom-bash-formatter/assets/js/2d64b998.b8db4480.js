"use strict";(self.webpackChunkjstz_docs=self.webpackChunkjstz_docs||[]).push([[2539],{2327:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"api/smart_function","title":"SmartFunction","description":"The SmartFunction namespace provides an API to create and calljstz smart functions.","source":"@site/api/smart_function.md","sourceDirName":"api","slug":"/api/smart_function","permalink":"/previews/jstz/custom-bash-formatter/api/smart_function","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"SmartFunction","sidebar_label":"SmartFunction"},"sidebar":"documentationSidebar","previous":{"title":"KV","permalink":"/previews/jstz/custom-bash-formatter/api/kv"},"next":{"title":"Ledger","permalink":"/previews/jstz/custom-bash-formatter/api/ledger"}}');var r=n(4848),c=n(3023);const o={title:"SmartFunction",sidebar_label:"SmartFunction"},i=void 0,a={},d=[{value:"Quick Start",id:"quick-start",level:2},{value:"Instance Methods",id:"instance-methods",level:2},{value:"<code>SmartFunction.call(request: Request): Promise&lt;Response&gt;</code>",id:"smartfunctioncallrequest-request-promiseresponse",level:3},{value:"<code>SmartFunction.create(code : string): Promise&lt;Address&gt;</code>",id:"smartfunctioncreatecode--string-promiseaddress",level:3}];function l(e){const t={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"SmartFunction"})," namespace provides an API to create and call",(0,r.jsx)(t.code,{children:"jstz"})," smart functions.\nNew smart functions can be created with the ",(0,r.jsx)(t.code,{children:"SmartFunction.create()"})," method\nand ",(0,r.jsx)(t.code,{children:"SmartFunction.call()"})," is used for calling other smart functions."]}),"\n",(0,r.jsxs)(t.p,{children:["All operations on ",(0,r.jsx)(t.code,{children:"SmartFunction"})," are asynchronous."]}),"\n",(0,r.jsx)(t.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,r.jsxs)(t.p,{children:["We may deploy a new smart function programmatically by calling ",(0,r.jsx)(t.code,{children:"SmartFunction.create()"})," with a single ",(0,r.jsx)(t.code,{children:"string"})," argument.\nThe smart function code must be valid ECMAScript. TypeScript is not supported when deploying functions using\n",(0,r.jsx)(t.code,{children:"SmartFunction.create"}),"."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:'const newSmartFunction = SmartFunction.create(\n  "export default handler () => new Response()",\n);\n'})}),"\n",(0,r.jsxs)(t.p,{children:["This will deploy a new smart function with the code ",(0,r.jsx)(t.code,{children:"export default handler () => new Response()"}),",\nreturning a ",(0,r.jsx)(t.em,{children:"promise"})," which will resolve to the address of the new function."]}),"\n",(0,r.jsxs)(t.p,{children:["Once a smart function is deployed we may call it from another smart function using the\n",(0,r.jsx)(t.code,{children:"SmartFunction.call()"})," method. To call a smart function we create a new ",(0,r.jsx)(t.a,{href:"/previews/jstz/custom-bash-formatter/api/request",children:"Request"})," object with\nscheme ",(0,r.jsx)(t.code,{children:"tezos"})," and the address as the hostname."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:'async function handler(_: Request): Promise<Response> {\n  const newAddress = await SmartFunction.create(\n    "export default handler () => new Response()",\n  );\n  return SmartFunction.call(new Request(`jstz://${newAddress}`));\n}\n'})}),"\n",(0,r.jsx)(t.h2,{id:"instance-methods",children:"Instance Methods"}),"\n",(0,r.jsx)(t.h3,{id:"smartfunctioncallrequest-request-promiseresponse",children:(0,r.jsx)(t.code,{children:"SmartFunction.call(request: Request): Promise<Response>"})}),"\n",(0,r.jsxs)(t.p,{children:["Calls a ",(0,r.jsx)(t.code,{children:"jstz"})," smart function with the given request, returning a promise that resolves to an\nHTTP ",(0,r.jsx)(t.a,{href:"/previews/jstz/custom-bash-formatter/api/response",children:(0,r.jsx)(t.code,{children:"Response"})})," object."]}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"request"})," parameter is a HTTP ",(0,r.jsx)(t.a,{href:"/previews/jstz/custom-bash-formatter/api/request",children:(0,r.jsx)(t.code,{children:"Request"})})," object.\nThe URL scheme ",(0,r.jsx)(t.em,{children:"must"})," be ",(0,r.jsx)(t.code,{children:"tezos"})," and the host ",(0,r.jsx)(t.em,{children:"must"})," be the address of a deployed ",(0,r.jsx)(t.code,{children:"jstz"})," smart function.\nThe ",(0,r.jsx)(t.code,{children:"Referer"})," header ",(0,r.jsx)(t.em,{children:"must"})," not be set."]}),"\n",(0,r.jsx)(t.h3,{id:"smartfunctioncreatecode--string-promiseaddress",children:(0,r.jsx)(t.code,{children:"SmartFunction.create(code : string): Promise<Address>"})}),"\n",(0,r.jsxs)(t.p,{children:["Creates and deploys a new ",(0,r.jsx)(t.code,{children:"jstz"})," smart function with the given code, returning a promise that resolves to the address of the newly deployed smart function."]}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"code"})," must be a ",(0,r.jsx)(t.code,{children:"string"})," containing an ECMAscript module.\nThe module ",(0,r.jsx)(t.em,{children:"must"})," define a default export of type ",(0,r.jsx)(t.code,{children:"(request: Request) => Response | Promise<Response>"}),"."]})]})}function u(e={}){const{wrapper:t}={...(0,c.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},3023:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>i});var s=n(6540);const r={},c=s.createContext(r);function o(e){const t=s.useContext(c);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(c.Provider,{value:t},e.children)}}}]);