"use strict";(self.webpackChunkjstz_docs=self.webpackChunkjstz_docs||[]).push([[686],{3023:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>o});var s=n(6540);const a={},i=s.createContext(a);function r(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(i.Provider,{value:t},e.children)}},5622:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"api/kv","title":"\ud83e\udea3 KV","description":"As described in Storing data, Jstz smart functions store data in a persistent key-value database.","source":"@site/api/kv.md","sourceDirName":"api","slug":"/api/kv","permalink":"/previews/jstz/docusaurus/api/kv","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"\ud83e\udea3 KV","sidebar_label":"KV"},"sidebar":"documentationSidebar","previous":{"title":"Console","permalink":"/previews/jstz/docusaurus/api/console"},"next":{"title":"SmartFunction","permalink":"/previews/jstz/docusaurus/api/smart_function"}}');var a=n(4848),i=n(3023);const r={title:"\ud83e\udea3 KV",sidebar_label:"KV"},o=void 0,d={},c=[{value:"Instance Methods",id:"instance-methods",level:2},{value:"<code>Kv.set(key: string, value: unknown): void</code>",id:"kvsetkey-string-value-unknown-void",level:3},{value:"<code>Kv.get&lt;T = unknown&gt;(key: string): T | null</code>",id:"kvgett--unknownkey-string-t--null",level:3},{value:"<code>Kv.delete(key: string): void</code>",id:"kvdeletekey-string-void",level:3},{value:"<code>Kv.has(key: string): boolean</code>",id:"kvhaskey-string-boolean",level:3}];function l(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(t.p,{children:["As described in ",(0,a.jsx)(t.a,{href:"/functions/data_storage",children:"Storing data"}),", Jstz smart functions store data in a persistent key-value database.\nThis database is built directly into the Jstz runtime, available using the global ",(0,a.jsx)(t.code,{children:"Kv"})," object.\nSmart functions can read only their own data, not the data of other smart functions.\nTherefore, it is not necessary to worry about name collisions for keys with other smart functions.\nOther clients can read the data, but only a smart function can write to the keys it puts in the database."]}),"\n",(0,a.jsx)(t.p,{children:"Data is stored as a persistent collection of key-value pairs, much like the properties of a JavaScript object or a Map object.\nThe keys are strings and the values are serializable JavaScript objects.\nKeys are unique within the database, and the last value to be set is the one that is returned when next reading the key."}),"\n",(0,a.jsxs)(t.p,{children:["As described in ",(0,a.jsx)(t.a,{href:"/functions/data_storage#errors",children:"Errors"})," operations on the database are synchronous and atomic, committed only if the request to the smart function succeeds.\nIf a smart function writes to storage and throws an uncaught error later in the same transaction, the changes to the database are reversed and the storage is set to what it was before the request that failed."]}),"\n",(0,a.jsxs)(t.p,{children:["To create a key-value pair and store data, pass the key and the value to the ",(0,a.jsx)(t.code,{children:"Kv.set"})," function, as in this example:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-typescript",children:'Kv.set("foo", { bar: "baz" });\n'})}),"\n",(0,a.jsxs)(t.p,{children:["To read it, pass the key to the ",(0,a.jsx)(t.code,{children:"Kv.get()"})," function:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-typescript",children:'const data = Kv.get("foo");\nconsole.log(JSON.stringify(data)); // { "bar": "baz" }\n'})}),"\n",(0,a.jsxs)(t.p,{children:["You can also delete a key-value pair using ",(0,a.jsx)(t.code,{children:"Kv.delete()"}),"."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-typescript",children:'Kv.delete("foo");\n'})}),"\n",(0,a.jsxs)(t.p,{children:["For more examples, see ",(0,a.jsx)(t.a,{href:"/functions/data_storage",children:"Storing data"}),"."]}),"\n",(0,a.jsx)(t.h2,{id:"instance-methods",children:"Instance Methods"}),"\n",(0,a.jsx)(t.h3,{id:"kvsetkey-string-value-unknown-void",children:(0,a.jsx)(t.code,{children:"Kv.set(key: string, value: unknown): void"})}),"\n",(0,a.jsx)(t.p,{children:"Set the value for the given key in the database. If a value already exists for the key, it will be overwritten."}),"\n",(0,a.jsx)(t.h3,{id:"kvgett--unknownkey-string-t--null",children:(0,a.jsx)(t.code,{children:"Kv.get<T = unknown>(key: string): T | null"})}),"\n",(0,a.jsxs)(t.p,{children:["Retrieve the value for the given key from the database. If no value exists for the key, this function returns ",(0,a.jsx)(t.code,{children:"null"}),"."]}),"\n",(0,a.jsx)(t.h3,{id:"kvdeletekey-string-void",children:(0,a.jsx)(t.code,{children:"Kv.delete(key: string): void"})}),"\n",(0,a.jsx)(t.p,{children:"Deletes the value for the given key from the database. If no value exists for the key, this function is a no-op."}),"\n",(0,a.jsx)(t.h3,{id:"kvhaskey-string-boolean",children:(0,a.jsx)(t.code,{children:"Kv.has(key: string): boolean"})}),"\n",(0,a.jsxs)(t.p,{children:["Returns ",(0,a.jsx)(t.code,{children:"true"})," if a value exists for the given key in the database, ",(0,a.jsx)(t.code,{children:"false"})," otherwise."]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}}}]);