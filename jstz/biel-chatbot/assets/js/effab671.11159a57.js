"use strict";(self.webpackChunkjstz_docs=self.webpackChunkjstz_docs||[]).push([[213],{3023:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>c});var i=t(6540);const s={},r=i.createContext(s);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}},6347:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"functions/building","title":"Building smart functions","description":"Smart functions are written and run in ordinary TypeScript, but you must still build them with the Jstz dependencies before deploying them.","source":"@site/functions/building.md","sourceDirName":"functions","slug":"/functions/building","permalink":"/previews/jstz/biel-chatbot/functions/building","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Building smart functions","sidebar_label":"Building"},"sidebar":"documentationSidebar","previous":{"title":"Smart functions","permalink":"/previews/jstz/biel-chatbot/functions/overview"},"next":{"title":"Deploying","permalink":"/previews/jstz/biel-chatbot/functions/deploying"}}');var s=t(4848),r=t(3023);const o={title:"Building smart functions",sidebar_label:"Building"},c=void 0,d={},l=[];function a(e){const n={a:"a",code:"code",li:"li",ol:"ol",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"Smart functions are written and run in ordinary TypeScript, but you must still build them with the Jstz dependencies before deploying them."}),"\n",(0,s.jsxs)(n.p,{children:["For examples of smart function projects, see the examples folder: ",(0,s.jsx)(n.a,{href:"https://github.com/jstz-dev/jstz/tree/main/examples",children:"https://github.com/jstz-dev/jstz/tree/main/examples"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Follow these steps to create and build a TypeScript project for your smart function:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Create a ",(0,s.jsx)(n.code,{children:"package.json"})," file appropriate for a TypeScript project.\nYou can use the ",(0,s.jsx)(n.code,{children:"npm init"})," command, the ",(0,s.jsx)(n.code,{children:"yarn init"})," command, or create a ",(0,s.jsx)(n.code,{children:"package.json"})," file manually to describe the project."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Add the ",(0,s.jsx)(n.code,{children:"@jstz-dev/jstz"})," dependency and ",(0,s.jsx)(n.code,{children:"esbuild"})," build dependencies."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Add a build script that looks like this, with the name of your smart function source file in place of the variable ",(0,s.jsx)(n.code,{children:"<SOURCE_FILE>"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"esbuild <SOURCE_FILE> --bundle --format=esm --target=esnext --minify --outfile=dist/index.js\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Here is an example of a ",(0,s.jsx)(n.code,{children:"package.json"})," file for a smart function project:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "name": "my-smart-function",\n  "authors": "",\n  "version": "0.0.0",\n  "main": "index.ts",\n  "dependencies": {\n    "@jstz-dev/jstz": "^0.0.0"\n  },\n  "devDependencies": {\n    "esbuild": "^0.20.2"\n  },\n  "scripts": {\n    "build": "esbuild index.ts --bundle --format=esm --target=esnext --minify --outfile=dist/index.js"\n  }\n}\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Add a ",(0,s.jsx)(n.code,{children:"tsconfig.json"})," file to specify how TypeScript builds the file, including accessing types for Jstz code, as in this example:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "compilerOptions": {\n    "lib": ["esnext"],\n    "module": "esnext",\n    "target": "esnext",\n    "strict": true,\n    "moduleResolution": "node",\n    "types": ["@jstz-dev/types"]\n  },\n  "exclude": ["node_modules"]\n}\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Install the dependencies by running ",(0,s.jsx)(n.code,{children:"npm install"})," or ",(0,s.jsx)(n.code,{children:"yarn install"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Add the code of your smart function to a TypeScript file in the project and make sure that the ",(0,s.jsx)(n.code,{children:"build"})," script builds it.\nFor example, you can use the example smart function in ",(0,s.jsx)(n.a,{href:"/functions/overview",children:"Smart functions"})," or any of the smart functions in the ",(0,s.jsx)(n.a,{href:"https://github.com/jstz-dev/jstz/tree/main/examples",children:"examples folder"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Build the smart function with the ",(0,s.jsx)(n.code,{children:"build"})," script, either by running ",(0,s.jsx)(n.code,{children:"npm run build"})," or ",(0,s.jsx)(n.code,{children:"yarn build"}),".\nJstz builds the smart function with the necessary dependencies and writes the output to ",(0,s.jsx)(n.code,{children:"dist/index.ts"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Now you can deploy the smart function to the local sandbox.\nSee ",(0,s.jsx)(n.a,{href:"/functions/deploying",children:"Deploying"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"::: tip"}),"\n",(0,s.jsxs)(n.p,{children:["You can verify the size of the built smart function with the ",(0,s.jsx)(n.code,{children:"du"})," command, as in ",(0,s.jsx)(n.code,{children:"du -bh dist/index.ts"}),".\nSmart functions must be less than 10MB to be deployed."]}),"\n",(0,s.jsx)(n.p,{children:":::"})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}}}]);