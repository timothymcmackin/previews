"use strict";(self.webpackChunktezos_developer_docs=self.webpackChunktezos_developer_docs||[]).push([[7746],{56455:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"smart-contracts/entrypoints","title":"Entrypoints","description":"The entrypoints of a contract represent the different ways that it can be called, similar to a method or function in many programming languages or an endpoint of an API.","source":"@site/docs/smart-contracts/entrypoints.md","sourceDirName":"smart-contracts","slug":"/smart-contracts/entrypoints","permalink":"/previews/docs/ledger/smart-contracts/entrypoints","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1704862800000,"frontMatter":{"title":"Entrypoints","authors":"Mathias Hiron (Nomadic Labs), Sasha Aldrick (TriliTech), Tim McMackin (TriliTech)","last_update":{"date":"10 January 2024"}},"sidebar":"documentationSidebar","previous":{"title":"Deploying smart contracts","permalink":"/previews/docs/ledger/smart-contracts/deploying"},"next":{"title":"Storage","permalink":"/previews/docs/ledger/smart-contracts/storage"}}');var s=n(74848),a=n(28453);const o={title:"Entrypoints",authors:"Mathias Hiron (Nomadic Labs), Sasha Aldrick (TriliTech), Tim McMackin (TriliTech)",last_update:{date:"10 January 2024"}},i=void 0,c={},l=[{value:"Entrypoint logic",id:"entrypoint-logic",level:2},{value:"Example entrypoints",id:"example-entrypoints",level:2},{value:"Implementation details: the default entrypoint",id:"implementation-details-the-default-entrypoint",level:2}];function d(e){const t={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"The entrypoints of a contract represent the different ways that it can be called, similar to a method or function in many programming languages or an endpoint of an API.\nThe entrypoints in a Tezos smart contract must meet these specifications:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Contracts must have at least one entrypoint."}),"\n",(0,s.jsx)(t.li,{children:"Each entrypoint must have a name."}),"\n",(0,s.jsx)(t.li,{children:"Entrypoints may accept parameters, which can be of almost any data type that Tezos supports."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Unlike functions and API endpoints, entrypoints do not return a value directly to the caller.\nTo return data from a smart contract, you can use one of these methods:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Use ",(0,s.jsx)(t.a,{href:"/smart-contracts/views",children:"Views"})," to return data to smart contracts or off-chain applications"]}),"\n",(0,s.jsxs)(t.li,{children:["Use ",(0,s.jsx)(t.a,{href:"/smart-contracts/events",children:"Events"})," to return data to off-chain applications"]}),"\n",(0,s.jsxs)(t.li,{children:["Include a callback parameter that sends information to another smart contract, as in the ",(0,s.jsx)(t.code,{children:"getAllowance"}),", ",(0,s.jsx)(t.code,{children:"getBalance"}),", and ",(0,s.jsx)(t.code,{children:"getTotalSupply"})," entrypoints of ",(0,s.jsx)(t.a,{href:"/architecture/tokens/FA1.2",children:"FA1.2"})," contracts"]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["For an example of a simple contract, see the tutorial ",(0,s.jsx)(t.a,{href:"/tutorials/smart-contract",children:"Create a smart contract"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["For examples of more complex contracts, see ",(0,s.jsx)(t.a,{href:"https://opentezos.com/smart-contracts/simplified-contracts/",children:"Examples of contracts"})," on opentezos.com."]}),"\n",(0,s.jsx)(t.h2,{id:"entrypoint-logic",children:"Entrypoint logic"}),"\n",(0,s.jsx)(t.p,{children:"An entrypoint may run logic based on:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"The contract storage"}),"\n",(0,s.jsx)(t.li,{children:"The parameters that senders pass"}),"\n",(0,s.jsx)(t.li,{children:"Transaction context values such as the address of the caller"}),"\n",(0,s.jsx)(t.li,{children:"The table of constants"}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["Entrypoints cannot access information outside of Tezos, such as calling external APIs.\nIf an entrypoint needs information from outside Tezos it must use oracles; see ",(0,s.jsx)(t.a,{href:"/smart-contracts/oracles",children:"Oracles"})," and ",(0,s.jsx)(t.a,{href:"https://opentezos.com/smart-contracts/oracles/",children:"Using and trusting Oracles"})," on opentezos.com."]}),"\n",(0,s.jsx)(t.p,{children:"The only effects that an entrypoint can have are changes to its storage and new operations that are run after the entrypoint completes.\nAn entrypoint can call other entrypoints in its contract or entrypoints in other contracts."}),"\n",(0,s.jsx)(t.h2,{id:"example-entrypoints",children:"Example entrypoints"}),"\n",(0,s.jsxs)(t.p,{children:["The contract in the tutorial ",(0,s.jsx)(t.a,{href:"/tutorials/smart-contract",children:"Create a smart contract"})," has three entrypoints:"]}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Entrypoint"}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"increment"})}),(0,s.jsxs)(t.td,{children:[(0,s.jsx)(t.code,{children:"increment"})," takes an ",(0,s.jsx)(t.code,{children:"int"})," as a parameter and adds it to the previous value of the storage"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"decrement"})}),(0,s.jsxs)(t.td,{children:[(0,s.jsx)(t.code,{children:"decrement"})," takes an ",(0,s.jsx)(t.code,{children:"int"})," as a parameter and subtracts it from the previous value of the storage"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"reset"})}),(0,s.jsxs)(t.td,{children:[(0,s.jsx)(t.code,{children:"reset"}),' takes "Unit" (no value) as a parameter and sets the storage to 0']})]})]})]}),"\n",(0,s.jsx)(t.h2,{id:"implementation-details-the-default-entrypoint",children:"Implementation details: the default entrypoint"}),"\n",(0,s.jsx)(t.p,{children:"Even though your higher-level code may have separate codeblocks for each entrypoint, the compiled Michelson code uses a single codeblock with a single entrypoint, known as the default entrypoint.\nThis default entrypoint uses the parameter that clients pass to decide which code to run."}),"\n",(0,s.jsx)(t.p,{children:"In most cases, developers can ignore the default entrypoint and imagine that the compiled Michelson code has multiple entrypoints like the higher-level code.\nHowever, in some cases, you may need to consider how the contract actually decides which code to run and how clients trigger this code."}),"\n",(0,s.jsxs)(t.p,{children:["For example, when you compile the contract in the tutorial ",(0,s.jsx)(t.a,{href:"/tutorials/smart-contract",children:"Create a smart contract"})," to Michelson, its first line defines the parameter type that the contract accepts:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"parameter (or (unit %reset) (or (int %decrement) (int %increment)))\n"})}),"\n",(0,s.jsxs)(t.p,{children:["To call the ",(0,s.jsx)(t.code,{children:"reset"})," entrypoint, clients technically call the default entrypoint and pass the Michelson-encoded parameter ",(0,s.jsx)(t.code,{children:"Left Unit"}),".\nThis parameter value means that the left value of the parameter type, which is annotated ",(0,s.jsx)(t.code,{children:"%reset"}),", is set to the value ",(0,s.jsx)(t.code,{children:"Unit"}),", which means no value.\nIn its logic, the compiled Michelson code uses the ",(0,s.jsx)(t.code,{children:"IF_LEFT"})," command to check if the left value of the parameter is defined and if so, it runs the ",(0,s.jsx)(t.code,{children:"reset"})," entrypoint code."]}),"\n",(0,s.jsxs)(t.p,{children:["In this way, the following Octez client commands are equivalent; one passes ",(0,s.jsx)(t.code,{children:"Unit"})," to the ",(0,s.jsx)(t.code,{children:"reset"})," entrypoint and the other passes ",(0,s.jsx)(t.code,{children:"Left Unit"})," to the default entrypoint:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"octez-client --wait none transfer 0 from myAccount to myContract \\\n  --entrypoint 'reset' --arg 'Unit' --burn-cap 0.1\n"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"octez-client --wait none transfer 0 from myAccount to myContract \\\n  --arg 'Left Unit' --burn-cap 0.1\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Developers need to know about the default entrypoint only when they encode parameters for smart contracts manually.\nMost Tezos clients, including Octez and Taquito, encode parameters automatically.\nWorking from the previous example, they convert a call to the ",(0,s.jsx)(t.code,{children:"increment"})," entrypoint with the parameter 5 as a call to the default entrypoint with the parameter ",(0,s.jsx)(t.code,{children:"Right (Right 5)"}),"."]}),"\n",(0,s.jsx)(t.p,{children:"Different languages have different ways of indicating entrypoints.\nFor information about coding entrypoints in specific languages, see these links:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Michelson: ",(0,s.jsx)(t.a,{href:"https://tezos.gitlab.io/active/michelson.html#entrypoints",children:"Entrypoint"})]}),"\n",(0,s.jsxs)(t.li,{children:["Archetype: ",(0,s.jsx)(t.a,{href:"https://archetype-lang.org/docs/reference/declarations/entrypoint",children:"Entrypoint"})]}),"\n",(0,s.jsxs)(t.li,{children:["SmartPy: ",(0,s.jsx)(t.a,{href:"https://smartpy.io/manual/syntax/overview?#contracts",children:"Contracts"})]}),"\n",(0,s.jsxs)(t.li,{children:["LIGO: ",(0,s.jsx)(t.a,{href:"https://ligolang.org/docs/advanced/entrypoints-contracts",children:"Main function and Entrypoints"})]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>i});var r=n(96540);const s={},a=r.createContext(s);function o(e){const t=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);