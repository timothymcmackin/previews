"use strict";(self.webpackChunktezos_developer_docs=self.webpackChunktezos_developer_docs||[]).push([[389],{94743:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"smart-contracts/sapling","title":"Private transactions (Sapling)","description":"Sapling is a protocol that enables transactions of fungible tokens while increasing privacy.","source":"@site/docs/smart-contracts/sapling.md","sourceDirName":"smart-contracts","slug":"/smart-contracts/sapling","permalink":"/previews/docs/ledger/smart-contracts/sapling","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1696392000000,"frontMatter":{"title":"Private transactions (Sapling)","authors":"Mathias Hiron (Nomadic Labs), Sasha Aldrick (TriliTech), Tim McMackin (TriliTech)","last_update":{"date":"4 October 2023"}},"sidebar":"documentationSidebar","previous":{"title":"Serialization","permalink":"/previews/docs/ledger/smart-contracts/serialization"},"next":{"title":"Views","permalink":"/previews/docs/ledger/smart-contracts/views"}}');var i=t(74848),a=t(28453);const r={title:"Private transactions (Sapling)",authors:"Mathias Hiron (Nomadic Labs), Sasha Aldrick (TriliTech), Tim McMackin (TriliTech)",last_update:{date:"4 October 2023"}},o=void 0,c={},l=[{value:"Implementation information",id:"implementation-information",level:2}];function h(e){const n={a:"a",em:"em",h2:"h2",li:"li",ol:"ol",p:"p",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Sapling is a protocol that enables transactions of fungible tokens while increasing privacy.\nIt hides transactions from the public, but allows specific entities to view them to comply with regulations."}),"\n",(0,i.jsx)(n.p,{children:"The key steps are as follows:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["A ",(0,i.jsx)(n.em,{children:"shielded pool"})," is created within a contract which a number of users can call to perform transactions whilst keeping details private."]}),"\n",(0,i.jsxs)(n.li,{children:["The users send tokens to this shielded pool, which is called ",(0,i.jsx)(n.em,{children:"shielding tokens"}),".\nInformation about these transactions is public."]}),"\n",(0,i.jsxs)(n.li,{children:["Users perform ",(0,i.jsx)(n.em,{children:"shielded transactions"}),", in such a way that the amount, sender of receiver of each transactions are not revealed publicly.\nOnly the origin and destination of each transaction have access to the transaction information."]}),"\n",(0,i.jsxs)(n.li,{children:["Later, users may get some or all of their tokens out of the pool by ",(0,i.jsx)(n.em,{children:"unshielding their tokens"}),".\nInformation about these transactions is public."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["If a regulator needs access to the transactions of a user, this user may share a ",(0,i.jsx)(n.em,{children:"viewing key"}),", which gives access to all the transactions made by this user."]}),"\n",(0,i.jsxs)(n.p,{children:["Note that using the Sapling protocol in a ",(0,i.jsx)(n.em,{children:"shielded pool"})," and expecting a high degree of privacy requires taking a number of precautions, including:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Making sure there are enough members in the pool to ensure anonymity.\nFor example, if there are only two members, it becomes very easy to identify the source and destination of transactions."}),"\n",(0,i.jsx)(n.li,{children:"Adding dummy transactions, or dummy inputs and outputs of transactions, to hide the actual number of parties involved in each transaction."}),"\n",(0,i.jsx)(n.li,{children:"Making sure to use shielded tokens in multiple transactions.\nFor example, if a user shields exactly 16.32 tokens and another user later unshields exactly 16.32 tokens, the transaction may be traceable."}),"\n",(0,i.jsx)(n.li,{children:"Being careful about information that can be deduced from the timing of transactions."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:'The internals of Sapling are quite technical.\nThe system is based on an UTXO (bitcoin-like) transaction system, where each transaction consumes some unspent output and produces new unspent outputs.\nIt uses a system of cryptographic commitments in place of public amounts and addresses, that can then be "consumed" using a system of nullifiers.\nThe process uses a mix of cryptographic tools including SNARKs, incremental Merkle trees, and Diffie-Hellman key exchanges.'}),"\n",(0,i.jsx)(n.h2,{id:"implementation-information",children:"Implementation information"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Michelson: ",(0,i.jsx)(n.a,{href:"https://tezos.gitlab.io/active/sapling.html",children:"Sapling integration"})]}),"\n",(0,i.jsxs)(n.li,{children:["Archetype: ",(0,i.jsx)(n.a,{href:"https://archetype-lang.org/docs/language-basics/crypto#sapling",children:"Sapling"})]}),"\n",(0,i.jsxs)(n.li,{children:["LIGO: ",(0,i.jsx)(n.a,{href:"https://ligolang.org/docs/reference/current-reference#sapling",children:"Sapling"})]}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>o});var s=t(96540);const i={},a=s.createContext(i);function r(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);