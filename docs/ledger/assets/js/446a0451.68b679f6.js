"use strict";(self.webpackChunktezos_developer_docs=self.webpackChunktezos_developer_docs||[]).push([[2434],{82531:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"tutorials/smart-rollup/run","title":"Part 5: Running and interacting with the rollup node","description":"Now that the Smart Rollup is originated on layer 1, anyone can run a Smart Rollup node for it.","source":"@site/docs/tutorials/smart-rollup/run.md","sourceDirName":"tutorials/smart-rollup","slug":"/tutorials/smart-rollup/run","permalink":"/previews/docs/ledger/tutorials/smart-rollup/run","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1722484800000,"frontMatter":{"title":"Part 5: Running and interacting with the rollup node","last_update":{"date":"1 August 2024"}},"sidebar":"tutorialsSidebar","previous":{"title":"Part 4: Deploying (originating) the rollup","permalink":"/previews/docs/ledger/tutorials/smart-rollup/deploy"},"next":{"title":"Build an NFT marketplace","permalink":"/previews/docs/ledger/tutorials/build-an-nft-marketplace"}}');var l=t(74848),s=t(28453);const o={title:"Part 5: Running and interacting with the rollup node",last_update:{date:"1 August 2024"}},i=void 0,a={},d=[{value:"Running a Smart Rollup node",id:"running-a-smart-rollup-node",level:2},{value:"Interacting with the rollup node",id:"interacting-with-the-rollup-node",level:2},{value:"Next steps",id:"next-steps",level:2},{value:"References",id:"references",level:2}];function c(e){const n={a:"a",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.p,{children:"Now that the Smart Rollup is originated on layer 1, anyone can run a Smart Rollup node for it.\nSmart Rollup nodes are similar to baking nodes, but they run the Smart Rollup kernel instead of baking Tezos blocks.\nIn these steps, you start a Smart Rollup node, but note that anyone can run a node based on your kernel, including people who want to verify the rollup's behavior."}),"\n",(0,l.jsx)(n.h2,{id:"running-a-smart-rollup-node",children:"Running a Smart Rollup node"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:["Copy the contents of the ",(0,l.jsx)(n.code,{children:"preimages"})," folder to a folder that the rollup node can access by running these commands:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"mkdir -p ~/.tezos-rollup-node/wasm_2_0_0\n\ncp preimages/* ~/.tezos-rollup-node/wasm_2_0_0/\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"In the second terminal window, in the Docker container, start the rollup node:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'octez-smart-rollup-node run operator for "test_smart_rollup" \\\n    with operators "bootstrap2" --data-dir ~/.tezos-rollup-node/ \\\n    --log-kernel-debug --log-kernel-debug-file hello_kernel.debug\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Now the node is running and writing to the log file ",(0,l.jsx)(n.code,{children:"hello_kernel.debug"}),".\nLeave this command running in the terminal window just like you left the first terminal window running the Tezos sandbox."]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"interacting-with-the-rollup-node",children:"Interacting with the rollup node"}),"\n",(0,l.jsx)(n.p,{children:"Now you can add messages to the inbox and see the rollup node receive and respond to them."}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Open a third terminal window and enter the Docker container again:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"docker exec -it octez-container /bin/sh\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:["In the container, go to the ",(0,l.jsx)(n.code,{children:"hello_world_kernel"})," folder."]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Print the contents of the log file:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"tail -f hello_kernel.debug\n"})}),"\n",(0,l.jsx)(n.p,{children:"Now, each time a block is baked, the Smart Rollup node prints the contents of the messages in the Smart Rollup inbox, as in this example:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:'# Hello, kernel!\n# Got message: Internal(StartOfLevel)\n# Got message: Internal(InfoPerLevel(InfoPerLevel { predecessor_timestamp: 2023-06-07T15:31:09Z, predecessor: BlockHash("BLQucC2rFyNhoeW4tuh1zS1g6H6ukzs2DQDUYArWNALGr6g2Jdq") }))\n# Got message: Internal(EndOfLevel)\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Stop the command by pressing Ctrl + C."}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Run this command to watch for external messages to the rollup:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"tail -f hello_kernel.debug | grep External\n"})}),"\n",(0,l.jsx)(n.p,{children:"No output appears at first because the rollup has not received any messages aside from the internal messages that indicate the beginning and end of the inbox."}),"\n",(0,l.jsx)(n.p,{children:"Leave this command running."}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:["Open a fourth terminal window, enter the Docker container with the command ",(0,l.jsx)(n.code,{children:"docker exec -it octez-container /bin/sh"}),", and go to the ",(0,l.jsx)(n.code,{children:"hello_world_kernel"})," folder."]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"In this fourth terminal window, run this command to simulate adding a message to the Smart Rollup inbox:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'octez-client send smart rollup message \'[ "test" ]\' from "bootstrap3"\n'})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Go back to the third terminal window."}),"\n",(0,l.jsx)(n.p,{children:'This window shows the message that you sent in the fourth window, which it received in binary format, with the numbers representing the letters in "test."'}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"Got message: External([116, 101, 115, 116])\n"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Now you can send messages to this rollup via Tezos layer 1 and act on them in the rollup code."}),"\n",(0,l.jsx)(n.h2,{id:"next-steps",children:"Next steps"}),"\n",(0,l.jsxs)(n.p,{children:["To continue your work with Smart Rollups, you can you can explore examples from the ",(0,l.jsx)(n.a,{href:"https://gitlab.com/tezos/kernel-gallery/-/tree/main/",children:"kernel gallery"})," or create your own."]}),"\n",(0,l.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://tezos.gitlab.io/alpha/smart_rollups.html",children:"Smart Rollup documentation"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://gitlab.com/tezos/tezos/-/tree/master/src/kernel_sdk",children:"Smart Rollup kernel SDK"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://gitlab.com/tezos/kernel-gallery/-/tree/main/",children:"Smart Rollup kernel examples"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://airtable.com/shrvwpb63rhHMiDg9/tbl2GNV1AZL4dkGgq",children:"Tezos Smart Rollups resources"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://teztnets.com/",children:"Tezos testnets"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://tezos.stackexchange.com/questions/4784/how-to-originating-a-smart-rollup-with-an-installer-kernel/5794#5794",children:"Originating the installer kernel"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://docs.docker.com/get-started/",children:"Docker documentation"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>i});var r=t(96540);const l={},s=r.createContext(l);function o(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:o(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);