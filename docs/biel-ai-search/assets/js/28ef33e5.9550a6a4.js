"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2372],{6789:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>r});const s=JSON.parse('{"id":"tutorials/build-your-first-app/wallets-tokens","title":"Part 2: Accessing wallets","description":"Accessing the user\'s wallet is a prerequisite for interacting with the Tezos blockchain.","source":"@site/docs/tutorials/build-your-first-app/wallets-tokens.md","sourceDirName":"tutorials/build-your-first-app","slug":"/tutorials/build-your-first-app/wallets-tokens","permalink":"/previews/docs/biel-ai-search/tutorials/build-your-first-app/wallets-tokens","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1700024400000,"frontMatter":{"title":"Part 2: Accessing wallets","authors":"Claude Barde, Tim McMackin","last_update":{"date":"15 November 2023"}},"sidebar":"tutorialsSidebar","previous":{"title":"Part 1: Setting up the application","permalink":"/previews/docs/biel-ai-search/tutorials/build-your-first-app/setting-up-app"},"next":{"title":"Part 3: Sending transactions","permalink":"/previews/docs/biel-ai-search/tutorials/build-your-first-app/sending-transactions"}}');var a=n(74848),o=n(28453);const i={title:"Part 2: Accessing wallets",authors:"Claude Barde, Tim McMackin",last_update:{date:"15 November 2023"}},l=void 0,c={},r=[{value:"Creating and funding a wallet",id:"creating-and-funding-a-wallet",level:2},{value:"Connecting to the user&#39;s wallet",id:"connecting-to-the-users-wallet",level:2},{value:"Using the application",id:"using-the-application",level:2},{value:"Design considerations",id:"design-considerations",level:2}];function h(e){const t={a:"a",code:"code",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.p,{children:"Accessing the user's wallet is a prerequisite for interacting with the Tezos blockchain.\nAccessing the wallet allows your app to see the tokens in it and to prompt the user to submit transactions, but it does not give your app direct control over the wallet.\nUsers must still confirm all transactions in their wallet application."}),"\n",(0,a.jsx)(t.p,{children:"Using a wallet application in this way saves you from having to implement payment processing and security in your application.\nAs you see in this section, it takes only a few lines of code to connect to a user's wallet."}),"\n",(0,a.jsx)(t.h2,{id:"creating-and-funding-a-wallet",children:"Creating and funding a wallet"}),"\n",(0,a.jsx)(t.p,{children:"To use the application, you need a wallet and some tez tokens."}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Install a Tezos-compatible wallet.\nWhich wallet you install is up to you and whether you want to install a wallet on your computer, in a browser extension, or as a mobile app."}),"\n",(0,a.jsxs)(t.p,{children:["If you don't know which one to choose, try the ",(0,a.jsx)(t.a,{href:"https://templewallet.com/",children:"Temple"})," browser extension, because then you can use it in the same browser that you are using to view the web app."]}),"\n",(0,a.jsxs)(t.p,{children:["Desktop wallets for Tezos include the ",(0,a.jsx)(t.a,{href:"https://templewallet.com/",children:"Temple"})," browser extension, ",(0,a.jsx)(t.a,{href:"https://wallet.kukai.app/",children:"Kukai"}),", and ",(0,a.jsx)(t.a,{href:"https://umamiwallet.com/",children:"Umami"}),"."]}),"\n",(0,a.jsxs)(t.p,{children:["Mobile apps include ",(0,a.jsx)(t.a,{href:"https://templewallet.com/",children:"Temple"}),", ",(0,a.jsx)(t.a,{href:"https://wallet.kukai.app/",children:"Kukai"}),", and ",(0,a.jsx)(t.a,{href:"https://umamiwallet.com/",children:"Umami"}),"."]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Switch the wallet to use the Ghostnet testnet instead of Tezos Mainnet.\nGhostnet is a network for testing Tezos applications where tokens are free so you don't have to spend real currency to work with your applications."}),"\n",(0,a.jsxs)(t.p,{children:["For example, for the Temple browser wallet, click ",(0,a.jsx)(t.strong,{children:"Tezos Mainnet"})," at the top and then click ",(0,a.jsx)(t.strong,{children:"Ghostnet Testnet"}),", as in this picture:"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Selecting the Ghostnet testnet in the Temple wallet",src:n(29304).A+"",width:"363",height:"377"})}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["From your wallet, get the address of your account, which starts with ",(0,a.jsx)(t.code,{children:"tz1"}),".\nThis is the address that applications use to work with your wallet."]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["Go to the Ghostnet faucet page at ",(0,a.jsx)(t.a,{href:"https://faucet.ghostnet.teztnets.com",children:"https://faucet.ghostnet.teztnets.com"}),"."]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:'On the faucet page, paste your wallet address into the input field labeled "Or fund any address" and click the button for the amount of tez to add to your wallet.\n20 tez is enough to work with the tutorial application, and you can return to the faucet later if you need more tez.'}),"\n",(0,a.jsx)(t.p,{children:"It may take a few minutes for the faucet to send the tokens and for those tokens to appear in your wallet."}),"\n",(0,a.jsx)(t.p,{children:"You can use the faucet as much as you need to get tokens on the testnet, but those tokens are worthless and cannot be used on Mainnet."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Fund your wallet using the Ghostnet Faucet",src:n(39354).A+"",width:"629",height:"238"})}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"If you created a new account, initialize the account by sending any amount of tez to any other account."}),"\n",(0,a.jsx)(t.p,{children:"Before the new account can use dApps, it must send at least one transaction to Tezos.\nThis first transaction reveals the public key that proves that transactions came from this account."}),"\n",(0,a.jsx)(t.p,{children:"If your account is new, you can send 1 tez to any other account, including your own account, via your wallet application to reveal the account."}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"Now you have an account and funds that you can use in dApps."}),"\n",(0,a.jsx)(t.h2,{id:"connecting-to-the-users-wallet",children:"Connecting to the user's wallet"}),"\n",(0,a.jsxs)(t.p,{children:["In this section, you add code to connect to the user's wallet with the Taquito ",(0,a.jsx)(t.code,{children:"TezosToolkit"})," and Beacon ",(0,a.jsx)(t.code,{children:"BeaconWallet"})," objects.\nTaquito accesses Tezos and Beacon accesses wallets."]}),"\n",(0,a.jsxs)(t.p,{children:["IMPORTANT: however you design your app, it is essential to use a single instance of the ",(0,a.jsx)(t.code,{children:"BeaconWallet"})," object.\nIt is also highly recommended use a single instance of the ",(0,a.jsx)(t.code,{children:"TezosToolkit"})," object.\nCreating multiple instances can cause problems in your app and with Taquito in general."]}),"\n",(0,a.jsxs)(t.p,{children:["This application keeps these objects in the ",(0,a.jsx)(t.code,{children:"App.svelte"})," file because this is the only component in the application.\nIf you add more components, you should move these objects to a separate file to maintain a single instance of them."]}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["In the ",(0,a.jsx)(t.code,{children:"src/App.svelte"})," file, add these imports to the ",(0,a.jsx)(t.code,{children:"<script>"})," section:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-javascript",children:'import { BeaconWallet } from "@taquito/beacon-wallet";\nimport { NetworkType } from "@airgap/beacon-types";\nimport { TezosToolkit } from "@taquito/taquito";\n'})}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Under those imports, create these constants that represent the Taquito toolkit's access to Tezos:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-javascript",children:'const rpcUrl = "https://ghostnet.ecadinfra.com";\nconst Tezos = new TezosToolkit(rpcUrl);\n'})}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Create variables to represent the wallet itself, its account address, and its balance:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-javascript",children:"let wallet;\nlet address;\nlet balance;\n"})}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["Still within the ",(0,a.jsx)(t.code,{children:"<script>"})," section, add this function to connect to the user's wallet:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-javascript",children:'const connectWallet = async () => {\n  const newWallet = new BeaconWallet({\n    name: "Simple dApp tutorial",\n    network: {\n     type: NetworkType.GHOSTNET,\n   },\n  });\n  await newWallet.requestPermissions();\n  address = await newWallet.getPKH();\n  getWalletBalance(address);\n  wallet = newWallet;\n};\n'})}),"\n",(0,a.jsxs)(t.p,{children:["This function creates an instance of the Beacon wallet toolkit, uses the ",(0,a.jsx)(t.code,{children:"requestPermissions()"})," function to ask the user's permission to connect to it, and retrieves its address and balance.\nIt provides a name for the app, which appears in the wallet UI when it asks the user to allow the connection.\nIt also includes the network to use, such as the Tezos main network or test network."]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Add this function to disconnect from the user's wallet:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-javascript",children:"const disconnectWallet = () => {\n  wallet.client.clearActiveAccount();\n  wallet = undefined;\n};\n"})}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Add this function to get the wallet's balance:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-javascript",children:"const getWalletBalance = async (walletAddress) => {\n  const balanceMutez = await Tezos.tz.getBalance(walletAddress);\n  balance = balanceMutez.div(1000000).toFormat(2);\n};\n"})}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["Update the ",(0,a.jsx)(t.code,{children:"<main>"})," section to have this code:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-html",children:'<h1>Tezos bank dApp</h1>\n\n<div class="card">\n   {#if wallet}\n    <p>The address of the connected wallet is {address}.</p>\n    <p>Its balance in tez is {balance}.</p>\n    <p>To get tez, go to <a href="https://faucet.ghostnet.teztnets.com/" target="_blank">\n       https://faucet.ghostnet.teztnets.com/\n      </a>.\n    </p>\n    <p>\n      <button on:click={disconnectWallet}> Disconnect wallet </button>\n    </p>\n   {:else}\n    <button on:click={connectWallet}> Connect wallet </button>\n   {/if}\n</div>\n'})}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:"if"})," condition in this code shows a button to connect to a wallet if there is no connected wallet.\nIf there is a connected wallet, it shows the address and balance of the wallet in tez."]}),"\n",(0,a.jsx)(t.p,{children:"The application could connect immediately when the page loads, but it's better user experience to let the page load first and allow the user to connect the wallet when they trust the application.\nConnecting the wallet is harmless because it does not give the application any control over the user's account, but it is still better user experience to keep the user in control.\nFor this reason, dApps should have prominent buttons to connect and disconnect wallets."}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(t.p,{children:["The complete ",(0,a.jsx)(t.code,{children:"App.svelte"})," file looks like this:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-html",children:'<script>\n  import { BeaconWallet } from "@taquito/beacon-wallet";\n  import { NetworkType } from "@airgap/beacon-types";\n  import { TezosToolkit } from "@taquito/taquito";\n\n  const rpcUrl = "https://ghostnet.ecadinfra.com";\n  const Tezos = new TezosToolkit(rpcUrl);\n\n  let wallet;\n  let address;\n  let balance;\n\n  const connectWallet = async () => {\n    const newWallet = new BeaconWallet({\n      name: "Simple dApp tutorial",\n      network: {\n        type: NetworkType.GHOSTNET,\n      },\n    });\n    await newWallet.requestPermissions();\n    address = await newWallet.getPKH();\n    getWalletBalance(address);\n    wallet = newWallet;\n  };\n\n  const disconnectWallet = () => {\n    wallet.client.clearActiveAccount();\n    wallet = undefined;\n  };\n\n  const getWalletBalance = async (walletAddress) => {\n    const balanceMutez = await Tezos.tz.getBalance(walletAddress);\n    balance = balanceMutez.div(1000000).toFormat(2);\n  };\n<\/script>\n\n<main>\n  <h1>Tezos bank dApp</h1>\n\n  <div class="card">\n    {#if wallet}\n      <p>The address of the connected wallet is {address}.</p>\n      <p>Its balance in tez is {balance}.</p>\n      <p>\n        To get tez, go to <a\n          href="https://faucet.ghostnet.teztnets.com/"\n          target="_blank"\n        >\n          https://faucet.ghostnet.teztnets.com/\n        </a>.\n      </p>\n      <p>\n        <button on:click={disconnectWallet}> Disconnect wallet </button>\n      </p>\n    {:else}\n      <button on:click={connectWallet}> Connect wallet </button>\n    {/if}\n  </div>\n</main>\n\n<style>\n</style>\n'})}),"\n",(0,a.jsx)(t.h2,{id:"using-the-application",children:"Using the application"}),"\n",(0,a.jsxs)(t.p,{children:["To try the application, run ",(0,a.jsx)(t.code,{children:"npm run dev"})," and open the page ",(0,a.jsx)(t.a,{href:"http://localhost:4000/",children:"http://localhost:4000/"})," in a web browser."]}),"\n",(0,a.jsx)(t.p,{children:'Because no wallet is connected, the app shows the "Connect wallet" button, as in this picture:'}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"The initial page of the bank dApp, showing a title and the button that connects to the user&#39;s wallet",src:n(70875).A+"",width:"339",height:"161"})}),"\n",(0,a.jsxs)(t.p,{children:["When you click ",(0,a.jsx)(t.strong,{children:"Connect wallet"}),", the ",(0,a.jsx)(t.code,{children:"connectWallet"})," function runs and the Beacon toolkit opens, showing some of the types of wallets it can connect to:"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"The Beacon wallet connection popup",src:n(22221).A+"",width:"290",height:"267"})}),"\n",(0,a.jsxs)(t.p,{children:["The procedure for connecting each type of wallet is different.\nFor example, if you are using the Temple browser extension, you click ",(0,a.jsx)(t.strong,{children:"Temple"})," and then ",(0,a.jsx)(t.strong,{children:"Connect now"}),".\nThen the Temple wallet shows a popup that allows you to confirm that you want to connect your wallet to the application, as in this picture:"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Connecting to the application in the Temple wallet",src:n(60241).A+"",width:"378",height:"599"})}),"\n",(0,a.jsxs)(t.p,{children:["Then the application runs the ",(0,a.jsx)(t.code,{children:"getWalletBalance"})," function, which gets the wallet's balance in tez tokens.\nBecause the Svelte component's variables changed, the application refreshes automatically and shows the wallet address, balance, and \"Disconnect wallet\" button:"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"The application showing information about the connected wallet",src:n(25423).A+"",width:"394",height:"188"})}),"\n",(0,a.jsxs)(t.p,{children:["If you click ",(0,a.jsx)(t.strong,{children:"Disconnect wallet"}),", the application goes back to its initial state."]}),"\n",(0,a.jsx)(t.p,{children:"Now the application can connect to user wallets.\nIn the next section, you add code to use the wallet to get the user's approval to send transactions to Tezos."}),"\n",(0,a.jsx)(t.h2,{id:"design-considerations",children:"Design considerations"}),"\n",(0,a.jsx)(t.p,{children:"Interacting with a wallet in a decentralized application is a new paradigm for many developers and users.\nFollow these practices to make the process easier for users:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Let users manually connect their wallets instead of prompting users to connect their wallet immediately when the app loads.\nGetting a wallet pop-up window before the user can see the page is annoying.\nAlso, users may hesitate to connect a wallet before they have had time to look at and trust the application, even though connecting the wallet is harmless."}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Provide a prominent button to connect and disconnect wallets."}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Put the button in a predictable position, typically at the top right or left corner of the interface."}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:'Use "Connect" as the label for the button.\nAvoid words like "sync" because they can have different meanings in dApps.'}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Display the status of the wallet clearly in the UI.\nYou can also add information about the wallet, including token balances and the connected network for the user's convenience, as this tutorial application does.\nShowing information about the tokens and updating it after transactions allows the user to verify that the application is working properly."}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"Enable and disable functions of the application based on the status of the wallet connection.\nFor example, if the wallet is not connected, disable buttons for transactions that require a wallet connection.\nAlso, disable transaction buttons while transactions are pending to prevent users from making duplicate transactions."}),"\n"]}),"\n"]})]})}function d(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},70875:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/bank-app-connect-button-b4a12cf39b733e2e165f09841fb9e9e3.png"},25423:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/bank-app-first-connection-78b91b9a45f253d1466353224ffcb73b.png"},22221:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/beacon-connect-wallet-options-62f16f68cbb2f13c7b43ae820a5921bf.png"},60241:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/temple-connect-wallet-c6837450d83a51f4f02c3ea67f2a231f.png"},29304:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/temple-switch-network-f922c04d15102345f2102373aabbfd9d.png"},39354:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/wallet-funding-e05c7102fac15a32ea27494ec05e8ab5.png"},28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>l});var s=n(96540);const a={},o=s.createContext(a);function i(e){const t=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(o.Provider,{value:t},e.children)}}}]);