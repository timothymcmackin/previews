"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[8740],{30828:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>d,frontMatter:()=>i,metadata:()=>a,toc:()=>r});const a=JSON.parse('{"id":"tutorials/create-nfts/connect-wallet","title":"Part 2: Connecting to wallets","description":"Before the application can interact with Tezos, you must connect to the user\'s wallet.","source":"@site/docs/tutorials/create-nfts/connect-wallet.md","sourceDirName":"tutorials/create-nfts","slug":"/tutorials/create-nfts/connect-wallet","permalink":"/previews/docs/docmap-thumbnail/tutorials/create-nfts/connect-wallet","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1734498000000,"frontMatter":{"title":"Part 2: Connecting to wallets","authors":"Tim McMackin","last_update":{"date":"18 December 2024"}},"sidebar":"tutorialsSidebar","previous":{"title":"Part 1: Setting up the application","permalink":"/previews/docs/docmap-thumbnail/tutorials/create-nfts/setting-up-app"},"next":{"title":"Part 3: Sending transactions","permalink":"/previews/docs/docmap-thumbnail/tutorials/create-nfts/send-transactions"}}');var s=n(74848),o=n(28453);const i={title:"Part 2: Connecting to wallets",authors:"Tim McMackin",last_update:{date:"18 December 2024"}},c=void 0,l={},r=[{value:"Testing the wallet connection",id:"testing-the-wallet-connection",level:2},{value:"Design considerations",id:"design-considerations",level:2}];function h(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"Before the application can interact with Tezos, you must connect to the user's wallet.\nConnecting to a wallet allows your application to get the address of the user's account, get information about the tokens in that account, and create transactions for the user to approve.\nConnecting to a wallet doesn't give the application direct control over an account, only the ability to send transactions to the wallet for the user to approve and sign."}),"\n",(0,s.jsx)(t.p,{children:"To connect to a user's wallet, you use the Beacon toolkit, which is a standard interface for Tezos wallets."}),"\n",(0,s.jsxs)(t.admonition,{type:"note",children:[(0,s.jsxs)(t.p,{children:["However you design your app, you must use a single instance of the ",(0,s.jsx)(t.code,{children:"BeaconWallet"})," object.\nIt is also highly recommended to use a single instance of the ",(0,s.jsx)(t.code,{children:"TezosToolkit"})," object.\nCreating multiple instances can cause problems in your app and with Taquito in general."]}),(0,s.jsxs)(t.p,{children:["Because this sample application has only one page, it defines the ",(0,s.jsx)(t.code,{children:"TezosToolkit"})," and ",(0,s.jsx)(t.code,{children:"BeaconWallet"})," objects in the code of that page.\nIf your application has multiple pages, define these objects in a single file and re-use them on each page."]})]}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["In the file ",(0,s.jsx)(t.code,{children:"src/App.svelte"}),", in the ",(0,s.jsx)(t.code,{children:'<script lang="ts">'})," section, after the existing code, add this code to connect to the user's wallet and get basic information about it, including its address and balance in tez:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:'let wallet;\nlet address;\nlet balance;\nlet statusMessage = "Connect your wallet.";\nlet buttonActive = false;\n\nconst connectWallet = async () => {\n  try {\n    const newWallet = new BeaconWallet({\n      name: "NFT app tutorial",\n      network: {\n       type: NetworkType.GHOSTNET,\n     },\n    });\n    await newWallet.requestPermissions();\n    address = await newWallet.getPKH();\n    const balanceMutez = await Tezos.tz.getBalance(address);\n    balance = balanceMutez.div(1000000).toFormat(2);\n    buttonActive = true;\n    statusMessage = "Wallet connected. Ready to mint NFTs.";\n    wallet = newWallet;\n  } catch (error) {\n    console.error("Error connecting wallet:", error);\n  }\n};\n'})}),"\n",(0,s.jsxs)(t.p,{children:["This ",(0,s.jsx)(t.code,{children:"connectWallet"})," function provides a name for the app, which appears in the wallet UI when it asks the user to allow the connection.\nIt also includes the network to use, such as the Tezos main network or test network.\nWhen it is connected, it sets the ",(0,s.jsx)(t.code,{children:"buttonActive"})," flag to true, which the UI will use to enable the button to create NFTs."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["After the ",(0,s.jsx)(t.code,{children:"connectWallet"})," function, add a function to disconnect the user's wallet:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:'const disconnectWallet = () => {\n  wallet.client.clearActiveAccount();\n  statusMessage = "Connect your wallet.";\n  wallet = undefined;\n  buttonActive = false;\n};\n'})}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"disconnectWallet"})," function runs these steps to disconnect the wallet and reset the state of the app:"]}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"It closes the connection to the Beacon SDK."}),"\n",(0,s.jsxs)(t.li,{children:["It nullifies the wallet reference by setting the ",(0,s.jsx)(t.code,{children:"wallet"})," variable to ",(0,s.jsx)(t.code,{children:"undefined"}),"."]}),"\n",(0,s.jsxs)(t.li,{children:["It deactivates the NFT button by setting the ",(0,s.jsx)(t.code,{children:"buttonActive"})," flag to false."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Update the ",(0,s.jsx)(t.code,{children:"<main>"})," block to have this code, which creates a button that the user can click to connect or disconnect their wallet:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-html",children:'<main>\n  <h1>Simple NFT dApp</h1>\n\n  <div class="card">\n    {#if wallet}\n      <p>The address of the connected wallet is {address}.</p>\n      <p>Its balance in tez is {balance}.</p>\n      <button on:click={disconnectWallet}>Disconnect wallet</button>\n    {:else}\n      <button on:click={connectWallet}>Connect wallet</button>\n    {/if}\n      <p>{statusMessage}</p>\n  </div>\n</main>\n'})}),"\n",(0,s.jsx)(t.p,{children:"Now you have functions that allow your application to connect and disconnect wallets."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"testing-the-wallet-connection",children:"Testing the wallet connection"}),"\n",(0,s.jsx)(t.p,{children:"Follow these steps to test that the application can connect to wallets:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Make sure that you have a wallet and some tez on the Ghostnet testnet in your account.\nSee ",(0,s.jsx)(t.a,{href:"/developing/wallet-setup",children:"Installing and funding a wallet"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Start the application by running the command ",(0,s.jsx)(t.code,{children:"npm run dev"})," in the folder that contains the ",(0,s.jsx)(t.code,{children:"package.json"})," file."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Open the web application in a web browser at ",(0,s.jsx)(t.code,{children:"http://localhost:4000"}),"."]}),"\n",(0,s.jsx)(t.p,{children:"The application shows the connection button and status message:"}),"\n",(0,s.jsx)("img",{src:"/img/tutorials/create-nfts-connect-not-connected.png",alt:"The application showing the wallet connection button",style:{width:300}}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Click the ",(0,s.jsx)(t.strong,{children:"Connect wallet"})," button and follow the prompts to connect your wallet.\nThe popup window can connect to wallet apps in your web browser or show a barcode to connect to a wallet app on a mobile device."]}),"\n",(0,s.jsx)(t.p,{children:"When the wallet connects successfully, the web application changes to show the connected account address and its balance in tez:"}),"\n",(0,s.jsx)("img",{src:"/img/tutorials/create-nfts-connect-connected.png",alt:"The application showing information about the connected account",style:{width:300}}),"\n",(0,s.jsxs)(t.p,{children:["If the wallet doesn't connect correctly, make sure that your application matches the application at ",(0,s.jsx)(t.a,{href:"https://github.com/trilitech/tutorial-applications/tree/main/create-nfts/part-2",children:"https://github.com/trilitech/tutorial-applications/tree/main/create-nfts/part-2"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Click the ",(0,s.jsx)(t.strong,{children:"Disconnect wallet"})," button and see that the wallet disconnects and the information disappears from the page."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["Now your application can connect to wallets.\nIn the next section, you create transactions for the user wallet to send to Tezos.\nReview the design considerations for dApps below and then continue to ",(0,s.jsx)(t.a,{href:"/tutorials/create-nfts/send-transactions",children:"Part 3: Sending transactions"}),"."]}),"\n",(0,s.jsx)(t.h2,{id:"design-considerations",children:"Design considerations"}),"\n",(0,s.jsx)(t.p,{children:"Interacting with a wallet in a decentralized application is a new paradigm for many developers and users.\nFollow these practices to make the process easier for users:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Let users manually connect their wallets instead of prompting users to connect their wallet immediately when the app loads.\nGetting a wallet pop-up window before the user can see the page is annoying.\nAlso, users may hesitate to connect a wallet before they have had time to look at and trust the application, even though connecting the wallet is harmless."}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Provide a prominent button to connect or disconnect wallets."}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Put the button in a predictable position, typically at the top right or left corner of the interface."}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Use ",(0,s.jsx)(t.strong,{children:"Connect"}),' as the label for the button.\nAvoid words like "sync" because they can have different meanings in dApps.']}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Display the status of the wallet connection clearly in the UI.\nYou can also add information about the wallet, including token balances and the connected network for the user's convenience.\nShowing information about the tokens and updating it after transactions allows the user to verify that the application is working properly."}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Enable and disable functions of the application based on the status of the wallet connection.\nFor example, if the wallet is not connected, disable buttons for transactions that require a wallet connection."}),"\n"]}),"\n"]})]})}function d(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>c});var a=n(96540);const s={},o=a.createContext(s);function i(e){const t=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),a.createElement(o.Provider,{value:t},e.children)}}}]);