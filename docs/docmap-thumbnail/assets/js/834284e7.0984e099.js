"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2722],{84638:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"tutorials/bake-with-ledger/setup-baker","title":"Set up your Ledger baking key with octez-signer","description":"It\u2019s recommended to use a separate machine to run the remote signer. For simplicity, in this tutorial, we assume a setup where the Ledger device is connected to the same machine running the baker binary. On the same machine, the following commands can be used to set up the baking key with octez-signer.","source":"@site/docs/tutorials/bake-with-ledger/setup-baker.md","sourceDirName":"tutorials/bake-with-ledger","slug":"/tutorials/bake-with-ledger/setup-baker","permalink":"/previews/docs/docmap-thumbnail/tutorials/bake-with-ledger/setup-baker","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1736485200000,"frontMatter":{"title":"Set up your Ledger baking key with octez-signer","authors":"S\xe9bastien Palmer","last_update":{"date":"10 January 2025"}},"sidebar":"tutorialsSidebar","previous":{"title":"Set up your ledger","permalink":"/previews/docs/docmap-thumbnail/tutorials/bake-with-ledger/setup-ledger"},"next":{"title":"Running a baker signing using a Ledger baking key","permalink":"/previews/docs/docmap-thumbnail/tutorials/bake-with-ledger/run-baker"}}');var s=t(74848),o=t(28453);const r={title:"Set up your Ledger baking key with octez-signer",authors:"S\xe9bastien Palmer",last_update:{date:"10 January 2025"}},c=void 0,a={},d=[{value:"Import a key from your Ledger device to the <code>octez-signer</code> context",id:"import-a-key-from-your-ledger-device-to-the-octez-signer-context",level:2},{value:"Authorise the baking key in the <code>Tezos Baking</code> application",id:"authorise-the-baking-key-in-the-tezos-baking-application",level:2},{value:"Link <code>octez-signer</code> to <code>octez-client</code>",id:"link-octez-signer-to-octez-client",level:2}];function l(e){const n={admonition:"admonition",blockquote:"blockquote",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["It\u2019s recommended to use a separate machine to run the remote signer. For simplicity, in this tutorial, we assume a setup where the Ledger device is connected to the same machine running the baker binary. On the same machine, the following commands can be used to set up the baking key with ",(0,s.jsx)(n.code,{children:"octez-signer"}),"."]}),"\n",(0,s.jsxs)(n.h2,{id:"import-a-key-from-your-ledger-device-to-the-octez-signer-context",children:["Import a key from your Ledger device to the ",(0,s.jsx)(n.code,{children:"octez-signer"})," context"]}),"\n",(0,s.jsxs)(n.p,{children:["Let's start by importing a key from your Ledger device for ",(0,s.jsx)(n.code,{children:"octez-signer"}),".\nConnect your Ledger device with a USB cable and open the ",(0,s.jsx)(n.code,{children:"Tezos Baking"})," application.\nTo see the available keys, run:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"octez-signer list connected ledgers\n"})}),"\n",(0,s.jsx)(n.p,{children:"Output:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-console",children:'## Ledger `masculine-pig-stupendous-dugong`\nFound a Tezos Baking 2.4.7 (git-description: "v2.4.7-70-g3195b4d2")\napplication running on Ledger Nano S Plus at [1-1.4.6:1.0].\n\nTo use keys at BIP32 path m/44\'/1729\'/0\'/0\' (default Tezos key path), use one\nof:\n  octez-client import secret key ledger_username "ledger://masculine-pig-stupendous-dugong/ed25519/0h/0h"\n  octez-client import secret key ledger_username "ledger://masculine-pig-stupendous-dugong/secp256k1/0h/0h"\n  octez-client import secret key ledger_username "ledger://masculine-pig-stupendous-dugong/P-256/0h/0h"\n  octez-client import secret key ledger_username "ledger://masculine-pig-stupendous-dugong/bip25519/0h/0h"\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Key's URIs are of the form ",(0,s.jsx)(n.code,{children:"ledger://<animals>/<curve>[/<path>]"})," where:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"<animals>"})," is the identifier of the ledger."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"<curve>"})," is the signing curve"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"<path>"})," is a BIP32 path anchored at m/44h/1729h. The ledger does not yet support non-hardened paths, so each node of the path must be hardened."]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{title:"Signing curve",type:"note",children:(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"secp256k1"})," and ",(0,s.jsx)(n.code,{children:"P-256"})," signature schemes (resp. ",(0,s.jsx)(n.code,{children:"tz2"})," and ",(0,s.jsx)(n.code,{children:"tz3"}),") have the best signature performance with the ",(0,s.jsx)(n.code,{children:"Tezos Baking"})," application."]})}),"\n",(0,s.jsxs)(n.p,{children:["Choose one of the URIs shown, modifying the BIP32 path as you like, then import it using ",(0,s.jsx)(n.code,{children:"octez-signer"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'octez-signer import secret key my_ledger_key "ledger://masculine-pig-stupendous-dugong/secp256k1/0h/0h"\n'})}),"\n",(0,s.jsxs)(n.p,{children:["On your Ledger device, you should see a screen sequence similar to:\n",(0,s.jsx)(n.img,{alt:"Ledger Key Review",src:t(78674).A+"",width:"1774",height:"202"})]}),"\n",(0,s.jsx)(n.p,{children:"If the public key hash displayed on your Ledger is equal to the address displayed in the command output, you can approve."}),"\n",(0,s.jsx)(n.p,{children:"Output:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-console",children:"Please validate (and write down) the public key hash displayed on the Ledger,\nit should be equal\nto `tz...`:\nTezos address added: tz...\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"authorise-the-baking-key-in-the-tezos-baking-application",children:["Authorise the baking key in the ",(0,s.jsx)(n.code,{children:"Tezos Baking"})," application"]}),"\n",(0,s.jsxs)(n.p,{children:["For your security, the ",(0,s.jsx)(n.code,{children:"Tezos Baking"})," application only allows one key to be used for signing. So you need to specify which key you want to bake with:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"octez-signer setup ledger to bake for my_ledger_key\n"})}),"\n",(0,s.jsxs)(n.p,{children:["On your Ledger device, you should see a screen sequence similar to:\n",(0,s.jsx)(n.img,{alt:"Ledger Setup Review",src:t(10372).A+"",width:"2269",height:"157"})]}),"\n",(0,s.jsx)(n.p,{children:"If the information displayed on your Ledger is similar to the information displayed in the command output, you can approve."}),"\n",(0,s.jsx)(n.p,{children:"Output:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-console",children:"Setting up the ledger:\n* Main chain ID: 'Unspecified' -> NetXdQprcVkpaWU\n* Main chain High Watermark: 0 (round: 0) -> 0 (round: 0)\n* Test chain High Watermark: 0 (round: 0) -> 0 (round: 0)\nAuthorized baking for address: tz...\nCorresponding full public key: ..pk...\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"link-octez-signer-to-octez-client",children:["Link ",(0,s.jsx)(n.code,{children:"octez-signer"})," to ",(0,s.jsx)(n.code,{children:"octez-client"})]}),"\n",(0,s.jsxs)(n.p,{children:["Now that your baking key on ",(0,s.jsx)(n.code,{children:"octez-signer"})," is linked to your Ledger device, ",(0,s.jsx)(n.code,{children:"octez-signer"})," will be in charge of signing using your Ledger device. Let's launch ",(0,s.jsx)(n.code,{children:"octez-signer"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"octez-signer launch socket signer -a localhost\n"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["The default port is ",(0,s.jsx)(n.code,{children:"7732"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["To be able to sign from ",(0,s.jsx)(n.code,{children:"octez-client"})," and from the baker binaries, you have to link your remote signer for ",(0,s.jsx)(n.code,{children:"octez-client"}),".\nIn a new terminal, run:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"octez-client -R 'tcp://localhost:7732' config update\n"})}),"\n",(0,s.jsxs)(n.p,{children:["This way, the key stored in the context of your ",(0,s.jsx)(n.code,{children:"octez-signer"})," will be accessible by remote from the ",(0,s.jsx)(n.code,{children:"octez-client"})," context."]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},78674:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/pkh-review-9d92571d7ad22dbf23a0aa07fbb5044b.png"},10372:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/setup-review-de9c8c305acc942cf7735d4320fe7935.png"},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>c});var i=t(96540);const s={},o=i.createContext(s);function r(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);