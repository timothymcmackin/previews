"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6212],{63189:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"architecture/tokens/FA2.1","title":"FA2.1 tokens","description":"The FA2.1 standard adds several features to tokens while remaining backward-compatible with the FA2 standard.","source":"@site/docs/architecture/tokens/FA2.1.md","sourceDirName":"architecture/tokens","slug":"/architecture/tokens/FA2.1","permalink":"/previews/docs/biel-custom-location/architecture/tokens/FA2.1","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1721707200000,"frontMatter":{"title":"FA2.1 tokens","authors":"Tim McMackin","last_update":{"date":"23 July 2024"}},"sidebar":"documentationSidebar","previous":{"title":"FA2 tokens","permalink":"/previews/docs/biel-custom-location/architecture/tokens/FA2"},"next":{"title":"Smart Rollups","permalink":"/previews/docs/biel-custom-location/architecture/smart-rollups"}}');var o=n(74848),a=n(28453);const r={title:"FA2.1 tokens",authors:"Tim McMackin",last_update:{date:"23 July 2024"}},i=void 0,c={},h=[{value:"Major changes from FA2",id:"major-changes-from-fa2",level:2},{value:"Examples",id:"examples",level:2},{value:"Metadata",id:"metadata",level:2},{value:"Tickets",id:"tickets",level:2},{value:"Access control",id:"access-control",level:2},{value:"Operators",id:"operators",level:3},{value:"Allowances",id:"allowances",level:3},{value:"Minting and burning",id:"minting-and-burning",level:2},{value:"Entrypoints",id:"entrypoints",level:2},{value:"Views",id:"views",level:2},{value:"Events",id:"events",level:2},{value:"Errors",id:"errors",level:2}];function l(e){const t={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",ul:"ul",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.p,{children:"The FA2.1 standard adds several features to tokens while remaining backward-compatible with the FA2 standard."}),"\n",(0,o.jsx)(t.p,{children:"Like FA2 tokens, FA2.1 tokens can be fungible or non-fungible."}),"\n",(0,o.jsxs)(t.p,{children:["For the full details of the FA2.1 standard, see ",(0,o.jsx)(t.a,{href:"https://gitlab.com/tezos/tzip/-/blob/master/proposals/tzip-26/tzip-26.md",children:"Tezos Improvement Proposal 26 (TZIP-26)"}),", which defines the standard."]}),"\n",(0,o.jsx)(t.h2,{id:"major-changes-from-fa2",children:"Major changes from FA2"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:"FA2.1 allows contracts to export tokens as tickets, use those tickets outside of the contract, and import those tickets back into the contract."}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:["FA2.1 includes on-chain ",(0,o.jsx)(t.a,{href:"/smart-contracts/views",children:"views"})," that allow contracts to provide information to on-chain and off-chain applications."]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:["FA2.1 includes ",(0,o.jsx)(t.a,{href:"/smart-contracts/events",children:"events"}),", which provide notifications of token-related activity to off-chain applications."]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:"FA2.1 adds the concept of allowances from FA1.2 so contracts can use operators or allowances to control access to tokens."}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"examples",children:"Examples"}),"\n",(0,o.jsxs)(t.p,{children:["For examples of FA2.1 contracts, see the ",(0,o.jsx)(t.a,{href:"https://gitlab.com/tezos/tzip/-/blob/master/proposals/tzip-26/tzip-26.md?ref_type=heads#implementation",children:"Implementation"})," section of the standard."]}),"\n",(0,o.jsx)(t.h2,{id:"metadata",children:"Metadata"}),"\n",(0,o.jsxs)(t.p,{children:["Like FA2 tokens, each FA2.1 token has metadata that describes what the token represents.\nThe standard provides multiple options for the structure of the metadata and it refers to other standards for how the metadata is stored.\nFA2.1 suggests that contracts store metadata according to ",(0,o.jsx)(t.a,{href:"https://gitlab.com/tezos/tzip/-/blob/master/proposals/tzip-21/tzip-21.md",children:"TZIP-21"}),", which is an extension of the TZIP-16 metadata standard used in FA2.\nFor examples of working with metadata, see the tutorial ",(0,o.jsx)(t.a,{href:"/tutorials/create-nfts",children:"Create NFTs from a web application"}),"."]}),"\n",(0,o.jsx)(t.h2,{id:"tickets",children:"Tickets"}),"\n",(0,o.jsxs)(t.p,{children:["A major change in FA2.1 is that contracts can optionally export ",(0,o.jsx)(t.a,{href:"/smart-contracts/data-types/complex-data-types#tickets",children:"tickets"})," that represent tokens.\nIn this case, the contract decreases an owner's balance of tokens and creates a ticket that represents those tokens.\nIt keeps the total balance of the tokens in its ledger the same.\nThen the ticket owner can transfer the ticket without using the original contract, similar to a wrapped token."]}),"\n",(0,o.jsxs)(t.p,{children:["Then, contracts can import tickets by accepting the ticket, destroying it, and increasing the user's balance of tokens.\nExporting and importing tickets in this way allows users to bridge tokens between Tezos layers, such as how ",(0,o.jsx)(t.a,{href:"https://docs.etherlink.com/get-started/bridging",children:"Bridging tokens"})," works in Etherlink.\nIt's even possible for a contract to import a ticket created by another contract, though this is not the default case; in most cases, contracts import and export only their own tickets that represent their own tokens."]}),"\n",(0,o.jsx)(t.h2,{id:"access-control",children:"Access control"}),"\n",(0,o.jsx)(t.p,{children:"FA2.1 token contracts can implement neither, either, or both of two different methods for controlling token access: operators and allowances.\nIf it implements neither method, only token owners can transfer tokens."}),"\n",(0,o.jsx)(t.h3,{id:"operators",children:"Operators"}),"\n",(0,o.jsx)(t.p,{children:"FA2.1 contracts can implement operators, which behave like they do in FA2 contracts."}),"\n",(0,o.jsxs)(t.p,{children:["Accounts that are authorized to transfer other accounts' tokens are called ",(0,o.jsx)(t.em,{children:"operators"}),".\nFor example, a user might want to sell a token on a marketplace, so they set the marketplace as an operator of that token type, which allows the marketplace to sell the token without getting further approval from the owner.\nUnlike allowances, operators can transfer any number of the owner's tokens of the specified type."]}),"\n",(0,o.jsx)(t.h3,{id:"allowances",children:"Allowances"}),"\n",(0,o.jsx)(t.p,{children:"FA2.1 contracts can implement allowances, which are similar to allowances in FA1.2 contracts."}),"\n",(0,o.jsxs)(t.p,{children:["In this case, the contract keeps track of how many tokens an account A permits another account B to transfer out of account A.\nThis limit is known as the ",(0,o.jsx)(t.em,{children:"allowance"})," for account B.\nIn this scenario, account B is known as the ",(0,o.jsx)(t.em,{children:"spender"})," for account A."]}),"\n",(0,o.jsxs)(t.p,{children:["The ",(0,o.jsx)(t.code,{children:"approve"})," entrypoint changes allowances."]}),"\n",(0,o.jsx)(t.p,{children:"This feature allows an account to authorize another account to transfer a certain amount of tokens on its behalf."}),"\n",(0,o.jsx)(t.p,{children:"For example, you might authorize an application to take a certain amount of your tokens, as part of one or several transactions, by setting the application's allowance for your tokens."}),"\n",(0,o.jsx)(t.p,{children:"The spender must have an allowance from the owner of the tokens for a number of their tokens to transfer.\nWhen a spender or token owner transfers tokens, their allowance decreases by the amount of tokens they transfer."}),"\n",(0,o.jsx)(t.p,{children:"Allowances also apply to the token owner.\nAn account cannot transfer more tokens than its allowance, even if it has enough tokens and it sent the request itself.\nThis means that if you want to transfer some of your tokens, you must first set your account's allowance to the amount to transfer."}),"\n",(0,o.jsx)(t.p,{children:"Unlike FA1.2 contracts, you can change an allowance from a non-zero amount to another non-zero amount."}),"\n",(0,o.jsx)(t.h2,{id:"minting-and-burning",children:"Minting and burning"}),"\n",(0,o.jsx)(t.p,{children:"Like FA2, FA2.1 does not require contracts to provide entrypoints that mint (create) or burn (destroy) tokens, but it permits developers to add those entrypoints if they choose.\nIf the contract does not have a mint entrypoint, it can create tokens in some other way or developers can initialize its storage with all of the tokens that it will ever have."}),"\n",(0,o.jsx)(t.h2,{id:"entrypoints",children:"Entrypoints"}),"\n",(0,o.jsx)(t.p,{children:"FA2.1 contracts must have these entrypoints:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"transfer"}),": Transfers tokens from a source account to one or more destination accounts.\nIts parameters are the address of the source account and a list of destination accounts, each with the token ID and amount to transfer."]}),"\n",(0,o.jsxs)(t.p,{children:["The core behavior of the ",(0,o.jsx)(t.code,{children:"transfer"})," entrypoint is similar to that of the FA2 entrypoint but the FA2.1 version has different rules for who can transfer tokens, as described in ",(0,o.jsx)(t.a,{href:"#access-control",children:"Access control"}),"."]}),"\n",(0,o.jsxs)(t.p,{children:["This entrypoint must emit the ",(0,o.jsx)(t.code,{children:"transfer_event"}),", ",(0,o.jsx)(t.code,{children:"balance_update"}),", and ",(0,o.jsx)(t.code,{children:"allowance_update"})," events."]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"balance_of"}),": Sends information about an owner's token balance to another contract.\nIts parameters are a callback contract that accepts a list of token IDs and the amount that the specified account owns.\nThis entrypoint is the same as in FA2."]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"update_operators"}),": Adds or removes operators for the specified token owners and token IDs.\nIts parameters are a list of commands to add or remove operators for token owners and IDs.\nThis entrypoint is the same as in FA2."]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"approve"}),": Sets the amount of tokens that an account can transfer on behalf of the token owner.\nIts parameters are a list of commands to increase or decrease the allowances for token owners and IDs.\nUnlike the ",(0,o.jsx)(t.code,{children:"approve"})," entrypoint in the FA1.2 standard, this entrypoint accepts a batch of parameters."]}),"\n",(0,o.jsxs)(t.p,{children:["This entrypoint must emit the ",(0,o.jsx)(t.code,{children:"allowance_update"})," event."]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"export_ticket"}),": Creates one or more tickets that represent an account's tokens and sends them to the specified addresses.\nThe contract deducts the tokens from the source account, but the contract's total supply of the tokens does not change; the ",(0,o.jsx)(t.code,{children:"get_total_supply"})," view must return the same amount of tokens as before the entrypoint was called."]}),"\n",(0,o.jsxs)(t.p,{children:["This entrypoint must follow the same access control rules as the ",(0,o.jsx)(t.code,{children:"transfer"})," entrypoint.\nFor example, if the contract is using operators, only the token owner or their operators can call this entrypoint."]}),"\n",(0,o.jsxs)(t.p,{children:["This entrypoint must emit the ",(0,o.jsx)(t.code,{children:"balance_update"})," and ",(0,o.jsx)(t.code,{children:"allowance_update"})," events but not the ",(0,o.jsx)(t.code,{children:"transfer_event"})," event."]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"import_ticket"}),": Accepts one or more tickets that represent tokens, destroys the tickets, and adds the tokens to the specified accounts.\nThis entrypoint is the converse of the ",(0,o.jsx)(t.code,{children:"export_ticket"})," entrypoint."]}),"\n",(0,o.jsxs)(t.p,{children:["This entrypoint must emit the ",(0,o.jsx)(t.code,{children:"balance_update"})," and ",(0,o.jsx)(t.code,{children:"total_supply_update"})," events but not the ",(0,o.jsx)(t.code,{children:"transfer_event"})," event."]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"lambda_export"}),": Creates one or more tickets and runs a lambda that determines what happens to them.\nFor security reasons, the contract runs the lambda in a separate sandbox contract."]}),"\n",(0,o.jsxs)(t.p,{children:["This entrypoint must emit the ",(0,o.jsx)(t.code,{children:"balance_update"})," and ",(0,o.jsx)(t.code,{children:"allowance_update"})," events."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:["The standard defines what happens when these entrypoints are called, the access control for them, the format of their parameters, and error cases.\nFor information about these requirements, see ",(0,o.jsx)(t.a,{href:"https://gitlab.com/tezos/tzip/-/blob/master/proposals/tzip-12/tzip-12.md",children:"TZIP-12"}),"."]}),"\n",(0,o.jsx)(t.p,{children:"FA2.1 contracts can add any other entrypoints in addition to the required entrypoints."}),"\n",(0,o.jsx)(t.h2,{id:"views",children:"Views"}),"\n",(0,o.jsx)(t.p,{children:"Unlike FA2, the FA2.1 standard specifies that entrypoints implement views to provide information about tokens.\nThe standard recommends that views don't fail or return errors but instead return meaningful default values.\nFor example, if a caller requests the balance of a non-existent address or token ID, the view should return 0."}),"\n",(0,o.jsx)(t.p,{children:"These are the views that FA2.1 contracts must implement:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"get_balance"}),": Returns the number of tokens of the specified token ID that the specified address owns."]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"get_total_supply"}),": Returns the total amount of the specified token ID.\nFor contracts that implement tickets, this amount includes the amount of tokens tracked directly in the contract ledger and the amount of tokens exported as tickets."]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"is_operator"}),": Returns true if the specified account is an operator of the specified account and token ID."]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"get_allowance"}),": Returns the allowance for the specified spender, owner, and token ID."]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"get_token_metadata"}),": Returns the metadata for the specified token ID."]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"is_token"}),": Returns true if the specified token ID exists."]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"events",children:"Events"}),"\n",(0,o.jsx)(t.p,{children:"Unlike FA2, the FA2.1 standard specifies that entrypoints emit events when they are called.\nTo avoid confusion about the order of events, the entrypoints must emit these events before other transactions."}),"\n",(0,o.jsx)(t.p,{children:"These are the events that FA2.1 contracts must emit and the entrypoints that emit them:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"transfer_event"}),": Emitted when tokens are transferred, either by the ",(0,o.jsx)(t.code,{children:"transfer"})," entrypoint or any other mechanism that transfers tickets.\nHowever, the ",(0,o.jsx)(t.code,{children:"export_ticket"})," and ",(0,o.jsx)(t.code,{children:"import_ticket"})," entrypoints should not emit this event.\nThe event includes the source and target accounts, the token ID, and the amount of tokens."]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"balance_update"}),": Emitted when the amount of tokens in an account changes, such as by the ",(0,o.jsx)(t.code,{children:"transfer"}),", ",(0,o.jsx)(t.code,{children:"export_ticket"}),", ",(0,o.jsx)(t.code,{children:"lambda_export"}),", and ",(0,o.jsx)(t.code,{children:"import_ticket"})," entrypoints.\nThe event includes the account, the token ID, the new balance, and the difference between the old and new balance."]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"total_supply_update"}),": Emitted when the total number of a certain token type changes, such as by minting tokens.\nThe event includes the token ID, the new total supply, and the difference between the old and new amounts."]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"operator_update"}),": Emitted when operators change, such as by the ",(0,o.jsx)(t.code,{children:"update_operators"})," entrypoint.\nThe event includes the token owner, the operator, the token ID, and a Boolean value that is true if the operator is being added or false if the operator is being removed."]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"allowance_update"}),": Emitted when a spender's allowance is changed, including when it is decreased as a result of a token transfer.\nThe event includes the token owner, the spender, the token ID, the new allowance, and the difference between the old and new allowances."]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"token_metadata_update"}),": Emitted when a token's metadata changes.\nThe event includes the token ID and an option type that contains the new metadata or ",(0,o.jsx)(t.code,{children:"none"})," if the token was burned."]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"errors",children:"Errors"}),"\n",(0,o.jsxs)(t.p,{children:["FA2.1 contracts use the same errors as FA2 contracts plus additional FA2.1 errors for failures related to tickets and allowances.\nFor a list of these errors, see ",(0,o.jsx)(t.a,{href:"https://gitlab.com/tezos/tzip/-/blob/master/proposals/tzip-26/tzip-26.md",children:"TZIP-26"}),"."]})]})}function d(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>i});var s=n(96540);const o={},a=s.createContext(o);function r(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);