"use strict";(self.webpackChunketherlink_docs=self.webpackChunketherlink_docs||[]).push([[64290],{90754:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>c,frontMatter:()=>s,metadata:()=>a,toc:()=>d});var r=t(85893),o=t(11151);const s={title:"Running an Etherlink EVM node"},i=void 0,a={id:"network/evm-nodes",title:"Running an Etherlink EVM node",description:"The Etherlink EVM nodes are responsible for maintaining a copy of the Etherlink context and applying new blueprints that process EVM transactions.",source:"@site/docs/network/evm-nodes.md",sourceDirName:"network",slug:"/network/evm-nodes",permalink:"/previews/etherlink/connection-buttons/network/evm-nodes",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedAt:1732109838e3,frontMatter:{title:"Running an Etherlink EVM node"},sidebar:"documentationSidebar",previous:{title:"Running an Etherlink Smart Rollup node",permalink:"/previews/etherlink/connection-buttons/network/smart-rollup-nodes"},next:{title:"Building the Etherlink kernel",permalink:"/previews/etherlink/connection-buttons/network/building-kernel"}},l={},d=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"System requirements",id:"system-requirements",level:2},{value:"Getting the <code>octez-evm-node</code> binary",id:"getting-the-octez-evm-node-binary",level:2},{value:"Initializing the data directory",id:"initializing-the-data-directory",level:2},{value:"Running the node",id:"running-the-node",level:2},{value:"From a snapshot",id:"from-a-snapshot",level:3},{value:"From an existing Etherlink Smart Rollup node",id:"from-an-existing-etherlink-smart-rollup-node",level:3},{value:"From genesis",id:"from-genesis",level:3}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"The Etherlink EVM nodes are responsible for maintaining a copy of the Etherlink context and applying new blueprints that process EVM transactions."}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Make sure you understand the interaction between different nodes as described in ",(0,r.jsx)(n.a,{href:"/network/architecture",children:"Etherlink architecture"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["If you want to verify the blueprints that come from the sequencer, run an Etherlink Smart Rollup node as described in ",(0,r.jsx)(n.a,{href:"/network/smart-rollup-nodes",children:"Running an Etherlink Smart Rollup node"}),".\nPublic Smart Rollup nodes for Etherlink are not yet available, so you must run your own if you want to participate in the Etherlink network."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"The EVM node runs Etherlink's kernel.\nYou can get the kernel by importing it from a running Etherlink Smart Rollup node or by providing the installer kernel."}),"\n",(0,r.jsx)(n.h2,{id:"system-requirements",children:"System requirements"}),"\n",(0,r.jsx)(n.p,{children:"Running an Etherlink EVM node on Etherlink Mainnet requires a computer with 500GB of disk space and at least 16GB RAM."}),"\n",(0,r.jsxs)(n.h2,{id:"getting-the-octez-evm-node-binary",children:["Getting the ",(0,r.jsx)(n.code,{children:"octez-evm-node"})," binary"]}),"\n",(0,r.jsxs)(n.p,{children:["The easiest way to get the ",(0,r.jsx)(n.code,{children:"octez-evm-node"})," binary is to download the binaries distributed as part of its latest release from ",(0,r.jsx)(n.a,{href:"https://gitlab.com/tezos/tezos/-/releases",children:"https://gitlab.com/tezos/tezos/-/releases"}),".\nThe release page provides static binaries for Linux systems (for amd64 and arm64 architectures)."]}),"\n",(0,r.jsxs)(n.p,{children:["As an alternative, you can use the minimal Docker image ",(0,r.jsx)(n.a,{href:"https://hub.docker.com/r/tezos/tezos-bare/tags?name=octez-evm-node",children:"tezos/tezos-bare"})," with a tag that includes ",(0,r.jsx)(n.code,{children:"octez-evm-node"}),".\nThese images contain the correct version of the binary."]}),"\n",(0,r.jsx)(n.h2,{id:"initializing-the-data-directory",children:"Initializing the data directory"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["If you want your EVM node to check the correctness of the blueprints it receives via a Smart Rollup node, set the ",(0,r.jsx)(n.code,{children:"sr_node_observer_rpc"})," environment variable to the URL of that Etherlink Smart Rollup node, such as ",(0,r.jsx)(n.code,{children:"http://localhost:8932"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Set the ",(0,r.jsx)(n.code,{children:"evm_observer_dir"})," environment variable to the directory where the node should store its local data.\nThe default is ",(0,r.jsx)(n.code,{children:"$HOME/.octez-evm-node"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Initialize the node. To trust incoming blueprints, use ",(0,r.jsx)(n.code,{children:"--dont-track-rollup-node"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"octez-evm-node init config \\\n  --data-dir $evm_observer_dir --dont-track-rollup-node \\\n  --preimages-endpoint https://snapshots.eu.tzinit.org/etherlink-mainnet/wasm_2_0_0 \\\n  --evm-node-endpoint https://relay.mainnet.etherlink.com\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Alternatively, if you want to rely on a Smart Rollup node to check the correctness of blueprints coming from the sequencer, use ",(0,r.jsx)(n.code,{children:"--rollup-node-endpoint"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"octez-evm-node init config \\\n  --data-dir $evm_observer_dir --rollup-node-endpoint $sr_node_observer_rpc \\\n  --preimages-endpoint https://snapshots.eu.tzinit.org/etherlink-mainnet/wasm_2_0_0 \\\n  --evm-node-endpoint https://relay.mainnet.etherlink.com\n"})}),"\n",(0,r.jsxs)(n.p,{children:["This configuration uses the preimages that the Tezos Foundation hosts on a file server on a so-called \"preimages endpoint\".\nIt's safe to use these preimages because the node verifies them.\nIf you don't want to use third-party preimages, you can build the kernel yourself and move the contents of the ",(0,r.jsx)(n.code,{children:"wasm_2_0_0/"})," directory to the local data directory; see ",(0,r.jsx)(n.a,{href:"/network/building-kernel",children:"Building the Etherlink kernel"}),".\nHowever, in this case, you must manually update this directory with the preimages of every kernel voted by the community and deployed on Etherlink after that."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"running-the-node",children:"Running the node"}),"\n",(0,r.jsx)(n.p,{children:"You can initialize the node from a snapshot or allow it to compute the Etherlink state from genesis, which can take a long time."}),"\n",(0,r.jsx)(n.h3,{id:"from-a-snapshot",children:"From a snapshot"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Download ",(0,r.jsx)(n.a,{href:"http://vps-58f6d7fc.vps.ovh.net/snapshots/",children:"an Etherlink snapshot"}),", and use the ",(0,r.jsx)(n.code,{children:"octez-evm-node"})," to import it. Assuming you have set ",(0,r.jsx)(n.code,{children:"$latest_snapshot"})," to the name of the latest snapshot,"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"wget http://vps-58f6d7fc.vps.ovh.net/snapshots/$latest_snapshot -O snapshot.gz\noctez-evm-node snapshot import snapshot.gz --data-dir $evm_observer_dir\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Run this command to start the node:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"octez-evm-node run observer --data-dir $evm_observer_dir\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["By default, the EVM node exposes its JSON RPC API endpoint to ",(0,r.jsx)(n.code,{children:"localhost:8545"}),".\nYou can test that everything works as expected by running RPC requests manually or by setting your wallet to use your local node.\nFor example, this command gets the number of the most recent block in hexadecimal:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -X POST -H \'Content-Type: application/json\' --data \'{"jsonrpc":"2.0","method":"eth_blockNumber"}\' http://localhost:8545\n'})}),"\n",(0,r.jsx)(n.h3,{id:"from-an-existing-etherlink-smart-rollup-node",children:"From an existing Etherlink Smart Rollup node"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Download ",(0,r.jsx)(n.a,{href:"https://snapshots.eu.tzinit.org/etherlink-ghostnet/",children:"an Etherlink Smart Rollup node snapshot"}),", and use the ",(0,r.jsx)(n.code,{children:"octez-smart-rollup-node"})," binary to import it in a temporary directory."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"wget https://snapshots.eu.tzinit.org/etherlink-mainnet/eth-mainnet.full\noctez-smart-rollup-node --endpoint https://rpc.tzkt.io/mainnet \\\n  snapshot import eth-mainnet.full \\\n  --data-dir $sr_observer_data_dir\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsx)(n.p,{children:"If you are running a Smart Rollup node on the same machine, you can skip this step because you can reuse its data directory."})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Set the ",(0,r.jsx)(n.code,{children:"sr_observer_data_dir"})," environment variable to the location of the data directory you got from the previous step."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Run this command to import the kernel from the Smart Rollup node:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"octez-evm-node init from rollup node $sr_observer_data_dir --data-dir $evm_observer_dir\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Run this command to start the node:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"octez-evm-node run observer --data-dir $evm_observer_dir\n"})}),"\n",(0,r.jsx)(n.p,{children:"The EVM node runs in archive mode."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["By default, the EVM node exposes its JSON RPC API endpoint to ",(0,r.jsx)(n.code,{children:"localhost:8545"}),".\nYou can test that everything works as expected by running RPC requests manually or by setting your wallet to use your local node.\nFor example, this command gets the number of the most recent block in hexadecimal:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -X POST -H \'Content-Type: application/json\' --data \'{"jsonrpc":"2.0","method":"eth_blockNumber"}\' http://localhost:8545\n'})}),"\n",(0,r.jsx)(n.h3,{id:"from-genesis",children:"From genesis"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Get the Etherlink installer kernel (",(0,r.jsx)(n.code,{children:"installer.hex"})," file), which you can build yourself as described in ",(0,r.jsx)(n.a,{href:"/network/building-kernel",children:"Building the Etherlink kernel"})," or download here: ",(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(39716).Z+"",children:"installer.hex"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Run this command to start the node with the Etherlink installer kernel that you built or downloaded; change the name of the ",(0,r.jsx)(n.code,{children:"installer.hex"})," file in the command accordingly:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"octez-evm-node run observer --data-dir $evm_observer_dir --initial-kernel installer.hex\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"--initial-kernel"})," argument is needed only the first time that you start the node."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["By default, the EVM node exposes its JSON RPC API endpoint to ",(0,r.jsx)(n.code,{children:"localhost:8545"}),".\nYou can test that everything works as expected by running RPC requests manually or by setting your wallet to use your local node.\nFor example, you can call the node's RPC API with this command, putting the URL to your EVM node at the end:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -X POST -H \'Content-Type: application/json\' --data \'{"jsonrpc":"2.0","method":"tez_kernelVersion"}\' http://localhost:8545\n'})})]})}function c(e={}){const{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},39716:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/files/installer-df17277bbd62ff61bfd336fd0393e238.hex"},11151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>i});var r=t(67294);const o={},s=r.createContext(o);function i(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);